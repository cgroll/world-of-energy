{"version":3,"kind":"Notebook","sha256":"d512a743e9a88552b4b4387c7b1a1da7c83f391e2bfc2467d86459b556adc696","slug":"notebooks.pressure-and-weather","location":"/notebooks/13_pressure_and_weather.ipynb","dependencies":[],"frontmatter":{"title":"Pressure Levels and the Jet Stream","content_includes_title":false,"kernelspec":{"name":"world-of-energy","display_name":"World of Energy","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","numbering":{"title":{"offset":1}},"source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/13_pressure_and_weather.ipynb","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/13_pressure_and_weather.ipynb","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","exports":[{"format":"ipynb","filename":"13_pressure_and_weather.ipynb","url":"/world-of-energy/build/13_pressure_and_weat-44041d1df367ab8bc8a3537292ffdf44.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The atmosphere is not just a flat layer of air — it has rich three-dimensional\nstructure.  Weather systems, temperature gradients, and especially the\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i4MQInYqVx"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"jet stream","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xutHmO1lL2"}],"key":"T6AexUMq02"},{"type":"text","value":" only make sense once you understand how the atmosphere is\nstacked vertically.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YxxAAvkBb7"}],"key":"cii2D9RBvN"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"This notebook explores that structure using ERA5 reanalysis data for a\nsingle snapshot (2025-06-03 12:00 UTC), combining surface observations with\npressure-level data to build an intuition for the jet stream as a\n","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qmGUM9UskO"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"three-dimensional tube of fast-moving air","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LGTuxwOfct"}],"key":"KCuhEGXHel"},{"type":"text","value":" circling the globe at\nroughly 10 km altitude.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Tal9g8tWiE"}],"key":"W57jaxDtej"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"We start at the surface, then work our way up through the atmosphere,\nbefore looking at vertical cross-sections that reveal the full 3D shape.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wwfWcpBas7"}],"key":"Yc4CAreEO6"}],"key":"zLzygpmWXF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:17.608454Z","iopub.status.busy":"2026-03-01T17:11:17.608362Z","iopub.status.idle":"2026-03-01T17:11:18.368706Z","shell.execute_reply":"2026-03-01T17:11:18.367941Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import io\n\nimport numpy as np\nimport xarray as xr\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as mticker\nimport matplotlib.patches as mpatches\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nfrom cartopy.util import add_cyclic_point\nfrom matplotlib.colors import LinearSegmentedColormap\nfrom PIL import Image\n\nfrom woe.paths import ProjPaths\n\npaths = ProjPaths()","key":"NurBSS1CFy"},{"type":"outputs","id":"JLpLso_7ZiG1Ub8TeSRbD","children":[],"key":"plQm3mKHzp"}],"key":"s42EoY7yAc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:18.370884Z","iopub.status.busy":"2026-03-01T17:11:18.370580Z","iopub.status.idle":"2026-03-01T17:11:18.472918Z","shell.execute_reply":"2026-03-01T17:11:18.472273Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"DATE = \"2025-06-03\"\nTIME = \"2025-06-03T12:00:00\"\nG = 9.80665  # standard gravity m/s²\n\nds_sfc = xr.open_dataset(paths.era5_snapshot_20250603_1200_surface_file)\nds_pl  = xr.open_dataset(paths.era5_snapshot_20250603_1200_pressure_file)\n\nprint(f\"Surface dimensions:        {dict(ds_sfc.dims)}\")\nprint(f\"Surface variables:         {list(ds_sfc.data_vars)}\")\nprint(f\"Pressure-level dimensions: {dict(ds_pl.dims)}\")\nprint(f\"Pressure-level variables:  {list(ds_pl.data_vars)}\")\nprint(f\"Pressure levels (hPa):     {sorted(ds_pl.level.values.tolist(), reverse=True)}\")","key":"sa87uHScMo"},{"type":"outputs","id":"a3OKgxjJPuI7km707cNWR","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Surface dimensions:        {'latitude': 721, 'longitude': 1440}\nSurface variables:         ['2m_temperature', '10m_u_component_of_wind', '10m_v_component_of_wind', 'mean_sea_level_pressure', 'total_precipitation', 'total_cloud_cover']\nPressure-level dimensions: {'level': 12, 'latitude': 721, 'longitude': 1440}\nPressure-level variables:  ['geopotential', 'temperature', 'u_component_of_wind', 'v_component_of_wind']\nPressure levels (hPa):     [850, 500, 400, 350, 300, 250, 225, 200, 175, 150, 125, 100]\n"},"children":[],"key":"ZZmin0Jsff"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/243307618.py:8: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  print(f\"Surface dimensions:        {dict(ds_sfc.dims)}\")\n/tmp/ipykernel_151767/243307618.py:10: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  print(f\"Pressure-level dimensions: {dict(ds_pl.dims)}\")\n"},"children":[],"key":"ynn7DYQePN"}],"key":"DlMGpxNvOM"}],"key":"MXdTKpdmhf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:18.474105Z","iopub.status.busy":"2026-03-01T17:11:18.473933Z","iopub.status.idle":"2026-03-01T17:11:18.520656Z","shell.execute_reply":"2026-03-01T17:11:18.519948Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# --- Surface fields ---\nt2m      = ds_sfc[\"2m_temperature\"].squeeze()\nt2m_c    = t2m - 273.15\nu10      = ds_sfc[\"10m_u_component_of_wind\"].squeeze()\nv10      = ds_sfc[\"10m_v_component_of_wind\"].squeeze()\nwspd10   = np.sqrt(u10**2 + v10**2)\ntcc      = ds_sfc[\"total_cloud_cover\"].squeeze()\n\nlats_sfc = ds_sfc.latitude.values\nlons_sfc = ds_sfc.longitude.values\n\n# --- Pressure-level fields ---\nlats_pl = ds_pl.latitude.values\nlons_pl = ds_pl.longitude.values\n\n# Levels sorted from high pressure (low altitude) → low pressure (high altitude)\nlevels_sorted = sorted(ds_pl.level.values.tolist(), reverse=True)\n\nu250   = ds_pl[\"u_component_of_wind\"].sel(level=250).squeeze()\nv250   = ds_pl[\"v_component_of_wind\"].sel(level=250).squeeze()\nwspd250 = np.sqrt(u250**2 + v250**2)\n\ngph500  = ds_pl[\"geopotential\"].sel(level=500).squeeze() / G  # metres\n\nprint(f\"2m temperature:    {float(t2m_c.min()):.1f}°C to {float(t2m_c.max()):.1f}°C\")\nprint(f\"10m wind speed:    {float(wspd10.min()):.1f}–{float(wspd10.max()):.1f} m/s\")\nprint(f\"250 hPa max wind:  {float(wspd250.max()):.1f} m/s\")\nprint(f\"500 hPa GPH range: {float(gph500.min()):.0f}–{float(gph500.max()):.0f} m\")","key":"C9GReKaVbR"},{"type":"outputs","id":"PT4g1kotRhxZtHRUZB5K-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"2m temperature:    -68.5°C to 46.0°C\n10m wind speed:    0.0–24.4 m/s\n250 hPa max wind:  81.7 m/s\n500 hPa GPH range: 4784–5959 m\n"},"children":[],"key":"KQnyWuUzeF"}],"key":"ZVZmclUQQH"}],"key":"vuqW82Imf7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Surface weather","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TUMX8ubSCW"}],"identifier":"surface-weather","label":"Surface weather","html_id":"surface-weather","implicit":true,"key":"Vq1TTYHkZu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Before climbing into the atmosphere, we look at what is happening at the\nEarth’s surface on this snapshot.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aV7njNQJSQ"}],"key":"tWSM6AxDrJ"}],"key":"NOAKIANV2m"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2m Temperature","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YeyWvDMGVy"}],"identifier":"id-2m-temperature","label":"2m Temperature","html_id":"id-2m-temperature","implicit":true,"key":"uK0EvgGuoJ"}],"key":"uokSHeozmO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:18.522067Z","iopub.status.busy":"2026-03-01T17:11:18.521981Z","iopub.status.idle":"2026-03-01T17:11:34.290624Z","shell.execute_reply":"2026-03-01T17:11:34.289867Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(16, 9), subplot_kw={\"projection\": ccrs.Robinson()})\n\nim = ax.pcolormesh(\n    lons_sfc, lats_sfc, t2m_c.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdYlBu_r\", vmin=-40, vmax=45, shading=\"auto\",\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\"--\")\nax.set_global()\nax.set_title(f\"ERA5 2m Temperature — {DATE} 12:00 UTC\", fontsize=14)\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.6)\ncbar.set_label(\"Temperature (°C)\")\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_surface_temperature.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"hGQ2BrqsLb"},{"type":"outputs","id":"w32nPWn1EZLVINnRiSCMt","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/760305152.py:18: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"Bzn1fRluKM"}],"key":"Z2XBXIV385"}],"key":"CbrJkXHoWM"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","alt":"ERA5 2m temperature on 2025-06-03 at 12:00 UTC.  The classic summer contrast\nbetween the warm continents (especially the Middle East and Central Asia) and the\ncooler oceans and polar regions is clearly visible.","data":{"altTextIsAutoGenerated":true},"key":"fGoqmldoLu","urlSource":"../../output/images/13_surface_temperature.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-surface-temperature","identifier":"fig-13-surface-temperature","html_id":"fig-13-surface-temperature","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"uvMVq0mfAa"},{"type":"text","value":"1","key":"w2xNhyYTyE"},{"type":"text","value":":","key":"lmvUSg3JU1"}],"template":"Figure %s:","key":"e2oSorp4pb"},{"type":"text","value":"ERA5 2m temperature on 2025-06-03 at 12:00 UTC.  The classic summer contrast\nbetween the warm continents (especially the Middle East and Central Asia) and the\ncooler oceans and polar regions is clearly visible.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x3Rkqug2JC"}],"key":"iE1WOZAPjP"}],"key":"azFP9EdYBO"}],"label":"fig-13-surface-temperature","identifier":"fig-13-surface-temperature","enumerator":"1","html_id":"fig-13-surface-temperature","key":"T1COHeJEj4"}],"key":"oITdouAJyp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10m Wind Speed","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XAwCSI09JQ"}],"identifier":"id-10m-wind-speed","label":"10m Wind Speed","html_id":"id-10m-wind-speed","implicit":true,"key":"a00ma9Ic7m"}],"key":"wruPHqv6oi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:34.292310Z","iopub.status.busy":"2026-03-01T17:11:34.292180Z","iopub.status.idle":"2026-03-01T17:11:50.574273Z","shell.execute_reply":"2026-03-01T17:11:50.573311Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"wspd10_c, lons10_c = add_cyclic_point(wspd10.values, coord=lons_sfc)\nu10_c, _           = add_cyclic_point(u10.values,    coord=lons_sfc)\nv10_c, _           = add_cyclic_point(v10.values,    coord=lons_sfc)\n\nstride     = 20  # 0.25° × 20 = 5° subsampling for arrows\nlons10_sub = lons10_c[::stride]\nlats10_sub = lats_sfc[::stride]\nu10_sub    = u10_c[::stride, ::stride]\nv10_sub    = v10_c[::stride, ::stride]\nwspd10_sub = np.sqrt(u10_sub**2 + v10_sub**2)\nwspd10_sub = np.where(wspd10_sub == 0, 1, wspd10_sub)\nu10_norm   = u10_sub / wspd10_sub\nv10_norm   = v10_sub / wspd10_sub\n\nfig = plt.figure(figsize=(16, 8))\nax = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\ncf = ax.contourf(\n    lons10_c, lats_sfc, wspd10_c,\n    levels=np.arange(0, 25, 2),\n    cmap=\"YlOrRd\", transform=ccrs.PlateCarree(), extend=\"max\",\n)\nax.quiver(\n    lons10_sub, lats10_sub, u10_norm, v10_norm,\n    transform=ccrs.PlateCarree(),\n    color=\"steelblue\", alpha=0.7, scale=80, width=0.002,\n    headwidth=3, headlength=3, headaxislength=3.75, regrid_shape=None,\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\")\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7)\nax.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\", zorder=0)\nax.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\", zorder=0)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90, 91,  30))\n\ncbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\", pad=0.03, fraction=0.04, aspect=40)\ncbar.set_label(\"10 m wind speed (m/s)\", fontsize=11)\nax.set_title(\n    f\"Surface wind — 10 m speed and direction\\n{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n    fontsize=13, pad=10,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_surface_wind.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"ZL80ZPEXi4"},{"type":"outputs","id":"EFhqrK-M0CHTUvmOMOidN","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Pl8D45WKzY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/2893093739.py:49: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"VVE9yeGIjG"}],"key":"EIlApSJwdQ"}],"key":"W2TlSsny4b"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_surface_wind-95319e4b3c6625c65805fc7e68e9fe0a.png","alt":"ERA5 10 m wind speed (filled contours) and direction (blue arrows) on\n2025-06-03 at 12:00 UTC.  The strongest surface winds are found over the\nstorm-track regions of the Southern Ocean and North Atlantic.  Blue arrows\nshow normalised wind direction; colour shows magnitude.","data":{"altTextIsAutoGenerated":true},"key":"Vi5TzIaIVl","urlSource":"../../output/images/13_surface_wind.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-surface-wind","identifier":"fig-13-surface-wind","html_id":"fig-13-surface-wind","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"sDDN2fRGJd"},{"type":"text","value":"2","key":"vT8g28rZua"},{"type":"text","value":":","key":"m4I2wb1DHn"}],"template":"Figure %s:","key":"j757Okec6o"},{"type":"text","value":"ERA5 10 m wind speed (filled contours) and direction (blue arrows) on\n2025-06-03 at 12:00 UTC.  The strongest surface winds are found over the\nstorm-track regions of the Southern Ocean and North Atlantic.  Blue arrows\nshow normalised wind direction; colour shows magnitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l6djuyjLFc"}],"key":"wG61f5Jb3M"}],"key":"haTcoOBCNI"}],"label":"fig-13-surface-wind","identifier":"fig-13-surface-wind","enumerator":"2","html_id":"fig-13-surface-wind","key":"Msu054QVMh"}],"key":"MsHBm2rWCH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cloud cover over satellite imagery","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BL9hCn7sOD"}],"identifier":"cloud-cover-over-satellite-imagery","label":"Cloud cover over satellite imagery","html_id":"cloud-cover-over-satellite-imagery","implicit":true,"key":"qxlVSr9bfA"}],"key":"ytpSJkk669"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:50.575513Z","iopub.status.busy":"2026-03-01T17:11:50.575416Z","iopub.status.idle":"2026-03-01T17:12:06.071669Z","shell.execute_reply":"2026-03-01T17:12:06.071010Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"cloud_cmap = LinearSegmentedColormap.from_list(\"clouds\", [\n    (1, 1, 1, 0),   # transparent where cloud-free\n    (1, 1, 1, 1),   # opaque white where fully overcast\n])\n\nfig, ax = plt.subplots(figsize=(16, 9), subplot_kw={\"projection\": ccrs.Robinson()})\nax.stock_img()\n\nax.pcolormesh(\n    lons_sfc, lats_sfc, tcc.values,\n    transform=ccrs.PlateCarree(),\n    cmap=cloud_cmap, vmin=0, vmax=1, shading=\"auto\",\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.4, color=\"0.3\")\nax.add_feature(cfeature.BORDERS,   linewidth=0.2, linestyle=\"--\", color=\"0.4\")\nax.set_global()\nax.set_title(f\"ERA5 Cloud Cover over Blue Marble — {DATE} 12:00 UTC\", fontsize=14)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_cloud_satellite.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"QQLY0cNwaD"},{"type":"outputs","id":"2IQzQKKddTZRkOSXivIBy","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Ju30y8Q4RA"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/880923943.py:21: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"nr0U22Yq7h"}],"key":"yPEji7Xgcx"}],"key":"a7uypZpSNK"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_cloud_satellite-b4737e22972b999986536e05ec4b5b7d.png","alt":"ERA5 total cloud cover overlaid on Blue Marble satellite imagery.  Cloud-free\nareas reveal the land/ocean surface; white patches mark frontal systems and\nconvective clouds over the tropics.","data":{"altTextIsAutoGenerated":true},"key":"zWhWgrTxIs","urlSource":"../../output/images/13_cloud_satellite.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-cloud-satellite","identifier":"fig-13-cloud-satellite","html_id":"fig-13-cloud-satellite","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"yFQv5rLI5D"},{"type":"text","value":"3","key":"MJw2jDTS2o"},{"type":"text","value":":","key":"UdtxvuxIff"}],"template":"Figure %s:","key":"lvi8gULMae"},{"type":"text","value":"ERA5 total cloud cover overlaid on Blue Marble satellite imagery.  Cloud-free\nareas reveal the land/ocean surface; white patches mark frontal systems and\nconvective clouds over the tropics.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KPwejoanjV"}],"key":"Ovz9RJLcWk"}],"key":"bPycrvcoqz"}],"label":"fig-13-cloud-satellite","identifier":"fig-13-cloud-satellite","enumerator":"3","html_id":"fig-13-cloud-satellite","key":"kkAJQgy4PB"}],"key":"l7uEoReHxx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What are pressure levels?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V1EBpJH4CO"}],"identifier":"what-are-pressure-levels","label":"What are pressure levels?","html_id":"what-are-pressure-levels","implicit":true,"key":"s920mCiL7B"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The atmosphere is divided into ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"frzBF84RGm"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"pressure levels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KiwtHbCGoz"}],"key":"sJvgsdG0ao"},{"type":"text","value":" — horizontal surfaces where\nair pressure has the same value everywhere.  Standard levels include\n1000 hPa (near sea level), 850 hPa (~1.5 km), 500 hPa (~5.5 km), and\n250 hPa (~10 km).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MIkmDEn7j9"}],"key":"y3RrpQsiDK"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"A crucial insight is that these surfaces are ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PGiU1tizDK"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"not flat","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OfaH6p3piP"}],"key":"b6xBl21B0J"},{"type":"text","value":".  Where the air\ncolumn is warm — and therefore expanded — a given pressure level sits\nhigher; where the air is cold and compressed, it sits lower.  These\nundulations (measured as ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ivQFW8uXcr"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"geopotential height","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"R5DAWllonl"}],"key":"XVXzJndtTc"},{"type":"text","value":", in metres) encode the\nlarge-scale temperature and pressure patterns that drive weather systems.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cSAft9mYxv"}],"key":"T5PKQyBzgD"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"The figure below shows the ERA5 data cross-sectioned along ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"lFxSJHSrDI"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"55°N","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"r2D2nSKktB"}],"key":"beHg5PqRY8"},{"type":"text","value":" — a\nlatitude that cuts through Iceland, the United Kingdom, central Europe,\nand central Russia.  Each coloured band is the atmospheric layer between\ntwo successive pressure levels.  Thicker bands indicate warmer (more\nexpanded) air; thinner bands indicate colder air.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"yUH4j25QLu"}],"key":"AGZrwzq01g"}],"key":"H8mbOxyAHm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:06.072999Z","iopub.status.busy":"2026-03-01T17:12:06.072897Z","iopub.status.idle":"2026-03-01T17:12:06.798397Z","shell.execute_reply":"2026-03-01T17:12:06.797626Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"LAT_TRANSECT = 55.0\n\n# Geopotential height in km at 55°N, all levels, all longitudes\ngph_transect = ds_pl[\"geopotential\"].sel(latitude=LAT_TRANSECT, method=\"nearest\").squeeze()\ngph_km       = gph_transect / G / 1000  # km\n\n# ERA5 uses 0–360° longitudes; convert to −180–180° and sort west→east\nlons_180 = np.where(lons_pl > 180, lons_pl - 360, lons_pl)\nsort_idx  = np.argsort(lons_180)\nlons_sort = lons_180[sort_idx]\ngph_sort  = gph_km.isel(longitude=sort_idx)\n\n# Colour palette: cool (low levels, high pressure) → warm (high levels, low pressure)\nband_cmap   = plt.cm.coolwarm\nn_bands     = len(levels_sorted) - 1\nband_colors = [band_cmap(i / max(n_bands - 1, 1)) for i in range(n_bands)]\n\nfig = plt.figure(figsize=(22, 7))\ngs  = fig.add_gridspec(1, 5, wspace=0.45)\n\n# --- Left: world map showing the transect latitude ---\nax_map = fig.add_subplot(gs[0, :2], projection=ccrs.Robinson())\nax_map.set_global()\nax_map.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\")\nax_map.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\")\nax_map.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax_map.add_feature(cfeature.BORDERS,   linewidth=0.3, alpha=0.7)\nax_map.plot(\n    [-180, 180], [LAT_TRANSECT, LAT_TRANSECT],\n    color=\"crimson\", linewidth=2.5, transform=ccrs.PlateCarree(), zorder=5,\n)\nax_map.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                 linewidth=0.3, color=\"gray\", alpha=0.4, linestyle=\"--\")\nax_map.set_title(\n    f\"Cross-section location\\n(red line = {LAT_TRANSECT:.0f}°N)\",\n    fontsize=12, color=\"crimson\",\n)\n\n# --- Right: pressure level bands ---\nax_b = fig.add_subplot(gs[0, 2:])\n\nfor i in range(n_bands):\n    lower_lev = levels_sorted[i]       # higher pressure = lower altitude\n    upper_lev = levels_sorted[i + 1]   # lower pressure  = higher altitude\n    lower_h   = gph_sort.sel(level=lower_lev).values\n    upper_h   = gph_sort.sel(level=upper_lev).values\n    ax_b.fill_between(lons_sort, lower_h, upper_h,\n                      color=band_colors[i], alpha=0.65)\n\n# Pressure-surface lines and labels\nfor lev in levels_sorted:\n    h = gph_sort.sel(level=lev).values\n    ax_b.plot(lons_sort, h, color=\"black\", linewidth=0.8, alpha=0.7)\n    ax_b.text(lons_sort[-1] + 2, h[-1], f\" {lev} hPa\",\n              va=\"center\", fontsize=8, fontweight=\"bold\")\n\n# Shade the jet-stream zone (250–200 hPa) with a thin annotation\njet_low  = gph_sort.sel(level=250).values.mean()\njet_high = gph_sort.sel(level=200).values.mean()\nax_b.axhspan(jet_low, jet_high, color=\"gold\", alpha=0.25, zorder=0)\nax_b.text(lons_sort[0] + 2, (jet_low + jet_high) / 2,\n          \"← jet stream zone\", va=\"center\", fontsize=9,\n          color=\"goldenrod\", fontweight=\"bold\")\n\nax_b.set_xlabel(\"Longitude (°E)\", fontsize=12)\nax_b.set_ylabel(\"Geopotential height (km)\", fontsize=12)\nax_b.set_xlim(lons_sort.min(), lons_sort.max() + 14)\nax_b.grid(True, alpha=0.2)\nax_b.set_title(\n    f\"Atmospheric layers along {LAT_TRANSECT:.0f}°N — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_pressure_bands.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"nrEHJPD5e3"},{"type":"outputs","id":"SP9tJcqflmiKVDJt62GNp","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/388062872.py:74: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"MGcVvokmXY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/388062872.py:76: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"jEqmhzPvOg"}],"key":"ZOIVnEmAF5"}],"key":"mlJrWXvzAZ"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_pressure_bands-30e8a9eba5d5bf4385f5bf78696e67d2.png","alt":"Left: world map showing the cross-section location (red line = 55°N).\nRight: atmospheric layers along 55°N.  Each coloured band represents the\nlayer between two pressure levels; black lines are the actual geopotential\nheight of each surface.  Thicker bands indicate warmer (expanded) air.  The\ngold shading marks the jet-stream zone (~200–250 hPa, ~10–12 km altitude).\nNote how the pressure surfaces undulate by hundreds of metres — these waves\nare the Rossby waves that steer surface weather systems.","data":{"altTextIsAutoGenerated":true},"key":"wwvHqCkas6","urlSource":"../../output/images/13_pressure_bands.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-pressure-bands","identifier":"fig-13-pressure-bands","html_id":"fig-13-pressure-bands","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"SBZzmsGVtN"},{"type":"text","value":"4","key":"W37kZlSJnF"},{"type":"text","value":":","key":"L41aPK0SnB"}],"template":"Figure %s:","key":"ykIeS5kRXn"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Left:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JWbGLXEGkB"}],"key":"p0wTbEwEmX"},{"type":"text","value":" world map showing the cross-section location (red line = 55°N).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JYfvIGtjRu"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Right:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ILS6QeVKmc"}],"key":"HzStjow3ky"},{"type":"text","value":" atmospheric layers along 55°N.  Each coloured band represents the\nlayer between two pressure levels; black lines are the actual geopotential\nheight of each surface.  Thicker bands indicate warmer (expanded) air.  The\ngold shading marks the jet-stream zone (~200–250 hPa, ~10–12 km altitude).\nNote how the pressure surfaces undulate by hundreds of metres — these waves\nare the Rossby waves that steer surface weather systems.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BgHglP8Git"}],"key":"OjGD8tsitt"}],"key":"aeEJ5ksgB9"}],"label":"fig-13-pressure-bands","identifier":"fig-13-pressure-bands","enumerator":"4","html_id":"fig-13-pressure-bands","key":"PCtQMQ6xPK"}],"key":"ozgmO0Sk31"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The jet stream in 2D","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WfcoAYuauC"}],"identifier":"the-jet-stream-in-2d","label":"The jet stream in 2D","html_id":"the-jet-stream-in-2d","implicit":true,"key":"gKn87Tg7sL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N0m2U6F3Se"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"jet stream","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CPf5eqOXHA"}],"key":"HzKp7HXPEi"},{"type":"text","value":" is a narrow corridor of fast-moving air located near the\ntropopause, typically at 250 hPa (~10 km altitude).  Two jets exist in each\nhemisphere:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j6gNAao4bf"}],"key":"SqWKWxP4Es"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Polar front jet","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IFtyYHUK2L"}],"key":"uBsP0Aufml"},{"type":"text","value":" (~50–65°): marks the boundary between cold polar air\nand warmer mid-latitude air.  Its meanders steer surface weather systems.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oBwTq22T53"}],"key":"pkzS6JaIM1"}],"key":"rEtlHpB2oQ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Subtropical jet","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"P37LL7aFf8"}],"key":"uxdiwJ8CMX"},{"type":"text","value":" (~25–35°): driven by the Hadley cell; typically\nstronger in winter, weaker in summer.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"py17jj7hxU"}],"key":"BtcSVEUUXi"}],"key":"Q6fZYgC0BB"}],"key":"qaBj4OKZoH"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"On a summer snapshot like ours (June), the polar jet is weaker and displaced\npoleward.  We visualise it in two ways:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cEkwIcr6Jv"}],"key":"r79yYEJAnI"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Global Robinson map","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bM9aLkzzt6"}],"key":"Vkgv20uozY"},{"type":"text","value":" — 250 hPa wind speed in colour, with 500 hPa\ngeopotential height as contour lines to show the pressure wave pattern.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JXcvTnNt2W"}],"key":"LlBdJlduYy"}],"key":"VGqq48FhpY"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Polar (top-down) view","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iWYItJ4og7"}],"key":"lTZDDyvyvy"},{"type":"text","value":" — shows the jet stream as a ring around the\nNorth Pole.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Sb3rQ1uvlm"}],"key":"UlH6eqre4b"}],"key":"BoCLPt3g36"}],"key":"bhle0Sooad"}],"key":"a8ZeLKR6nQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global view: 250 hPa wind + 500 hPa geopotential","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V2RNvPvnaD"}],"identifier":"global-view-250-hpa-wind-500-hpa-geopotential","label":"Global view: 250 hPa wind + 500 hPa geopotential","html_id":"global-view-250-hpa-wind-500-hpa-geopotential","implicit":true,"key":"U8HRK2nN2j"}],"key":"HHbqEGSaIF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:06.799768Z","iopub.status.busy":"2026-03-01T17:12:06.799675Z","iopub.status.idle":"2026-03-01T17:12:17.329816Z","shell.execute_reply":"2026-03-01T17:12:17.329087Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"wspd250_c, lons250_c = add_cyclic_point(wspd250.values, coord=lons_pl)\ngph500_c,  _         = add_cyclic_point(gph500.values,  coord=lons_pl)\n\n# Geopotential-height contour levels in 80 m steps\nz500_levels = np.arange(\n    np.floor(float(gph500.min()) / 100) * 100,\n    np.ceil(float(gph500.max())  / 100) * 100 + 1,\n    80,\n)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\ncf = ax.contourf(\n    lons250_c, lats_pl, wspd250_c,\n    levels=np.arange(0, 85, 5),\n    cmap=\"hot_r\", transform=ccrs.PlateCarree(), extend=\"max\",\n)\ncs = ax.contour(\n    lons250_c, lats_pl, gph500_c,\n    levels=z500_levels,\n    colors=\"steelblue\", linewidths=0.8, alpha=0.7,\n    transform=ccrs.PlateCarree(),\n)\nax.clabel(cs, fmt=\"%d m\", fontsize=7, inline=True)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\")\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\ncbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\", pad=0.04, shrink=0.6)\ncbar.set_label(\"250 hPa wind speed (m/s)\")\nax.set_title(\n    f\"250 hPa wind speed + 500 hPa geopotential height — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_z500_wind250.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"TJ3trwNZj0"},{"type":"outputs","id":"RdD9onute8zQJhsDv2nTx","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/2006442886.py:45: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"hnWlCje24J"}],"key":"nh72jppAL4"}],"key":"hAhILxHsKE"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_z500_wind250-0f7e57f53197eaee4c792829f98046a4.png","alt":"250 hPa wind speed (filled, hot colourmap) with 500 hPa geopotential height\ncontours (blue lines, labelled in metres).  The jet stream appears as the orange/red\nband encircling the mid-latitudes.  The 500 hPa contours reveal the trough/ridge\nwave pattern that the jet stream follows: the jet accelerates through troughs\n(low geopotential) and decelerates through ridges (high geopotential).","data":{"altTextIsAutoGenerated":true},"key":"soJ6nbJ3BS","urlSource":"../../output/images/13_z500_wind250.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-z500-wind250","identifier":"fig-13-z500-wind250","html_id":"fig-13-z500-wind250","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"PWI9ZdMgwB"},{"type":"text","value":"5","key":"rgpJV4wpfb"},{"type":"text","value":":","key":"ut5jurWY9O"}],"template":"Figure %s:","key":"Cxzlun1Wjn"},{"type":"text","value":"250 hPa wind speed (filled, hot colourmap) with 500 hPa geopotential height\ncontours (blue lines, labelled in metres).  The jet stream appears as the orange/red\nband encircling the mid-latitudes.  The 500 hPa contours reveal the trough/ridge\nwave pattern that the jet stream follows: the jet accelerates through troughs\n(low geopotential) and decelerates through ridges (high geopotential).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u4KasUBo2E"}],"key":"pClF5xlnxz"}],"key":"yYEFBGyxYw"}],"label":"fig-13-z500-wind250","identifier":"fig-13-z500-wind250","enumerator":"5","html_id":"fig-13-z500-wind250","key":"M49C1cCcPA"}],"key":"s3qfIGK5t7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"500 hPa geopotential + 250 hPa jet stream footprint","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rnuu5JLEHz"}],"identifier":"id-500-hpa-geopotential-250-hpa-jet-stream-footprint","label":"500 hPa geopotential + 250 hPa jet stream footprint","html_id":"id-500-hpa-geopotential-250-hpa-jet-stream-footprint","implicit":true,"key":"JeNhz9EU8k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The same Z500 wave pattern as above, but now the 250 hPa wind speed is\ncollapsed to a binary mask: grid points where the jet core exceeds 30 m/s\nare filled in purple, while slower regions are transparent.  This style —\nborrowed from operational meteorological charts — immediately shows the\njet-stream corridor without the distraction of a continuous colour scale.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JNDk0aJCTG"}],"key":"SRa67aECwk"}],"key":"cwtEgnEUB8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:17.331260Z","iopub.status.busy":"2026-03-01T17:12:17.331159Z","iopub.status.idle":"2026-03-01T17:12:20.617587Z","shell.execute_reply":"2026-03-01T17:12:20.616596Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"JET_THRESHOLD = 30  # m/s — standard meteorological jet-stream criterion\n\n# Reuse cyclic arrays already computed above\nz500_levels   = np.arange(\n    np.floor(float(gph500.min()) / 60) * 60,\n    np.ceil(float(gph500.max())  / 60) * 60 + 1,\n    80,\n)\njet_masked_c = np.where(wspd250_c >= JET_THRESHOLD, wspd250_c, np.nan)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\nax.add_feature(cfeature.OCEAN, facecolor=\"#d0e8f5\", zorder=0)\nax.add_feature(cfeature.LAND,  facecolor=\"#f0ede8\", zorder=0)\n\ncs = ax.contour(\n    lons250_c, lats_pl, gph500_c,\n    levels=z500_levels, colors=\"black\", linewidths=0.6,\n    transform=ccrs.PlateCarree(), zorder=3,\n)\nax.clabel(cs, fmt=\"%d m\", fontsize=7, inline=True, inline_spacing=3)\n\nax.contourf(\n    lons250_c, lats_pl, jet_masked_c,\n    levels=[JET_THRESHOLD, 300], colors=[\"mediumpurple\"], alpha=0.75,\n    transform=ccrs.PlateCarree(), zorder=4,\n)\nax.contour(\n    lons250_c, lats_pl, wspd250_c,\n    levels=[JET_THRESHOLD], colors=[\"rebeccapurple\"], linewidths=1.0,\n    transform=ccrs.PlateCarree(), zorder=5,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\", zorder=6)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7, zorder=6)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\nax.legend(\n    handles=[mpatches.Patch(facecolor=\"mediumpurple\", edgecolor=\"rebeccapurple\",\n                            alpha=0.75, label=f\"Jet stream ≥ {JET_THRESHOLD} m/s  (250 hPa)\")],\n    loc=\"lower left\", fontsize=10, framealpha=0.85,\n)\nax.set_title(\n    f\"500 hPa geopotential height (contours) + jet stream footprint — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_z500_jet_purple.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"zJsWMDRlTK"},{"type":"outputs","id":"8QCa9IsSoFGefX6WkP_WY","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"nhtgYwx2Xt"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/786794077.py:56: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"SBGFwiCTli"}],"key":"LpunPMBhF7"}],"key":"t3BqzHHoMt"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_z500_jet_purple-228b4cb0a74df55c77412e4fa44fed5f.png","alt":"500 hPa geopotential height (black contours, labelled in metres) with the\n250 hPa jet stream footprint (purple, ≥ 30 m/s).  The jet hugs the steepest\ngeopotential gradient, flowing fastest where contours are most tightly packed.\nTroughs (contours bending equatorward) and ridges (bending poleward) mark\nthe Rossby-wave pattern that steers the jet.","data":{"altTextIsAutoGenerated":true},"key":"btKFFBaXjf","urlSource":"../../output/images/13_z500_jet_purple.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-z500-jet-purple","identifier":"fig-13-z500-jet-purple","html_id":"fig-13-z500-jet-purple","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"o5P72kfgme"},{"type":"text","value":"6","key":"IZ8FRBx9Vx"},{"type":"text","value":":","key":"pUhPMffABI"}],"template":"Figure %s:","key":"HIFHr9xUZ0"},{"type":"text","value":"500 hPa geopotential height (black contours, labelled in metres) with the\n250 hPa jet stream footprint (purple, ≥ 30 m/s).  The jet hugs the steepest\ngeopotential gradient, flowing fastest where contours are most tightly packed.\nTroughs (contours bending equatorward) and ridges (bending poleward) mark\nthe Rossby-wave pattern that steers the jet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GB3zDsneD2"}],"key":"jjq6sN4SP5"}],"key":"aydJ2AbWAx"}],"label":"fig-13-z500-jet-purple","identifier":"fig-13-z500-jet-purple","enumerator":"6","html_id":"fig-13-z500-jet-purple","key":"RNdhe1di2I"}],"key":"vNfCh4WxT6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2m temperature + 500 hPa geopotential contours","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ca08hf7tbU"}],"identifier":"id-2m-temperature-500-hpa-geopotential-contours","label":"2m temperature + 500 hPa geopotential contours","html_id":"id-2m-temperature-500-hpa-geopotential-contours","implicit":true,"key":"h3rwhJGC41"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The Z500 wave pattern also reflects the surface temperature distribution —\nwarm air expands the lower troposphere and pushes pressure surfaces higher,\nwhile cold air compresses them.  Overlaying Z500 contours on 2m temperature\nmakes this connection explicit: ridges (high Z500) sit over warm air masses,\ntroughs (low Z500) over cold ones.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gYacH2fwdd"}],"key":"dNt2Wytrwa"}],"key":"X1MlhSNXau"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:20.619241Z","iopub.status.busy":"2026-03-01T17:12:20.619147Z","iopub.status.idle":"2026-03-01T17:12:36.817497Z","shell.execute_reply":"2026-03-01T17:12:36.816594Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"t2m_c_cyc, lons_t2m_c = add_cyclic_point(t2m_c.values, coord=lons_sfc)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\nim = ax.pcolormesh(\n    lons_t2m_c, lats_sfc, t2m_c_cyc,\n    cmap=\"RdBu_r\", vmin=-40, vmax=45,\n    transform=ccrs.PlateCarree(), shading=\"auto\",\n)\ncs = ax.contour(\n    lons250_c, lats_pl, gph500_c,\n    levels=z500_levels, colors=\"black\", linewidths=0.6,\n    transform=ccrs.PlateCarree(), zorder=3,\n)\nax.clabel(cs, fmt=\"%d m\", fontsize=7, inline=True, inline_spacing=3)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"0.15\", zorder=4)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\", color=\"0.35\", zorder=4)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.6)\ncbar.set_label(\"2m temperature (°C)\")\nax.set_title(\n    f\"500 hPa geopotential height (contours) + 2m temperature — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_t2m_z500.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"M3b8kWeKlJ"},{"type":"outputs","id":"YpJJE2Z5cQA6_xbfg1tu8","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"NuzHZwPjT6"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/3147655083.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"roBZRlyCql"}],"key":"w0UcnhDXQw"}],"key":"MoxDba0wYD"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_t2m_z500-03a08c92a8fe1b764b26a85c48826cd4.png","alt":"2m temperature (filled, red–blue scale) with 500 hPa geopotential height\ncontours (black).  Ridges (contours arching poleward) align with warm air\nmasses; troughs (contours dipping equatorward) sit over cold air.  The\ntight coupling between the upper-level wave pattern and the surface\ntemperature field is a key driver of both weather and energy demand.","data":{"altTextIsAutoGenerated":true},"key":"msrBJd3jq8","urlSource":"../../output/images/13_t2m_z500.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-t2m-z500","identifier":"fig-13-t2m-z500","html_id":"fig-13-t2m-z500","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"g15K3a6Wbh"},{"type":"text","value":"7","key":"FRCWfANcI8"},{"type":"text","value":":","key":"MZPOKwZHDA"}],"template":"Figure %s:","key":"gjarTl9KUZ"},{"type":"text","value":"2m temperature (filled, red–blue scale) with 500 hPa geopotential height\ncontours (black).  Ridges (contours arching poleward) align with warm air\nmasses; troughs (contours dipping equatorward) sit over cold air.  The\ntight coupling between the upper-level wave pattern and the surface\ntemperature field is a key driver of both weather and energy demand.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AnCzKLBcef"}],"key":"G6w38WzWVr"}],"key":"PLhbgmtx26"}],"label":"fig-13-t2m-z500","identifier":"fig-13-t2m-z500","enumerator":"7","html_id":"fig-13-t2m-z500","key":"LPPiY7MMN3"}],"key":"owYC9iX8Jg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2m temperature with 250 hPa jet stream core overlay","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h6cmhzN81b"}],"identifier":"id-2m-temperature-with-250-hpa-jet-stream-core-overlay","label":"2m temperature with 250 hPa jet stream core overlay","html_id":"id-2m-temperature-with-250-hpa-jet-stream-core-overlay","implicit":true,"key":"h5Wo5njWhR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The jet stream is the boundary between cold polar air and warm subtropical\nair.  Overlaying the jet core (> 30 m/s, shown here as a white band that\nbrightens with wind speed) directly on the 2m temperature field makes this\nair-mass boundary visible: north of the jet lies colder, denser polar air;\nsouth of it lies warmer subtropical air.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lJpDgLR6V1"}],"key":"BhryrtLjTo"}],"key":"Qt2G3cumrF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:36.819157Z","iopub.status.busy":"2026-03-01T17:12:36.819053Z","iopub.status.idle":"2026-03-01T17:12:53.522681Z","shell.execute_reply":"2026-03-01T17:12:53.521774Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"jet_core_c  = np.where(wspd250_c > JET_THRESHOLD, wspd250_c, np.nan)\njet_core_cmap = LinearSegmentedColormap.from_list(\"jet_core\", [\n    (0.2, 0.2, 0.2, 0.6),  # dark grey, semi-transparent at threshold\n    (1.0, 1.0, 1.0, 1.0),  # bright white at 80 m/s\n])\n\nfig = plt.figure(figsize=(16, 9))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\nim_temp = ax.pcolormesh(\n    lons_t2m_c, lats_sfc, t2m_c_cyc,\n    cmap=\"RdYlBu_r\", vmin=-40, vmax=45,\n    transform=ccrs.PlateCarree(), shading=\"auto\",\n)\nax.pcolormesh(\n    lons250_c, lats_pl, jet_core_c,\n    cmap=jet_core_cmap, vmin=JET_THRESHOLD, vmax=80,\n    transform=ccrs.PlateCarree(), shading=\"auto\",\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\")\n\ncbar = fig.colorbar(im_temp, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.6)\ncbar.set_label(\"Temperature (°C)\")\nax.set_title(\n    f\"2m temperature with jet stream core (> {JET_THRESHOLD} m/s at 250 hPa) — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_t2m_jet_core.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"WoG3rgtbQi"},{"type":"outputs","id":"61IKt38cu7Z6lljfIYIfU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/2907177902.py:34: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"HSJk6Go1Xl"}],"key":"r3w5AIkSbO"}],"key":"hXuMUMpqCR"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_t2m_jet_core-5b7161509dd6ee9fbf9cc498a527393c.png","alt":"2m temperature (filled, RdYlBu_r) with the 250 hPa jet stream core overlaid\nas a white band (brightening with wind speed above 30 m/s).  The jet marks\nthe sharp boundary between cold polar air to the north and warm subtropical\nair to the south — a boundary that in winter can be associated with\ntemperature differences of 20–30 °C over just a few degrees of latitude.","data":{"altTextIsAutoGenerated":true},"key":"YgucpfPok2","urlSource":"../../output/images/13_t2m_jet_core.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-t2m-jet-core","identifier":"fig-13-t2m-jet-core","html_id":"fig-13-t2m-jet-core","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"dA0yY1K6Ts"},{"type":"text","value":"8","key":"pLDdyINdL4"},{"type":"text","value":":","key":"VFgA9bOLKh"}],"template":"Figure %s:","key":"c9fJGuIE27"},{"type":"text","value":"2m temperature (filled, RdYlBu_r) with the 250 hPa jet stream core overlaid\nas a white band (brightening with wind speed above 30 m/s).  The jet marks\nthe sharp boundary between cold polar air to the north and warm subtropical\nair to the south — a boundary that in winter can be associated with\ntemperature differences of 20–30 °C over just a few degrees of latitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H37uaZVUPu"}],"key":"SBDzTUtLUw"}],"key":"HjkiKPuoS3"}],"label":"fig-13-t2m-jet-core","identifier":"fig-13-t2m-jet-core","enumerator":"8","html_id":"fig-13-t2m-jet-core","key":"joOVxFZY2a"}],"key":"nQ7rmPAvZ5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Polar view: the jet stream as a ring around the North Pole","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCkg2kqDSu"}],"identifier":"polar-view-the-jet-stream-as-a-ring-around-the-north-pole","label":"Polar view: the jet stream as a ring around the North Pole","html_id":"polar-view-the-jet-stream-as-a-ring-around-the-north-pole","implicit":true,"key":"JRdmAWtf5s"}],"key":"hgduZBduZS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:53.523917Z","iopub.status.busy":"2026-03-01T17:12:53.523827Z","iopub.status.idle":"2026-03-01T17:13:03.650063Z","shell.execute_reply":"2026-03-01T17:13:03.649202Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Subsample for streamlines (dense grids overwhelm cartopy's streamplot)\nstep  = 8\nlons_sub = u250.longitude.values[::step]\nlats_sub = lats_pl[::step]\nu_sub    = u250.values[::step, ::step]\nv_sub    = v250.values[::step, ::step]\n\nfig, ax = plt.subplots(\n    figsize=(10, 10),\n    subplot_kw={\"projection\": ccrs.NorthPolarStereo()},\n)\n\nim = ax.pcolormesh(\n    lons_pl, lats_pl, wspd250.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"hot_r\", vmin=0, vmax=80, shading=\"auto\",\n)\nax.streamplot(\n    lons_sub, lats_sub, u_sub, v_sub,\n    transform=ccrs.PlateCarree(),\n    color=\"white\", linewidth=0.5, density=1.5, arrowsize=0.8,\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\")\nax.set_extent([-180, 180, 20, 90], crs=ccrs.PlateCarree())\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.7)\ncbar.set_label(\"250 hPa wind speed (m/s)\")\nax.set_title(\n    f\"Jet stream viewed from above — 250 hPa\\n{DATE} 12:00 UTC  |  ERA5\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_jet_stream_polar.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"GSnmtWblYB"},{"type":"outputs","id":"CrKsTU-4p1ZV_2GfXMq3U","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/1322210975.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"HCqD7YsAq2"}],"key":"LH7S76z8r1"}],"key":"o6r0o1YWil"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_jet_stream_polar-1a30fbe8dd3c3babcc4fb680f07e0c90.png","alt":"The Northern Hemisphere jet stream viewed from directly above the North Pole\n(North Polar Stereographic projection).  Wind speed at 250 hPa is shown in\ncolour; white streamlines indicate wind direction.  The jet stream traces an\nirregular ring around the pole, with Rossby-wave meanders visible as north–south\nexcursions.  This “ring” perspective makes it clear why the jet stream is\nsometimes described as a three-dimensional tube encircling the planet.","data":{"altTextIsAutoGenerated":true},"key":"Ohxoxh0yve","urlSource":"../../output/images/13_jet_stream_polar.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-jet-stream-polar","identifier":"fig-13-jet-stream-polar","html_id":"fig-13-jet-stream-polar","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"mWkaOYnovd"},{"type":"text","value":"9","key":"hoz9S4YMQ5"},{"type":"text","value":":","key":"ACq5eZ82k4"}],"template":"Figure %s:","key":"PaZ42LEBMV"},{"type":"text","value":"The Northern Hemisphere jet stream viewed from directly above the North Pole\n(North Polar Stereographic projection).  Wind speed at 250 hPa is shown in\ncolour; white streamlines indicate wind direction.  The jet stream traces an\nirregular ring around the pole, with Rossby-wave meanders visible as north–south\nexcursions.  This “ring” perspective makes it clear why the jet stream is\nsometimes described as a three-dimensional tube encircling the planet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VoLWGPLP5b"}],"key":"FB9OBiTayP"}],"key":"XOcqPR6kQT"}],"label":"fig-13-jet-stream-polar","identifier":"fig-13-jet-stream-polar","enumerator":"9","html_id":"fig-13-jet-stream-polar","key":"x69HS8dObU"}],"key":"tPcbBbFVzt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Jet stream across altitude levels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GXYwJczgCJ"}],"identifier":"jet-stream-across-altitude-levels","label":"Jet stream across altitude levels","html_id":"jet-stream-across-altitude-levels","implicit":true,"key":"QbBqDUR4Bs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The figures above show the jet stream at a single pressure level (250 hPa).\nBut the jet has ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BOXYyBeSpK"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"vertical extent","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uDOf0qm0ZC"}],"key":"xoKJ4ivByJ"},{"type":"text","value":" — it intensifies from the mid-troposphere\nupward through the tropopause, then weakens in the stratosphere above.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eSq181Ff1b"}],"key":"T3U4W95URW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The animation below steps through all available pressure levels from\n850 hPa (~1.5 km, near-surface) to 100 hPa (~16 km, lower stratosphere).\nWatch how the fast-moving core (red/orange) emerges at mid-tropospheric\nlevels, peaks near 200–250 hPa, then fades in the stratosphere above.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j0yYz4k5dL"}],"key":"X2IiNkQ1kg"},{"type":"table","position":{"start":{"line":12,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Level (hPa)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qumowElKiL"}],"key":"w67ElxMUb8"},{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Approx. altitude","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EZ2J68Inor"}],"key":"AqkcDsxopx"},{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"H6DPLEMfYb"}],"key":"PjvD8g168Q"}],"key":"VUpIhLr4a4"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"850","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zBrfsVcA8z"}],"key":"jGZV4CNPMN"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"~1.5 km","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mmUcpKPVxZ"}],"key":"dDdDlQ1dep"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"lower troposphere","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CjUT5wCyab"}],"key":"rl5Rmor2lS"}],"key":"dZzhSB51JE"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"500","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TfijaCxPGf"}],"key":"S0julHypZs"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"~5.5 km","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"WR3Dukn1GV"}],"key":"g61skgvVkU"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"mid-troposphere","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Iy9A5mQKfz"}],"key":"WGl8SImw2z"}],"key":"OF2oYSx3kW"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"400","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"h9EE4lFUmk"}],"key":"iztUUTGPxq"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"~7 km","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"XfJKa6YzPd"}],"key":"tUvkHixM7o"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"mid-troposphere","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"WKgXggl6fq"}],"key":"rU4hUcIkMu"}],"key":"B9s3xLPDzx"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"350","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"fPteNV3oXn"}],"key":"exo173ec3W"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"~8 km","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Xs5oqpcDl9"}],"key":"KDATtsnNYK"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"upper troposphere","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nntaXJVC9S"}],"key":"p4R2PkKAuR"}],"key":"D0TYJUYp0g"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"300","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SWTJ1zcAx3"}],"key":"k6xCYNf3Iv"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"~9 km","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"udGQpO3KnO"}],"key":"EF4x2bZ5aO"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"upper troposphere","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"PK7gKC5KNv"}],"key":"J8pbm7d7lY"}],"key":"EMHp6SM1Cc"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"250","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BR5N8zQ14j"}],"key":"OJnfcwW6ri"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"~10 km","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gNFlyCUJaj"}],"key":"Fv1lLPrpJQ"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"jet-stream core","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Mvm8YidY5C"}],"key":"CoFlhowur1"}],"key":"t8f6lB0ycX"}],"key":"nhTYAB89BT"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"225","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"LpiwNI7cWP"}],"key":"fOUwNALI5b"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"~11 km","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"tSzmPlb0fd"}],"key":"l3iRkJJF1p"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"jet-stream core","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"yc65myi5M5"}],"key":"X5LuNdzvng"}],"key":"ms6GMB72Kd"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"200","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"sfI249P1rZ"}],"key":"SrNCEuukNc"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"~12 km","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"pparxex6Ja"}],"key":"tC0XogQmSq"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"jet / tropopause","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"CTbUSu1Ynv"}],"key":"fyPJPEB0qk"}],"key":"LLVSSd3Qtx"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"175","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XT6aeltgBC"}],"key":"HEnYtAfkyJ"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"~13 km","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"c6HPDhE6qz"}],"key":"khxXvKHEcj"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"tropopause","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hbXnIUgIcN"}],"key":"cShwOQmUip"}],"key":"hmtrrEu4m3"},{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FfHplFLwFz"}],"key":"uo4rxnnHzQ"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"~14 km","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"QdsJTILjYn"}],"key":"spo2Wlmepq"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"lower stratosphere","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"n1PiHJUHy4"}],"key":"HrqbnYl5zq"}],"key":"R2dCYJap0Z"},{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"125","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"IVt5QVciQH"}],"key":"RTY6BeqqO6"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"~15 km","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"e5UkCWrdX1"}],"key":"UCziiL60rR"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"lower stratosphere","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"MnQECzaYPd"}],"key":"O8HfdEhh7W"}],"key":"cPRAjhUx75"},{"type":"tableRow","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"100","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"o1t7DaVnuu"}],"key":"HSdRFMAwxF"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"~16 km","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"pxVjblpK9L"}],"key":"QTDUE2YBO0"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"lower stratosphere","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"OMexsjOzT1"}],"key":"q4LIiV3fnl"}],"key":"mI7fGCqHLj"}],"key":"Hp9E98BHkX"}],"key":"sMhGDTzrMz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:13:03.651532Z","iopub.status.busy":"2026-03-01T17:13:03.651439Z","iopub.status.idle":"2026-03-01T17:14:38.541106Z","shell.execute_reply":"2026-03-01T17:14:38.540520Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"_ALT_LABELS = {\n    850: \"~1.5 km (lower troposphere)\",\n    500: \"~5.5 km (mid-troposphere)\",\n    400: \"~7 km\",\n    350: \"~8 km\",\n    300: \"~9 km (upper troposphere)\",\n    250: \"~10 km ★ jet-stream core\",\n    225: \"~11 km ★ jet-stream core\",\n    200: \"~12 km (jet / tropopause)\",\n    175: \"~13 km (tropopause)\",\n    150: \"~14 km (lower stratosphere)\",\n    125: \"~15 km\",\n    100: \"~16 km (lower stratosphere)\",\n}\n\ngif_frames_pl = []\n\nfor level in levels_sorted:\n    u_lev   = ds_pl[\"u_component_of_wind\"].sel(level=level).squeeze()\n    v_lev   = ds_pl[\"v_component_of_wind\"].sel(level=level).squeeze()\n    wspd_lv = np.sqrt(u_lev.values**2 + v_lev.values**2)\n\n    wspd_c, lons_c = add_cyclic_point(wspd_lv,       coord=lons_pl)\n    u_c,    _      = add_cyclic_point(u_lev.values,   coord=lons_pl)\n    v_c,    _      = add_cyclic_point(v_lev.values,   coord=lons_pl)\n\n    stride   = 20\n    lons_sub = lons_c[::stride]\n    lats_sub = lats_pl[::stride]\n    u_sub    = u_c[::stride, ::stride]\n    v_sub    = v_c[::stride, ::stride]\n    wspd_sub = np.sqrt(u_sub**2 + v_sub**2)\n    wspd_sub = np.where(wspd_sub == 0, 1, wspd_sub)\n    u_norm   = u_sub / wspd_sub\n    v_norm   = v_sub / wspd_sub\n\n    fig = plt.figure(figsize=(16, 8))\n    ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\n    ax.set_global()\n\n    cf = ax.contourf(\n        lons_c, lats_pl, wspd_c,\n        levels=np.arange(0, 85, 5),\n        cmap=\"YlOrRd\", transform=ccrs.PlateCarree(), extend=\"max\",\n    )\n    ax.quiver(\n        lons_sub, lats_sub, u_norm, v_norm,\n        transform=ccrs.PlateCarree(),\n        color=\"steelblue\", alpha=0.7, scale=80, width=0.002,\n        headwidth=3, headlength=3, headaxislength=3.75, regrid_shape=None,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\")\n    ax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7)\n    ax.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\",  zorder=0)\n    ax.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\", zorder=0)\n\n    gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                      linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\n    gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\n    gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\n    cbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\",\n                        pad=0.03, fraction=0.04, aspect=40)\n    cbar.set_label(f\"Wind speed at {level} hPa (m/s)\", fontsize=11)\n    cbar.ax.tick_params(labelsize=9)\n\n    ax.set_title(\n        f\"Upper-level wind — {level} hPa  ({_ALT_LABELS.get(level, '')})\\n\"\n        f\"{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n        fontsize=13, pad=10,\n    )\n\n    fig.tight_layout()\n\n    buf = io.BytesIO()\n    fig.savefig(buf, format=\"png\", dpi=100, bbox_inches=\"tight\")\n    plt.close(fig)\n    buf.seek(0)\n    gif_frames_pl.append(Image.open(buf).copy())\n    print(f\"  pressure level frame: {level} hPa\")\n\nout_gif_pl = paths.images_path / \"13_pressure_levels_animation.gif\"\ngif_frames_pl[0].save(\n    out_gif_pl,\n    save_all=True,\n    append_images=gif_frames_pl[1:],\n    duration=700,   # ms per frame — slow enough to read the title\n    loop=0,\n)\nprint(f\"saved → {out_gif_pl.name}  ({len(gif_frames_pl)} frames)\")","key":"VaZtdwHMUw"},{"type":"outputs","id":"Z1yMaz9IS1KWB9RskokFQ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Ls4HpFZRwT"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 850 hPa\n"},"children":[],"key":"Mv8PmNBZPw"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"jDIl8XCUEe"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 500 hPa\n"},"children":[],"key":"vLIsgB1q90"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"eq6ljotd69"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 400 hPa\n"},"children":[],"key":"kvoLMMI4Fy"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"PwyAkDKWVN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 350 hPa\n"},"children":[],"key":"nqjDGSOzEB"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Ia1GrF0ea4"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 300 hPa\n"},"children":[],"key":"EeMRxHQ8A2"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"NoeF10BjiK"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 250 hPa\n"},"children":[],"key":"yL0EIuAqCx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"HLgwzVE0t6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 225 hPa\n"},"children":[],"key":"Ch8qRCrz8n"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"zJKu7s8h1k"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 200 hPa\n"},"children":[],"key":"CmNr9olHPM"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"X9KUMOGcLU"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 175 hPa\n"},"children":[],"key":"kPrjDcz3OW"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"R48gOpmqDz"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 150 hPa\n"},"children":[],"key":"cprHcHTnIP"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"KpgZWldxCY"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 125 hPa\n"},"children":[],"key":"ImNPsz2Hbv"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"cjo4kYl4w8"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 100 hPa\n"},"children":[],"key":"MhJenLBlNh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"saved → 13_pressure_levels_animation.gif  (12 frames)\n"},"children":[],"key":"RmbKiLKXcV"}],"key":"Fh2irfXJp5"}],"key":"kfobaBWeCN"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_pressure_levels_a-e94991b9b187468f1f9ee013fcb40bc2.gif","alt":"Animation stepping from 850 hPa (near-surface) up to 100 hPa (lower stratosphere).\nThe jet stream emerges as the fast-moving core (orange/red) intensifies through the\nmid-troposphere, peaks at 200–250 hPa, then weakens in the stratosphere above.\nBlue arrows show wind direction.  This animation reveals the jet stream as a\nvertically coherent structure rather than just a surface phenomenon.","data":{"altTextIsAutoGenerated":true},"key":"JPh1WVbH4H","urlSource":"../../output/images/13_pressure_levels_animation.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-pressure-levels-animation","identifier":"fig-13-pressure-levels-animation","html_id":"fig-13-pressure-levels-animation","enumerator":"10","children":[{"type":"text","value":"Figure ","key":"yGCYjFQGYs"},{"type":"text","value":"10","key":"SdFHuhJoPd"},{"type":"text","value":":","key":"wEolqtgw6A"}],"template":"Figure %s:","key":"ySd4JWOmDg"},{"type":"text","value":"Animation stepping from 850 hPa (near-surface) up to 100 hPa (lower stratosphere).\nThe jet stream emerges as the fast-moving core (orange/red) intensifies through the\nmid-troposphere, peaks at 200–250 hPa, then weakens in the stratosphere above.\nBlue arrows show wind direction.  This animation reveals the jet stream as a\nvertically coherent structure rather than just a surface phenomenon.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GtwnbLglEd"}],"key":"yc9ZtaCTqr"}],"key":"SDWJ9Zm7Wb"}],"label":"fig-13-pressure-levels-animation","identifier":"fig-13-pressure-levels-animation","enumerator":"10","html_id":"fig-13-pressure-levels-animation","key":"DZX5D4hFEF"}],"key":"dR6BUuFjSl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vertical cross-sections","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CctTO0wKLw"}],"identifier":"vertical-cross-sections","label":"Vertical cross-sections","html_id":"vertical-cross-sections","implicit":true,"key":"dqffaQBADI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PHHs9xG7L7"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"vertical cross-section","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f5CFuPAhLV"}],"key":"xFu1hoG8nr"},{"type":"text","value":" cuts through the atmosphere at a fixed longitude\nand shows how wind speed and temperature vary simultaneously with latitude\n(x-axis) and altitude (y-axis).  This is the most direct way to see the jet\nstream’s three-dimensional shape.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EKDx2pR8wg"}],"key":"eW6i2mvSDn"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The y-axis uses ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OL0ch0rheL"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"geopotential height","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"IRsroAFKtB"}],"key":"KNMB6J4smu"},{"type":"text","value":" (km) so altitude increases naturally\nupward.  Each cross-section is paired with a world map highlighting the\nmeridian it was cut along.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"y6N0O8pyqm"}],"key":"lyDYuXR1i7"}],"key":"rEn76jp7Sr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cross-section helper","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pxnlYz4b80"}],"identifier":"cross-section-helper","label":"Cross-section helper","html_id":"cross-section-helper","implicit":true,"key":"DCl07lqL9L"}],"key":"ggv75sjGPy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:14:38.542472Z","iopub.status.busy":"2026-03-01T17:14:38.542345Z","iopub.status.idle":"2026-03-01T17:14:38.546985Z","shell.execute_reply":"2026-03-01T17:14:38.546414Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"def _fmt_cross_axes(ax):\n    ax.set_xlabel(\"Latitude (°)\", fontsize=10)\n    ax.set_ylabel(\"Geopotential height (km)\", fontsize=10)\n    ax.xaxis.set_major_formatter(mticker.FormatStrFormatter(\"%d°\"))\n    ax.xaxis.set_major_locator(mticker.MultipleLocator(15))\n    ax.grid(axis=\"x\", linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\n    ax.grid(axis=\"y\", linewidth=0.4, color=\"gray\", alpha=0.3, linestyle=\":\")\n\n\ndef _cross_section_data(ds_pl, lon_cut):\n    \"\"\"Extract and sort cross-section arrays for a given longitude.\"\"\"\n    ds_cut    = ds_pl.sel(longitude=lon_cut, method=\"nearest\")\n    lon_act   = float(ds_cut.longitude)\n    lon_plot  = lon_act if lon_act <= 180 else lon_act - 360\n\n    u_cut  = ds_cut[\"u_component_of_wind\"].squeeze().values  # (level, lat)\n    v_cut  = ds_cut[\"v_component_of_wind\"].squeeze().values\n    z_cut  = ds_cut[\"geopotential\"].squeeze().values\n    t_cut  = ds_cut[\"temperature\"].squeeze().values\n    lats_c = ds_cut.latitude.values  # descending 90→−90\n\n    z_km       = z_cut / G / 1000\n    level_ord  = np.argsort(z_km.mean(axis=1))  # bottom → top\n\n    z_km_s  = z_km[level_ord][:, ::-1]                                # south→north\n    wspd_s  = np.sqrt(u_cut**2 + v_cut**2)[level_ord][:, ::-1]\n    t_s     = t_cut[level_ord][:, ::-1] - 273.15\n    lat_2d  = np.broadcast_to(lats_c[::-1], z_km_s.shape).copy()\n\n    return lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s","key":"JwzHcVnBMQ"},{"type":"outputs","id":"ofuuG0nofaDSBpeowi8Qq","children":[],"key":"AGm0P2XO3h"}],"key":"SX1sPffVDz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Static cross-section at 0 °E (prime meridian) with location map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YwoeWwICLq"}],"identifier":"static-cross-section-at-0-e-prime-meridian-with-location-map","label":"Static cross-section at 0 °E (prime meridian) with location map","html_id":"static-cross-section-at-0-e-prime-meridian-with-location-map","implicit":true,"key":"YyBv3t4haN"}],"key":"m4PXQyieyg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:14:38.548181Z","iopub.status.busy":"2026-03-01T17:14:38.548100Z","iopub.status.idle":"2026-03-01T17:14:39.361038Z","shell.execute_reply":"2026-03-01T17:14:39.360259Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"LON_STATIC = 0\nlon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s = _cross_section_data(ds_pl, LON_STATIC)\n\nfig = plt.figure(figsize=(22, 6))\ngs  = fig.add_gridspec(1, 10, wspace=0.5)\n\n# --- Location map ---\nax_map = fig.add_subplot(gs[0, :2], projection=ccrs.PlateCarree())\nax_map.set_global()\nax_map.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\")\nax_map.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\")\nax_map.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax_map.add_feature(cfeature.BORDERS,   linewidth=0.3, alpha=0.7)\nax_map.plot([lon_plot, lon_plot], [-90, 90],\n            color=\"crimson\", linewidth=2.5, transform=ccrs.PlateCarree(), zorder=5)\ngl_m = ax_map.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,\n                         linewidth=0.3, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl_m.top_labels   = False\ngl_m.right_labels = False\ngl_m.xlocator     = mticker.FixedLocator(range(-180, 181, 60))\ngl_m.ylocator     = mticker.FixedLocator(range(-90,  91,  30))\ngl_m.xlabel_style = {\"size\": 8}\ngl_m.ylabel_style = {\"size\": 8}\nax_map.set_title(\n    f\"Cross-section at\\n{lon_act:.0f}°E ({lon_plot:+.0f}°)\",\n    fontsize=10, color=\"crimson\",\n)\n\n# --- Wind speed ---\nax_w = fig.add_subplot(gs[0, 2:6])\ncf_w = ax_w.contourf(lat_2d, z_km_s, wspd_s,\n                     levels=np.arange(0, 85, 5), cmap=\"YlOrRd\", extend=\"max\")\ncs_w = ax_w.contour(lat_2d, z_km_s, wspd_s, levels=[30, 50, 70],\n                    colors=\"black\", linewidths=0.8, alpha=0.6)\nax_w.clabel(cs_w, fmt=\"%d m/s\", fontsize=8)\nfig.colorbar(cf_w, ax=ax_w, orientation=\"vertical\", pad=0.02,\n             fraction=0.03, aspect=30).set_label(\"Wind speed (m/s)\", fontsize=10)\n_fmt_cross_axes(ax_w)\nax_w.set_title(f\"Wind speed — {lon_act:.0f}°E ({lon_plot:+.0f}°)\", fontsize=11)\n\n# --- Temperature ---\nax_t = fig.add_subplot(gs[0, 6:10], sharey=ax_w)\ncf_t = ax_t.contourf(lat_2d, z_km_s, t_s,\n                     levels=np.arange(-80, 25, 5), cmap=\"RdBu_r\", extend=\"both\")\ncs_t = ax_t.contour(lat_2d, z_km_s, t_s, levels=np.arange(-80, 25, 10),\n                    colors=\"black\", linewidths=0.6, alpha=0.5)\nax_t.clabel(cs_t, fmt=\"%d°C\", fontsize=8)\nfig.colorbar(cf_t, ax=ax_t, orientation=\"vertical\", pad=0.02,\n             fraction=0.03, aspect=30).set_label(\"Temperature (°C)\", fontsize=10)\nax_t.set_xlabel(\"Latitude (°)\", fontsize=10)\nax_t.xaxis.set_major_formatter(mticker.FormatStrFormatter(\"%d°\"))\nax_t.xaxis.set_major_locator(mticker.MultipleLocator(15))\nax_t.grid(axis=\"x\", linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\nax_t.grid(axis=\"y\", linewidth=0.4, color=\"gray\", alpha=0.3, linestyle=\":\")\nax_t.tick_params(labelleft=False)\nax_t.set_title(f\"Temperature — {lon_act:.0f}°E ({lon_plot:+.0f}°)\", fontsize=11)\n\nfig.suptitle(\n    f\"Vertical cross-section at {lon_act:.0f}°E ({lon_plot:+.0f}°) — \"\n    f\"{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n    fontsize=13, y=1.02,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_cross_section_0E.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"cG7Aby0VzF"},{"type":"outputs","id":"mrAlcz3sGBavNhbVQ8B_S","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/3683643321.py:64: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"iV08u7uwGx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/3683643321.py:66: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"PNMPCBVcDa"}],"key":"M42on6DJuc"}],"key":"ZIhBPESNML"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_cross_section_0E-6e7a88cf6933d064344249f62ef10250.png","alt":"Vertical cross-section through the atmosphere at 0°E (prime meridian).\nLeft: location map with the section meridian (red).\nCentre: wind speed — the jet stream appears as the orange/red core at\n40–60°N between 8 and 14 km altitude.\nRight: temperature — the stratospheric warm layer above ~12 km and the\nsharp temperature gradient across the jet are clearly visible.","data":{"altTextIsAutoGenerated":true},"key":"zeMWzJBuMR","urlSource":"../../output/images/13_cross_section_0E.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-cross-section-0E","identifier":"fig-13-cross-section-0e","html_id":"fig-13-cross-section-0e","enumerator":"11","children":[{"type":"text","value":"Figure ","key":"CwT82RKrUb"},{"type":"text","value":"11","key":"Z93dwCDsYz"},{"type":"text","value":":","key":"safH5mNtop"}],"template":"Figure %s:","key":"ubrtjTfTIC"},{"type":"text","value":"Vertical cross-section through the atmosphere at 0°E (prime meridian).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YZshyfeerI"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Left:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fZMOixSHTh"}],"key":"MuRAYUMWYC"},{"type":"text","value":" location map with the section meridian (red).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H1x8lCYcUx"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Centre:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YKp8JCtatU"}],"key":"WR5Y2hXyLO"},{"type":"text","value":" wind speed — the jet stream appears as the orange/red core at\n40–60°N between 8 and 14 km altitude.\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HTLecWSwcn"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Right:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"otodd9JweA"}],"key":"IeadNTjdhg"},{"type":"text","value":" temperature — the stratospheric warm layer above ~12 km and the\nsharp temperature gradient across the jet are clearly visible.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NSFHZZpXyq"}],"key":"CN860pubY1"}],"key":"oXpyz0kloR"}],"label":"fig-13-cross-section-0E","identifier":"fig-13-cross-section-0e","enumerator":"11","html_id":"fig-13-cross-section-0e","key":"GDnY4WHtr4"}],"key":"fDHEGigVVS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Animation: cross-sections at every 5° longitude","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SKeEPsGAVO"}],"identifier":"animation-cross-sections-at-every-5-longitude","label":"Animation: cross-sections at every 5° longitude","html_id":"animation-cross-sections-at-every-5-longitude","implicit":true,"key":"oc4I8I76co"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The GIF below steps through all meridians in 5° increments, each frame\nshowing the wind-speed and temperature cross-section alongside a world map\nthat highlights the current longitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"htMbILT0PP"}],"key":"ZQ2fTSdJQD"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Watch the jet stream core (orange/red, 8–14 km) shift northward and\nsouthward as the section rotates around the globe, tracing the Rossby-wave\nmeanders of the jet.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"F8p6zDiFQB"}],"key":"llqu5ORcUM"}],"key":"hCnIGrWTHV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:14:39.362883Z","iopub.status.busy":"2026-03-01T17:14:39.362787Z","iopub.status.idle":"2026-03-01T17:15:02.427856Z","shell.execute_reply":"2026-03-01T17:15:02.427125Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gif_frames_cs = []\n\nfor lon_cut in range(0, 360, 5):\n    lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s = _cross_section_data(ds_pl, lon_cut)\n\n    fig = plt.figure(figsize=(18, 5))\n    gs  = fig.add_gridspec(1, 10, wspace=0.5)\n\n    # Location map\n    ax_map = fig.add_subplot(gs[0, :2], projection=ccrs.Robinson())\n    ax_map.set_global()\n    ax_map.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\")\n    ax_map.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\")\n    ax_map.add_feature(cfeature.COASTLINE, linewidth=0.5)\n    ax_map.plot([lon_plot, lon_plot], [-90, 90],\n                color=\"crimson\", linewidth=2.5,\n                transform=ccrs.PlateCarree(), zorder=5)\n    ax_map.set_title(\n        f\"{lon_act:.0f}°E ({lon_plot:+.0f}°)\",\n        fontsize=9, color=\"crimson\",\n    )\n\n    # Wind speed\n    ax_w = fig.add_subplot(gs[0, 2:6])\n    cf_w = ax_w.contourf(lat_2d, z_km_s, wspd_s,\n                         levels=np.arange(0, 85, 5), cmap=\"YlOrRd\", extend=\"max\")\n    ax_w.contour(lat_2d, z_km_s, wspd_s, levels=[30, 50, 70],\n                 colors=\"black\", linewidths=0.8, alpha=0.6)\n    fig.colorbar(cf_w, ax=ax_w, fraction=0.04, pad=0.02,\n                 aspect=25).set_label(\"Wind speed (m/s)\", fontsize=9)\n    _fmt_cross_axes(ax_w)\n    ax_w.set_title(\"Wind speed\", fontsize=10)\n\n    # Temperature\n    ax_t = fig.add_subplot(gs[0, 6:10], sharey=ax_w)\n    cf_t = ax_t.contourf(lat_2d, z_km_s, t_s,\n                         levels=np.arange(-80, 25, 5), cmap=\"RdBu_r\", extend=\"both\")\n    ax_t.contour(lat_2d, z_km_s, t_s, levels=np.arange(-80, 25, 10),\n                 colors=\"black\", linewidths=0.6, alpha=0.5)\n    fig.colorbar(cf_t, ax=ax_t, fraction=0.04, pad=0.02,\n                 aspect=25).set_label(\"Temperature (°C)\", fontsize=9)\n    ax_t.set_xlabel(\"Latitude (°)\", fontsize=9)\n    ax_t.xaxis.set_major_formatter(mticker.FormatStrFormatter(\"%d°\"))\n    ax_t.xaxis.set_major_locator(mticker.MultipleLocator(15))\n    ax_t.grid(axis=\"x\", linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\n    ax_t.grid(axis=\"y\", linewidth=0.4, color=\"gray\", alpha=0.3, linestyle=\":\")\n    ax_t.tick_params(labelleft=False)\n    ax_t.set_title(\"Temperature\", fontsize=10)\n\n    fig.suptitle(\n        f\"Vertical cross-section at {lon_act:.0f}°E ({lon_plot:+.0f}°)  —  \"\n        f\"{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n        fontsize=11,\n    )\n    fig.tight_layout()\n\n    buf = io.BytesIO()\n    fig.savefig(buf, format=\"png\", dpi=90, bbox_inches=\"tight\")\n    plt.close(fig)\n    buf.seek(0)\n    gif_frames_cs.append(Image.open(buf).copy())\n    print(f\"  cross-section frame: {lon_act:.0f}°E\", end=\"\\r\")\n\nout_gif_cs = paths.images_path / \"13_cross_section_animation.gif\"\ngif_frames_cs[0].save(\n    out_gif_cs,\n    save_all=True,\n    append_images=gif_frames_cs[1:],\n    duration=200,   # ms per frame\n    loop=0,\n)\nprint(f\"\\nsaved → {out_gif_cs.name}  ({len(gif_frames_cs)} frames)\")","key":"z9YGDynkk6"},{"type":"outputs","id":"eUuJSCLPSwhK50MtNzVzz","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"PlOHHVJ9hM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 0°E\r"},"children":[],"key":"HgJECSwE1S"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"dvXKgyDmHh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 5°E\r"},"children":[],"key":"H87VOQE1we"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rh5RSp4KmP"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 10°E\r"},"children":[],"key":"loOSbEC3w4"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"sL1TCkO3MJ"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 15°E\r"},"children":[],"key":"Agcmu821Os"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"OGMJHgTV2v"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 20°E\r"},"children":[],"key":"Xhp5P7eSHH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"MfCY0t4P8P"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 25°E\r"},"children":[],"key":"XvprZkB1Ou"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"mBKIoLkUgi"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 30°E\r"},"children":[],"key":"T6ravDeLNt"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"JGUTDDAGUG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 35°E\r"},"children":[],"key":"c8fr8ztsBL"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Ce6ma9Pm33"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 40°E\r"},"children":[],"key":"uhI2mpBnh7"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"d3M8ndtAD0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 45°E\r"},"children":[],"key":"WXD9kieLRx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"OhSi144ylG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 50°E\r"},"children":[],"key":"b3hXrnzKjH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"ud5wNkUkAS"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 55°E\r"},"children":[],"key":"namYteo0CY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"kiCvhuYX8x"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 60°E\r"},"children":[],"key":"F5hCWVASwL"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"k1Hod91Ccs"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 65°E\r"},"children":[],"key":"KNXE2rJo1F"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"GtptWCKg6I"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 70°E\r"},"children":[],"key":"v9TjX7aJMN"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"KGxEd7ZYNK"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 75°E\r"},"children":[],"key":"FDgUJqkfjM"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"PD8xLK1xQ3"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 80°E\r"},"children":[],"key":"Sb8VuN7S6l"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"P5a6s5h2Md"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 85°E\r"},"children":[],"key":"gls3lOSgB0"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"MoaoVb1HX7"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 90°E\r"},"children":[],"key":"K6adnvzzZr"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rDh3TxiSJy"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 95°E\r"},"children":[],"key":"ap8NVeuRDf"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"LEwz2CJJ3X"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 100°E\r"},"children":[],"key":"KaOgA9mnFo"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"spoLU6YqWp"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 105°E\r"},"children":[],"key":"j3eFfwbSRP"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"n3V14v0mIN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 110°E\r"},"children":[],"key":"jQUWHlhxnj"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rYAv8JeUy9"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 115°E\r"},"children":[],"key":"ocs4WsvYMq"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"eybDVdsDfp"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 120°E\r"},"children":[],"key":"r60Rkf0h1q"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"CdYgeY1Tw0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 125°E\r"},"children":[],"key":"iRK7bpdWmk"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"I3YctC84Qo"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 130°E\r"},"children":[],"key":"wKgascWexK"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"gmpD1ysdb2"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 135°E\r"},"children":[],"key":"K4GLKgGeMH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"boL1jQ4htr"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 140°E\r"},"children":[],"key":"ArG28FP01d"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"oduuK1EReh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 145°E\r"},"children":[],"key":"T2klMxB5Jh"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"GY95u3C2ex"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 150°E\r"},"children":[],"key":"adYThJIxQ7"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Jv68Ye1pOi"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 155°E\r"},"children":[],"key":"IcvpyrMVSU"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"iWpbJSS0fk"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 160°E\r"},"children":[],"key":"K9q0CR3CD9"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"uiTPFhTWG0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 165°E\r"},"children":[],"key":"M6rHneqUQt"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Iw6ljtkVcL"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 170°E\r"},"children":[],"key":"b1B8kWeK1Q"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"xkun1USA7c"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 175°E\r"},"children":[],"key":"hNW2Sb6FL0"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"EVsnE2o0he"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 180°E\r"},"children":[],"key":"mZ0U9RHV8t"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"kNMuDOuBr2"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 185°E\r"},"children":[],"key":"vWxZh08uwA"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Y9Vx85vbCB"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 190°E\r"},"children":[],"key":"a33Supb5Vg"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"K2D8WqEIeT"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 195°E\r"},"children":[],"key":"fJVUekUOUN"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"VNmMvMiQu1"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 200°E\r"},"children":[],"key":"jzk6byRpY5"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"xVv7sMoGif"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 205°E\r"},"children":[],"key":"jOMgoT3t0m"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Z5NO63tRo3"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 210°E\r"},"children":[],"key":"zT84yzcB1a"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rEwIB4t5aN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 215°E\r"},"children":[],"key":"DQBaKxFTrl"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"fUtbXVjswp"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 220°E\r"},"children":[],"key":"zXEc9tbWfj"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"pPnJx90Up6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 225°E\r"},"children":[],"key":"semNzw01K7"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"T1e1BeUHh8"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 230°E\r"},"children":[],"key":"cO2h91uvip"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"nwb0curH4Z"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 235°E\r"},"children":[],"key":"AcePWvkoTx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"sSTCtEcR2l"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 240°E\r"},"children":[],"key":"EVsV6Tcgxb"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"yVhDOfeaHM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 245°E\r"},"children":[],"key":"yOgAoRCvaH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"zYcTmMdAPf"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 250°E\r"},"children":[],"key":"kqYdZdmsI9"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"ThzSGvIgBf"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 255°E\r"},"children":[],"key":"nix8rtL1mP"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"euMXBGv8iH"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 260°E\r"},"children":[],"key":"CLtnWkhxqX"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"lqBsXQ3IcV"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 265°E\r"},"children":[],"key":"FAdNGioXSA"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"nJyKwouvyr"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 270°E\r"},"children":[],"key":"ICsFwz7SeK"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"STc6FAsA48"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 275°E\r"},"children":[],"key":"QCVkRRcWGv"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rdjxscAGKG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 280°E\r"},"children":[],"key":"sS7r0DBszk"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"VB6oSIg0NM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 285°E\r"},"children":[],"key":"gk19tXuRrZ"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"P9rrMj8JKh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 290°E\r"},"children":[],"key":"UbQPc3r2fk"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"W2xc38Pb6u"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 295°E\r"},"children":[],"key":"CWHaVLyWRU"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"TZUnIUjGAI"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 300°E\r"},"children":[],"key":"iFkdP2Wcgp"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rmgXOMVGjF"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 305°E\r"},"children":[],"key":"C2E9rA1zcb"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"EzL8oQ9OxI"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 310°E\r"},"children":[],"key":"B6mKmrmA8O"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"G91C64oxy1"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 315°E\r"},"children":[],"key":"vGc0tKTGkY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"LRdX7olbha"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 320°E\r"},"children":[],"key":"rvi52CZOtB"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"WqiwtRAzxD"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 325°E\r"},"children":[],"key":"MeSfVzPQSE"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"JU24vBJocP"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 330°E\r"},"children":[],"key":"vIMZXFW5rr"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"uo1yuerzsk"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 335°E\r"},"children":[],"key":"Zjczjto6Q5"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"ehOAb9ALBN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 340°E\r"},"children":[],"key":"gzIEYnhA1i"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"qjPUiylc0f"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 345°E\r"},"children":[],"key":"ShCwkAKrmI"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"KnYhFRQFwc"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 350°E\r"},"children":[],"key":"SudushSFrT"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"BzublmS0sN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 355°E\r"},"children":[],"key":"HlqKxdrFCe"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\nsaved → 13_cross_section_animation.gif  (72 frames)\n"},"children":[],"key":"hSkvH7m06Z"}],"key":"Ut8sQEKBmX"}],"key":"atWuvLy1zU"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_cross_section_ani-c9d9196886036b3b8edd7b284f0419f4.gif","alt":"Vertical cross-sections rotating around the globe in 5° steps.  Each frame\nshows wind speed (centre) and temperature (right) vs. latitude and geopotential\nheight, paired with a world map highlighting the current meridian (red line).\nThe jet-stream core (orange/red at 8–14 km, 40–65°N) shifts north and south\nwith the Rossby-wave pattern as the section rotates — demonstrating the\njet’s three-dimensional tube-like shape encircling the Northern Hemisphere.","data":{"altTextIsAutoGenerated":true},"key":"kV470MJ1Om","urlSource":"../../output/images/13_cross_section_animation.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-cross-section-animation","identifier":"fig-13-cross-section-animation","html_id":"fig-13-cross-section-animation","enumerator":"12","children":[{"type":"text","value":"Figure ","key":"VzV101bui5"},{"type":"text","value":"12","key":"o4ISbPMuNx"},{"type":"text","value":":","key":"GD63aJ2EvW"}],"template":"Figure %s:","key":"PJrd1aDpWO"},{"type":"text","value":"Vertical cross-sections rotating around the globe in 5° steps.  Each frame\nshows wind speed (centre) and temperature (right) vs. latitude and geopotential\nheight, paired with a world map highlighting the current meridian (red line).\nThe jet-stream core (orange/red at 8–14 km, 40–65°N) shifts north and south\nwith the Rossby-wave pattern as the section rotates — demonstrating the\njet’s three-dimensional tube-like shape encircling the Northern Hemisphere.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CTOY7lHZI8"}],"key":"eMbltnnpuB"}],"key":"bLYutyDu0P"}],"label":"fig-13-cross-section-animation","identifier":"fig-13-cross-section-animation","enumerator":"12","html_id":"fig-13-cross-section-animation","key":"cc64B9vBuy"}],"key":"RZ5ADjVOvT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Column-maximum wind speed","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PKo4Jz04cm"}],"identifier":"column-maximum-wind-speed","label":"Column-maximum wind speed","html_id":"column-maximum-wind-speed","implicit":true,"key":"mXrsW5S7q1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"By taking the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gKhO2ZgXop"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"maximum wind speed across all pressure levels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"loHjLkM0hl"}],"key":"yei3j2Cpjb"},{"type":"text","value":" at each\nhorizontal grid point, we collapse the full vertical structure into a single\nmap that highlights every location where the jet core passes — regardless\nof its exact altitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YXwWRCiKSD"}],"key":"cpil1YjXyT"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Grid points where the jet tilts vertically or splits into multiple cores\nare still captured, making this a robust indicator of the jet’s\nhorizontal footprint.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BZD0oR8tgE"}],"key":"zxxJE6X2sC"}],"key":"RIwBEeHcLh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:02.429265Z","iopub.status.busy":"2026-03-01T17:15:02.429154Z","iopub.status.idle":"2026-03-01T17:15:02.600339Z","shell.execute_reply":"2026-03-01T17:15:02.599603Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"u_all    = ds_pl[\"u_component_of_wind\"].squeeze()  # (level, lat, lon)\nv_all    = ds_pl[\"v_component_of_wind\"].squeeze()\nwspd_all = np.sqrt(u_all**2 + v_all**2)\nwspd_max = wspd_all.max(dim=\"level\")\n\nprint(f\"Column-max wind range: {float(wspd_max.min()):.1f}–{float(wspd_max.max()):.1f} m/s\")","key":"OchkHauE8L"},{"type":"outputs","id":"Nvr7LP2yIUV9dZcUwAhAp","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Column-max wind range: 2.7–81.8 m/s\n"},"children":[],"key":"VTnFzJWbwQ"}],"key":"BNRctKPFd8"}],"key":"hDNkiryPyp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:02.601747Z","iopub.status.busy":"2026-03-01T17:15:02.601635Z","iopub.status.idle":"2026-03-01T17:15:12.588431Z","shell.execute_reply":"2026-03-01T17:15:12.587717Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"wspd_max_c, lons_max_c = add_cyclic_point(wspd_max.values, coord=lons_pl)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\ncf = ax.contourf(\n    lons_max_c, lats_pl, wspd_max_c,\n    levels=np.arange(0, 85, 5),\n    cmap=\"YlOrRd\", transform=ccrs.PlateCarree(), extend=\"max\",\n)\n\n# Jet-stream footprint: contour line at 30 m/s threshold\nax.contour(\n    lons_max_c, lats_pl, wspd_max_c,\n    levels=[30],\n    colors=[\"mediumpurple\"], linewidths=1.5,\n    transform=ccrs.PlateCarree(),\n)\nlegend_el = [mpatches.Patch(facecolor=\"mediumpurple\", edgecolor=\"mediumpurple\",\n                             label=\"Jet-stream threshold (≥ 30 m/s)\")]\nax.legend(handles=legend_el, loc=\"lower left\", fontsize=10, framealpha=0.85)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\")\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7)\nax.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\",  zorder=0)\nax.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\", zorder=0)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\ncbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\",\n                    pad=0.03, fraction=0.04, aspect=40)\ncbar.set_label(\"Column-maximum wind speed (m/s)\", fontsize=11)\ncbar.ax.tick_params(labelsize=9)\n\nax.set_title(\n    f\"Column-maximum wind speed (850–100 hPa)\\n{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n    fontsize=13, pad=10,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_jet_colmax.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"b06glUYNdz"},{"type":"outputs","id":"Dhj5-SSb88XWqWT18W5ys","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"witgwoTJdY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/4078208183.py:46: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"HWVwvYUhGM"}],"key":"auiQI5llro"}],"key":"bFBI6J8qWl"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_jet_colmax-a1333cf63885ae18d2e64e68cb987852.png","alt":"Column-maximum wind speed from 850 to 100 hPa.  By collapsing all altitude\nlevels into a single value per grid point, this map shows the horizontal\nfootprint of the jet stream regardless of where it sits vertically.  The\npurple contour marks the 30 m/s threshold commonly used to define the\njet-stream boundary.  In this summer snapshot, the jet is weaker than in\nwinter and displaced poleward, leaving a narrower and more fragmented footprint.","data":{"altTextIsAutoGenerated":true},"key":"GCfVt7MCZn","urlSource":"../../output/images/13_jet_colmax.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-jet-colmax","identifier":"fig-13-jet-colmax","html_id":"fig-13-jet-colmax","enumerator":"13","children":[{"type":"text","value":"Figure ","key":"Ue6pQ5jM7o"},{"type":"text","value":"13","key":"JzXAM8HUm7"},{"type":"text","value":":","key":"aE28mqa2xd"}],"template":"Figure %s:","key":"xU4YuuuBDv"},{"type":"text","value":"Column-maximum wind speed from 850 to 100 hPa.  By collapsing all altitude\nlevels into a single value per grid point, this map shows the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MxjYcTQxtv"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"horizontal\nfootprint","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"paxss3Rg2e"}],"key":"FQArCedDrH"},{"type":"text","value":" of the jet stream regardless of where it sits vertically.  The\npurple contour marks the 30 m/s threshold commonly used to define the\njet-stream boundary.  In this summer snapshot, the jet is weaker than in\nwinter and displaced poleward, leaving a narrower and more fragmented footprint.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lPkHMDPCUo"}],"key":"LSS1EeaGDM"}],"key":"WAHHngDSLg"}],"label":"fig-13-jet-colmax","identifier":"fig-13-jet-colmax","enumerator":"13","html_id":"fig-13-jet-colmax","key":"ZiEMgrXfue"}],"key":"qmR9c6e5o5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ex5SmGF5z6"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"gDrMaRYQOh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Combining the visualisations above builds a coherent picture of the jet\nstream as a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IbWQCdwMOa"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"three-dimensional structure","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l6A4ItgpAm"}],"key":"P9wehndV2r"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TUCVsdi0Ua"}],"key":"UXia3cuye6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"At the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jkrTlz1PNX"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"surface","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uOu5iJqxpm"}],"key":"AxS0LUaZGq"},{"type":"text","value":" (10 m wind, cloud cover, 2m temperature), the jet’s\ninfluence is indirect — it steers cyclones and anticyclones that modulate\nsurface conditions.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SXslrSiwI4"}],"key":"w4YSfUxFWL"}],"key":"FNCCh0qUOh"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gR0TymuxVi"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"mid-troposphere","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OwG9pkPhTj"}],"key":"Rk1sjtRLcp"},{"type":"text","value":" (500 hPa geopotential), the Rossby-wave pattern\nshows the large-scale trough/ridge structure that the jet follows.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EhzJtMJYsn"}],"key":"bFhV8caDOi"}],"key":"iiUDyTHR49"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"At ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oEbluNhbls"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"jet-stream altitude","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CdmvE70E7b"}],"key":"IFdw8Hazkn"},{"type":"text","value":" (200–250 hPa), the fast core is concentrated\nin a band 20–30° latitude wide, reaching 60–80 m/s in winter (weaker in\nthis June snapshot).","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ueZE1vbEPa"}],"key":"tmJgZDth30"}],"key":"obrf9lqAMr"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Vertical cross-sections","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"nuItFJ3mdS"}],"key":"CYkN9pTilW"},{"type":"text","value":" reveal the core sitting between ~8 and 14 km,\nwith the strongest winds near the tropopause (~200 hPa).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"c1UOiqPC3Z"}],"key":"nmAf1Gi2WY"}],"key":"Bg33htYWHJ"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"VVIPsMai8Q"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"polar view","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"JZen17WxjG"}],"key":"baT07xQmB7"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"gLmZmIFMKw"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"column-maximum map","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"y4A9tc5PEh"}],"key":"OtnfNICeYG"},{"type":"text","value":" show the jet’s horizontal\nfootprint as a ring around the Northern Hemisphere, punctuated by the\nRossby-wave meanders that connect upper-level dynamics to surface weather.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GM5QHRucSt"}],"key":"dd0MlxV7iG"}],"key":"CgLo5ibScz"}],"key":"g0U9XVOnSn"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"For energy systems, the key takeaway is that wind and solar availability\nacross Europe depend critically on the current state of this three-dimensional\njet — its latitude, its strength, and whether it is blocked or meandering.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QSheDs5Am3"}],"key":"iVM9YItAQ8"}],"key":"XnfUQujsL2"}],"key":"P2WxFecUHf"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Map Projections — ERA5 2 m Temperature","url":"/notebooks/projections","group":"Weather"},"next":{"title":"Weather Variability in Germany — Beyond the Seasonal Cycle","url":"/notebooks/germany-variations","group":"Weather"}}},"domain":"http://localhost:3000"}
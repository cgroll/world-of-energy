{"version":3,"kind":"Notebook","sha256":"b5307f1d58303aa9e667f6bba75528fc0963864417f5cbc03914d937d15bc3df","slug":"notebooks.nao-index","location":"/notebooks/18_nao_index.md","dependencies":[],"frontmatter":{"title":"Monthly ERA5 Reanalysis","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"text_representation":{"format_name":"percent"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/18_nao_index.md","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/18_nao_index.md","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-e831c71a5d50caa3613616905ea8daeb.png","exports":[{"format":"md","filename":"18_nao_index.md","url":"/world-of-energy/build/18_nao_index-9dcfaac90371863f0164a696228fec44.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"This notebook loads the monthly ERA5 reanalysis data downloaded from the\nCopernicus Climate Data Store and stored as a Zarr archive.  It visualises\n2 m temperature on a Robinson projection.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EaZyuqKTPO"}],"key":"w0AJao9Idg"}],"key":"ZD3HXP8bCH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport xarray as xr\nimport matplotlib.pyplot as plt\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\n\nfrom woe.paths import ProjPaths\n\npaths = ProjPaths()","key":"UXWofVgFGz"},{"type":"outputs","id":"DY12OqG_6AHFn7mvInN7n","children":[],"key":"EC0UWYTVus"}],"key":"lBK5qkyrLS"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Load Zarr store","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"VDnowlcWYP"}],"identifier":"load-zarr-store","label":"Load Zarr store","html_id":"load-zarr-store","implicit":true,"key":"tOW00oglbo"}],"key":"b0DbKGOqeJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds = xr.open_zarr(paths.era5_monthly_zarr_path)\nprint(f\"Variables:   {list(ds.data_vars)}\")\nprint(f\"Dimensions:  {dict(ds.dims)}\")\nprint(f\"Time range:  {ds.time.values[0]} → {ds.time.values[-1]}\")","key":"pXCXX0Aj9x"},{"type":"outputs","id":"vXFLpxEofPbFNtbf6VKJK","children":[],"key":"gCc4EgweN5"}],"key":"P6ceZlmrBQ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"2 m temperature — January 2025","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"XVyde8tB3c"}],"identifier":"id-2-m-temperature-january-2025","label":"2 m temperature — January 2025","html_id":"id-2-m-temperature-january-2025","implicit":true,"key":"Hqh45wAbWA"}],"key":"pdusrsQnjn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"DATE = \"2024-01\"\nt2m = ds[\"t2m\"].sel(time=DATE).squeeze() - 273.15  # K → °C\n\nfig, ax = plt.subplots(\n    figsize=(14, 7),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nim = ax.pcolormesh(\n    t2m.longitude,\n    t2m.latitude,\n    t2m.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-40,\n    vmax=40,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\nax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.04, fraction=0.04)\ncbar.set_label(\"2 m temperature (°C)\")\n\nax.set_title(f\"ERA5 monthly mean 2 m temperature — {DATE}\", fontsize=13)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_era5_t2m_2025_01.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"tpcGysf3zT"},{"type":"outputs","id":"mtXHrZF13L_FtdUarW1V2","children":[],"key":"bqslx21uSo"}],"key":"tGuq8zfuBD"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_era5_t2m_2025_01-e831c71a5d50caa3613616905ea8daeb.png","alt":"ERA5 monthly mean 2 m temperature for January 2025 on a Robinson projection.","data":{"altTextIsAutoGenerated":true},"key":"R1Bd3yT0DR","urlSource":"../../output/images/15_era5_t2m_2025_01.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-era5-t2m-2025-01","identifier":"fig-15-era5-t2m-2025-01","html_id":"fig-15-era5-t2m-2025-01","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"pk4GuCvUfR"},{"type":"text","value":"1","key":"FxkJGhAR4e"},{"type":"text","value":":","key":"xrpY0jxAeM"}],"template":"Figure %s:","key":"mxwweGzxsX"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for January 2025 on a Robinson projection.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"CPGtaTu1DH"}],"key":"RKhZEcgvQv"}],"key":"kClNiw2fIU"}],"label":"fig-15-era5-t2m-2025-01","identifier":"fig-15-era5-t2m-2025-01","enumerator":"1","html_id":"fig-15-era5-t2m-2025-01","key":"tGPumep2bl"}],"key":"BNIa2oMlDq"},{"type":"block","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"2 m temperature — January 2025 (Europe, Lambert Conformal)","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"QTzuopmAeK"}],"identifier":"id-2-m-temperature-january-2025-europe-lambert-conformal","label":"2 m temperature — January 2025 (Europe, Lambert Conformal)","html_id":"id-2-m-temperature-january-2025-europe-lambert-conformal","implicit":true,"key":"fQ1OOoJAsl"}],"key":"gyac2CGCUv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"proj = ccrs.LambertConformal(central_longitude=10, central_latitude=50)\n\nfig, ax = plt.subplots(figsize=(10, 9), subplot_kw={\"projection\": proj})\n\nax.set_extent([-25, 45, 30, 72], crs=ccrs.PlateCarree())\n\nim = ax.pcolormesh(\n    t2m.longitude,\n    t2m.latitude,\n    t2m.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-25,\n    vmax=25,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.7)\nax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=\":\")\nax.add_feature(cfeature.LAND, facecolor=\"none\", edgecolor=\"none\")\ngl = ax.gridlines(draw_labels=True, linewidth=0.3, color=\"gray\", alpha=0.5)\ngl.top_labels = False\ngl.right_labels = False\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"vertical\", pad=0.04, fraction=0.03)\ncbar.set_label(\"2 m temperature (°C)\")\n\nax.set_title(f\"ERA5 monthly mean 2 m temperature — {DATE}\", fontsize=13)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_era5_t2m_europe_2025_01.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"GAds0Pqg4r"},{"type":"outputs","id":"qj8lig2jWXxhSHOBqpMt1","children":[],"key":"kRBiizWTQ9"}],"key":"j2ECntIjgc"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_era5_t2m_europe_2-afc767dff8d57392167664acb2298451.png","alt":"ERA5 monthly mean 2 m temperature for January 2025 over Europe on a Lambert\nConformal projection.","data":{"altTextIsAutoGenerated":true},"key":"XORpP6VmfM","urlSource":"../../output/images/15_era5_t2m_europe_2025_01.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-era5-t2m-europe-2025-01","identifier":"fig-15-era5-t2m-europe-2025-01","html_id":"fig-15-era5-t2m-europe-2025-01","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"vXjO6DZnPt"},{"type":"text","value":"2","key":"C3pMMHR7tz"},{"type":"text","value":":","key":"D8IbgiZbXG"}],"template":"Figure %s:","key":"atBYqh9bWp"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for January 2025 over Europe on a Lambert\nConformal projection.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"hZB5L5nlrO"}],"key":"FWyq875rvs"}],"key":"DVz7Fbfq7v"}],"label":"fig-15-era5-t2m-europe-2025-01","identifier":"fig-15-era5-t2m-europe-2025-01","enumerator":"2","html_id":"fig-15-era5-t2m-europe-2025-01","key":"S411CTFjxX"}],"key":"KMOTqcqLBj"},{"type":"block","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"2 m temperature — January 2025 (full domain, Plate Carrée)","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"KvsXK3opTf"}],"identifier":"id-2-m-temperature-january-2025-full-domain-plate-carr-e","label":"2 m temperature — January 2025 (full domain, Plate Carrée)","html_id":"id-2-m-temperature-january-2025-full-domain-plate-carr-e","implicit":true,"key":"ax7mShuX3q"}],"key":"ZUJ8SagKVs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# BOUNDING_BOX = [North=80, West=-90, South=20, East=40]\nfig, ax = plt.subplots(\n    figsize=(14, 7),\n    subplot_kw={\"projection\": ccrs.PlateCarree()},\n)\n\nax.set_extent([-90, 40, 20, 80], crs=ccrs.PlateCarree())\n\nim = ax.pcolormesh(\n    t2m.longitude,\n    t2m.latitude,\n    t2m.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-40,\n    vmax=40,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\ngl = ax.gridlines(draw_labels=True, linewidth=0.3, color=\"gray\", alpha=0.5)\ngl.top_labels = False\ngl.right_labels = False\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, fraction=0.04)\ncbar.set_label(\"2 m temperature (°C)\")\n\nax.set_title(f\"ERA5 monthly mean 2 m temperature — {DATE}\", fontsize=13)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_era5_t2m_domain_2025_01.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"ZDMtPBEqLk"},{"type":"outputs","id":"YnfgILXfVOf-rT5I0Fa6v","children":[],"key":"BvucY9ExPn"}],"key":"YhuONYteRJ"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_era5_t2m_domain_2-8f74445a8c8885767547687f79a26a87.png","alt":"ERA5 monthly mean 2 m temperature for January 2025 on a Plate Carrée projection\nshowing the full downloaded domain.","data":{"altTextIsAutoGenerated":true},"key":"T7V5rbox1Y","urlSource":"../../output/images/15_era5_t2m_domain_2025_01.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":164,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-era5-t2m-domain-2025-01","identifier":"fig-15-era5-t2m-domain-2025-01","html_id":"fig-15-era5-t2m-domain-2025-01","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"lHHrbUnFmv"},{"type":"text","value":"3","key":"UkttEKSgDj"},{"type":"text","value":":","key":"M3m8TBBXWe"}],"template":"Figure %s:","key":"QNEpeRARTV"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for January 2025 on a Plate Carrée projection\nshowing the full downloaded domain.","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"uOdeWJNmmj"}],"key":"ZxxYfWcVZR"}],"key":"ksmZDfLtYM"}],"label":"fig-15-era5-t2m-domain-2025-01","identifier":"fig-15-era5-t2m-domain-2025-01","enumerator":"3","html_id":"fig-15-era5-t2m-domain-2025-01","key":"zwa0Jamg4E"}],"key":"Vt5wl42m1i"},{"type":"block","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"Winter NAO Index (1940–2024)","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"O5t4CxcqY0"}],"identifier":"winter-nao-index-1940-2024","label":"Winter NAO Index (1940–2024)","html_id":"winter-nao-index-1940-2024","implicit":true,"key":"AbB53Yzb82"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"The station-based North Atlantic Oscillation (NAO) index is the standardised\nmean-sea-level pressure (MSLP) difference between the Azores (Ponta Delgada)\nand Iceland (Reykjavik), following the Hurrell (1995) definition.","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"y0LKcoacBE"}],"key":"h4M3egNHUX"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"Positive NAO winters bring stronger-than-normal westerlies across the North\nAtlantic, resulting in warmer and wetter conditions over northern Europe.\nNegative NAO winters are associated with blocking and cold-air outbreaks.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"UjVg1cNZC6"}],"key":"BhzA8QGlGp"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"strong","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"Method:","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"SmfmMQUKCo"}],"key":"bEwtRPOeHS"}],"key":"S9jT3Wpor2"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":181,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Filter monthly ERA5 MSLP to DJF months only.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"PH6IAcE00e"}],"key":"AoWdaE3BdF"}],"key":"Tsqq6yMdCk"},{"type":"listItem","spread":true,"position":{"start":{"line":182,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Resample with ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"NxKqf67qns"},{"type":"inlineCode","value":"YS-DEC","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"IADJpQXNer"},{"type":"text","value":" so that Dec(N), Jan(N+1), Feb(N+1) form one\nseason labelled by year N — identical to the Hurrell convention.","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"aD15vKTHZD"}],"key":"xbKgV7za8V"}],"key":"MzsbjmJwHF"},{"type":"listItem","spread":true,"position":{"start":{"line":184,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Drop boundary seasons with fewer than 3 months (first and last groups\nare partial because the dataset starts in January 1940).","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"ziIJB4nENQ"}],"key":"xOI309LqCL"}],"key":"gW6WxdfYFY"},{"type":"listItem","spread":true,"position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Snap to the nearest ERA5 grid point for each station.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"T2oQAe4CK1"}],"key":"wUCCn3ZPDp"}],"key":"Khxr56TyYu"},{"type":"listItem","spread":true,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Normalise each series independently (subtract mean, divide by std).","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"KKeIJGe8W2"}],"key":"ezxrGZFx15"}],"key":"fGnNOUZh1L"},{"type":"listItem","spread":true,"position":{"start":{"line":188,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"NAO index = Azores normalised − Iceland normalised.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"JnRHfs7GBD"}],"key":"fEzoyAD2Fh"}],"key":"pLLAukcUgE"}],"key":"jpeMiOwz31"}],"key":"gmZVtHmM7T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ERA5 short name for mean sea level pressure is 'msl'\nmsl = ds[\"msl\"]\n\n# --- Step 1: keep only DJF months ---\nis_djf = msl[\"time.month\"].isin([12, 1, 2])\nwinter_mslp = msl.sel(time=is_djf)\n\n# --- Step 2: resample into DJF seasons anchored at December ---\nwinter_means = winter_mslp.resample(time=\"YS-DEC\").mean()\nwinter_counts = winter_mslp.resample(time=\"YS-DEC\").count(dim=\"time\")\n\n# --- Step 3: drop incomplete boundary seasons (< 3 months) ---\n# Use a single reference point to get a 1-D count series for the time mask.\n_count_ref = winter_counts.isel(latitude=0, longitude=0, drop=True)\ncomplete = _count_ref == 3\nwinter_means = winter_means.sel(time=complete)\n\n# --- Step 4: extract station points (nearest ERA5 grid point) ---\n# Ponta Delgada, São Miguel, Azores: 37.74°N, 25.67°W\n# Reykjavik, Iceland:               64.13°N, 21.90°W\nazores  = winter_means.sel(latitude=37.74, longitude=-25.67, method=\"nearest\")\niceland = winter_means.sel(latitude=64.13, longitude=-21.90, method=\"nearest\")\n\n# --- Step 5: standardise each series over its full period ---\nazores_norm  = (azores  - azores.mean(\"time\"))  / azores.std(\"time\")\niceland_norm = (iceland - iceland.mean(\"time\")) / iceland.std(\"time\")\n\n# --- Step 6: NAO index ---\nnao = (azores_norm - iceland_norm).compute()\n\nyears  = nao.time.dt.year.values\nvalues = nao.values\n\nprint(f\"NAO index: {len(years)} winters ({years[0]}/{years[0]+1} – {years[-1]}/{years[-1]+1})\")\nprint(f\"Mean: {values.mean():.3f}  Std: {values.std():.3f}\")","key":"JrKk2fWmn9"},{"type":"outputs","id":"eDik_kOtJcr_h6Mcz1SWO","children":[],"key":"mDD8hvIIZB"}],"key":"yhwYMSmsbM"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"NAO bar chart","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"XjtotuHPca"}],"identifier":"nao-bar-chart","label":"NAO bar chart","html_id":"nao-bar-chart","implicit":true,"key":"VPwT6BR815"}],"key":"Nug8m0V2Dp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 9-year centred running mean to show decadal variability\nnao_smooth = nao.rolling(time=9, center=True, min_periods=5).mean().values\n\nbar_colors = np.where(values >= 0, \"crimson\", \"steelblue\")\n\nfig, ax = plt.subplots(figsize=(14, 5))\n\nax.bar(years, values, color=bar_colors, width=0.85, alpha=0.80,\n       label=\"Annual DJF NAO\")\nax.plot(years, nao_smooth, color=\"black\", linewidth=2.0, zorder=3,\n        label=\"9-yr running mean\")\nax.axhline(0, color=\"black\", linewidth=0.8, zorder=4)\n\nax.set_title(\n    \"Winter (DJF) North Atlantic Oscillation Index — ERA5 1940–2024\",\n    fontsize=13, fontweight=\"bold\",\n)\nax.set_ylabel(\"Standardised NAO Index\")\nax.set_xlabel(\"Winter Start Year\")\nax.legend(loc=\"upper right\", framealpha=0.9)\nax.grid(axis=\"y\", alpha=0.3)\n\n# Annotate the reference stations\nstation_text = (\n    \"Azores: Ponta Delgada (37.74°N, 25.67°W)\\n\"\n    \"Iceland: Reykjavik (64.13°N, 21.90°W)\"\n)\nax.text(0.01, 0.03, station_text, transform=ax.transAxes,\n        fontsize=8, color=\"gray\", va=\"bottom\")\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_index.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"jtsd7jVVnd"},{"type":"outputs","id":"_fdwMvPXBSwfN1Zj-oJpG","children":[],"key":"jUniLoui7Y"}],"key":"D6sPngGGRt"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_index-ca966d75999241a230e5688322aab3b7.png","alt":"Winter (DJF) NAO index derived from ERA5 MSLP, 1940–2024. Red bars indicate\npositive-phase winters (stronger westerlies, milder northern Europe); blue bars\nindicate negative-phase winters (weaker westerlies, cold-air outbreaks). The\nblack line is a 9-year centred running mean highlighting decadal variability.","data":{"altTextIsAutoGenerated":true},"key":"GFIRRMzQ8D","urlSource":"../../output/images/15_nao_index.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-index","identifier":"fig-15-nao-index","html_id":"fig-15-nao-index","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"J73RDb88F0"},{"type":"text","value":"4","key":"vogThwi7Ev"},{"type":"text","value":":","key":"vLSrXW9NdU"}],"template":"Figure %s:","key":"FOA8b679lG"},{"type":"text","value":"Winter (DJF) NAO index derived from ERA5 MSLP, 1940–2024. Red bars indicate\npositive-phase winters (stronger westerlies, milder northern Europe); blue bars\nindicate negative-phase winters (weaker westerlies, cold-air outbreaks). The\nblack line is a 9-year centred running mean highlighting decadal variability.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"KNmILuzQJB"}],"key":"qPHdhAhuQy"}],"key":"x0ID5MOiUQ"}],"label":"fig-15-nao-index","identifier":"fig-15-nao-index","enumerator":"4","html_id":"fig-15-nao-index","key":"CGHHNtrktu"}],"key":"L1QmoX02l4"},{"type":"block","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"Spatial correlation: NAO vs winter 2 m temperature","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"DQ8LdIj8k8"}],"identifier":"spatial-correlation-nao-vs-winter-2-m-temperature","label":"Spatial correlation: NAO vs winter 2 m temperature","html_id":"spatial-correlation-nao-vs-winter-2-m-temperature","implicit":true,"key":"AuGjp5ERso"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"Each grid point shows the Pearson ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"vOuVEFI8hx"},{"type":"emphasis","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"r","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"lbXFiaaNXx"}],"key":"SgZnLJR6Si"},{"type":"text","value":" between the DJF NAO index and the\nlocal DJF-mean 2 m temperature over 1940–2024.  Red (positive correlation)\nmeans the location warms during NAO+ winters; blue means it cools.","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"f0yL0WZ6Lx"}],"key":"jP0RZeaptt"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"The canonical NAO fingerprint is visible: warming over northern Europe and\nthe North Atlantic, and cooling over the Mediterranean and parts of\nnorth-eastern North America.","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"ZjnXcmflfc"}],"key":"EfRQsOcVqn"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"Reuses the ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"LoSClacodx"},{"type":"inlineCode","value":"complete","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"FyMUxBJGcg"},{"type":"text","value":" season mask from the NAO section to guarantee\nidentical time axes before calling ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"ittxHdXjGE"},{"type":"inlineCode","value":"xr.corr","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"B7xopbMgGY"},{"type":"text","value":".","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"IzzTlvzuL2"}],"key":"eCwhZPacl6"}],"key":"GzvY9YtPEO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Build DJF mean temperature with the same resampling and completeness filter\nwinter_t2m_means = (\n    ds[\"t2m\"]\n    .sel(time=ds.time.dt.month.isin([12, 1, 2]))\n    .resample(time=\"YS-DEC\")\n    .mean()\n    .sel(time=complete)  # same incomplete-season mask as the NAO index\n)\n\n# Pearson r at every grid point along the shared time dimension\nprint(\"Computing spatial correlation …\")\ncorr_map = xr.corr(nao, winter_t2m_means, dim=\"time\").compute()\nprint(\"Done.\")","key":"g7Ds26LzEb"},{"type":"outputs","id":"kY4MD_KmPxJ_lREq13rxK","children":[],"key":"blhRy7vJzK"}],"key":"NoqLtPg2lN"},{"type":"block","children":[],"key":"nTG52qqYmT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"proj = ccrs.Orthographic(central_longitude=-10, central_latitude=55)\nfig, ax = plt.subplots(figsize=(10, 8), subplot_kw={\"projection\": proj})\n\nax.set_extent([-90, 40, 20, 80], crs=ccrs.PlateCarree())\n\nim = ax.pcolormesh(\n    corr_map.longitude,\n    corr_map.latitude,\n    corr_map.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-0.8,\n    vmax=0.8,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.7)\nax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=\":\")\nax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\ncbar = fig.colorbar(\n    im, ax=ax, orientation=\"horizontal\", pad=0.04, fraction=0.04, shrink=0.85\n)\ncbar.set_label(\"Pearson r — NAO index vs DJF 2 m temperature\")\n\nax.set_title(\n    \"NAO impact on winter (DJF) 2 m temperature — ERA5 1940–2024\",\n    fontsize=13,\n    fontweight=\"bold\",\n)\n\nfig.tight_layout()\nfig.savefig(\n    paths.images_path / \"15_nao_t2m_correlation.png\", dpi=150, bbox_inches=\"tight\"\n)\nplt.show()","key":"WNr2wPUhb5"},{"type":"outputs","id":"8plgTWeyyrvUxQZUOns08","children":[],"key":"jNEA7ktNpT"}],"key":"VFLsQVuxwt"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_t2m_correlati-43ba897f343acb918b3fff4dd495bfcd.png","alt":"Pearson correlation between the DJF NAO index and ERA5 DJF 2 m temperature,\n1940–2024.  Red shading indicates regions that are warmer than average during\nNAO+ winters; blue shading indicates cooler regions.","data":{"altTextIsAutoGenerated":true},"key":"znjHvcxgMH","urlSource":"../../output/images/15_nao_t2m_correlation.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-t2m-correlation","identifier":"fig-15-nao-t2m-correlation","html_id":"fig-15-nao-t2m-correlation","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"wIOgO3GL19"},{"type":"text","value":"5","key":"PVmGGqFuJk"},{"type":"text","value":":","key":"UnofHxoI5i"}],"template":"Figure %s:","key":"q5RwerJ7yp"},{"type":"text","value":"Pearson correlation between the DJF NAO index and ERA5 DJF 2 m temperature,\n1940–2024.  Red shading indicates regions that are warmer than average during\nNAO+ winters; blue shading indicates cooler regions.","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"KfGQ7tVaRm"}],"key":"yBomF97sv7"}],"key":"CqcK6fxiR7"}],"label":"fig-15-nao-t2m-correlation","identifier":"fig-15-nao-t2m-correlation","enumerator":"5","html_id":"fig-15-nao-t2m-correlation","key":"lnovpgkHr2"}],"key":"vkMJltqyQe"},{"type":"block","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"Germany DJF temperature vs NAO index","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"eRytoSvbzj"}],"identifier":"germany-djf-temperature-vs-nao-index","label":"Germany DJF temperature vs NAO index","html_id":"germany-djf-temperature-vs-nao-index","implicit":true,"key":"yZMgtDcLIg"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"Load the Germany spatial-mean 2 m temperature produced by\n","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"Vu0iY1o7kF"},{"type":"inlineCode","value":"16_dev_germany_weather.py","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"PnjG0ZUWzD"},{"type":"text","value":", apply the identical YS-DEC resampling used for\nthe NAO index, and scatter the two series against each other.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"mNBWUkXwEd"}],"key":"m6SswAezUp"}],"key":"WPPdpUIrXM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load Germany monthly spatial-mean temperature (mean aggregation, K → °C)\ndf_de = pd.read_parquet(paths.era5_germany_monthly_ts_file)\nt2m_de_monthly = df_de[\"t2m\"] - 273.15  # K → °C\n\n# Filter to DJF and resample with YS-DEC (same convention as NAO index)\nis_djf_de = t2m_de_monthly.index.month.isin([12, 1, 2])\nt2m_de_djf_monthly = t2m_de_monthly[is_djf_de]\nt2m_de_djf = t2m_de_djf_monthly.resample(\"YS-DEC\").mean()\ncounts_de   = t2m_de_djf_monthly.resample(\"YS-DEC\").count()\nt2m_de_djf  = t2m_de_djf[counts_de == 3]\n\n# NAO as a pandas Series indexed by the season's December date (YS-DEC labels)\nnao_series = pd.Series(values, index=pd.DatetimeIndex(nao.time.values))\n\n# Align on the shared index (inner join → only seasons present in both)\ncombined = pd.DataFrame({\"nao\": nao_series, \"t2m_de\": t2m_de_djf}).dropna()\nprint(f\"Aligned seasons: {len(combined)}  \"\n      f\"({combined.index.year[0]}/{combined.index.year[0]+1} – \"\n      f\"{combined.index.year[-1]}/{combined.index.year[-1]+1})\")\n\n# Pearson correlation and OLS trend line\npearson_r = combined[\"nao\"].corr(combined[\"t2m_de\"])\nm_slope, m_intercept = np.polyfit(combined[\"nao\"], combined[\"t2m_de\"], 1)\nprint(f\"Pearson r (NAO vs Germany DJF T2m): {pearson_r:.3f}\")\nprint(f\"OLS slope:                           {m_slope:+.2f} °C per σ of NAO\")\n\nx_fit = np.linspace(combined[\"nao\"].min(), combined[\"nao\"].max(), 100)\n\nfig, ax = plt.subplots(figsize=(7, 6))\n\nsc = ax.scatter(\n    combined[\"nao\"], combined[\"t2m_de\"],\n    c=combined.index.year, cmap=\"plasma\",\n    s=45, alpha=0.85, zorder=3,\n)\nax.plot(x_fit, m_slope * x_fit + m_intercept,\n        color=\"crimson\", linewidth=1.8, zorder=4,\n        label=f\"OLS: {m_slope:+.2f} °C / σ  (r = {pearson_r:.2f})\")\nax.axhline(combined[\"t2m_de\"].mean(), color=\"gray\", linewidth=0.8,\n           linestyle=\"--\", alpha=0.6)\nax.axvline(0, color=\"gray\", linewidth=0.8, linestyle=\"--\", alpha=0.6)\n\ncbar = fig.colorbar(sc, ax=ax, label=\"Winter start year\")\nax.set_xlabel(\"DJF NAO Index (standardised)\")\nax.set_ylabel(\"Germany DJF mean 2 m temperature (°C)\")\nax.set_title(\n    \"Germany winter temperature vs NAO index\\n\"\n    \"ERA5 DJF seasons, 1940–2024\",\n    fontsize=12,\n)\nax.legend(loc=\"upper left\")\nax.grid(linewidth=0.4, alpha=0.5)\nfig.tight_layout()\n\nfig.savefig(paths.images_path / \"15_nao_germany_t2m.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"pYjIzOBpTx"},{"type":"outputs","id":"tyypzi-s60qhGC2jxpf27","children":[],"key":"oOHGwBdYB2"}],"key":"aJV5wkahQy"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_germany_t2m-d6abf5cc87a46de2fe7ddd7cabc4fc33.png","alt":"Scatter plot of Germany DJF mean 2 m temperature against the ERA5-derived\nNAO index, 1940–2024.  Each point is one winter season, coloured by year.\nThe crimson line is an OLS regression; the slope (°C per σ of NAO) quantifies\nhow much Germany warms for each standard-deviation increase in the NAO index.","data":{"altTextIsAutoGenerated":true},"key":"KgdC0XC8xP","urlSource":"../../output/images/15_nao_germany_t2m.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":419,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-germany-t2m","identifier":"fig-15-nao-germany-t2m","html_id":"fig-15-nao-germany-t2m","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"stP5dBf6Ks"},{"type":"text","value":"6","key":"sm1AqV2qSS"},{"type":"text","value":":","key":"GnOoFkCcQl"}],"template":"Figure %s:","key":"EjFIdcmH7j"},{"type":"text","value":"Scatter plot of Germany DJF mean 2 m temperature against the ERA5-derived\nNAO index, 1940–2024.  Each point is one winter season, coloured by year.\nThe crimson line is an OLS regression; the slope (°C per σ of NAO) quantifies\nhow much Germany warms for each standard-deviation increase in the NAO index.","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"HCJRlxhpdC"}],"key":"cfSYIOAVoN"}],"key":"m8bPXlQU2X"}],"label":"fig-15-nao-germany-t2m","identifier":"fig-15-nao-germany-t2m","enumerator":"6","html_id":"fig-15-nao-germany-t2m","key":"B4AJqqdMjS"}],"key":"Q6hz6Tldup"},{"type":"block","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"DJF temperature maps — extreme NAO winters","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"cXaVUy6em8"}],"identifier":"djf-temperature-maps-extreme-nao-winters","label":"DJF temperature maps — extreme NAO winters","html_id":"djf-temperature-maps-extreme-nao-winters","implicit":true,"key":"FQQQ0vwFIp"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"Full spatial field of ERA5 DJF mean 2 m temperature for the winters with the\nhighest and lowest NAO index in the record (1940–2024).  Uses the same\n","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"cDNv0MZ0xN"},{"type":"inlineCode","value":"winter_t2m_means","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"RCzr3Czid1"},{"type":"text","value":" DataArray (already filtered to complete DJF seasons) that\nwas used for the NAO computation.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"ymSuAqy7vj"}],"key":"baMIZYstEG"}],"key":"pk73bjRQvq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"idx_max = int(np.argmax(values))\nidx_min = int(np.argmin(values))\nyear_max, nao_max = years[idx_max], values[idx_max]\nyear_min, nao_min = years[idx_min], values[idx_min]\n\nprint(f\"Max NAO winter: {year_max}/{year_max+1}  NAO = {nao_max:+.2f} σ\")\nprint(f\"Min NAO winter: {year_min}/{year_min+1}  NAO = {nao_min:+.2f} σ\")\n\nt2m_max_field = (winter_t2m_means.sel(time=nao.time[idx_max]) - 273.15).compute()\nt2m_min_field = (winter_t2m_means.sel(time=nao.time[idx_min]) - 273.15).compute()\n\nfig, axes = plt.subplots(\n    1, 2, figsize=(18, 6),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nfor ax, t2m, year, nao_val, label in [\n    (axes[0], t2m_max_field, year_max, nao_max, \"Maximum NAO\"),\n    (axes[1], t2m_min_field, year_min, nao_min, \"Minimum NAO\"),\n]:\n    im = ax.pcolormesh(\n        t2m.longitude, t2m.latitude, t2m.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"RdBu_r\", vmin=-40, vmax=40,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n    ax.set_title(\n        f\"{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)\",\n        fontsize=12, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"DJF mean 2 m temperature (°C)\",\n)\nfig.suptitle(\n    \"ERA5 DJF mean 2 m temperature — extreme NAO winters\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_winters.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"C4vfyrCXKG"},{"type":"outputs","id":"r5BCofFwfw70u7zEZVyEF","children":[],"key":"lVqdGw2LGY"}],"key":"STvpXRN2rw"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_winte-e7c7949a252fd408e2a155078ee5b13f.png","alt":"ERA5 DJF mean 2 m temperature for the winter with the highest NAO index\n(left) and lowest NAO index (right) in the 1940–2024 record.  The contrast\nbetween the two panels illustrates the NAO’s influence on winter temperatures\nacross the North Atlantic–European sector.","data":{"altTextIsAutoGenerated":true},"key":"Jkv9MekXah","urlSource":"../../output/images/15_nao_extreme_winters.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":483,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-winters","identifier":"fig-15-nao-extreme-winters","html_id":"fig-15-nao-extreme-winters","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"omZk3qzokt"},{"type":"text","value":"7","key":"VCfdiea0Dl"},{"type":"text","value":":","key":"ZF37LnIy3j"}],"template":"Figure %s:","key":"ohKwUK1yJG"},{"type":"text","value":"ERA5 DJF mean 2 m temperature for the winter with the highest NAO index\n(left) and lowest NAO index (right) in the 1940–2024 record.  The contrast\nbetween the two panels illustrates the NAO’s influence on winter temperatures\nacross the North Atlantic–European sector.","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"key":"R85CAtNdY6"}],"key":"eGGRXut44k"}],"key":"k0K2W1b9SU"}],"label":"fig-15-nao-extreme-winters","identifier":"fig-15-nao-extreme-winters","enumerator":"7","html_id":"fig-15-nao-extreme-winters","key":"aiK8hRFNWz"}],"key":"Bw5L0vCZPi"},{"type":"block","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"children":[{"type":"text","value":"Temperature difference: max-NAO minus min-NAO winter","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"R7G646llzk"}],"identifier":"temperature-difference-max-nao-minus-min-nao-winter","label":"Temperature difference: max-NAO minus min-NAO winter","html_id":"temperature-difference-max-nao-minus-min-nao-winter","implicit":true,"key":"uK7MBQBsrn"}],"key":"kM9pmmuuZk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t2m_diff = t2m_max_field - t2m_min_field  # signed: positive = warmer in NAO+ winter\n\nvabs = float(np.abs(t2m_diff.values).max())\n\nfig, ax = plt.subplots(\n    figsize=(14, 7),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nim = ax.pcolormesh(\n    t2m_diff.longitude, t2m_diff.latitude, t2m_diff.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\", vmin=-vabs, vmax=vabs,\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\nax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.04, fraction=0.04)\ncbar.set_label(\"Temperature difference (°C)  [max-NAO minus min-NAO]\")\n\nax.set_title(\n    f\"DJF temperature difference: {year_max}/{year_max+1} (NAO={nao_max:+.2f}σ)\"\n    f\"  minus  {year_min}/{year_min+1} (NAO={nao_min:+.2f}σ)\",\n    fontsize=12, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_diff.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"WTLJaCRZQC"},{"type":"outputs","id":"0Tkz3QGdVgIS3KfQpXXjB","children":[],"key":"VFc4V5YYbh"}],"key":"bnGQo53WzT"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_diff-61309d39f85d49153f7c17f9bfc746e5.png","alt":"Signed temperature difference between the maximum-NAO and minimum-NAO DJF\nseasons in the ERA5 record.  Red indicates regions that were warmer during\nthe NAO+ winter; blue indicates regions that were colder.","data":{"altTextIsAutoGenerated":true},"key":"TkKJPst6MT","urlSource":"../../output/images/15_nao_extreme_diff.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":527,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-diff","identifier":"fig-15-nao-extreme-diff","html_id":"fig-15-nao-extreme-diff","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"lK3y8ZR0tH"},{"type":"text","value":"8","key":"H7S21lcPbK"},{"type":"text","value":":","key":"kbiGsyeezk"}],"template":"Figure %s:","key":"B9IqNTDaKQ"},{"type":"text","value":"Signed temperature difference between the maximum-NAO and minimum-NAO DJF\nseasons in the ERA5 record.  Red indicates regions that were warmer during\nthe NAO+ winter; blue indicates regions that were colder.","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"jMMTXnKssw"}],"key":"gssXOLrx3t"}],"key":"qkoOjvoV3s"}],"label":"fig-15-nao-extreme-diff","identifier":"fig-15-nao-extreme-diff","enumerator":"8","html_id":"fig-15-nao-extreme-diff","key":"qoOhPf8E4J"}],"key":"mPX7OorQOz"},{"type":"block","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"text","value":"250 hPa wind speed — extreme NAO winters","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"KgPMWvtrUw"}],"identifier":"id-250-hpa-wind-speed-extreme-nao-winters","label":"250 hPa wind speed — extreme NAO winters","html_id":"id-250-hpa-wind-speed-extreme-nao-winters","implicit":true,"key":"DVVBDeNOko"},{"type":"paragraph","position":{"start":{"line":536,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"DJF mean 250 hPa wind speed (jet stream level) for the max-NAO and min-NAO\nwinters.  U and V components are resampled with the same YS-DEC convention\nand completeness mask before computing speed = √(u² + v²).  Wind direction\nis overlaid as thinned quiver arrows.","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"YdcEHOF23J"}],"key":"v7e4uuApbS"}],"key":"cdXU01U2x6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Build DJF mean U and V at 250 hPa with the same season mask as the NAO index\ndef _djf_season_mean(da):\n    return (\n        da.sel(time=ds.time.dt.month.isin([12, 1, 2]))\n        .resample(time=\"YS-DEC\")\n        .mean()\n        .sel(time=complete)\n    )\n\nu250 = _djf_season_mean(ds[\"u\"].sel(pressure_level=250))\nv250 = _djf_season_mean(ds[\"v\"].sel(pressure_level=250))\n\n# Select the two extreme seasons and compute wind speed\nu_max = u250.sel(time=nao.time[idx_max]).compute()\nv_max = v250.sel(time=nao.time[idx_max]).compute()\nu_min = u250.sel(time=nao.time[idx_min]).compute()\nv_min = v250.sel(time=nao.time[idx_min]).compute()\n\nwspd_max = np.sqrt(u_max**2 + v_max**2)\nwspd_min = np.sqrt(u_min**2 + v_min**2)\n\nvmax_wspd = float(max(wspd_max.values.max(), wspd_min.values.max()))\n\n# Thin the quiver grid to avoid overplotting (every Nth point)\nN = 6\nlons_q = wspd_max.longitude.values[::N]\nlats_q = wspd_max.latitude.values[::N]\n\nfig, axes = plt.subplots(\n    1, 2, figsize=(18, 6),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nfor ax, wspd, u_q, v_q, year, nao_val, label in [\n    (axes[0], wspd_max, u_max.values[::N, ::N], v_max.values[::N, ::N],\n     year_max, nao_max, \"Maximum NAO\"),\n    (axes[1], wspd_min, u_min.values[::N, ::N], v_min.values[::N, ::N],\n     year_min, nao_min, \"Minimum NAO\"),\n]:\n    im = ax.pcolormesh(\n        wspd.longitude, wspd.latitude, wspd.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"YlOrRd\", vmin=0, vmax=vmax_wspd,\n    )\n    ax.quiver(\n        lons_q, lats_q, u_q, v_q,\n        transform=ccrs.PlateCarree(),\n        scale=2000, width=0.001, color=\"black\", alpha=0.55,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n    ax.set_title(\n        f\"{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)\",\n        fontsize=12, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"250 hPa wind speed (m/s)\",\n)\nfig.suptitle(\n    \"ERA5 DJF mean 250 hPa wind speed — extreme NAO winters\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_250hpa_wind.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"Ma7UGNtLp8"},{"type":"outputs","id":"nzmB1woZ9tcYMwbI91oYA","children":[],"key":"Bd4w1h3oJD"}],"key":"rTJADI6zeW"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_250hp-82509ca6ba1ced54a50813ff0c295dcd.png","alt":"DJF mean 250 hPa wind speed for the maximum-NAO (left) and minimum-NAO\n(right) winters in the ERA5 record.  Colour shows wind speed; arrows show\nwind direction (thinned for clarity).  The NAO+ winter typically shows a\nstronger, more zonally oriented jet stream over the North Atlantic.","data":{"altTextIsAutoGenerated":true},"key":"znaVog3rB2","urlSource":"../../output/images/15_nao_extreme_250hpa_wind.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":614,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-250hpa-wind","identifier":"fig-15-nao-extreme-250hpa-wind","html_id":"fig-15-nao-extreme-250hpa-wind","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"zSoCAh1TMA"},{"type":"text","value":"9","key":"z481vosuVI"},{"type":"text","value":":","key":"M3ibKViF8i"}],"template":"Figure %s:","key":"pKBtXK3Hbd"},{"type":"text","value":"DJF mean 250 hPa wind speed for the maximum-NAO (left) and minimum-NAO\n(right) winters in the ERA5 record.  Colour shows wind speed; arrows show\nwind direction (thinned for clarity).  The NAO+ winter typically shows a\nstronger, more zonally oriented jet stream over the North Atlantic.","position":{"start":{"line":614,"column":1},"end":{"line":614,"column":1}},"key":"FS86rGFy2Q"}],"key":"TWSuaVOl2C"}],"key":"OX7GLjJhuh"}],"label":"fig-15-nao-extreme-250hpa-wind","identifier":"fig-15-nao-extreme-250hpa-wind","enumerator":"9","html_id":"fig-15-nao-extreme-250hpa-wind","key":"hmMMzptLbU"}],"key":"WbNmCBVToM"},{"type":"block","position":{"start":{"line":620,"column":1},"end":{"line":620,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"text","value":"500 hPa geopotential height — extreme NAO winters","position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"key":"re86C7gPNb"}],"identifier":"id-500-hpa-geopotential-height-extreme-nao-winters","label":"500 hPa geopotential height — extreme NAO winters","html_id":"id-500-hpa-geopotential-height-extreme-nao-winters","implicit":true,"key":"TIyPHy4w2H"},{"type":"paragraph","position":{"start":{"line":624,"column":1},"end":{"line":627,"column":1}},"children":[{"type":"text","value":"DJF mean 500 hPa geopotential height (Z500) for the max-NAO and min-NAO\nwinters.  Geopotential (m²/s²) is converted to geopotential height (m) by\ndividing by g = 9.80665 m/s².  Filled contours show height; contour lines\nhighlight the main ridges and troughs.","position":{"start":{"line":624,"column":1},"end":{"line":624,"column":1}},"key":"tLMYhp0apd"}],"key":"ECWaEA06Gs"}],"key":"vRlOb2fcH6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"G = 9.80665  # standard gravity m/s²\n\nz500_max = (_djf_season_mean(ds[\"z\"].sel(pressure_level=500))\n            .sel(time=nao.time[idx_max]).compute() / G)\nz500_min = (_djf_season_mean(ds[\"z\"].sel(pressure_level=500))\n            .sel(time=nao.time[idx_min]).compute() / G)\n\n# Shared colour scale anchored to the combined range\nvmin_z = float(min(z500_max.values.min(), z500_min.values.min()))\nvmax_z = float(max(z500_max.values.max(), z500_min.values.max()))\n\nfig, axes = plt.subplots(\n    1, 2, figsize=(18, 6),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nfor ax, z500, year, nao_val, label in [\n    (axes[0], z500_max, year_max, nao_max, \"Maximum NAO\"),\n    (axes[1], z500_min, year_min, nao_min, \"Minimum NAO\"),\n]:\n    lons = z500.longitude.values\n    lats = z500.latitude.values\n\n    im = ax.pcolormesh(\n        lons, lats, z500.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"RdBu_r\", vmin=vmin_z, vmax=vmax_z,\n    )\n    # Contour lines every 80 m\n    cs = ax.contour(\n        lons, lats, z500.values,\n        levels=np.arange(np.floor(vmin_z / 80) * 80,\n                         np.ceil(vmax_z / 80) * 80 + 1, 80),\n        colors=\"black\", linewidths=0.6, alpha=0.6,\n        transform=ccrs.PlateCarree(),\n    )\n    ax.clabel(cs, fmt=\"%d\", fontsize=7, inline=True)\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\n    # NAO station markers\n    for (lon, lat, name) in [\n        (-25.67, 37.74, \"Azores\"),\n        (-21.90, 64.13, \"Iceland\"),\n    ]:\n        ax.plot(lon, lat, transform=ccrs.PlateCarree(),\n                marker=\"*\", markersize=10, color=\"gold\",\n                markeredgecolor=\"black\", markeredgewidth=0.6, zorder=5)\n        ax.text(lon + 1.5, lat, name, transform=ccrs.PlateCarree(),\n                fontsize=8, fontweight=\"bold\", color=\"black\",\n                va=\"center\", zorder=5)\n\n    ax.set_title(\n        f\"{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)\",\n        fontsize=12, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"500 hPa geopotential height (m)\",\n)\nfig.suptitle(\n    \"ERA5 DJF mean 500 hPa geopotential height — extreme NAO winters\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_z500.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"iKSoEwkDpq"},{"type":"outputs","id":"YbyTAzdrf8M_DnJYcEv-0","children":[],"key":"zgZeI0LhdT"}],"key":"T9YOzsVSXM"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_z500-5d1df860211ea54ff2a20af1bfa64b4c.png","alt":"DJF mean 500 hPa geopotential height for the maximum-NAO (left) and\nminimum-NAO (right) winters.  Contour lines are drawn every 80 m.  The\nNAO+ pattern shows higher geopotential over the Azores and lower over\nIceland, steering mild Atlantic air into Europe; NAO− reverses this,\nfavouring blocking and cold-air advection.","data":{"altTextIsAutoGenerated":true},"key":"dEsWJy98WG","urlSource":"../../output/images/15_nao_extreme_z500.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":703,"column":1},"end":{"line":707,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-z500","identifier":"fig-15-nao-extreme-z500","html_id":"fig-15-nao-extreme-z500","enumerator":"10","children":[{"type":"text","value":"Figure ","key":"RC5Ldx3yku"},{"type":"text","value":"10","key":"qir0SFC5xf"},{"type":"text","value":":","key":"XLHx0MmSzv"}],"template":"Figure %s:","key":"N0FcXGwQPa"},{"type":"text","value":"DJF mean 500 hPa geopotential height for the maximum-NAO (left) and\nminimum-NAO (right) winters.  Contour lines are drawn every 80 m.  The\nNAO+ pattern shows higher geopotential over the Azores and lower over\nIceland, steering mild Atlantic air into Europe; NAO− reverses this,\nfavouring blocking and cold-air advection.","position":{"start":{"line":703,"column":1},"end":{"line":703,"column":1}},"key":"xLZ9QjPdVU"}],"key":"TAazhKlQ6n"}],"key":"tYWgQLoeOW"}],"label":"fig-15-nao-extreme-z500","identifier":"fig-15-nao-extreme-z500","enumerator":"10","html_id":"fig-15-nao-extreme-z500","key":"XX4G8iBGIx"}],"key":"R3WW2cCoSD"}],"key":"aVSFohxVbY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Weather Variability in Germany — Beyond the Seasonal Cycle","url":"/notebooks/germany-variations","group":"World of Energy"},"next":{"title":"NAO and Jet Stream — Daily Evolution","url":"/notebooks/daily-jet-stream-animations","group":"World of Energy"}}},"domain":"http://localhost:3000"}
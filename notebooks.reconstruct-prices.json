{"version":3,"kind":"Notebook","sha256":"820b6d18f168caa2818cd3d535c9fc439f52411cc5974bf2aa6ff0680f56de9d","slug":"notebooks.reconstruct-prices","location":"/notebooks/04_reconstruct_prices.ipynb","dependencies":[],"frontmatter":{"title":"Fossil Fuel Costs and Electricity Price Reconstruction","content_includes_title":false,"kernelspec":{"name":"world-of-energy","display_name":"World of Energy","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","numbering":{"title":{"offset":1}},"source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/04_reconstruct_prices.ipynb","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/04_reconstruct_prices.ipynb","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","exports":[{"format":"ipynb","filename":"04_reconstruct_prices.ipynb","url":"/world-of-energy/build/04_reconstruct_price-1f9c3f554a536b5b12432f60024d867b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook calculates the Short Run Marginal Costs (SRMC) of generating\nelectricity using hard coal and fossil gas, then uses a simplified merit\norder model to reconstruct wholesale electricity prices.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yX41YAIJci"}],"key":"dQo2EFRXYB"},{"type":"heading","depth":2,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Approach","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ars5uRdKXT"}],"identifier":"approach","label":"Approach","html_id":"approach","implicit":true,"key":"SEGTQBA5LY"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Calculate ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ci3FseuwzT"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SRMC","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rlfaL1LYVi"}],"key":"l8CAJqz3SC"},{"type":"text","value":" for coal and gas power plants from commodity prices","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"I1wcC8Vozo"}],"key":"YWCDAtPYBu"}],"key":"gSmsZeWQRP"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Calculate ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"z2aWqCYrp9"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Fossil Residual Load","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LhS1YZiRkv"}],"key":"S4DjGGTTh2"},{"type":"text","value":": the demand that must be met by fossil plants\nafter accounting for renewables and baseload generation","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YzDgXtGF3U"}],"key":"fTwyRGVmL2"}],"key":"rz1PdHImNE"}],"key":"I2Dfqu96d1"},{"type":"math","value":"RL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro}_{RoR})","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>=</mo><mtext>Load</mtext><mo>−</mo><mo stretchy=\"false\">(</mo><mtext>Wind</mtext><mo>+</mo><mtext>Solar</mtext><mo stretchy=\"false\">)</mo><mo>−</mo><mo stretchy=\"false\">(</mo><mtext>Nuclear</mtext><mo>+</mo><mtext>Biomass</mtext><mo>+</mo><msub><mtext>Hydro</mtext><mrow><mi>R</mi><mi>o</mi><mi>R</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">RL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro}_{RoR})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">oss</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">Load</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">Wind</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Solar</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">Nuclear</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">Biomass</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Hydro</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2342em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"1","key":"OXYGxEpEA9"},{"type":"list","ordered":true,"start":3,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Determine which fossil fuel (coal or gas) is cheaper based on SRMC","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zpCKdDCO9w"}],"key":"IMzcQN7h5H"}],"key":"rVk7IXFNqd"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Assign price based on merit order:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"HV55ExTWvK"}],"key":"pmbSWKJpQV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gtHXIkKKsw"},{"type":"inlineMath","value":"RL_{fossil} \\leq \\text{cheaper capacity}","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>≤</mo><mtext>cheaper capacity</mtext></mrow><annotation encoding=\"application/x-tex\">RL_{fossil} \\leq \\text{cheaper capacity}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">oss</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">cheaper capacity</span></span></span></span></span>","key":"DUgjNC8Nz4"},{"type":"text","value":": price = cheaper SRMC","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ikAYcAoa0J"}],"key":"HqSmddUOD6"}],"key":"IQvagKMaGJ"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ETbr44zSh8"},{"type":"inlineMath","value":"RL_{fossil} > \\text{cheaper capacity}","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>&gt;</mo><mtext>cheaper capacity</mtext></mrow><annotation encoding=\"application/x-tex\">RL_{fossil} &gt; \\text{cheaper capacity}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">oss</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">cheaper capacity</span></span></span></span></span>","key":"HA7bBWikBC"},{"type":"text","value":": price = more expensive SRMC","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"cqIns8z9l4"}],"key":"wJBnKeUNhA"}],"key":"dJUfQ98GLp"}],"key":"f2w56pR2WG"}],"key":"jfPrhdoas9"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Compare reconstructed prices with actual market prices","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"TGcbtE3hjt"}],"key":"UNV8UXOMUP"}],"key":"HkBNUoGcG9"}],"key":"Dw0DmUfm1f"}],"key":"N1YhBqQQ7c"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Short Run Marginal Costs (SRMC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XncmeQ454m"}],"identifier":"short-run-marginal-costs-srmc","label":"Short Run Marginal Costs (SRMC)","html_id":"short-run-marginal-costs-srmc","implicit":true,"key":"SDxsjlfuqf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xom3gN8lYs"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Short Run Marginal Cost (SRMC)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kbJxei6FJU"}],"key":"CXmWDLzQn9"},{"type":"text","value":" represents the variable cost of producing\none additional MWh of electricity from a power plant. It determines the merit\norder position of generators in wholesale electricity markets.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iiLt66lzYy"}],"key":"qtmvRM9c57"},{"type":"heading","depth":3,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Components of SRMC","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"n1za5t705g"}],"identifier":"components-of-srmc","label":"Components of SRMC","html_id":"components-of-srmc","implicit":true,"key":"RoKA0uiB5s"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SRMC consists of three main components:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Je8XD9J3Ov"}],"key":"Pt2c6i8eUP"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Fuel costs","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uE3fl5dcrE"}],"key":"Kzgg4wI7My"},{"type":"text","value":" - The cost of the primary fuel (gas or coal) needed to\ngenerate electricity, adjusted for plant efficiency.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NJ6X2UeTb7"}],"key":"zy35eiACsp"}],"key":"r4CeeUekvZ"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Carbon costs","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tHkq1bdVn8"}],"key":"HHnZM0Yzn4"},{"type":"text","value":" - The cost of CO2 emissions under the EU Emissions Trading\nScheme (EU ETS), based on the carbon intensity of the fuel.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"PUsUJTp1kC"}],"key":"NHkxzwjOYw"}],"key":"N2wlB5jkR9"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Variable O&M costs","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"YtTkfJkpqu"}],"key":"qxtSHlW9bv"},{"type":"text","value":" - Operating and maintenance costs that vary with\nelectricity output.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ufPaxl2sEN"}],"key":"SCcmokJEGB"}],"key":"Xr2VrQlyjO"}],"key":"oyV0QLxDsB"},{"type":"heading","depth":3,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Price References","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"nsrdxK7RNo"}],"identifier":"price-references","label":"Price References","html_id":"price-references","implicit":true,"key":"tmUPmpNyev"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Fossil Gas:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Z2hNkFFASB"}],"key":"oG2tbIcfCS"}],"key":"FpJIwed8BB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Dutch Title Transfer Facility (TTF) is the benchmark for gas traded in Europe","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FZTgn6sXNM"}],"key":"jkE9Gdb3U6"}],"key":"anskPqChG8"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Other European hubs (CEGH VTP, THE, PSV, etc.) trade at spreads to TTF","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"OSBi9oEnp8"}],"key":"Krpo47G4Bh"}],"key":"SToDAo5yD0"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prices sourced from commodity exchanges (e.g., ICE, EEX)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"olgQj14pag"}],"key":"UtUsvQFzD6"}],"key":"OD1nkEuVuC"}],"key":"FEjlOKHA6g"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Hard Coal:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"anSZzbK64h"}],"key":"s8P45XmSqP"}],"key":"X0tIvD8yEn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"API 2 Rotterdam is the benchmark for coal imported into Northwest Europe","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"uQZktnQapn"}],"key":"pud3n7ciuv"}],"key":"iyQ0103J5Y"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Front month settlement prices in USD/metric ton","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"bldpI6gqVX"}],"key":"UFrSSWfVA3"}],"key":"szysM6RHYd"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Thermal content approximately 6,000 kcal/kg (NAR)","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"xelYKx3vc3"}],"key":"t4Tyh0xyxd"}],"key":"RjjcX7oZbc"}],"key":"Z7nEr653gJ"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"strong","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Carbon:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"aYdCM6YKal"}],"key":"VcZzzGi3Vn"}],"key":"ssgcISHRdc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"EU ETS allowance prices (EUA) for the front December contract","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"XhQe8necX9"}],"key":"ZciFPowYXv"}],"key":"x7s19YRx8r"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prices in EUR per tonne CO2","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"pWqgLFerzW"}],"key":"K14kZVu9JS"}],"key":"BPeIebqWsR"}],"key":"Vlv3fin35m"},{"type":"heading","depth":3,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Calculation Assumptions","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"mqw65u4tNo"}],"identifier":"calculation-assumptions","label":"Calculation Assumptions","html_id":"calculation-assumptions","implicit":true,"key":"cxiS38VTek"},{"type":"table","position":{"start":{"line":38,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Parameter","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"iYR5jD538f"}],"key":"dYAMexKtTY"},{"type":"tableCell","header":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Hard Coal","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"exmwvK9nug"}],"key":"IMf4ZCo6vb"},{"type":"tableCell","header":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Fossil Gas","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"ylR8dgv2DF"}],"key":"HGRTgIvnww"}],"key":"MpumobJEoP"},{"type":"tableRow","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Efficiency (HHV)","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ebzoWt0VCg"}],"key":"UkkgS7F3ka"},{"type":"tableCell","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"40%","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ccV4MJOBij"}],"key":"Kd8g7WFQgw"},{"type":"tableCell","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"50%","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"BnmRaXn38D"}],"key":"y1kIh61MTU"}],"key":"htbev3TjNi"},{"type":"tableRow","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Carbon intensity","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"eKZcMT9fsX"}],"key":"Odw4z7OA71"},{"type":"tableCell","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"0.83 tCO2/MWh","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"Fdw8NkX4YH"}],"key":"m3e7XvvtFP"},{"type":"tableCell","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"0.37 tCO2/MWh","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"Ldm6Gmunbq"}],"key":"kq7XsvHmZA"}],"key":"pfeJNYl4Bn"},{"type":"tableRow","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Variable O&M","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"NMRddpf7Eo"}],"key":"qM4YiN2Yds"},{"type":"tableCell","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"€2/MWh","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"LD132dotqN"}],"key":"XXcaqGDBC2"},{"type":"tableCell","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"€2/MWh","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"i5R3xAEPa2"}],"key":"aJH5xGolBZ"}],"key":"Fr7QYw4Hw2"}],"key":"aQh7wDfePS"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"The carbon intensity values represent emissions per MWh of electricity generated,\naccounting for the power plant efficiency.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"bpOVxaBxDR"}],"key":"T0Grqz0yKt"},{"type":"heading","depth":3,"position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Why SRMC Matters","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ZgC5kLZDQJ"}],"identifier":"why-srmc-matters","label":"Why SRMC Matters","html_id":"why-srmc-matters","implicit":true,"key":"gHQOCXqL6k"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"In liberalized electricity markets, generators bid close to their marginal cost.\nThe SRMC comparison between coal and gas determines:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"KM9xyPKDQO"}],"key":"sdUxNtXNgr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":52,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Fuel switching","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"Qqqy9S9OpD"}],"key":"PQmghcNAxI"},{"type":"text","value":" - When gas SRMC falls below coal, utilities switch from\ncoal to gas, reducing emissions","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"QrsUhNDJh7"}],"key":"Bi0NENpM00"}],"key":"NQeIdEwrSx"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Price formation","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"TKa2SpVF07"}],"key":"n69FZfr7UI"},{"type":"text","value":" - The highest SRMC plant needed to meet demand often\nsets the wholesale electricity price","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"La3BvzyF0S"}],"key":"ahAJmxshUE"}],"key":"iNeNYURmXU"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Investment signals","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"V0kwYpek3a"}],"key":"ogkL7iJDot"},{"type":"text","value":" - Persistent SRMC relationships influence new build\ndecisions and plant retirements","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"uqaqPscqdX"}],"key":"ad17oXdJh6"}],"key":"ynHI7mgNNY"}],"key":"sl7UswfcFv"}],"key":"dAabpnG8YN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:29.337959Z","iopub.status.busy":"2026-03-01T17:07:29.337775Z","iopub.status.idle":"2026-03-01T17:07:30.503932Z","shell.execute_reply":"2026-03-01T17:07:30.503239Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score\n\nfrom woe.paths import ProjPaths","key":"ZL92REccQn"},{"type":"outputs","id":"Pp_LCXmgHidLAvuFp-IpT","children":[],"key":"QpqHU8ireQ"}],"key":"fA6kSzpDPI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SRMC Calculation Parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KFNqBhu2B1"}],"identifier":"srmc-calculation-parameters","label":"SRMC Calculation Parameters","html_id":"srmc-calculation-parameters","implicit":true,"key":"KreRMnWB46"}],"key":"UCHDq4DGqS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.505995Z","iopub.status.busy":"2026-03-01T17:07:30.505720Z","iopub.status.idle":"2026-03-01T17:07:30.509172Z","shell.execute_reply":"2026-03-01T17:07:30.508619Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Power plant efficiency rates (Higher Heating Value / Gross Calorific Value)\nCOAL_EFFICIENCY = 0.40  # 40%\nGAS_EFFICIENCY = 0.50  # 50%\n\n# Carbon intensity (tCO2 per MWh of electricity generated)\nCOAL_CARBON_INTENSITY = 0.83  # tCO2/MWh\nGAS_CARBON_INTENSITY = 0.37  # tCO2/MWh\n\n# Variable Operating and Maintenance costs (EUR/MWh)\nVOM_COST = 2.0\n\n# Coal thermal content (MWh per metric ton)\n# API 2 coal specification: 6,000 kcal/kg NAR\n# 6,000 kcal/kg = 6,000,000 kcal/t ÷ 860,421 kcal/MWh ≈ 6.98 MWh/t\nCOAL_THERMAL_CONTENT = 6.98  # MWh/t\n\n# EUR/USD exchange rate (approximate)\nEURUSD_RATE = 1.08","key":"oLlxc6oC85"},{"type":"outputs","id":"kiai2ZjouNHLRKnGbaXO-","children":[],"key":"nyBfgACBm3"}],"key":"QTHeHh0mZn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bC8gPf3a8J"}],"identifier":"load-data","label":"Load Data","html_id":"load-data","implicit":true,"key":"VUTy1scZXi"}],"key":"r2kTy8DNH1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.510491Z","iopub.status.busy":"2026-03-01T17:07:30.510409Z","iopub.status.idle":"2026-03-01T17:07:30.560098Z","shell.execute_reply":"2026-03-01T17:07:30.559524Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"paths = ProjPaths()\npaths.images_path.mkdir(parents=True, exist_ok=True)\n\n# Load generation and consumption data\nprint(\"Loading SMARD data...\")\nsolar = pd.read_parquet(paths.smard_solar_file)\nwind_onshore = pd.read_parquet(paths.smard_wind_onshore_file)\nwind_offshore = pd.read_parquet(paths.smard_wind_offshore_file)\ntotal_load = pd.read_parquet(paths.smard_total_load_file)\nprices = pd.read_parquet(paths.smard_prices_file)\ncapacities = pd.read_parquet(paths.smard_capacities_file)\n\nprint(f\"Generation data: {solar.index.min()} to {solar.index.max()}\")\nprint(f\"Prices: {prices.index.min()} to {prices.index.max()}\")\nprint(f\"Capacities: {capacities.index.min()} to {capacities.index.max()}\")","key":"DZ8twbCF7C"},{"type":"outputs","id":"C69NCXrrICqoSkhWUGWDE","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Loading SMARD data...\nGeneration data: 2016-12-31 00:00:00 to 2026-02-09 19:00:00\nPrices: 2018-10-01 00:00:00 to 2026-02-09 23:00:00\nCapacities: 2015-01-01 00:00:00 to 2026-12-01 00:00:00\n"},"children":[],"key":"M7tWnU08ZO"}],"key":"J7XZnOa9xa"}],"key":"uPbgWcJlzk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Baseload Generation Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lbgB5pVKgu"}],"identifier":"baseload-generation-data","label":"Baseload Generation Data","html_id":"baseload-generation-data","implicit":true,"key":"jDH1Pgk2Ml"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Nuclear, biomass, and hydro generation data for the fossil residual load calculation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tGpL4M8ldr"}],"key":"MjJoyrKlfx"}],"key":"YErw117UDs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.561384Z","iopub.status.busy":"2026-03-01T17:07:30.561275Z","iopub.status.idle":"2026-03-01T17:07:30.579777Z","shell.execute_reply":"2026-03-01T17:07:30.579258Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Loading baseload generation data...\")\nnuclear = pd.read_parquet(paths.smard_nuclear_file)\nbiomass = pd.read_parquet(paths.smard_biomass_file)\nhydro = pd.read_parquet(paths.smard_hydro_file)\n\nprint(f\"Nuclear: {len(nuclear)} records\")\nprint(f\"Biomass: {len(biomass)} records\")\nprint(f\"Hydro: {len(hydro)} records\")","key":"LG9GNsr1PJ"},{"type":"outputs","id":"9dgOXy2xyS7XbOlRQWYVk","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Loading baseload generation data...\nNuclear: 46735 records\nBiomass: 79808 records\nHydro: 79799 records\n"},"children":[],"key":"hjzo4PxJzK"}],"key":"olgsdCrfcG"}],"key":"pg2ZdeR8l8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Commodity Prices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mAcjdTzNKN"}],"identifier":"commodity-prices","label":"Commodity Prices","html_id":"commodity-prices","implicit":true,"key":"tK1WBlhtl3"}],"key":"two139gFOH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.581069Z","iopub.status.busy":"2026-03-01T17:07:30.580982Z","iopub.status.idle":"2026-03-01T17:07:30.583417Z","shell.execute_reply":"2026-03-01T17:07:30.582870Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def load_investing_com_csv(filepath: str) -> pd.Series:\n    \"\"\"Load price data from Investing.com CSV export.\"\"\"\n    df = pd.read_csv(\n        filepath,\n        encoding=\"utf-8-sig\",\n        parse_dates=[\"Date\"],\n        dayfirst=False,\n    )\n    df = df.set_index(\"Date\").sort_index()\n    return df[\"Price\"]","key":"TeTn8DudTK"},{"type":"outputs","id":"zdbHxru-h93FxhIRdQ1CY","children":[],"key":"uCcpicNrZ2"}],"key":"h7ipEiaN4v"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.584508Z","iopub.status.busy":"2026-03-01T17:07:30.584427Z","iopub.status.idle":"2026-03-01T17:07:30.616366Z","shell.execute_reply":"2026-03-01T17:07:30.615607Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load commodity prices\nprint(\"Loading commodity prices...\")\ngas_df = pd.read_parquet(paths.ttf_gas_prices_file)\ngas_prices = gas_df[\"Close\"].rename(\"gas_price\")\n\ncoal_prices = load_investing_com_csv(paths.rotterdam_coal_prices_file).rename(\n    \"coal_price\"\n)\n\ncarbon_prices = load_investing_com_csv(paths.eu_carbon_prices_file).rename(\n    \"carbon_price\"\n)\n\nprint(f\"Gas prices: {gas_prices.index.min()} to {gas_prices.index.max()}\")\nprint(f\"Coal prices: {coal_prices.index.min()} to {coal_prices.index.max()}\")\nprint(f\"Carbon prices: {carbon_prices.index.min()} to {carbon_prices.index.max()}\")","key":"sAF0ITsuYx"},{"type":"outputs","id":"_UvYK9baSe1yVeoWMTmt5","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Loading commodity prices...\nGas prices: 2017-10-23 00:00:00 to 2026-02-09 00:00:00\nCoal prices: 2017-01-03 00:00:00 to 2026-02-06 00:00:00\nCarbon prices: 2017-01-02 00:00:00 to 2026-02-06 00:00:00\n"},"children":[],"key":"EjaLXLLs0R"}],"key":"sXL0zGxIXD"}],"key":"UBSX9p68ab"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculate SRMC","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PyzVittVXA"}],"identifier":"calculate-srmc","label":"Calculate SRMC","html_id":"calculate-srmc","implicit":true,"key":"d6bVgLwdTj"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Gas SRMC","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q896odMOz6"}],"identifier":"gas-srmc","label":"Gas SRMC","html_id":"gas-srmc","implicit":true,"key":"yebYkbj8jq"},{"type":"math","value":"\\text{Gas SRMC} = \\frac{\\text{Gas Price}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>Gas SRMC</mtext><mo>=</mo><mfrac><mtext>Gas Price</mtext><mtext>Efficiency</mtext></mfrac><mo>+</mo><mtext>Carbon Intensity</mtext><mo>×</mo><mtext>Carbon Price</mtext><mo>+</mo><mtext>VOM</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{Gas SRMC} = \\frac{\\text{Gas Price}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">Gas SRMC</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2408em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Efficiency</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Gas Price</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">Carbon Intensity</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">Carbon Price</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">VOM</span></span></span></span></span></span>","enumerator":"2","key":"CbALEjk8tT"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Coal SRMC","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"z2WJ7tCNfe"}],"identifier":"coal-srmc","label":"Coal SRMC","html_id":"coal-srmc","implicit":true,"key":"vPXIwEyTqu"},{"type":"math","value":"\\text{Coal SRMC} = \\frac{\\text{Coal Price (EUR/MWh)}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>Coal SRMC</mtext><mo>=</mo><mfrac><mtext>Coal Price (EUR/MWh)</mtext><mtext>Efficiency</mtext></mfrac><mo>+</mo><mtext>Carbon Intensity</mtext><mo>×</mo><mtext>Carbon Price</mtext><mo>+</mo><mtext>VOM</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{Coal SRMC} = \\frac{\\text{Coal Price (EUR/MWh)}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">Coal SRMC</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Efficiency</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Coal Price (EUR/MWh)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">Carbon Intensity</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">Carbon Price</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">VOM</span></span></span></span></span></span>","enumerator":"3","key":"Q14KEoHZTJ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Note: Coal prices in USD/t need to be converted to EUR/MWh using:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JusM32xSOH"}],"key":"tZ096BgvR9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Exchange rate (USD/EUR)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"J0D886DdPu"}],"key":"X4VLKjISlv"}],"key":"XEYC0audxJ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Thermal content (MWh/t)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jfkOARLfX7"}],"key":"gLapZD3XkK"}],"key":"oeGOUQI2Ar"}],"key":"ebYkklLqXK"}],"key":"aWi6cBlVls"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.617578Z","iopub.status.busy":"2026-03-01T17:07:30.617490Z","iopub.status.idle":"2026-03-01T17:07:30.629417Z","shell.execute_reply":"2026-03-01T17:07:30.628835Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Combine commodity prices (daily)\ncommodity_prices = pd.concat(\n    [gas_prices, coal_prices, carbon_prices], axis=1, join=\"inner\"\n)\ncommodity_prices = commodity_prices.ffill()\n\n# Convert coal from USD/t to EUR/MWh\ncoal_eur_mwh = commodity_prices[\"coal_price\"] / EURUSD_RATE / COAL_THERMAL_CONTENT\n\n# Calculate SRMC components\ngas_fuel_cost = commodity_prices[\"gas_price\"] / GAS_EFFICIENCY\ncoal_fuel_cost = coal_eur_mwh / COAL_EFFICIENCY\n\ngas_carbon_cost = GAS_CARBON_INTENSITY * commodity_prices[\"carbon_price\"]\ncoal_carbon_cost = COAL_CARBON_INTENSITY * commodity_prices[\"carbon_price\"]\n\n# Total SRMC (daily)\nsrmc_daily = pd.DataFrame(index=commodity_prices.index)\nsrmc_daily[\"gas_srmc\"] = gas_fuel_cost + gas_carbon_cost + VOM_COST\nsrmc_daily[\"coal_srmc\"] = coal_fuel_cost + coal_carbon_cost + VOM_COST\n\n# Store components for analysis\nsrmc_daily[\"gas_fuel_cost\"] = gas_fuel_cost\nsrmc_daily[\"gas_carbon_cost\"] = gas_carbon_cost\nsrmc_daily[\"coal_fuel_cost\"] = coal_fuel_cost\nsrmc_daily[\"coal_carbon_cost\"] = coal_carbon_cost\n\nprint(\"SRMC Summary (EUR/MWh):\")\nprint(srmc_daily[[\"gas_srmc\", \"coal_srmc\"]].describe().round(2))","key":"MUwdHz81zp"},{"type":"outputs","id":"5HZmOLKDyyCnm0cjo6ACY","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"SRMC Summary (EUR/MWh):\n       gas_srmc  coal_srmc\ncount   2075.00    2075.00\nmean     105.26      85.19\nstd       90.38      41.89\nmin       17.17      31.19\n25%       44.53      44.46\n50%       89.41      91.70\n75%      115.54     107.87\nmax      713.81     206.47\n"},"children":[],"key":"QfvCVGc2Sr"}],"key":"VBUfNSOw0a"}],"key":"X2WoMPkc1l"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SRMC Time Series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ls6eUoqB1U"}],"identifier":"srmc-time-series","label":"SRMC Time Series","html_id":"srmc-time-series","implicit":true,"key":"Q0tNAZMcZT"}],"key":"H2cg9VPNPb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.630806Z","iopub.status.busy":"2026-03-01T17:07:30.630720Z","iopub.status.idle":"2026-03-01T17:07:30.820482Z","shell.execute_reply":"2026-03-01T17:07:30.819958Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(14, 6))\n\nax.plot(srmc_daily.index, srmc_daily[\"gas_srmc\"], label=\"Gas SRMC\", linewidth=1, alpha=0.8)\nax.plot(srmc_daily.index, srmc_daily[\"coal_srmc\"], label=\"Coal SRMC\", linewidth=1, alpha=0.8)\n\nax.set_xlabel(\"Date\")\nax.set_ylabel(\"SRMC (EUR/MWh)\")\nax.set_title(\"Short Run Marginal Costs: Coal vs Gas\")\nax.legend()\nax.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_srmc_timeseries.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"mBcMnyjyIJ"},{"type":"outputs","id":"dJi5AA81RuHTCV49z-Rdv","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/120160518.py:14: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"gVfulVUdzF"}],"key":"rvuvfttOwr"}],"key":"QcbGLRfieG"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","alt":"Short Run Marginal Costs: Coal vs Gas","data":{"altTextIsAutoGenerated":true},"key":"vPeO3Hik88","urlSource":"../../output/images/04_srmc_timeseries.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-srmc-timeseries","identifier":"fig-04-srmc-timeseries","html_id":"fig-04-srmc-timeseries","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"t5PxNUvDrt"},{"type":"text","value":"1","key":"iq1ZA7FG6q"},{"type":"text","value":":","key":"kqXVS6uaeA"}],"template":"Figure %s:","key":"YlStnWxnA3"},{"type":"text","value":"Short Run Marginal Costs: Coal vs Gas","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jPEDN2EHDx"}],"key":"e5cKvrNTke"}],"key":"rW0BmuDYOo"}],"label":"fig-04-srmc-timeseries","identifier":"fig-04-srmc-timeseries","enumerator":"1","html_id":"fig-04-srmc-timeseries","key":"COWAlAHOLC"}],"key":"EYbIQYvNeS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Monthly Average SRMC","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZZylWiK54e"}],"identifier":"monthly-average-srmc","label":"Monthly Average SRMC","html_id":"monthly-average-srmc","implicit":true,"key":"OBnq9ZGpkh"}],"key":"jkO7IULLZu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:30.821878Z","iopub.status.busy":"2026-03-01T17:07:30.821788Z","iopub.status.idle":"2026-03-01T17:07:31.045837Z","shell.execute_reply":"2026-03-01T17:07:31.045181Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"monthly_srmc = srmc_daily[[\"gas_srmc\", \"coal_srmc\"]].resample(\"ME\").mean()\n\nfig, ax = plt.subplots(figsize=(14, 6))\n\nax.plot(\n    monthly_srmc.index,\n    monthly_srmc[\"gas_srmc\"],\n    label=\"Gas SRMC\",\n    marker=\"o\",\n    markersize=3,\n)\nax.plot(\n    monthly_srmc.index,\n    monthly_srmc[\"coal_srmc\"],\n    label=\"Coal SRMC\",\n    marker=\"o\",\n    markersize=3,\n)\n\nax.set_xlabel(\"Date\")\nax.set_ylabel(\"SRMC (EUR/MWh)\")\nax.set_title(\"Monthly Average Short Run Marginal Costs\")\nax.legend()\nax.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_monthly_srmc.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"owRwADuXpm"},{"type":"outputs","id":"G1gsMeiVYlqMIAwgO0TAg","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/1810315613.py:28: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"Jd6DPu6MNI"}],"key":"b048FRYymF"}],"key":"R9CanMKXgy"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_monthly_srmc-a5ad3f5e68c2705b40462c76dccf432d.png","alt":"Monthly Average Short Run Marginal Costs","data":{"altTextIsAutoGenerated":true},"key":"g7uNC4OfQT","urlSource":"../../output/images/04_monthly_srmc.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-monthly-srmc","identifier":"fig-04-monthly-srmc","html_id":"fig-04-monthly-srmc","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"pwsAFmWV6S"},{"type":"text","value":"2","key":"eQNpzN7KEm"},{"type":"text","value":":","key":"wc8UlcP8ex"}],"template":"Figure %s:","key":"j1O44cBiBT"},{"type":"text","value":"Monthly Average Short Run Marginal Costs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cLPATdlrXQ"}],"key":"MEqZZDlIFA"}],"key":"FlSP63F0qu"}],"label":"fig-04-monthly-srmc","identifier":"fig-04-monthly-srmc","enumerator":"2","html_id":"fig-04-monthly-srmc","key":"Lrz8hLJvcI"}],"key":"PY2INPfuxI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fuel Switching Indicator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qWcOyY01yt"}],"identifier":"fuel-switching-indicator","label":"Fuel Switching Indicator","html_id":"fuel-switching-indicator","implicit":true,"key":"gwhE23Ops0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"When gas SRMC is lower than coal SRMC, it is economically favorable to dispatch\ngas plants over coal plants, leading to lower emissions. This “fuel switching”\nis a key mechanism for carbon price effectiveness.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hwtqV8p08F"}],"key":"y0MrD8PCdr"}],"key":"rJGTfRvg2l"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.047168Z","iopub.status.busy":"2026-03-01T17:07:31.047063Z","iopub.status.idle":"2026-03-01T17:07:31.400362Z","shell.execute_reply":"2026-03-01T17:07:31.399557Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate the spread (positive = gas cheaper than coal)\nsrmc_daily[\"spread\"] = srmc_daily[\"coal_srmc\"] - srmc_daily[\"gas_srmc\"]\n\nfig, axes = plt.subplots(2, 1, figsize=(14, 10), sharex=True)\n\n# SRMC comparison\nax1 = axes[0]\nax1.plot(srmc_daily.index, srmc_daily[\"gas_srmc\"], label=\"Gas SRMC\", linewidth=1, alpha=0.8)\nax1.plot(srmc_daily.index, srmc_daily[\"coal_srmc\"], label=\"Coal SRMC\", linewidth=1, alpha=0.8)\nax1.set_ylabel(\"SRMC (EUR/MWh)\")\nax1.set_title(\"Short Run Marginal Costs and Fuel Switching\")\nax1.legend()\nax1.grid(True, alpha=0.3)\n\n# Spread (coal - gas)\nax2 = axes[1]\nax2.fill_between(\n    srmc_daily.index,\n    srmc_daily[\"spread\"],\n    0,\n    where=srmc_daily[\"spread\"] >= 0,\n    color=\"green\",\n    alpha=0.5,\n    label=\"Gas cheaper (fuel switch)\",\n)\nax2.fill_between(\n    srmc_daily.index,\n    srmc_daily[\"spread\"],\n    0,\n    where=srmc_daily[\"spread\"] < 0,\n    color=\"red\",\n    alpha=0.5,\n    label=\"Coal cheaper\",\n)\nax2.axhline(y=0, color=\"black\", linestyle=\"-\", linewidth=0.5)\nax2.set_xlabel(\"Date\")\nax2.set_ylabel(\"Spread (EUR/MWh)\")\nax2.set_title(\"Coal-Gas Spread (positive = gas cheaper)\")\nax2.legend()\nax2.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_fuel_switching.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"umLCBCPqah"},{"type":"outputs","id":"78Rg7mg92fnYqgDq5qDg7","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/1956690996.py:44: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"N3l8SHEth3"}],"key":"c6gY041JSy"}],"key":"F4tmxGJ3CV"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_fuel_switching-ef118af026cb9df9a19892eb20bd396b.png","alt":"Short Run Marginal Costs and Fuel Switching Indicator","data":{"altTextIsAutoGenerated":true},"key":"jRXi8Q1MMp","urlSource":"../../output/images/04_fuel_switching.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-fuel-switching","identifier":"fig-04-fuel-switching","html_id":"fig-04-fuel-switching","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"HBAQ2zHCOL"},{"type":"text","value":"3","key":"qxUvGv6B3m"},{"type":"text","value":":","key":"dWj4XEvKKz"}],"template":"Figure %s:","key":"luL93S60qg"},{"type":"text","value":"Short Run Marginal Costs and Fuel Switching Indicator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A4jE5FKUxb"}],"key":"PuA27cUBTt"}],"key":"gD7F7wQKAa"}],"label":"fig-04-fuel-switching","identifier":"fig-04-fuel-switching","enumerator":"3","html_id":"fig-04-fuel-switching","key":"Te4HUSBPMD"}],"key":"EXzUDGFAWD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SRMC Cost Components","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RwoIzXLDX9"}],"identifier":"srmc-cost-components","label":"SRMC Cost Components","html_id":"srmc-cost-components","implicit":true,"key":"pKIZZAPxkl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Breaking down the SRMC into its fuel and carbon cost components shows the\nrelative importance of each driver.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AgDQ0eeEUp"}],"key":"QK3Xk5OJdK"}],"key":"zTWSE16KB4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.401678Z","iopub.status.busy":"2026-03-01T17:07:31.401588Z","iopub.status.idle":"2026-03-01T17:07:31.677351Z","shell.execute_reply":"2026-03-01T17:07:31.676646Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# Gas SRMC components\nax1 = axes[0]\nax1.stackplot(\n    srmc_daily.index,\n    srmc_daily[\"gas_fuel_cost\"],\n    srmc_daily[\"gas_carbon_cost\"],\n    [VOM_COST] * len(srmc_daily),\n    labels=[\"Fuel Cost\", \"Carbon Cost\", \"Variable O&M\"],\n    alpha=0.8,\n)\nax1.set_xlabel(\"Date\")\nax1.set_ylabel(\"Cost (EUR/MWh)\")\nax1.set_title(\"Gas SRMC Components\")\nax1.legend(loc=\"upper left\")\nax1.grid(True, alpha=0.3)\n\n# Coal SRMC components\nax2 = axes[1]\nax2.stackplot(\n    srmc_daily.index,\n    srmc_daily[\"coal_fuel_cost\"],\n    srmc_daily[\"coal_carbon_cost\"],\n    [VOM_COST] * len(srmc_daily),\n    labels=[\"Fuel Cost\", \"Carbon Cost\", \"Variable O&M\"],\n    alpha=0.8,\n)\nax2.set_xlabel(\"Date\")\nax2.set_ylabel(\"Cost (EUR/MWh)\")\nax2.set_title(\"Coal SRMC Components\")\nax2.legend(loc=\"upper left\")\nax2.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_srmc_components.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"MXqdNVHtQf"},{"type":"outputs","id":"-nZ92mrI9hN1x1LJ2-I1X","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/3647327109.py:37: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"jVH7SPTPQL"}],"key":"lwhPVv0a7n"}],"key":"ekSpTJe72C"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_srmc_components-2e520662cfcf2ecb5bb33866d24d3f5f.png","alt":"SRMC Cost Components (Gas and Coal)","data":{"altTextIsAutoGenerated":true},"key":"lzT1FOzXhz","urlSource":"../../output/images/04_srmc_components.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-srmc-components","identifier":"fig-04-srmc-components","html_id":"fig-04-srmc-components","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"Ucp8zMLKvH"},{"type":"text","value":"4","key":"ihhphEKy6O"},{"type":"text","value":":","key":"A49rB9XxG9"}],"template":"Figure %s:","key":"HUPZtQi8p9"},{"type":"text","value":"SRMC Cost Components (Gas and Coal)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s8O1QoApCb"}],"key":"ziGDA3Bi3m"}],"key":"Xnpn6HYxnQ"}],"label":"fig-04-srmc-components","identifier":"fig-04-srmc-components","enumerator":"4","html_id":"fig-04-srmc-components","key":"eFkatdnEmd"}],"key":"NWik0QENRb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Combine All Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aZlshLiUqQ"}],"identifier":"combine-all-data","label":"Combine All Data","html_id":"combine-all-data","implicit":true,"key":"vnccUOdhVx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Align all data to hourly resolution by forward-filling daily/monthly data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yQ8iY47J9l"}],"key":"MEJyguTlLd"}],"key":"TJPtWvtEBK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.678671Z","iopub.status.busy":"2026-03-01T17:07:31.678581Z","iopub.status.idle":"2026-03-01T17:07:31.714030Z","shell.execute_reply":"2026-03-01T17:07:31.713371Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Combine generation data into single DataFrame\ndf = pd.concat(\n    [\n        solar.rename(columns={solar.columns[0]: \"solar\"}),\n        wind_onshore.rename(columns={wind_onshore.columns[0]: \"wind_onshore\"}),\n        wind_offshore.rename(columns={wind_offshore.columns[0]: \"wind_offshore\"}),\n        total_load.rename(columns={total_load.columns[0]: \"total_load\"}),\n        prices.rename(columns={prices.columns[0]: \"price\"}),\n        nuclear.rename(columns={nuclear.columns[0]: \"nuclear\"}),\n        biomass.rename(columns={biomass.columns[0]: \"biomass\"}),\n        hydro.rename(columns={hydro.columns[0]: \"hydro\"}),\n    ],\n    axis=1,\n)\n\n# Drop rows with missing generation/price data\ndf = df.dropna()\nprint(f\"Combined hourly data: {len(df)} records\")\nprint(f\"Date range: {df.index.min()} to {df.index.max()}\")","key":"awCEGncLQE"},{"type":"outputs","id":"aEkUB2NfVMwBXHNoh3S0Z","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Combined hourly data: 46732 records\nDate range: 2018-10-01 01:00:00 to 2024-01-30 11:00:00\n"},"children":[],"key":"D6tm6SLBof"}],"key":"OpQjxQq9Uw"}],"key":"gKbACcXBLS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.715365Z","iopub.status.busy":"2026-03-01T17:07:31.715270Z","iopub.status.idle":"2026-03-01T17:07:31.740965Z","shell.execute_reply":"2026-03-01T17:07:31.740427Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Forward-fill SRMC to hourly\n# Normalize index to date only for merging\ndf[\"date\"] = df.index.date\nsrmc_daily_reset = srmc_daily.copy()\nsrmc_daily_reset.index = srmc_daily_reset.index.date\n\ndf = df.merge(\n    srmc_daily_reset[[\"gas_srmc\", \"coal_srmc\"]],\n    left_on=\"date\",\n    right_index=True,\n    how=\"left\",\n)\ndf = df.drop(columns=[\"date\"])\n\n# Forward-fill any gaps in SRMC\ndf[\"gas_srmc\"] = df[\"gas_srmc\"].ffill()\ndf[\"coal_srmc\"] = df[\"coal_srmc\"].ffill()\n\n# Drop rows without SRMC data\ndf = df.dropna(subset=[\"gas_srmc\", \"coal_srmc\"])\nprint(f\"After SRMC merge: {len(df)} records\")","key":"kRGRlXfufM"},{"type":"outputs","id":"J-d4cVVjFUCQHtAIx4OYK","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After SRMC merge: 46732 records\n"},"children":[],"key":"hNNiG9NJaY"}],"key":"jv4nTvX4zZ"}],"key":"tjMP0nLLAn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.742384Z","iopub.status.busy":"2026-03-01T17:07:31.742250Z","iopub.status.idle":"2026-03-01T17:07:31.757847Z","shell.execute_reply":"2026-03-01T17:07:31.757111Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Forward-fill capacities to hourly\n# Capacities are monthly, so we need to reindex and forward-fill\ncapacities_hourly = capacities.reindex(df.index, method=\"ffill\")\n\n# Add relevant capacity columns to main DataFrame\ndf[\"capacity_coal\"] = (\n    capacities_hourly[\"brown_coal\"].fillna(0)\n    + capacities_hourly[\"hard_coal\"].fillna(0)\n)\ndf[\"capacity_gas\"] = capacities_hourly[\"natural_gas\"].fillna(0)\n\n# Drop rows without capacity data\ndf = df.dropna(subset=[\"capacity_coal\", \"capacity_gas\"])\nprint(f\"After capacity merge: {len(df)} records\")\nprint(f\"Final date range: {df.index.min()} to {df.index.max()}\")","key":"O5iZKJArX1"},{"type":"outputs","id":"TnxixrZHmtacxtHviyWMH","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After capacity merge: 46732 records\nFinal date range: 2018-10-01 01:00:00 to 2024-01-30 11:00:00\n"},"children":[],"key":"jSDbfZ0wf7"}],"key":"hpTtrfmQZa"}],"key":"Jjr6bdZuwK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculate Fossil Residual Load","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yIueQ7CKHL"}],"identifier":"calculate-fossil-residual-load","label":"Calculate Fossil Residual Load","html_id":"calculate-fossil-residual-load","implicit":true,"key":"WBnqjIuTCq"},{"type":"math","value":"RL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro})","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>=</mo><mtext>Load</mtext><mo>−</mo><mo stretchy=\"false\">(</mo><mtext>Wind</mtext><mo>+</mo><mtext>Solar</mtext><mo stretchy=\"false\">)</mo><mo>−</mo><mo stretchy=\"false\">(</mo><mtext>Nuclear</mtext><mo>+</mo><mtext>Biomass</mtext><mo>+</mo><mtext>Hydro</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">RL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">oss</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">Load</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">Wind</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Solar</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">Nuclear</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">Biomass</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Hydro</span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"NXHln7EiZH"}],"key":"DRGEdM4vUL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.759126Z","iopub.status.busy":"2026-03-01T17:07:31.759037Z","iopub.status.idle":"2026-03-01T17:07:31.771973Z","shell.execute_reply":"2026-03-01T17:07:31.771264Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate components\ndf[\"wind\"] = df[\"wind_onshore\"] + df[\"wind_offshore\"]\ndf[\"renewables\"] = df[\"solar\"] + df[\"wind\"]\ndf[\"baseload\"] = df[\"nuclear\"] + df[\"biomass\"] + df[\"hydro\"]\n\n# Residual load for fossil plants\ndf[\"rl_fossil\"] = df[\"total_load\"] - df[\"renewables\"] - df[\"baseload\"]\n\n# Standard residual load (for comparison)\ndf[\"residual_load\"] = df[\"total_load\"] - df[\"renewables\"]\n\nprint(\"Fossil Residual Load Statistics (MW):\")\nprint(df[\"rl_fossil\"].describe().round(0))\n\n# Count negative fossil residual load hours\nnegative_hours = (df[\"rl_fossil\"] < 0).sum()\nprint(f\"\\nHours with negative RL_fossil: {negative_hours} ({100*negative_hours/len(df):.1f}%)\")","key":"EWzuJzYSQf"},{"type":"outputs","id":"jT8zE6-6QTukyq8AAmOmP","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Fossil Residual Load Statistics (MW):\ncount    46732.0\nmean     24404.0\nstd      12476.0\nmin     -12992.0\n25%      15884.0\n50%      24657.0\n75%      33056.0\nmax      62743.0\nName: rl_fossil, dtype: float64\n\nHours with negative RL_fossil: 1173 (2.5%)\n"},"children":[],"key":"kisYqd8NSp"}],"key":"pdTTthgnpf"}],"key":"UanQAN1QSH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reconstruct Prices Using Merit Order","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YyIUHoCAKs"}],"identifier":"reconstruct-prices-using-merit-order","label":"Reconstruct Prices Using Merit Order","html_id":"reconstruct-prices-using-merit-order","implicit":true,"key":"DQCNzlsEJN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For each hour:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"klBKKAHXjY"}],"key":"cR2aw1edqh"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Determine which fuel (coal or gas) has lower SRMC","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"NGl1uWTrSg"}],"key":"UgF7VAUO7X"}],"key":"U2q7fQ4D0G"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If fossil residual load can be met by cheaper fuel capacity alone, use cheaper SRMC","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tYuMyVdXKw"}],"key":"MPQYVA3dzH"}],"key":"QYAulAOt4x"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Otherwise, use more expensive SRMC as the marginal price","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hsEXzByQcD"}],"key":"BMktSaXd1R"}],"key":"aKO4XHJdh0"}],"key":"Skq5d0dM0R"}],"key":"BPMwP0rLp5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.773233Z","iopub.status.busy":"2026-03-01T17:07:31.773152Z","iopub.status.idle":"2026-03-01T17:07:31.784699Z","shell.execute_reply":"2026-03-01T17:07:31.784176Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def reconstruct_price(row):\n    \"\"\"Reconstruct electricity price based on merit order.\"\"\"\n    rl_fossil = row[\"rl_fossil\"]\n    gas_srmc = row[\"gas_srmc\"]\n    coal_srmc = row[\"coal_srmc\"]\n    capacity_coal = row[\"capacity_coal\"]\n    capacity_gas = row[\"capacity_gas\"]\n\n    # Handle negative residual load (renewable surplus)\n    if rl_fossil <= 0:\n        return 0.0  # Price floor at zero for simplicity\n\n    # Determine merit order based on SRMC\n    if coal_srmc <= gas_srmc:\n        # Coal is cheaper\n        cheaper_srmc = coal_srmc\n        expensive_srmc = gas_srmc\n        cheaper_capacity = capacity_coal\n    else:\n        # Gas is cheaper\n        cheaper_srmc = gas_srmc\n        expensive_srmc = coal_srmc\n        cheaper_capacity = capacity_gas\n\n    # Assign price based on which fuel is marginal\n    if rl_fossil <= cheaper_capacity:\n        return cheaper_srmc\n    else:\n        return expensive_srmc","key":"lEDyQMtRYb"},{"type":"outputs","id":"_e3iUJ3O3AFZyyOzXzisG","children":[],"key":"PebQod0hDj"}],"key":"fuMmU6aYbq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:31.786304Z","iopub.status.busy":"2026-03-01T17:07:31.786204Z","iopub.status.idle":"2026-03-01T17:07:32.087155Z","shell.execute_reply":"2026-03-01T17:07:32.086249Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Apply reconstruction\nprint(\"Reconstructing prices...\")\ndf[\"price_reconstructed\"] = df.apply(reconstruct_price, axis=1)\n\nprint(\"\\nReconstructed Price Statistics (EUR/MWh):\")\nprint(df[\"price_reconstructed\"].describe().round(2))\n\nprint(\"\\nActual Price Statistics (EUR/MWh):\")\nprint(df[\"price\"].describe().round(2))","key":"B04gMcvmNM"},{"type":"outputs","id":"mIAIoVM9J-WdKr4N7HT_K","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Reconstructing prices...\n"},"children":[],"key":"iO1GlVWbAs"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\nReconstructed Price Statistics (EUR/MWh):\ncount    46732.00\nmean        88.10\nstd         63.73\nmin          0.00\n25%         40.98\n50%         68.72\n75%        120.84\nmax        713.81\nName: price_reconstructed, dtype: float64\n\nActual Price Statistics (EUR/MWh):\ncount    46732.00\nmean        96.56\nstd        102.86\nmin       -500.00\n25%         35.87\n50%         58.65\n75%        117.01\nmax        871.00\nName: price, dtype: float64\n"},"children":[],"key":"nfCWglRf0A"}],"key":"o097DmlWKr"}],"key":"FOjKUsvK6A"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare Reconstructed vs Actual Prices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iINBsl5QRK"}],"identifier":"compare-reconstructed-vs-actual-prices","label":"Compare Reconstructed vs Actual Prices","html_id":"compare-reconstructed-vs-actual-prices","implicit":true,"key":"E8gzwNQmX3"}],"key":"SKA7BQZLeN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.088442Z","iopub.status.busy":"2026-03-01T17:07:32.088346Z","iopub.status.idle":"2026-03-01T17:07:32.239723Z","shell.execute_reply":"2026-03-01T17:07:32.238879Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Time series comparison (monthly averages)\nmonthly = df[[\"price\", \"price_reconstructed\"]].resample(\"ME\").mean()\n\nfig, ax = plt.subplots(figsize=(14, 6))\n\nax.plot(monthly.index, monthly[\"price\"], label=\"Actual Price\", linewidth=2)\nax.plot(\n    monthly.index,\n    monthly[\"price_reconstructed\"],\n    label=\"Reconstructed Price\",\n    linewidth=2,\n    linestyle=\"--\",\n)\n\nax.set_xlabel(\"Date\")\nax.set_ylabel(\"Price (EUR/MWh)\")\nax.set_title(\"Monthly Average: Actual vs Reconstructed Electricity Prices\")\nax.legend()\nax.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_actual_vs_reconstructed.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"CkggInCQKd"},{"type":"outputs","id":"K2Vex4jpDuHNnlHbVEZ_y","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/267352414.py:23: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"c3sxmfLEKy"}],"key":"BVF0OMZnNW"}],"key":"iJHNkAXLuq"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_actual_vs_reconst-178c1fe72bc7e43657e7f712a9e6a521.png","alt":"Monthly Average: Actual vs Reconstructed Electricity Prices","data":{"altTextIsAutoGenerated":true},"key":"D1aImoA8qo","urlSource":"../../output/images/04_actual_vs_reconstructed.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-actual-vs-reconstructed","identifier":"fig-04-actual-vs-reconstructed","html_id":"fig-04-actual-vs-reconstructed","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"BGlNt0eoJs"},{"type":"text","value":"5","key":"zMuFaHJbli"},{"type":"text","value":":","key":"cJz0QuHIsL"}],"template":"Figure %s:","key":"RK5cUyHGql"},{"type":"text","value":"Monthly Average: Actual vs Reconstructed Electricity Prices","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZZDiIvreQZ"}],"key":"wYPWiiMjOM"}],"key":"hgJj1IxkGo"}],"label":"fig-04-actual-vs-reconstructed","identifier":"fig-04-actual-vs-reconstructed","enumerator":"5","html_id":"fig-04-actual-vs-reconstructed","key":"YSimIeGQ6z"}],"key":"wNkwea5yap"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scatterplots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zi5h4kX3NX"}],"identifier":"scatterplots","label":"Scatterplots","html_id":"scatterplots","implicit":true,"key":"U3WtFNrKZO"}],"key":"GiVRRoKjj8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.240946Z","iopub.status.busy":"2026-03-01T17:07:32.240851Z","iopub.status.idle":"2026-03-01T17:07:32.258082Z","shell.execute_reply":"2026-03-01T17:07:32.257277Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Sample data for scatterplots (performance)\nsample_size = min(50000, len(df))\nsample = df.sample(sample_size, random_state=42)","key":"mcW8yhV6Y5"},{"type":"outputs","id":"H2XcAx2w1Pnvcp2lxX9My","children":[],"key":"ku1zR1Y8mP"}],"key":"ECVuB2kaJl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reconstructed Prices vs Actual Prices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z4xJkmfJbd"}],"identifier":"reconstructed-prices-vs-actual-prices","label":"Reconstructed Prices vs Actual Prices","html_id":"reconstructed-prices-vs-actual-prices","implicit":true,"key":"hsq21CfXTP"}],"key":"fYqi5ugrLV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.259552Z","iopub.status.busy":"2026-03-01T17:07:32.259465Z","iopub.status.idle":"2026-03-01T17:07:32.525684Z","shell.execute_reply":"2026-03-01T17:07:32.525049Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 10))\n\nax.scatter(\n    sample[\"price_reconstructed\"],\n    sample[\"price\"],\n    alpha=0.1,\n    s=1,\n)\n\n# Add 45-degree line\nprice_range = [\n    min(sample[\"price\"].min(), sample[\"price_reconstructed\"].min()),\n    max(sample[\"price\"].max(), sample[\"price_reconstructed\"].max()),\n]\nax.plot(price_range, price_range, \"r--\", linewidth=1, label=\"Perfect fit\")\n\nax.set_xlabel(\"Reconstructed Price (EUR/MWh)\")\nax.set_ylabel(\"Actual Price (EUR/MWh)\")\nax.set_title(\"Reconstructed vs Actual Electricity Prices\")\nax.legend()\nax.grid(True, alpha=0.3)\n\n# Add R² annotation\nr2_reconstructed = r2_score(df[\"price\"], df[\"price_reconstructed\"])\nax.text(\n    0.05,\n    0.95,\n    f\"R² = {r2_reconstructed:.3f}\",\n    transform=ax.transAxes,\n    fontsize=12,\n    verticalalignment=\"top\",\n    bbox=dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5),\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_scatter_reconstructed_vs_actual.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"xd7OnERIh0"},{"type":"outputs","id":"No4ZPJfb0h158D4Bz-8J3","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/3371223380.py:37: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"MTgvtd1Ic8"}],"key":"yrPjPphbHk"}],"key":"CSuxc4rjUS"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_scatter_reconstru-61495a8935d5241941426afe3682bceb.png","alt":"Reconstructed vs Actual Electricity Prices","data":{"altTextIsAutoGenerated":true},"key":"FayRlbFdaP","urlSource":"../../output/images/04_scatter_reconstructed_vs_actual.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-scatter-reconstructed-vs-actual","identifier":"fig-04-scatter-reconstructed-vs-actual","html_id":"fig-04-scatter-reconstructed-vs-actual","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"HoHZEuqDne"},{"type":"text","value":"6","key":"OtBH0wnb4R"},{"type":"text","value":":","key":"cD52r4mKUT"}],"template":"Figure %s:","key":"KavqjmZ2N8"},{"type":"text","value":"Reconstructed vs Actual Electricity Prices","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pJaOgPXtVB"}],"key":"iM1cc4vORk"}],"key":"bn5LuQimLe"}],"label":"fig-04-scatter-reconstructed-vs-actual","identifier":"fig-04-scatter-reconstructed-vs-actual","enumerator":"6","html_id":"fig-04-scatter-reconstructed-vs-actual","key":"Tv8R2Socwd"}],"key":"Nu27ZkWjCQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Residual Load vs Actual Prices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"guqt5nxpT2"}],"identifier":"residual-load-vs-actual-prices","label":"Residual Load vs Actual Prices","html_id":"residual-load-vs-actual-prices","implicit":true,"key":"e8HiAAhHwc"}],"key":"eqgUQxlU3D"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.527846Z","iopub.status.busy":"2026-03-01T17:07:32.527663Z","iopub.status.idle":"2026-03-01T17:07:32.740736Z","shell.execute_reply":"2026-03-01T17:07:32.740268Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 10))\n\nax.scatter(\n    sample[\"residual_load\"],\n    sample[\"price\"],\n    alpha=0.1,\n    s=1,\n)\n\nax.set_xlabel(\"Residual Load (MW)\")\nax.set_ylabel(\"Actual Price (EUR/MWh)\")\nax.set_title(\"Residual Load vs Electricity Price\")\nax.grid(True, alpha=0.3)\n\n# Add correlation\ncorr = df[\"residual_load\"].corr(df[\"price\"])\nax.text(\n    0.05,\n    0.95,\n    f\"Correlation: {corr:.3f}\",\n    transform=ax.transAxes,\n    fontsize=12,\n    verticalalignment=\"top\",\n    bbox=dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5),\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_scatter_residual_load_vs_price.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"r2yLUVMhRU"},{"type":"outputs","id":"hnSLBeztq_Dn1Ptgv6Do6","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/4116917786.py:29: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"IOLsLbsOvb"}],"key":"X0QrF5wGd4"}],"key":"hoX6a4vPib"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_scatter_residual_-dbe475ebae63f9569b66d5c6b94b4a21.png","alt":"Residual Load vs Electricity Price","data":{"altTextIsAutoGenerated":true},"key":"amVezerEkl","urlSource":"../../output/images/04_scatter_residual_load_vs_price.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-scatter-residual-load-vs-price","identifier":"fig-04-scatter-residual-load-vs-price","html_id":"fig-04-scatter-residual-load-vs-price","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"xOpOagyG8J"},{"type":"text","value":"7","key":"oZCxKzN1Ni"},{"type":"text","value":":","key":"zfkQmrKGnG"}],"template":"Figure %s:","key":"bp64s4IWht"},{"type":"text","value":"Residual Load vs Electricity Price","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QRPVf14h7j"}],"key":"wkKO4QSzhz"}],"key":"ibmURi5FUO"}],"label":"fig-04-scatter-residual-load-vs-price","identifier":"fig-04-scatter-residual-load-vs-price","enumerator":"7","html_id":"fig-04-scatter-residual-load-vs-price","key":"OyBwXZtNaT"}],"key":"ZwSIcuU0bp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fossil Residual Load vs Actual Prices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t7Yml9a4Qd"}],"identifier":"fossil-residual-load-vs-actual-prices","label":"Fossil Residual Load vs Actual Prices","html_id":"fossil-residual-load-vs-actual-prices","implicit":true,"key":"GiuDlnvCnN"}],"key":"yFu3hZM39z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.742277Z","iopub.status.busy":"2026-03-01T17:07:32.742179Z","iopub.status.idle":"2026-03-01T17:07:32.946130Z","shell.execute_reply":"2026-03-01T17:07:32.945424Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 10))\n\nax.scatter(\n    sample[\"rl_fossil\"],\n    sample[\"price\"],\n    alpha=0.1,\n    s=1,\n)\n\nax.set_xlabel(\"Fossil Residual Load (MW)\")\nax.set_ylabel(\"Actual Price (EUR/MWh)\")\nax.set_title(\"Fossil Residual Load vs Electricity Price\")\nax.grid(True, alpha=0.3)\n\n# Add correlation\ncorr_fossil = df[\"rl_fossil\"].corr(df[\"price\"])\nax.text(\n    0.05,\n    0.95,\n    f\"Correlation: {corr_fossil:.3f}\",\n    transform=ax.transAxes,\n    fontsize=12,\n    verticalalignment=\"top\",\n    bbox=dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5),\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_scatter_fossil_rl_vs_price.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"iFuCCNSrr8"},{"type":"outputs","id":"vH__Xu3sowfu8FaLsaO3D","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/2891545600.py:29: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"nsLHcUBnxw"}],"key":"TkHvaqHhqK"}],"key":"BxDvrDd58Y"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_scatter_fossil_rl-d08a3c2da993377aa068fa135e101d8e.png","alt":"Fossil Residual Load vs Electricity Price","data":{"altTextIsAutoGenerated":true},"key":"omjUtV9l9p","urlSource":"../../output/images/04_scatter_fossil_rl_vs_price.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-scatter-fossil-rl-vs-price","identifier":"fig-04-scatter-fossil-rl-vs-price","html_id":"fig-04-scatter-fossil-rl-vs-price","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"vEwHCxPxXx"},{"type":"text","value":"8","key":"JU21YYfR2s"},{"type":"text","value":":","key":"fhntCaLhj6"}],"template":"Figure %s:","key":"oP2uNV8JTT"},{"type":"text","value":"Fossil Residual Load vs Electricity Price","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gSQnnwddMn"}],"key":"luFvLxHqeS"}],"key":"Exzidpso2B"}],"label":"fig-04-scatter-fossil-rl-vs-price","identifier":"fig-04-scatter-fossil-rl-vs-price","enumerator":"8","html_id":"fig-04-scatter-fossil-rl-vs-price","key":"mc7Ib6AV32"}],"key":"jLIvMxlcNH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Variance Explained (R²)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MwZE4R2Kn0"}],"identifier":"variance-explained-r","label":"Variance Explained (R²)","html_id":"variance-explained-r","implicit":true,"key":"LeCxV4KEFP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"How much of the price variation is explained by each model?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E4q6rAJ1lz"}],"key":"xsc1uefnSr"}],"key":"Q81Z59KJKd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.947448Z","iopub.status.busy":"2026-03-01T17:07:32.947358Z","iopub.status.idle":"2026-03-01T17:07:32.960181Z","shell.execute_reply":"2026-03-01T17:07:32.959552Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Prepare data for regression (drop NaN and infinite values)\ndf_clean = df[[\"price\", \"residual_load\", \"rl_fossil\", \"price_reconstructed\"]].copy()\ndf_clean = df_clean.replace([np.inf, -np.inf], np.nan).dropna()\n\nX_residual = df_clean[[\"residual_load\"]].values\nX_fossil = df_clean[[\"rl_fossil\"]].values\nX_reconstructed = df_clean[[\"price_reconstructed\"]].values\ny = df_clean[\"price\"].values\n\n# Fit linear models\nmodel_residual = LinearRegression().fit(X_residual, y)\nmodel_fossil = LinearRegression().fit(X_fossil, y)\n\n# Calculate R² scores\nr2_residual = model_residual.score(X_residual, y)\nr2_fossil = model_fossil.score(X_fossil, y)\nr2_reconstructed = r2_score(y, df_clean[\"price_reconstructed\"].values)\n\nprint(\"=\" * 60)\nprint(\"VARIANCE EXPLAINED (R²)\")\nprint(\"=\" * 60)\nprint(f\"\\nResidual Load (linear regression):      R² = {r2_residual:.4f}\")\nprint(f\"Fossil Residual Load (linear regression): R² = {r2_fossil:.4f}\")\nprint(f\"Reconstructed Prices (merit order model): R² = {r2_reconstructed:.4f}\")\nprint()","key":"KflrxH4NDD"},{"type":"outputs","id":"Nw4jwl9kzVYZgCU1lPKq3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"============================================================\nVARIANCE EXPLAINED (R²)\n============================================================\n\nResidual Load (linear regression):      R² = 0.0966\nFossil Residual Load (linear regression): R² = 0.1637\nReconstructed Prices (merit order model): R² = 0.6301\n\n"},"children":[],"key":"CqkuwqzSlc"}],"key":"zsNZQQ1q6E"}],"key":"c1uRPjKbFv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary Statistics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v8di5ppA0P"}],"identifier":"summary-statistics","label":"Summary Statistics","html_id":"summary-statistics","implicit":true,"key":"VceNcod8Lz"}],"key":"QXh2azCAbD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.961369Z","iopub.status.busy":"2026-03-01T17:07:32.961276Z","iopub.status.idle":"2026-03-01T17:07:32.969189Z","shell.execute_reply":"2026-03-01T17:07:32.968736Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate additional metrics\nmae = np.abs(df_clean[\"price\"] - df_clean[\"price_reconstructed\"]).mean()\nrmse = np.sqrt(((df_clean[\"price\"] - df_clean[\"price_reconstructed\"]) ** 2).mean())\n\nprint(\"=\" * 60)\nprint(\"MODEL PERFORMANCE SUMMARY\")\nprint(\"=\" * 60)\nprint(f\"\\nMean Absolute Error (MAE):     {mae:.2f} EUR/MWh\")\nprint(f\"Root Mean Square Error (RMSE): {rmse:.2f} EUR/MWh\")\nprint(f\"\\nActual price mean:        {df_clean['price'].mean():.2f} EUR/MWh\")\nprint(f\"Reconstructed price mean: {df_clean['price_reconstructed'].mean():.2f} EUR/MWh\")\nprint()","key":"gwqRQZACNZ"},{"type":"outputs","id":"PJrhmE_RbHzPDNqAMZ4KH","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"============================================================\nMODEL PERFORMANCE SUMMARY\n============================================================\n\nMean Absolute Error (MAE):     31.57 EUR/MWh\nRoot Mean Square Error (RMSE): 62.56 EUR/MWh\n\nActual price mean:        96.56 EUR/MWh\nReconstructed price mean: 88.10 EUR/MWh\n\n"},"children":[],"key":"DVW0spyR60"}],"key":"abyEetGozY"}],"key":"BMgNGSeZik"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Comparison Chart: What Explains Price Variation?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OcRtOJw9WJ"}],"identifier":"comparison-chart-what-explains-price-variation","label":"Comparison Chart: What Explains Price Variation?","html_id":"comparison-chart-what-explains-price-variation","implicit":true,"key":"axD79jDPvm"}],"key":"FvLQolNJ6k"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:07:32.970519Z","iopub.status.busy":"2026-03-01T17:07:32.970441Z","iopub.status.idle":"2026-03-01T17:07:33.087005Z","shell.execute_reply":"2026-03-01T17:07:33.086344Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 6))\n\nmodels = [\"Residual Load\\n(Linear)\", \"Fossil RL\\n(Linear)\", \"Merit Order\\n(Reconstructed)\"]\nr2_values = [r2_residual, r2_fossil, r2_reconstructed]\ncolors = [\"#3498db\", \"#2ecc71\", \"#e74c3c\"]\n\nbars = ax.bar(models, r2_values, color=colors, edgecolor=\"black\", linewidth=1.2)\n\n# Add value labels on bars\nfor bar, val in zip(bars, r2_values):\n    height = bar.get_height()\n    ax.text(\n        bar.get_x() + bar.get_width() / 2.0,\n        height + 0.01,\n        f\"{val:.3f}\",\n        ha=\"center\",\n        va=\"bottom\",\n        fontsize=12,\n        fontweight=\"bold\",\n    )\n\nax.set_ylabel(\"R² (Variance Explained)\")\nax.set_title(\"How Much Price Variation is Explained?\")\nax.set_ylim(0, 1.0)\nax.grid(True, alpha=0.3, axis=\"y\")\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_r2_comparison.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"Bs6RWiMoTR"},{"type":"outputs","id":"Xd_GI274O5MK_iscDg-L3","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151193/4129910679.py:29: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"nwSPyfAcNK"}],"key":"L5Hf1Ltyy2"}],"key":"iVriBspDjD"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_r2_comparison-4aeb6e09415642a151c257d690ea5f49.png","alt":"How Much Price Variation is Explained?","data":{"altTextIsAutoGenerated":true},"key":"qLQyJdFFtg","urlSource":"../../output/images/04_r2_comparison.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-r2-comparison","identifier":"fig-04-r2-comparison","html_id":"fig-04-r2-comparison","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"kZzwsam5PV"},{"type":"text","value":"9","key":"f7HQuhnzvZ"},{"type":"text","value":":","key":"uLe3BdYH43"}],"template":"Figure %s:","key":"XUtknPDfcY"},{"type":"text","value":"How Much Price Variation is Explained?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AA6Fo7u8Nu"}],"key":"CCSYeTwkqI"}],"key":"XTC4z5hMfH"}],"label":"fig-04-r2-comparison","identifier":"fig-04-r2-comparison","enumerator":"9","html_id":"fig-04-r2-comparison","key":"k6n2UXMMn1"}],"key":"AG4GSD3qCF"}],"key":"OSdDhAVxJI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Electricity prices in Germany","url":"/notebooks/smard-de-prices","group":"Electricity Prices"},"next":{"title":"Seasonality Heatmaps","url":"/notebooks/load-seasonalities","group":"Electricity Prices"}}},"domain":"http://localhost:3000"}
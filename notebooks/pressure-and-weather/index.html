<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Pressure Levels and the Jet Stream - World of Energy</title><meta property="og:title" content="Pressure Levels and the Jet Stream - World of Energy"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png"/><meta property="og:image" content="/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png"/><link rel="stylesheet" href="/world-of-energy/build/_assets/app-BWFVNXVE.css"/><link rel="stylesheet" href="/world-of-energy/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/world-of-energy/favicon.ico"/><link rel="stylesheet" href="/world-of-energy/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/world-of-energy/"><div class="myst-home-link-logo mr-3 flex items-center dark:bg-white dark:rounded px-1"><img src="/world-of-energy/build/logo-aeda1ffb023693e5d517d4bd730a35ad.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="World of Energy" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/world-of-energy/">World of Energy</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Electricity Prices" class="block break-words rounded py-2 grow cursor-pointer">Electricity Prices</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Weather" class="block break-words rounded py-2 grow cursor-pointer">Weather</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Resources" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/markdown/resources">Resources</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0 ml-3 xl:ml-0 mr-3 max-w-[350px]"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/cgroll/world-of-energy" title="GitHub Repository: cgroll/world-of-energy" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/13_pressure_and_weather.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Pressure Levels and the Jet Stream</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Christian Groll</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="zLzygpmWXF" class="myst-jp-nb-block relative group/block"><p>The atmosphere is not just a flat layer of air — it has rich three-dimensional
structure.  Weather systems, temperature gradients, and especially the
<strong>jet stream</strong> only make sense once you understand how the atmosphere is
stacked vertically.</p><p>This notebook explores that structure using ERA5 reanalysis data for a
single snapshot (2025-06-03 12:00 UTC), combining surface observations with
pressure-level data to build an intuition for the jet stream as a
<strong>three-dimensional tube of fast-moving air</strong> circling the globe at
roughly 10 km altitude.</p><p>We start at the surface, then work our way up through the atmosphere,
before looking at vertical cross-sections that reveal the full 3D shape.</p></div><div id="s42EoY7yAc" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import io

import numpy as np
import xarray as xr
import matplotlib.pyplot as plt
import matplotlib.ticker as mticker
import matplotlib.patches as mpatches
import cartopy.crs as ccrs
import cartopy.feature as cfeature
from cartopy.util import add_cyclic_point
from matplotlib.colors import LinearSegmentedColormap
from PIL import Image

from woe.paths import ProjPaths

paths = ProjPaths()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="JLpLso_7ZiG1Ub8TeSRbD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MXdTKpdmhf" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">DATE = &quot;2025-06-03&quot;
TIME = &quot;2025-06-03T12:00:00&quot;
G = 9.80665  # standard gravity m/s²

ds_sfc = xr.open_dataset(paths.era5_snapshot_20250603_1200_surface_file)
ds_pl  = xr.open_dataset(paths.era5_snapshot_20250603_1200_pressure_file)

print(f&quot;Surface dimensions:        {dict(ds_sfc.dims)}&quot;)
print(f&quot;Surface variables:         {list(ds_sfc.data_vars)}&quot;)
print(f&quot;Pressure-level dimensions: {dict(ds_pl.dims)}&quot;)
print(f&quot;Pressure-level variables:  {list(ds_pl.data_vars)}&quot;)
print(f&quot;Pressure levels (hPa):     {sorted(ds_pl.level.values.tolist(), reverse=True)}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="a3OKgxjJPuI7km707cNWR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Surface dimensions:        {&#x27;latitude&#x27;: 721, &#x27;longitude&#x27;: 1440}
Surface variables:         [&#x27;2m_temperature&#x27;, &#x27;10m_u_component_of_wind&#x27;, &#x27;10m_v_component_of_wind&#x27;, &#x27;mean_sea_level_pressure&#x27;, &#x27;total_precipitation&#x27;, &#x27;total_cloud_cover&#x27;]
Pressure-level dimensions: {&#x27;level&#x27;: 12, &#x27;latitude&#x27;: 721, &#x27;longitude&#x27;: 1440}
Pressure-level variables:  [&#x27;geopotential&#x27;, &#x27;temperature&#x27;, &#x27;u_component_of_wind&#x27;, &#x27;v_component_of_wind&#x27;]
Pressure levels (hPa):     [850, 500, 400, 350, 300, 250, 225, 200, 175, 150, 125, 100]
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/243307618.py:8: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  print(f&quot;Surface dimensions:        {dict(ds_sfc.dims)}&quot;)
/tmp/ipykernel_151767/243307618.py:10: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  print(f&quot;Pressure-level dimensions: {dict(ds_pl.dims)}&quot;)
</span></code></pre></div></div></div></div><div id="vuqW82Imf7" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># --- Surface fields ---
t2m      = ds_sfc[&quot;2m_temperature&quot;].squeeze()
t2m_c    = t2m - 273.15
u10      = ds_sfc[&quot;10m_u_component_of_wind&quot;].squeeze()
v10      = ds_sfc[&quot;10m_v_component_of_wind&quot;].squeeze()
wspd10   = np.sqrt(u10**2 + v10**2)
tcc      = ds_sfc[&quot;total_cloud_cover&quot;].squeeze()

lats_sfc = ds_sfc.latitude.values
lons_sfc = ds_sfc.longitude.values

# --- Pressure-level fields ---
lats_pl = ds_pl.latitude.values
lons_pl = ds_pl.longitude.values

# Levels sorted from high pressure (low altitude) → low pressure (high altitude)
levels_sorted = sorted(ds_pl.level.values.tolist(), reverse=True)

u250   = ds_pl[&quot;u_component_of_wind&quot;].sel(level=250).squeeze()
v250   = ds_pl[&quot;v_component_of_wind&quot;].sel(level=250).squeeze()
wspd250 = np.sqrt(u250**2 + v250**2)

gph500  = ds_pl[&quot;geopotential&quot;].sel(level=500).squeeze() / G  # metres

print(f&quot;2m temperature:    {float(t2m_c.min()):.1f}°C to {float(t2m_c.max()):.1f}°C&quot;)
print(f&quot;10m wind speed:    {float(wspd10.min()):.1f}–{float(wspd10.max()):.1f} m/s&quot;)
print(f&quot;250 hPa max wind:  {float(wspd250.max()):.1f} m/s&quot;)
print(f&quot;500 hPa GPH range: {float(gph500.min()):.0f}–{float(gph500.max()):.0f} m&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="PT4g1kotRhxZtHRUZB5K-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>2m temperature:    -68.5°C to 46.0°C
10m wind speed:    0.0–24.4 m/s
250 hPa max wind:  81.7 m/s
500 hPa GPH range: 4784–5959 m
</span></code></pre></div></div></div></div><div id="NOAKIANV2m" class="myst-jp-nb-block relative group/block"><h2 id="surface-weather" class="relative group"><span class="heading-text">Surface weather</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#surface-weather" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Before climbing into the atmosphere, we look at what is happening at the
Earth’s surface on this snapshot.</p></div><div id="uokSHeozmO" class="myst-jp-nb-block relative group/block"><h3 id="id-2m-temperature" class="relative group"><span class="heading-text">2m Temperature</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2m-temperature" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="CbrJkXHoWM" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(16, 9), subplot_kw={&quot;projection&quot;: ccrs.Robinson()})

im = ax.pcolormesh(
    lons_sfc, lats_sfc, t2m_c.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;RdYlBu_r&quot;, vmin=-40, vmax=45, shading=&quot;auto&quot;,
)
ax.add_feature(cfeature.COASTLINE, linewidth=0.5)
ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;--&quot;)
ax.set_global()
ax.set_title(f&quot;ERA5 2m Temperature — {DATE} 12:00 UTC&quot;, fontsize=14)

cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.05, shrink=0.6)
cbar.set_label(&quot;Temperature (°C)&quot;)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_surface_temperature.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="w32nPWn1EZLVINnRiSCMt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/760305152.py:18: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="oITdouAJyp" class="myst-jp-nb-block relative group/block"><figure id="fig-13-surface-temperature" class="fig-figure"><img id="fGoqmldoLu" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png" alt="ERA5 2m temperature on 2025-06-03 at 12:00 UTC.  The classic summer contrast
between the warm continents (especially the Middle East and Central Asia) and the
cooler oceans and polar regions is clearly visible." data-canonical-url="../../output/images/13_surface_temperature.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-surface-temperature" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->1<!-- -->:</a>ERA5 2m temperature on 2025-06-03 at 12:00 UTC.  The classic summer contrast
between the warm continents (especially the Middle East and Central Asia) and the
cooler oceans and polar regions is clearly visible.</p></figcaption></figure></div><div id="wruPHqv6oi" class="myst-jp-nb-block relative group/block"><h3 id="id-10m-wind-speed" class="relative group"><span class="heading-text">10m Wind Speed</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10m-wind-speed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="W2TlSsny4b" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">wspd10_c, lons10_c = add_cyclic_point(wspd10.values, coord=lons_sfc)
u10_c, _           = add_cyclic_point(u10.values,    coord=lons_sfc)
v10_c, _           = add_cyclic_point(v10.values,    coord=lons_sfc)

stride     = 20  # 0.25° × 20 = 5° subsampling for arrows
lons10_sub = lons10_c[::stride]
lats10_sub = lats_sfc[::stride]
u10_sub    = u10_c[::stride, ::stride]
v10_sub    = v10_c[::stride, ::stride]
wspd10_sub = np.sqrt(u10_sub**2 + v10_sub**2)
wspd10_sub = np.where(wspd10_sub == 0, 1, wspd10_sub)
u10_norm   = u10_sub / wspd10_sub
v10_norm   = v10_sub / wspd10_sub

fig = plt.figure(figsize=(16, 8))
ax = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
ax.set_global()

cf = ax.contourf(
    lons10_c, lats_sfc, wspd10_c,
    levels=np.arange(0, 25, 2),
    cmap=&quot;YlOrRd&quot;, transform=ccrs.PlateCarree(), extend=&quot;max&quot;,
)
ax.quiver(
    lons10_sub, lats10_sub, u10_norm, v10_norm,
    transform=ccrs.PlateCarree(),
    color=&quot;steelblue&quot;, alpha=0.7, scale=80, width=0.002,
    headwidth=3, headlength=3, headaxislength=3.75, regrid_shape=None,
)
ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=&quot;black&quot;)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=&quot;black&quot;, alpha=0.7)
ax.add_feature(cfeature.OCEAN,     facecolor=&quot;aliceblue&quot;, zorder=0)
ax.add_feature(cfeature.LAND,      facecolor=&quot;whitesmoke&quot;, zorder=0)

gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                  linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))
gl.ylocator = mticker.FixedLocator(range(-90, 91,  30))

cbar = fig.colorbar(cf, ax=ax, orientation=&quot;horizontal&quot;, pad=0.03, fraction=0.04, aspect=40)
cbar.set_label(&quot;10 m wind speed (m/s)&quot;, fontsize=11)
ax.set_title(
    f&quot;Surface wind — 10 m speed and direction\n{DATE} 12:00 UTC  |  ERA5 reanalysis&quot;,
    fontsize=13, pad=10,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_surface_wind.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="EFhqrK-M0CHTUvmOMOidN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/2893093739.py:49: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="MsHBm2rWCH" class="myst-jp-nb-block relative group/block"><figure id="fig-13-surface-wind" class="fig-figure"><img id="Vi5TzIaIVl" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_surface_wind-95319e4b3c6625c65805fc7e68e9fe0a.png" alt="ERA5 10 m wind speed (filled contours) and direction (blue arrows) on
2025-06-03 at 12:00 UTC.  The strongest surface winds are found over the
storm-track regions of the Southern Ocean and North Atlantic.  Blue arrows
show normalised wind direction; colour shows magnitude." data-canonical-url="../../output/images/13_surface_wind.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-surface-wind" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->2<!-- -->:</a>ERA5 10 m wind speed (filled contours) and direction (blue arrows) on
2025-06-03 at 12:00 UTC.  The strongest surface winds are found over the
storm-track regions of the Southern Ocean and North Atlantic.  Blue arrows
show normalised wind direction; colour shows magnitude.</p></figcaption></figure></div><div id="ytpSJkk669" class="myst-jp-nb-block relative group/block"><h3 id="cloud-cover-over-satellite-imagery" class="relative group"><span class="heading-text">Cloud cover over satellite imagery</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#cloud-cover-over-satellite-imagery" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="a7uypZpSNK" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cloud_cmap = LinearSegmentedColormap.from_list(&quot;clouds&quot;, [
    (1, 1, 1, 0),   # transparent where cloud-free
    (1, 1, 1, 1),   # opaque white where fully overcast
])

fig, ax = plt.subplots(figsize=(16, 9), subplot_kw={&quot;projection&quot;: ccrs.Robinson()})
ax.stock_img()

ax.pcolormesh(
    lons_sfc, lats_sfc, tcc.values,
    transform=ccrs.PlateCarree(),
    cmap=cloud_cmap, vmin=0, vmax=1, shading=&quot;auto&quot;,
)
ax.add_feature(cfeature.COASTLINE, linewidth=0.4, color=&quot;0.3&quot;)
ax.add_feature(cfeature.BORDERS,   linewidth=0.2, linestyle=&quot;--&quot;, color=&quot;0.4&quot;)
ax.set_global()
ax.set_title(f&quot;ERA5 Cloud Cover over Blue Marble — {DATE} 12:00 UTC&quot;, fontsize=14)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_cloud_satellite.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="2IQzQKKddTZRkOSXivIBy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/880923943.py:21: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="l7uEoReHxx" class="myst-jp-nb-block relative group/block"><figure id="fig-13-cloud-satellite" class="fig-figure"><img id="zWhWgrTxIs" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_cloud_satellite-b4737e22972b999986536e05ec4b5b7d.png" alt="ERA5 total cloud cover overlaid on Blue Marble satellite imagery.  Cloud-free
areas reveal the land/ocean surface; white patches mark frontal systems and
convective clouds over the tropics." data-canonical-url="../../output/images/13_cloud_satellite.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-cloud-satellite" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->3<!-- -->:</a>ERA5 total cloud cover overlaid on Blue Marble satellite imagery.  Cloud-free
areas reveal the land/ocean surface; white patches mark frontal systems and
convective clouds over the tropics.</p></figcaption></figure></div><div id="H8mbOxyAHm" class="myst-jp-nb-block relative group/block"><h2 id="what-are-pressure-levels" class="relative group"><span class="heading-text">What are pressure levels?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-are-pressure-levels" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The atmosphere is divided into <strong>pressure levels</strong> — horizontal surfaces where
air pressure has the same value everywhere.  Standard levels include
1000 hPa (near sea level), 850 hPa (~1.5 km), 500 hPa (~5.5 km), and
250 hPa (~10 km).</p><p>A crucial insight is that these surfaces are <strong>not flat</strong>.  Where the air
column is warm — and therefore expanded — a given pressure level sits
higher; where the air is cold and compressed, it sits lower.  These
undulations (measured as <em>geopotential height</em>, in metres) encode the
large-scale temperature and pressure patterns that drive weather systems.</p><p>The figure below shows the ERA5 data cross-sectioned along <strong>55°N</strong> — a
latitude that cuts through Iceland, the United Kingdom, central Europe,
and central Russia.  Each coloured band is the atmospheric layer between
two successive pressure levels.  Thicker bands indicate warmer (more
expanded) air; thinner bands indicate colder air.</p></div><div id="mlJrWXvzAZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">LAT_TRANSECT = 55.0

# Geopotential height in km at 55°N, all levels, all longitudes
gph_transect = ds_pl[&quot;geopotential&quot;].sel(latitude=LAT_TRANSECT, method=&quot;nearest&quot;).squeeze()
gph_km       = gph_transect / G / 1000  # km

# ERA5 uses 0–360° longitudes; convert to −180–180° and sort west→east
lons_180 = np.where(lons_pl &gt; 180, lons_pl - 360, lons_pl)
sort_idx  = np.argsort(lons_180)
lons_sort = lons_180[sort_idx]
gph_sort  = gph_km.isel(longitude=sort_idx)

# Colour palette: cool (low levels, high pressure) → warm (high levels, low pressure)
band_cmap   = plt.cm.coolwarm
n_bands     = len(levels_sorted) - 1
band_colors = [band_cmap(i / max(n_bands - 1, 1)) for i in range(n_bands)]

fig = plt.figure(figsize=(22, 7))
gs  = fig.add_gridspec(1, 5, wspace=0.45)

# --- Left: world map showing the transect latitude ---
ax_map = fig.add_subplot(gs[0, :2], projection=ccrs.Robinson())
ax_map.set_global()
ax_map.add_feature(cfeature.OCEAN,     facecolor=&quot;aliceblue&quot;)
ax_map.add_feature(cfeature.LAND,      facecolor=&quot;whitesmoke&quot;)
ax_map.add_feature(cfeature.COASTLINE, linewidth=0.5)
ax_map.add_feature(cfeature.BORDERS,   linewidth=0.3, alpha=0.7)
ax_map.plot(
    [-180, 180], [LAT_TRANSECT, LAT_TRANSECT],
    color=&quot;crimson&quot;, linewidth=2.5, transform=ccrs.PlateCarree(), zorder=5,
)
ax_map.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                 linewidth=0.3, color=&quot;gray&quot;, alpha=0.4, linestyle=&quot;--&quot;)
ax_map.set_title(
    f&quot;Cross-section location\n(red line = {LAT_TRANSECT:.0f}°N)&quot;,
    fontsize=12, color=&quot;crimson&quot;,
)

# --- Right: pressure level bands ---
ax_b = fig.add_subplot(gs[0, 2:])

for i in range(n_bands):
    lower_lev = levels_sorted[i]       # higher pressure = lower altitude
    upper_lev = levels_sorted[i + 1]   # lower pressure  = higher altitude
    lower_h   = gph_sort.sel(level=lower_lev).values
    upper_h   = gph_sort.sel(level=upper_lev).values
    ax_b.fill_between(lons_sort, lower_h, upper_h,
                      color=band_colors[i], alpha=0.65)

# Pressure-surface lines and labels
for lev in levels_sorted:
    h = gph_sort.sel(level=lev).values
    ax_b.plot(lons_sort, h, color=&quot;black&quot;, linewidth=0.8, alpha=0.7)
    ax_b.text(lons_sort[-1] + 2, h[-1], f&quot; {lev} hPa&quot;,
              va=&quot;center&quot;, fontsize=8, fontweight=&quot;bold&quot;)

# Shade the jet-stream zone (250–200 hPa) with a thin annotation
jet_low  = gph_sort.sel(level=250).values.mean()
jet_high = gph_sort.sel(level=200).values.mean()
ax_b.axhspan(jet_low, jet_high, color=&quot;gold&quot;, alpha=0.25, zorder=0)
ax_b.text(lons_sort[0] + 2, (jet_low + jet_high) / 2,
          &quot;← jet stream zone&quot;, va=&quot;center&quot;, fontsize=9,
          color=&quot;goldenrod&quot;, fontweight=&quot;bold&quot;)

ax_b.set_xlabel(&quot;Longitude (°E)&quot;, fontsize=12)
ax_b.set_ylabel(&quot;Geopotential height (km)&quot;, fontsize=12)
ax_b.set_xlim(lons_sort.min(), lons_sort.max() + 14)
ax_b.grid(True, alpha=0.2)
ax_b.set_title(
    f&quot;Atmospheric layers along {LAT_TRANSECT:.0f}°N — {DATE} 12:00 UTC&quot;,
    fontsize=13,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_pressure_bands.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="SP9tJcqflmiKVDJt62GNp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/388062872.py:74: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/388062872.py:76: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="ozgmO0Sk31" class="myst-jp-nb-block relative group/block"><figure id="fig-13-pressure-bands" class="fig-figure"><img id="wwvHqCkas6" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_pressure_bands-30e8a9eba5d5bf4385f5bf78696e67d2.png" alt="Left: world map showing the cross-section location (red line = 55°N).
Right: atmospheric layers along 55°N.  Each coloured band represents the
layer between two pressure levels; black lines are the actual geopotential
height of each surface.  Thicker bands indicate warmer (expanded) air.  The
gold shading marks the jet-stream zone (~200–250 hPa, ~10–12 km altitude).
Note how the pressure surfaces undulate by hundreds of metres — these waves
are the Rossby waves that steer surface weather systems." data-canonical-url="../../output/images/13_pressure_bands.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-pressure-bands" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->4<!-- -->:</a><strong>Left:</strong> world map showing the cross-section location (red line = 55°N).
<strong>Right:</strong> atmospheric layers along 55°N.  Each coloured band represents the
layer between two pressure levels; black lines are the actual geopotential
height of each surface.  Thicker bands indicate warmer (expanded) air.  The
gold shading marks the jet-stream zone (~200–250 hPa, ~10–12 km altitude).
Note how the pressure surfaces undulate by hundreds of metres — these waves
are the Rossby waves that steer surface weather systems.</p></figcaption></figure></div><div id="a8ZeLKR6nQ" class="myst-jp-nb-block relative group/block"><h2 id="the-jet-stream-in-2d" class="relative group"><span class="heading-text">The jet stream in 2D</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#the-jet-stream-in-2d" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The <strong>jet stream</strong> is a narrow corridor of fast-moving air located near the
tropopause, typically at 250 hPa (~10 km altitude).  Two jets exist in each
hemisphere:</p><ul><li><p><strong>Polar front jet</strong> (~50–65°): marks the boundary between cold polar air
and warmer mid-latitude air.  Its meanders steer surface weather systems.</p></li><li><p><strong>Subtropical jet</strong> (~25–35°): driven by the Hadley cell; typically
stronger in winter, weaker in summer.</p></li></ul><p>On a summer snapshot like ours (June), the polar jet is weaker and displaced
poleward.  We visualise it in two ways:</p><ol start="1"><li><p><strong>Global Robinson map</strong> — 250 hPa wind speed in colour, with 500 hPa
geopotential height as contour lines to show the pressure wave pattern.</p></li><li><p><strong>Polar (top-down) view</strong> — shows the jet stream as a ring around the
North Pole.</p></li></ol></div><div id="HHbqEGSaIF" class="myst-jp-nb-block relative group/block"><h3 id="global-view-250-hpa-wind-500-hpa-geopotential" class="relative group"><span class="heading-text">Global view: 250 hPa wind + 500 hPa geopotential</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#global-view-250-hpa-wind-500-hpa-geopotential" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="hAhILxHsKE" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">wspd250_c, lons250_c = add_cyclic_point(wspd250.values, coord=lons_pl)
gph500_c,  _         = add_cyclic_point(gph500.values,  coord=lons_pl)

# Geopotential-height contour levels in 80 m steps
z500_levels = np.arange(
    np.floor(float(gph500.min()) / 100) * 100,
    np.ceil(float(gph500.max())  / 100) * 100 + 1,
    80,
)

fig = plt.figure(figsize=(16, 8))
ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
ax.set_global()

cf = ax.contourf(
    lons250_c, lats_pl, wspd250_c,
    levels=np.arange(0, 85, 5),
    cmap=&quot;hot_r&quot;, transform=ccrs.PlateCarree(), extend=&quot;max&quot;,
)
cs = ax.contour(
    lons250_c, lats_pl, gph500_c,
    levels=z500_levels,
    colors=&quot;steelblue&quot;, linewidths=0.8, alpha=0.7,
    transform=ccrs.PlateCarree(),
)
ax.clabel(cs, fmt=&quot;%d m&quot;, fontsize=7, inline=True)

ax.add_feature(cfeature.COASTLINE, linewidth=0.5)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=&quot;--&quot;)

gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                  linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))
gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))

cbar = fig.colorbar(cf, ax=ax, orientation=&quot;horizontal&quot;, pad=0.04, shrink=0.6)
cbar.set_label(&quot;250 hPa wind speed (m/s)&quot;)
ax.set_title(
    f&quot;250 hPa wind speed + 500 hPa geopotential height — {DATE} 12:00 UTC&quot;,
    fontsize=13,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_z500_wind250.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="RdD9onute8zQJhsDv2nTx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/2006442886.py:45: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="s3qfIGK5t7" class="myst-jp-nb-block relative group/block"><figure id="fig-13-z500-wind250" class="fig-figure"><img id="soJ6nbJ3BS" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_z500_wind250-0f7e57f53197eaee4c792829f98046a4.png" alt="250 hPa wind speed (filled, hot colourmap) with 500 hPa geopotential height
contours (blue lines, labelled in metres).  The jet stream appears as the orange/red
band encircling the mid-latitudes.  The 500 hPa contours reveal the trough/ridge
wave pattern that the jet stream follows: the jet accelerates through troughs
(low geopotential) and decelerates through ridges (high geopotential)." data-canonical-url="../../output/images/13_z500_wind250.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-z500-wind250" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->5<!-- -->:</a>250 hPa wind speed (filled, hot colourmap) with 500 hPa geopotential height
contours (blue lines, labelled in metres).  The jet stream appears as the orange/red
band encircling the mid-latitudes.  The 500 hPa contours reveal the trough/ridge
wave pattern that the jet stream follows: the jet accelerates through troughs
(low geopotential) and decelerates through ridges (high geopotential).</p></figcaption></figure></div><div id="cwtEgnEUB8" class="myst-jp-nb-block relative group/block"><h3 id="id-500-hpa-geopotential-250-hpa-jet-stream-footprint" class="relative group"><span class="heading-text">500 hPa geopotential + 250 hPa jet stream footprint</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-500-hpa-geopotential-250-hpa-jet-stream-footprint" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The same Z500 wave pattern as above, but now the 250 hPa wind speed is
collapsed to a binary mask: grid points where the jet core exceeds 30 m/s
are filled in purple, while slower regions are transparent.  This style —
borrowed from operational meteorological charts — immediately shows the
jet-stream corridor without the distraction of a continuous colour scale.</p></div><div id="t3BqzHHoMt" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">JET_THRESHOLD = 30  # m/s — standard meteorological jet-stream criterion

# Reuse cyclic arrays already computed above
z500_levels   = np.arange(
    np.floor(float(gph500.min()) / 60) * 60,
    np.ceil(float(gph500.max())  / 60) * 60 + 1,
    80,
)
jet_masked_c = np.where(wspd250_c &gt;= JET_THRESHOLD, wspd250_c, np.nan)

fig = plt.figure(figsize=(16, 8))
ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
ax.set_global()

ax.add_feature(cfeature.OCEAN, facecolor=&quot;#d0e8f5&quot;, zorder=0)
ax.add_feature(cfeature.LAND,  facecolor=&quot;#f0ede8&quot;, zorder=0)

cs = ax.contour(
    lons250_c, lats_pl, gph500_c,
    levels=z500_levels, colors=&quot;black&quot;, linewidths=0.6,
    transform=ccrs.PlateCarree(), zorder=3,
)
ax.clabel(cs, fmt=&quot;%d m&quot;, fontsize=7, inline=True, inline_spacing=3)

ax.contourf(
    lons250_c, lats_pl, jet_masked_c,
    levels=[JET_THRESHOLD, 300], colors=[&quot;mediumpurple&quot;], alpha=0.75,
    transform=ccrs.PlateCarree(), zorder=4,
)
ax.contour(
    lons250_c, lats_pl, wspd250_c,
    levels=[JET_THRESHOLD], colors=[&quot;rebeccapurple&quot;], linewidths=1.0,
    transform=ccrs.PlateCarree(), zorder=5,
)

ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=&quot;black&quot;, zorder=6)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=&quot;black&quot;, alpha=0.7, zorder=6)

gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                  linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))
gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))

ax.legend(
    handles=[mpatches.Patch(facecolor=&quot;mediumpurple&quot;, edgecolor=&quot;rebeccapurple&quot;,
                            alpha=0.75, label=f&quot;Jet stream ≥ {JET_THRESHOLD} m/s  (250 hPa)&quot;)],
    loc=&quot;lower left&quot;, fontsize=10, framealpha=0.85,
)
ax.set_title(
    f&quot;500 hPa geopotential height (contours) + jet stream footprint — {DATE} 12:00 UTC&quot;,
    fontsize=13,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_z500_jet_purple.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="8QCa9IsSoFGefX6WkP_WY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/786794077.py:56: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="vNfCh4WxT6" class="myst-jp-nb-block relative group/block"><figure id="fig-13-z500-jet-purple" class="fig-figure"><img id="btKFFBaXjf" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_z500_jet_purple-228b4cb0a74df55c77412e4fa44fed5f.png" alt="500 hPa geopotential height (black contours, labelled in metres) with the
250 hPa jet stream footprint (purple, ≥ 30 m/s).  The jet hugs the steepest
geopotential gradient, flowing fastest where contours are most tightly packed.
Troughs (contours bending equatorward) and ridges (bending poleward) mark
the Rossby-wave pattern that steers the jet." data-canonical-url="../../output/images/13_z500_jet_purple.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-z500-jet-purple" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->6<!-- -->:</a>500 hPa geopotential height (black contours, labelled in metres) with the
250 hPa jet stream footprint (purple, ≥ 30 m/s).  The jet hugs the steepest
geopotential gradient, flowing fastest where contours are most tightly packed.
Troughs (contours bending equatorward) and ridges (bending poleward) mark
the Rossby-wave pattern that steers the jet.</p></figcaption></figure></div><div id="X1MlhSNXau" class="myst-jp-nb-block relative group/block"><h3 id="id-2m-temperature-500-hpa-geopotential-contours" class="relative group"><span class="heading-text">2m temperature + 500 hPa geopotential contours</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2m-temperature-500-hpa-geopotential-contours" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The Z500 wave pattern also reflects the surface temperature distribution —
warm air expands the lower troposphere and pushes pressure surfaces higher,
while cold air compresses them.  Overlaying Z500 contours on 2m temperature
makes this connection explicit: ridges (high Z500) sit over warm air masses,
troughs (low Z500) over cold ones.</p></div><div id="MoxDba0wYD" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">t2m_c_cyc, lons_t2m_c = add_cyclic_point(t2m_c.values, coord=lons_sfc)

fig = plt.figure(figsize=(16, 8))
ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
ax.set_global()

im = ax.pcolormesh(
    lons_t2m_c, lats_sfc, t2m_c_cyc,
    cmap=&quot;RdBu_r&quot;, vmin=-40, vmax=45,
    transform=ccrs.PlateCarree(), shading=&quot;auto&quot;,
)
cs = ax.contour(
    lons250_c, lats_pl, gph500_c,
    levels=z500_levels, colors=&quot;black&quot;, linewidths=0.6,
    transform=ccrs.PlateCarree(), zorder=3,
)
ax.clabel(cs, fmt=&quot;%d m&quot;, fontsize=7, inline=True, inline_spacing=3)

ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=&quot;0.15&quot;, zorder=4)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=&quot;--&quot;, color=&quot;0.35&quot;, zorder=4)

gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                  linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))
gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))

cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.05, shrink=0.6)
cbar.set_label(&quot;2m temperature (°C)&quot;)
ax.set_title(
    f&quot;500 hPa geopotential height (contours) + 2m temperature — {DATE} 12:00 UTC&quot;,
    fontsize=13,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_t2m_z500.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="YpJJE2Z5cQA6_xbfg1tu8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/3147655083.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="owYC9iX8Jg" class="myst-jp-nb-block relative group/block"><figure id="fig-13-t2m-z500" class="fig-figure"><img id="msrBJd3jq8" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_t2m_z500-03a08c92a8fe1b764b26a85c48826cd4.png" alt="2m temperature (filled, red–blue scale) with 500 hPa geopotential height
contours (black).  Ridges (contours arching poleward) align with warm air
masses; troughs (contours dipping equatorward) sit over cold air.  The
tight coupling between the upper-level wave pattern and the surface
temperature field is a key driver of both weather and energy demand." data-canonical-url="../../output/images/13_t2m_z500.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-t2m-z500" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->7<!-- -->:</a>2m temperature (filled, red–blue scale) with 500 hPa geopotential height
contours (black).  Ridges (contours arching poleward) align with warm air
masses; troughs (contours dipping equatorward) sit over cold air.  The
tight coupling between the upper-level wave pattern and the surface
temperature field is a key driver of both weather and energy demand.</p></figcaption></figure></div><div id="Qt2G3cumrF" class="myst-jp-nb-block relative group/block"><h3 id="id-2m-temperature-with-250-hpa-jet-stream-core-overlay" class="relative group"><span class="heading-text">2m temperature with 250 hPa jet stream core overlay</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2m-temperature-with-250-hpa-jet-stream-core-overlay" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The jet stream is the boundary between cold polar air and warm subtropical
air.  Overlaying the jet core (&gt; 30 m/s, shown here as a white band that
brightens with wind speed) directly on the 2m temperature field makes this
air-mass boundary visible: north of the jet lies colder, denser polar air;
south of it lies warmer subtropical air.</p></div><div id="hXuMUMpqCR" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">jet_core_c  = np.where(wspd250_c &gt; JET_THRESHOLD, wspd250_c, np.nan)
jet_core_cmap = LinearSegmentedColormap.from_list(&quot;jet_core&quot;, [
    (0.2, 0.2, 0.2, 0.6),  # dark grey, semi-transparent at threshold
    (1.0, 1.0, 1.0, 1.0),  # bright white at 80 m/s
])

fig = plt.figure(figsize=(16, 9))
ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
ax.set_global()

im_temp = ax.pcolormesh(
    lons_t2m_c, lats_sfc, t2m_c_cyc,
    cmap=&quot;RdYlBu_r&quot;, vmin=-40, vmax=45,
    transform=ccrs.PlateCarree(), shading=&quot;auto&quot;,
)
ax.pcolormesh(
    lons250_c, lats_pl, jet_core_c,
    cmap=jet_core_cmap, vmin=JET_THRESHOLD, vmax=80,
    transform=ccrs.PlateCarree(), shading=&quot;auto&quot;,
)

ax.add_feature(cfeature.COASTLINE, linewidth=0.5)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=&quot;--&quot;)

cbar = fig.colorbar(im_temp, ax=ax, orientation=&quot;horizontal&quot;, pad=0.05, shrink=0.6)
cbar.set_label(&quot;Temperature (°C)&quot;)
ax.set_title(
    f&quot;2m temperature with jet stream core (&gt; {JET_THRESHOLD} m/s at 250 hPa) — {DATE} 12:00 UTC&quot;,
    fontsize=13,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_t2m_jet_core.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="61IKt38cu7Z6lljfIYIfU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/2907177902.py:34: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="nQ7rmPAvZ5" class="myst-jp-nb-block relative group/block"><figure id="fig-13-t2m-jet-core" class="fig-figure"><img id="YgucpfPok2" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_t2m_jet_core-5b7161509dd6ee9fbf9cc498a527393c.png" alt="2m temperature (filled, RdYlBu_r) with the 250 hPa jet stream core overlaid
as a white band (brightening with wind speed above 30 m/s).  The jet marks
the sharp boundary between cold polar air to the north and warm subtropical
air to the south — a boundary that in winter can be associated with
temperature differences of 20–30 °C over just a few degrees of latitude." data-canonical-url="../../output/images/13_t2m_jet_core.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-t2m-jet-core" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->8<!-- -->:</a>2m temperature (filled, RdYlBu_r) with the 250 hPa jet stream core overlaid
as a white band (brightening with wind speed above 30 m/s).  The jet marks
the sharp boundary between cold polar air to the north and warm subtropical
air to the south — a boundary that in winter can be associated with
temperature differences of 20–30 °C over just a few degrees of latitude.</p></figcaption></figure></div><div id="hgduZBduZS" class="myst-jp-nb-block relative group/block"><h3 id="polar-view-the-jet-stream-as-a-ring-around-the-north-pole" class="relative group"><span class="heading-text">Polar view: the jet stream as a ring around the North Pole</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#polar-view-the-jet-stream-as-a-ring-around-the-north-pole" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="o6r0o1YWil" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Subsample for streamlines (dense grids overwhelm cartopy&#x27;s streamplot)
step  = 8
lons_sub = u250.longitude.values[::step]
lats_sub = lats_pl[::step]
u_sub    = u250.values[::step, ::step]
v_sub    = v250.values[::step, ::step]

fig, ax = plt.subplots(
    figsize=(10, 10),
    subplot_kw={&quot;projection&quot;: ccrs.NorthPolarStereo()},
)

im = ax.pcolormesh(
    lons_pl, lats_pl, wspd250.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;hot_r&quot;, vmin=0, vmax=80, shading=&quot;auto&quot;,
)
ax.streamplot(
    lons_sub, lats_sub, u_sub, v_sub,
    transform=ccrs.PlateCarree(),
    color=&quot;white&quot;, linewidth=0.5, density=1.5, arrowsize=0.8,
)
ax.add_feature(cfeature.COASTLINE, linewidth=0.5)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=&quot;--&quot;)
ax.set_extent([-180, 180, 20, 90], crs=ccrs.PlateCarree())

cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.05, shrink=0.7)
cbar.set_label(&quot;250 hPa wind speed (m/s)&quot;)
ax.set_title(
    f&quot;Jet stream viewed from above — 250 hPa\n{DATE} 12:00 UTC  |  ERA5&quot;,
    fontsize=13,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_jet_stream_polar.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="CrKsTU-4p1ZV_2GfXMq3U" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/1322210975.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="tPcbBbFVzt" class="myst-jp-nb-block relative group/block"><figure id="fig-13-jet-stream-polar" class="fig-figure"><img id="Ohxoxh0yve" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_jet_stream_polar-1a30fbe8dd3c3babcc4fb680f07e0c90.png" alt="The Northern Hemisphere jet stream viewed from directly above the North Pole
(North Polar Stereographic projection).  Wind speed at 250 hPa is shown in
colour; white streamlines indicate wind direction.  The jet stream traces an
irregular ring around the pole, with Rossby-wave meanders visible as north–south
excursions.  This “ring” perspective makes it clear why the jet stream is
sometimes described as a three-dimensional tube encircling the planet." data-canonical-url="../../output/images/13_jet_stream_polar.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-jet-stream-polar" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->9<!-- -->:</a>The Northern Hemisphere jet stream viewed from directly above the North Pole
(North Polar Stereographic projection).  Wind speed at 250 hPa is shown in
colour; white streamlines indicate wind direction.  The jet stream traces an
irregular ring around the pole, with Rossby-wave meanders visible as north–south
excursions.  This “ring” perspective makes it clear why the jet stream is
sometimes described as a three-dimensional tube encircling the planet.</p></figcaption></figure></div><div id="sMhGDTzrMz" class="myst-jp-nb-block relative group/block"><h2 id="jet-stream-across-altitude-levels" class="relative group"><span class="heading-text">Jet stream across altitude levels</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#jet-stream-across-altitude-levels" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The figures above show the jet stream at a single pressure level (250 hPa).
But the jet has <strong>vertical extent</strong> — it intensifies from the mid-troposphere
upward through the tropopause, then weakens in the stratosphere above.</p><p>The animation below steps through all available pressure levels from
850 hPa (~1.5 km, near-surface) to 100 hPa (~16 km, lower stratosphere).
Watch how the fast-moving core (red/orange) emerges at mid-tropospheric
levels, peaks near 200–250 hPa, then fades in the stratosphere above.</p><table class=""><tbody><tr class=""><th class="">Level (hPa)</th><th class="">Approx. altitude</th><th class="">Layer</th></tr><tr class=""><td class="">850</td><td class="">~1.5 km</td><td class="">lower troposphere</td></tr><tr class=""><td class="">500</td><td class="">~5.5 km</td><td class="">mid-troposphere</td></tr><tr class=""><td class="">400</td><td class="">~7 km</td><td class="">mid-troposphere</td></tr><tr class=""><td class="">350</td><td class="">~8 km</td><td class="">upper troposphere</td></tr><tr class=""><td class="">300</td><td class="">~9 km</td><td class="">upper troposphere</td></tr><tr class=""><td class="">250</td><td class="">~10 km</td><td class=""><strong>jet-stream core</strong></td></tr><tr class=""><td class="">225</td><td class="">~11 km</td><td class="">jet-stream core</td></tr><tr class=""><td class="">200</td><td class="">~12 km</td><td class="">jet / tropopause</td></tr><tr class=""><td class="">175</td><td class="">~13 km</td><td class="">tropopause</td></tr><tr class=""><td class="">150</td><td class="">~14 km</td><td class="">lower stratosphere</td></tr><tr class=""><td class="">125</td><td class="">~15 km</td><td class="">lower stratosphere</td></tr><tr class=""><td class="">100</td><td class="">~16 km</td><td class="">lower stratosphere</td></tr></tbody></table></div><div id="kfobaBWeCN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">_ALT_LABELS = {
    850: &quot;~1.5 km (lower troposphere)&quot;,
    500: &quot;~5.5 km (mid-troposphere)&quot;,
    400: &quot;~7 km&quot;,
    350: &quot;~8 km&quot;,
    300: &quot;~9 km (upper troposphere)&quot;,
    250: &quot;~10 km ★ jet-stream core&quot;,
    225: &quot;~11 km ★ jet-stream core&quot;,
    200: &quot;~12 km (jet / tropopause)&quot;,
    175: &quot;~13 km (tropopause)&quot;,
    150: &quot;~14 km (lower stratosphere)&quot;,
    125: &quot;~15 km&quot;,
    100: &quot;~16 km (lower stratosphere)&quot;,
}

gif_frames_pl = []

for level in levels_sorted:
    u_lev   = ds_pl[&quot;u_component_of_wind&quot;].sel(level=level).squeeze()
    v_lev   = ds_pl[&quot;v_component_of_wind&quot;].sel(level=level).squeeze()
    wspd_lv = np.sqrt(u_lev.values**2 + v_lev.values**2)

    wspd_c, lons_c = add_cyclic_point(wspd_lv,       coord=lons_pl)
    u_c,    _      = add_cyclic_point(u_lev.values,   coord=lons_pl)
    v_c,    _      = add_cyclic_point(v_lev.values,   coord=lons_pl)

    stride   = 20
    lons_sub = lons_c[::stride]
    lats_sub = lats_pl[::stride]
    u_sub    = u_c[::stride, ::stride]
    v_sub    = v_c[::stride, ::stride]
    wspd_sub = np.sqrt(u_sub**2 + v_sub**2)
    wspd_sub = np.where(wspd_sub == 0, 1, wspd_sub)
    u_norm   = u_sub / wspd_sub
    v_norm   = v_sub / wspd_sub

    fig = plt.figure(figsize=(16, 8))
    ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
    ax.set_global()

    cf = ax.contourf(
        lons_c, lats_pl, wspd_c,
        levels=np.arange(0, 85, 5),
        cmap=&quot;YlOrRd&quot;, transform=ccrs.PlateCarree(), extend=&quot;max&quot;,
    )
    ax.quiver(
        lons_sub, lats_sub, u_norm, v_norm,
        transform=ccrs.PlateCarree(),
        color=&quot;steelblue&quot;, alpha=0.7, scale=80, width=0.002,
        headwidth=3, headlength=3, headaxislength=3.75, regrid_shape=None,
    )
    ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=&quot;black&quot;)
    ax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=&quot;black&quot;, alpha=0.7)
    ax.add_feature(cfeature.OCEAN,     facecolor=&quot;aliceblue&quot;,  zorder=0)
    ax.add_feature(cfeature.LAND,      facecolor=&quot;whitesmoke&quot;, zorder=0)

    gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                      linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
    gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))
    gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))

    cbar = fig.colorbar(cf, ax=ax, orientation=&quot;horizontal&quot;,
                        pad=0.03, fraction=0.04, aspect=40)
    cbar.set_label(f&quot;Wind speed at {level} hPa (m/s)&quot;, fontsize=11)
    cbar.ax.tick_params(labelsize=9)

    ax.set_title(
        f&quot;Upper-level wind — {level} hPa  ({_ALT_LABELS.get(level, &#x27;&#x27;)})\n&quot;
        f&quot;{DATE} 12:00 UTC  |  ERA5 reanalysis&quot;,
        fontsize=13, pad=10,
    )

    fig.tight_layout()

    buf = io.BytesIO()
    fig.savefig(buf, format=&quot;png&quot;, dpi=100, bbox_inches=&quot;tight&quot;)
    plt.close(fig)
    buf.seek(0)
    gif_frames_pl.append(Image.open(buf).copy())
    print(f&quot;  pressure level frame: {level} hPa&quot;)

out_gif_pl = paths.images_path / &quot;13_pressure_levels_animation.gif&quot;
gif_frames_pl[0].save(
    out_gif_pl,
    save_all=True,
    append_images=gif_frames_pl[1:],
    duration=700,   # ms per frame — slow enough to read the title
    loop=0,
)
print(f&quot;saved → {out_gif_pl.name}  ({len(gif_frames_pl)} frames)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Z1yMaz9IS1KWB9RskokFQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 850 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 500 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 400 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 350 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 300 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 250 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 225 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 200 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 175 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 150 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 125 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly
  warnings.warn(&#x27;Some vectors at source domain corners &#x27;
/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  pressure level frame: 100 hPa
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>saved → 13_pressure_levels_animation.gif  (12 frames)
</span></code></pre></div></div></div></div><div id="dR6BUuFjSl" class="myst-jp-nb-block relative group/block"><figure id="fig-13-pressure-levels-animation" class="fig-figure"><img id="JPh1WVbH4H" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_pressure_levels_a-e94991b9b187468f1f9ee013fcb40bc2.gif" alt="Animation stepping from 850 hPa (near-surface) up to 100 hPa (lower stratosphere).
The jet stream emerges as the fast-moving core (orange/red) intensifies through the
mid-troposphere, peaks at 200–250 hPa, then weakens in the stratosphere above.
Blue arrows show wind direction.  This animation reveals the jet stream as a
vertically coherent structure rather than just a surface phenomenon." data-canonical-url="../../output/images/13_pressure_levels_animation.gif" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-pressure-levels-animation" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->10<!-- -->:</a>Animation stepping from 850 hPa (near-surface) up to 100 hPa (lower stratosphere).
The jet stream emerges as the fast-moving core (orange/red) intensifies through the
mid-troposphere, peaks at 200–250 hPa, then weakens in the stratosphere above.
Blue arrows show wind direction.  This animation reveals the jet stream as a
vertically coherent structure rather than just a surface phenomenon.</p></figcaption></figure></div><div id="rEn76jp7Sr" class="myst-jp-nb-block relative group/block"><h2 id="vertical-cross-sections" class="relative group"><span class="heading-text">Vertical cross-sections</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#vertical-cross-sections" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>A <strong>vertical cross-section</strong> cuts through the atmosphere at a fixed longitude
and shows how wind speed and temperature vary simultaneously with latitude
(x-axis) and altitude (y-axis).  This is the most direct way to see the jet
stream’s three-dimensional shape.</p><p>The y-axis uses <strong>geopotential height</strong> (km) so altitude increases naturally
upward.  Each cross-section is paired with a world map highlighting the
meridian it was cut along.</p></div><div id="ggv75sjGPy" class="myst-jp-nb-block relative group/block"><h3 id="cross-section-helper" class="relative group"><span class="heading-text">Cross-section helper</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#cross-section-helper" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="SX1sPffVDz" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def _fmt_cross_axes(ax):
    ax.set_xlabel(&quot;Latitude (°)&quot;, fontsize=10)
    ax.set_ylabel(&quot;Geopotential height (km)&quot;, fontsize=10)
    ax.xaxis.set_major_formatter(mticker.FormatStrFormatter(&quot;%d°&quot;))
    ax.xaxis.set_major_locator(mticker.MultipleLocator(15))
    ax.grid(axis=&quot;x&quot;, linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
    ax.grid(axis=&quot;y&quot;, linewidth=0.4, color=&quot;gray&quot;, alpha=0.3, linestyle=&quot;:&quot;)


def _cross_section_data(ds_pl, lon_cut):
    &quot;&quot;&quot;Extract and sort cross-section arrays for a given longitude.&quot;&quot;&quot;
    ds_cut    = ds_pl.sel(longitude=lon_cut, method=&quot;nearest&quot;)
    lon_act   = float(ds_cut.longitude)
    lon_plot  = lon_act if lon_act &lt;= 180 else lon_act - 360

    u_cut  = ds_cut[&quot;u_component_of_wind&quot;].squeeze().values  # (level, lat)
    v_cut  = ds_cut[&quot;v_component_of_wind&quot;].squeeze().values
    z_cut  = ds_cut[&quot;geopotential&quot;].squeeze().values
    t_cut  = ds_cut[&quot;temperature&quot;].squeeze().values
    lats_c = ds_cut.latitude.values  # descending 90→−90

    z_km       = z_cut / G / 1000
    level_ord  = np.argsort(z_km.mean(axis=1))  # bottom → top

    z_km_s  = z_km[level_ord][:, ::-1]                                # south→north
    wspd_s  = np.sqrt(u_cut**2 + v_cut**2)[level_ord][:, ::-1]
    t_s     = t_cut[level_ord][:, ::-1] - 273.15
    lat_2d  = np.broadcast_to(lats_c[::-1], z_km_s.shape).copy()

    return lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ofuuG0nofaDSBpeowi8Qq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="m4PXQyieyg" class="myst-jp-nb-block relative group/block"><h3 id="static-cross-section-at-0-e-prime-meridian-with-location-map" class="relative group"><span class="heading-text">Static cross-section at 0 °E (prime meridian) with location map</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#static-cross-section-at-0-e-prime-meridian-with-location-map" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ZIhBPESNML" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">LON_STATIC = 0
lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s = _cross_section_data(ds_pl, LON_STATIC)

fig = plt.figure(figsize=(22, 6))
gs  = fig.add_gridspec(1, 10, wspace=0.5)

# --- Location map ---
ax_map = fig.add_subplot(gs[0, :2], projection=ccrs.PlateCarree())
ax_map.set_global()
ax_map.add_feature(cfeature.OCEAN,     facecolor=&quot;aliceblue&quot;)
ax_map.add_feature(cfeature.LAND,      facecolor=&quot;whitesmoke&quot;)
ax_map.add_feature(cfeature.COASTLINE, linewidth=0.6)
ax_map.add_feature(cfeature.BORDERS,   linewidth=0.3, alpha=0.7)
ax_map.plot([lon_plot, lon_plot], [-90, 90],
            color=&quot;crimson&quot;, linewidth=2.5, transform=ccrs.PlateCarree(), zorder=5)
gl_m = ax_map.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,
                         linewidth=0.3, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
gl_m.top_labels   = False
gl_m.right_labels = False
gl_m.xlocator     = mticker.FixedLocator(range(-180, 181, 60))
gl_m.ylocator     = mticker.FixedLocator(range(-90,  91,  30))
gl_m.xlabel_style = {&quot;size&quot;: 8}
gl_m.ylabel_style = {&quot;size&quot;: 8}
ax_map.set_title(
    f&quot;Cross-section at\n{lon_act:.0f}°E ({lon_plot:+.0f}°)&quot;,
    fontsize=10, color=&quot;crimson&quot;,
)

# --- Wind speed ---
ax_w = fig.add_subplot(gs[0, 2:6])
cf_w = ax_w.contourf(lat_2d, z_km_s, wspd_s,
                     levels=np.arange(0, 85, 5), cmap=&quot;YlOrRd&quot;, extend=&quot;max&quot;)
cs_w = ax_w.contour(lat_2d, z_km_s, wspd_s, levels=[30, 50, 70],
                    colors=&quot;black&quot;, linewidths=0.8, alpha=0.6)
ax_w.clabel(cs_w, fmt=&quot;%d m/s&quot;, fontsize=8)
fig.colorbar(cf_w, ax=ax_w, orientation=&quot;vertical&quot;, pad=0.02,
             fraction=0.03, aspect=30).set_label(&quot;Wind speed (m/s)&quot;, fontsize=10)
_fmt_cross_axes(ax_w)
ax_w.set_title(f&quot;Wind speed — {lon_act:.0f}°E ({lon_plot:+.0f}°)&quot;, fontsize=11)

# --- Temperature ---
ax_t = fig.add_subplot(gs[0, 6:10], sharey=ax_w)
cf_t = ax_t.contourf(lat_2d, z_km_s, t_s,
                     levels=np.arange(-80, 25, 5), cmap=&quot;RdBu_r&quot;, extend=&quot;both&quot;)
cs_t = ax_t.contour(lat_2d, z_km_s, t_s, levels=np.arange(-80, 25, 10),
                    colors=&quot;black&quot;, linewidths=0.6, alpha=0.5)
ax_t.clabel(cs_t, fmt=&quot;%d°C&quot;, fontsize=8)
fig.colorbar(cf_t, ax=ax_t, orientation=&quot;vertical&quot;, pad=0.02,
             fraction=0.03, aspect=30).set_label(&quot;Temperature (°C)&quot;, fontsize=10)
ax_t.set_xlabel(&quot;Latitude (°)&quot;, fontsize=10)
ax_t.xaxis.set_major_formatter(mticker.FormatStrFormatter(&quot;%d°&quot;))
ax_t.xaxis.set_major_locator(mticker.MultipleLocator(15))
ax_t.grid(axis=&quot;x&quot;, linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
ax_t.grid(axis=&quot;y&quot;, linewidth=0.4, color=&quot;gray&quot;, alpha=0.3, linestyle=&quot;:&quot;)
ax_t.tick_params(labelleft=False)
ax_t.set_title(f&quot;Temperature — {lon_act:.0f}°E ({lon_plot:+.0f}°)&quot;, fontsize=11)

fig.suptitle(
    f&quot;Vertical cross-section at {lon_act:.0f}°E ({lon_plot:+.0f}°) — &quot;
    f&quot;{DATE} 12:00 UTC  |  ERA5 reanalysis&quot;,
    fontsize=13, y=1.02,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_cross_section_0E.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="mrAlcz3sGBavNhbVQ8B_S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/3683643321.py:64: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/3683643321.py:66: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="fDHEGigVVS" class="myst-jp-nb-block relative group/block"><figure id="fig-13-cross-section-0e" class="fig-figure"><img id="zeMWzJBuMR" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_cross_section_0E-6e7a88cf6933d064344249f62ef10250.png" alt="Vertical cross-section through the atmosphere at 0°E (prime meridian).
Left: location map with the section meridian (red).
Centre: wind speed — the jet stream appears as the orange/red core at
40–60°N between 8 and 14 km altitude.
Right: temperature — the stratospheric warm layer above ~12 km and the
sharp temperature gradient across the jet are clearly visible." data-canonical-url="../../output/images/13_cross_section_0E.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-cross-section-0e" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->11<!-- -->:</a>Vertical cross-section through the atmosphere at 0°E (prime meridian).
<strong>Left:</strong> location map with the section meridian (red).
<strong>Centre:</strong> wind speed — the jet stream appears as the orange/red core at
40–60°N between 8 and 14 km altitude.
<strong>Right:</strong> temperature — the stratospheric warm layer above ~12 km and the
sharp temperature gradient across the jet are clearly visible.</p></figcaption></figure></div><div id="hCnIGrWTHV" class="myst-jp-nb-block relative group/block"><h3 id="animation-cross-sections-at-every-5-longitude" class="relative group"><span class="heading-text">Animation: cross-sections at every 5° longitude</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#animation-cross-sections-at-every-5-longitude" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The GIF below steps through all meridians in 5° increments, each frame
showing the wind-speed and temperature cross-section alongside a world map
that highlights the current longitude.</p><p>Watch the jet stream core (orange/red, 8–14 km) shift northward and
southward as the section rotates around the globe, tracing the Rossby-wave
meanders of the jet.</p></div><div id="atWuvLy1zU" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gif_frames_cs = []

for lon_cut in range(0, 360, 5):
    lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s = _cross_section_data(ds_pl, lon_cut)

    fig = plt.figure(figsize=(18, 5))
    gs  = fig.add_gridspec(1, 10, wspace=0.5)

    # Location map
    ax_map = fig.add_subplot(gs[0, :2], projection=ccrs.Robinson())
    ax_map.set_global()
    ax_map.add_feature(cfeature.OCEAN,     facecolor=&quot;aliceblue&quot;)
    ax_map.add_feature(cfeature.LAND,      facecolor=&quot;whitesmoke&quot;)
    ax_map.add_feature(cfeature.COASTLINE, linewidth=0.5)
    ax_map.plot([lon_plot, lon_plot], [-90, 90],
                color=&quot;crimson&quot;, linewidth=2.5,
                transform=ccrs.PlateCarree(), zorder=5)
    ax_map.set_title(
        f&quot;{lon_act:.0f}°E ({lon_plot:+.0f}°)&quot;,
        fontsize=9, color=&quot;crimson&quot;,
    )

    # Wind speed
    ax_w = fig.add_subplot(gs[0, 2:6])
    cf_w = ax_w.contourf(lat_2d, z_km_s, wspd_s,
                         levels=np.arange(0, 85, 5), cmap=&quot;YlOrRd&quot;, extend=&quot;max&quot;)
    ax_w.contour(lat_2d, z_km_s, wspd_s, levels=[30, 50, 70],
                 colors=&quot;black&quot;, linewidths=0.8, alpha=0.6)
    fig.colorbar(cf_w, ax=ax_w, fraction=0.04, pad=0.02,
                 aspect=25).set_label(&quot;Wind speed (m/s)&quot;, fontsize=9)
    _fmt_cross_axes(ax_w)
    ax_w.set_title(&quot;Wind speed&quot;, fontsize=10)

    # Temperature
    ax_t = fig.add_subplot(gs[0, 6:10], sharey=ax_w)
    cf_t = ax_t.contourf(lat_2d, z_km_s, t_s,
                         levels=np.arange(-80, 25, 5), cmap=&quot;RdBu_r&quot;, extend=&quot;both&quot;)
    ax_t.contour(lat_2d, z_km_s, t_s, levels=np.arange(-80, 25, 10),
                 colors=&quot;black&quot;, linewidths=0.6, alpha=0.5)
    fig.colorbar(cf_t, ax=ax_t, fraction=0.04, pad=0.02,
                 aspect=25).set_label(&quot;Temperature (°C)&quot;, fontsize=9)
    ax_t.set_xlabel(&quot;Latitude (°)&quot;, fontsize=9)
    ax_t.xaxis.set_major_formatter(mticker.FormatStrFormatter(&quot;%d°&quot;))
    ax_t.xaxis.set_major_locator(mticker.MultipleLocator(15))
    ax_t.grid(axis=&quot;x&quot;, linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
    ax_t.grid(axis=&quot;y&quot;, linewidth=0.4, color=&quot;gray&quot;, alpha=0.3, linestyle=&quot;:&quot;)
    ax_t.tick_params(labelleft=False)
    ax_t.set_title(&quot;Temperature&quot;, fontsize=10)

    fig.suptitle(
        f&quot;Vertical cross-section at {lon_act:.0f}°E ({lon_plot:+.0f}°)  —  &quot;
        f&quot;{DATE} 12:00 UTC  |  ERA5 reanalysis&quot;,
        fontsize=11,
    )
    fig.tight_layout()

    buf = io.BytesIO()
    fig.savefig(buf, format=&quot;png&quot;, dpi=90, bbox_inches=&quot;tight&quot;)
    plt.close(fig)
    buf.seek(0)
    gif_frames_cs.append(Image.open(buf).copy())
    print(f&quot;  cross-section frame: {lon_act:.0f}°E&quot;, end=&quot;\r&quot;)

out_gif_cs = paths.images_path / &quot;13_cross_section_animation.gif&quot;
gif_frames_cs[0].save(
    out_gif_cs,
    save_all=True,
    append_images=gif_frames_cs[1:],
    duration=200,   # ms per frame
    loop=0,
)
print(f&quot;\nsaved → {out_gif_cs.name}  ({len(gif_frames_cs)} frames)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="eUuJSCLPSwhK50MtNzVzz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 0°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 5°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 10°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 15°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 20°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 25°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 30°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 35°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 40°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 45°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 50°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 55°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 60°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 65°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 70°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 75°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 80°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 85°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 90°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 95°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 100°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 105°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 110°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 115°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 120°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 125°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 130°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 135°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 140°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 145°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 150°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 155°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 160°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 165°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 170°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 175°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 180°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 185°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 190°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 195°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 200°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 205°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 210°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 215°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 220°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 225°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 230°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 235°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 240°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 245°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 250°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 255°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 260°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 265°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 270°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 275°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 280°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 285°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 290°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 295°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 300°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 305°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 310°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 315°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 320°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 325°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 330°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 335°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 340°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 345°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 350°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  cross-section frame: 355°E</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
saved → 13_cross_section_animation.gif  (72 frames)
</span></code></pre></div></div></div></div><div id="RZ5ADjVOvT" class="myst-jp-nb-block relative group/block"><figure id="fig-13-cross-section-animation" class="fig-figure"><img id="kV470MJ1Om" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_cross_section_ani-c9d9196886036b3b8edd7b284f0419f4.gif" alt="Vertical cross-sections rotating around the globe in 5° steps.  Each frame
shows wind speed (centre) and temperature (right) vs. latitude and geopotential
height, paired with a world map highlighting the current meridian (red line).
The jet-stream core (orange/red at 8–14 km, 40–65°N) shifts north and south
with the Rossby-wave pattern as the section rotates — demonstrating the
jet’s three-dimensional tube-like shape encircling the Northern Hemisphere." data-canonical-url="../../output/images/13_cross_section_animation.gif" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-cross-section-animation" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->12<!-- -->:</a>Vertical cross-sections rotating around the globe in 5° steps.  Each frame
shows wind speed (centre) and temperature (right) vs. latitude and geopotential
height, paired with a world map highlighting the current meridian (red line).
The jet-stream core (orange/red at 8–14 km, 40–65°N) shifts north and south
with the Rossby-wave pattern as the section rotates — demonstrating the
jet’s three-dimensional tube-like shape encircling the Northern Hemisphere.</p></figcaption></figure></div><div id="RIwBEeHcLh" class="myst-jp-nb-block relative group/block"><h2 id="column-maximum-wind-speed" class="relative group"><span class="heading-text">Column-maximum wind speed</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#column-maximum-wind-speed" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By taking the <strong>maximum wind speed across all pressure levels</strong> at each
horizontal grid point, we collapse the full vertical structure into a single
map that highlights every location where the jet core passes — regardless
of its exact altitude.</p><p>Grid points where the jet tilts vertically or splits into multiple cores
are still captured, making this a robust indicator of the jet’s
horizontal footprint.</p></div><div id="hDNkiryPyp" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">u_all    = ds_pl[&quot;u_component_of_wind&quot;].squeeze()  # (level, lat, lon)
v_all    = ds_pl[&quot;v_component_of_wind&quot;].squeeze()
wspd_all = np.sqrt(u_all**2 + v_all**2)
wspd_max = wspd_all.max(dim=&quot;level&quot;)

print(f&quot;Column-max wind range: {float(wspd_max.min()):.1f}–{float(wspd_max.max()):.1f} m/s&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Nvr7LP2yIUV9dZcUwAhAp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Column-max wind range: 2.7–81.8 m/s
</span></code></pre></div></div></div></div><div id="bFBI6J8qWl" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">wspd_max_c, lons_max_c = add_cyclic_point(wspd_max.values, coord=lons_pl)

fig = plt.figure(figsize=(16, 8))
ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())
ax.set_global()

cf = ax.contourf(
    lons_max_c, lats_pl, wspd_max_c,
    levels=np.arange(0, 85, 5),
    cmap=&quot;YlOrRd&quot;, transform=ccrs.PlateCarree(), extend=&quot;max&quot;,
)

# Jet-stream footprint: contour line at 30 m/s threshold
ax.contour(
    lons_max_c, lats_pl, wspd_max_c,
    levels=[30],
    colors=[&quot;mediumpurple&quot;], linewidths=1.5,
    transform=ccrs.PlateCarree(),
)
legend_el = [mpatches.Patch(facecolor=&quot;mediumpurple&quot;, edgecolor=&quot;mediumpurple&quot;,
                             label=&quot;Jet-stream threshold (≥ 30 m/s)&quot;)]
ax.legend(handles=legend_el, loc=&quot;lower left&quot;, fontsize=10, framealpha=0.85)

ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=&quot;black&quot;)
ax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=&quot;black&quot;, alpha=0.7)
ax.add_feature(cfeature.OCEAN,     facecolor=&quot;aliceblue&quot;,  zorder=0)
ax.add_feature(cfeature.LAND,      facecolor=&quot;whitesmoke&quot;, zorder=0)

gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,
                  linewidth=0.4, color=&quot;gray&quot;, alpha=0.5, linestyle=&quot;--&quot;)
gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))
gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))

cbar = fig.colorbar(cf, ax=ax, orientation=&quot;horizontal&quot;,
                    pad=0.03, fraction=0.04, aspect=40)
cbar.set_label(&quot;Column-maximum wind speed (m/s)&quot;, fontsize=11)
cbar.ax.tick_params(labelsize=9)

ax.set_title(
    f&quot;Column-maximum wind speed (850–100 hPa)\n{DATE} 12:00 UTC  |  ERA5 reanalysis&quot;,
    fontsize=13, pad=10,
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;13_jet_colmax.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Dhj5-SSb88XWqWT18W5ys" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_151767/4078208183.py:46: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="qmR9c6e5o5" class="myst-jp-nb-block relative group/block"><figure id="fig-13-jet-colmax" class="fig-figure"><img id="GCfVt7MCZn" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/13_jet_colmax-a1333cf63885ae18d2e64e68cb987852.png" alt="Column-maximum wind speed from 850 to 100 hPa.  By collapsing all altitude
levels into a single value per grid point, this map shows the horizontal
footprint of the jet stream regardless of where it sits vertically.  The
purple contour marks the 30 m/s threshold commonly used to define the
jet-stream boundary.  In this summer snapshot, the jet is weaker than in
winter and displaced poleward, leaving a narrower and more fragmented footprint." data-canonical-url="../../output/images/13_jet_colmax.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-13-jet-colmax" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->13<!-- -->:</a>Column-maximum wind speed from 850 to 100 hPa.  By collapsing all altitude
levels into a single value per grid point, this map shows the <strong>horizontal
footprint</strong> of the jet stream regardless of where it sits vertically.  The
purple contour marks the 30 m/s threshold commonly used to define the
jet-stream boundary.  In this summer snapshot, the jet is weaker than in
winter and displaced poleward, leaving a narrower and more fragmented footprint.</p></figcaption></figure></div><div id="XnfUQujsL2" class="myst-jp-nb-block relative group/block"><h2 id="summary" class="relative group"><span class="heading-text">Summary</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#summary" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Combining the visualisations above builds a coherent picture of the jet
stream as a <strong>three-dimensional structure</strong>:</p><ul><li><p>At the <strong>surface</strong> (10 m wind, cloud cover, 2m temperature), the jet’s
influence is indirect — it steers cyclones and anticyclones that modulate
surface conditions.</p></li><li><p>In the <strong>mid-troposphere</strong> (500 hPa geopotential), the Rossby-wave pattern
shows the large-scale trough/ridge structure that the jet follows.</p></li><li><p>At <strong>jet-stream altitude</strong> (200–250 hPa), the fast core is concentrated
in a band 20–30° latitude wide, reaching 60–80 m/s in winter (weaker in
this June snapshot).</p></li><li><p><strong>Vertical cross-sections</strong> reveal the core sitting between ~8 and 14 km,
with the strongest winds near the tropopause (~200 hPa).</p></li><li><p>The <strong>polar view</strong> and <strong>column-maximum map</strong> show the jet’s horizontal
footprint as a ring around the Northern Hemisphere, punctuated by the
Rossby-wave meanders that connect upper-level dynamics to surface weather.</p></li></ul><p>For energy systems, the key takeaway is that wind and solar availability
across Europe depend critically on the current state of this three-dimensional
jet — its latitude, its strength, and whether it is blocked or meandering.</p></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/world-of-energy/notebooks/projections"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Weather</div>Map Projections — ERA5 2 m Temperature</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/world-of-energy/notebooks/germany-variations"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Weather</div>Weather Variability in Germany — Beyond the Seasonal Cycle</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/world-of-energy/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-XSZVU6CB.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/world-of-energy/build/root-DSHAHCKW.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-XFQAC62S.js"/><link rel="modulepreload" href="/world-of-energy/build/routes/$-NYGFW5Y3.js"/><script>window.__remixContext = {"url":"/notebooks/pressure-and-weather","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.0","options":{"favicon":"/world-of-energy/build/fav-dd7901f3f2cf8291caeff4207192226e.ico","logo":"/world-of-energy/build/logo-aeda1ffb023693e5d517d4bd730a35ad.png","folders":true},"nav":[],"actions":[],"projects":[{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"children":[{"file":"notebooks/03_smard_DE_prices.ipynb"},{"file":"notebooks/04_reconstruct_prices.ipynb"},{"file":"notebooks/05_load_seasonalities.ipynb"}],"title":"Electricity Prices"},{"children":[{"file":"notebooks/10_earth_seasons.ipynb"},{"file":"notebooks/12_projections.ipynb"},{"file":"notebooks/13_pressure_and_weather.ipynb"},{"file":"notebooks/17_germany_variations.ipynb"},{"file":"notebooks/18_nao_index.ipynb"},{"file":"notebooks/21_daily_jet_stream_animations.ipynb"}],"title":"Weather"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Electricity Prices"},{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5897d2d2ec58c9fc3341ae0ace50856b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-515875c959c281688fe9c9613ec1e24f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Weather"},{"slug":"notebooks.projections","title":"Map Projections — ERA5 2 m Temperature","description":"","date":"","thumbnail":"/world-of-energy/build/12_t2m_projections_o-458c35fb5ed415023332d684441d5a8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.pressure-and-weather","title":"Pressure Levels and the Jet Stream","description":"","date":"","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.germany-variations","title":"Weather Variability in Germany — Beyond the Seasonal Cycle","description":"","date":"","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nao-index","title":"Monthly ERA5 Reanalysis","description":"","date":"","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.daily-jet-stream-animations","title":"NAO and Jet Stream — Daily Evolution","description":"","date":"","thumbnail":"/world-of-energy/build/18_t2m_z500_2014-201-274e4fc869dc3f9bf6bb6a54f3cbd40c.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-9fcb1fdbd9556f4cf5f6a9c6156cb4a0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/world-of-energy"},"routes/$":{"config":{"version":3,"myst":"1.8.0","options":{"favicon":"/world-of-energy/build/fav-dd7901f3f2cf8291caeff4207192226e.ico","logo":"/world-of-energy/build/logo-aeda1ffb023693e5d517d4bd730a35ad.png","folders":true},"nav":[],"actions":[],"projects":[{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"children":[{"file":"notebooks/03_smard_DE_prices.ipynb"},{"file":"notebooks/04_reconstruct_prices.ipynb"},{"file":"notebooks/05_load_seasonalities.ipynb"}],"title":"Electricity Prices"},{"children":[{"file":"notebooks/10_earth_seasons.ipynb"},{"file":"notebooks/12_projections.ipynb"},{"file":"notebooks/13_pressure_and_weather.ipynb"},{"file":"notebooks/17_germany_variations.ipynb"},{"file":"notebooks/18_nao_index.ipynb"},{"file":"notebooks/21_daily_jet_stream_animations.ipynb"}],"title":"Weather"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Electricity Prices"},{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5897d2d2ec58c9fc3341ae0ace50856b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-515875c959c281688fe9c9613ec1e24f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Weather"},{"slug":"notebooks.projections","title":"Map Projections — ERA5 2 m Temperature","description":"","date":"","thumbnail":"/world-of-energy/build/12_t2m_projections_o-458c35fb5ed415023332d684441d5a8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.pressure-and-weather","title":"Pressure Levels and the Jet Stream","description":"","date":"","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.germany-variations","title":"Weather Variability in Germany — Beyond the Seasonal Cycle","description":"","date":"","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nao-index","title":"Monthly ERA5 Reanalysis","description":"","date":"","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.daily-jet-stream-animations","title":"NAO and Jet Stream — Daily Evolution","description":"","date":"","thumbnail":"/world-of-energy/build/18_t2m_z500_2014-201-274e4fc869dc3f9bf6bb6a54f3cbd40c.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-9fcb1fdbd9556f4cf5f6a9c6156cb4a0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":3,"kind":"Notebook","sha256":"d512a743e9a88552b4b4387c7b1a1da7c83f391e2bfc2467d86459b556adc696","slug":"notebooks.pressure-and-weather","location":"/notebooks/13_pressure_and_weather.ipynb","dependencies":[],"frontmatter":{"title":"Pressure Levels and the Jet Stream","content_includes_title":false,"kernelspec":{"name":"world-of-energy","display_name":"World of Energy","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","numbering":{"title":{"offset":1}},"source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/13_pressure_and_weather.ipynb","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/13_pressure_and_weather.ipynb","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","exports":[{"format":"ipynb","filename":"13_pressure_and_weather.ipynb","url":"/world-of-energy/build/13_pressure_and_weat-44041d1df367ab8bc8a3537292ffdf44.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The atmosphere is not just a flat layer of air — it has rich three-dimensional\nstructure.  Weather systems, temperature gradients, and especially the\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i4MQInYqVx"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"jet stream","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xutHmO1lL2"}],"key":"T6AexUMq02"},{"type":"text","value":" only make sense once you understand how the atmosphere is\nstacked vertically.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YxxAAvkBb7"}],"key":"cii2D9RBvN"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"This notebook explores that structure using ERA5 reanalysis data for a\nsingle snapshot (2025-06-03 12:00 UTC), combining surface observations with\npressure-level data to build an intuition for the jet stream as a\n","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qmGUM9UskO"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"three-dimensional tube of fast-moving air","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LGTuxwOfct"}],"key":"KCuhEGXHel"},{"type":"text","value":" circling the globe at\nroughly 10 km altitude.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Tal9g8tWiE"}],"key":"W57jaxDtej"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"We start at the surface, then work our way up through the atmosphere,\nbefore looking at vertical cross-sections that reveal the full 3D shape.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wwfWcpBas7"}],"key":"Yc4CAreEO6"}],"key":"zLzygpmWXF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:17.608454Z","iopub.status.busy":"2026-03-01T17:11:17.608362Z","iopub.status.idle":"2026-03-01T17:11:18.368706Z","shell.execute_reply":"2026-03-01T17:11:18.367941Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import io\n\nimport numpy as np\nimport xarray as xr\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as mticker\nimport matplotlib.patches as mpatches\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nfrom cartopy.util import add_cyclic_point\nfrom matplotlib.colors import LinearSegmentedColormap\nfrom PIL import Image\n\nfrom woe.paths import ProjPaths\n\npaths = ProjPaths()","key":"NurBSS1CFy"},{"type":"outputs","id":"JLpLso_7ZiG1Ub8TeSRbD","children":[],"key":"plQm3mKHzp"}],"key":"s42EoY7yAc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:18.370884Z","iopub.status.busy":"2026-03-01T17:11:18.370580Z","iopub.status.idle":"2026-03-01T17:11:18.472918Z","shell.execute_reply":"2026-03-01T17:11:18.472273Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"DATE = \"2025-06-03\"\nTIME = \"2025-06-03T12:00:00\"\nG = 9.80665  # standard gravity m/s²\n\nds_sfc = xr.open_dataset(paths.era5_snapshot_20250603_1200_surface_file)\nds_pl  = xr.open_dataset(paths.era5_snapshot_20250603_1200_pressure_file)\n\nprint(f\"Surface dimensions:        {dict(ds_sfc.dims)}\")\nprint(f\"Surface variables:         {list(ds_sfc.data_vars)}\")\nprint(f\"Pressure-level dimensions: {dict(ds_pl.dims)}\")\nprint(f\"Pressure-level variables:  {list(ds_pl.data_vars)}\")\nprint(f\"Pressure levels (hPa):     {sorted(ds_pl.level.values.tolist(), reverse=True)}\")","key":"sa87uHScMo"},{"type":"outputs","id":"a3OKgxjJPuI7km707cNWR","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Surface dimensions:        {'latitude': 721, 'longitude': 1440}\nSurface variables:         ['2m_temperature', '10m_u_component_of_wind', '10m_v_component_of_wind', 'mean_sea_level_pressure', 'total_precipitation', 'total_cloud_cover']\nPressure-level dimensions: {'level': 12, 'latitude': 721, 'longitude': 1440}\nPressure-level variables:  ['geopotential', 'temperature', 'u_component_of_wind', 'v_component_of_wind']\nPressure levels (hPa):     [850, 500, 400, 350, 300, 250, 225, 200, 175, 150, 125, 100]\n"},"children":[],"key":"ZZmin0Jsff"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/243307618.py:8: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  print(f\"Surface dimensions:        {dict(ds_sfc.dims)}\")\n/tmp/ipykernel_151767/243307618.py:10: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  print(f\"Pressure-level dimensions: {dict(ds_pl.dims)}\")\n"},"children":[],"key":"ynn7DYQePN"}],"key":"DlMGpxNvOM"}],"key":"MXdTKpdmhf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:18.474105Z","iopub.status.busy":"2026-03-01T17:11:18.473933Z","iopub.status.idle":"2026-03-01T17:11:18.520656Z","shell.execute_reply":"2026-03-01T17:11:18.519948Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# --- Surface fields ---\nt2m      = ds_sfc[\"2m_temperature\"].squeeze()\nt2m_c    = t2m - 273.15\nu10      = ds_sfc[\"10m_u_component_of_wind\"].squeeze()\nv10      = ds_sfc[\"10m_v_component_of_wind\"].squeeze()\nwspd10   = np.sqrt(u10**2 + v10**2)\ntcc      = ds_sfc[\"total_cloud_cover\"].squeeze()\n\nlats_sfc = ds_sfc.latitude.values\nlons_sfc = ds_sfc.longitude.values\n\n# --- Pressure-level fields ---\nlats_pl = ds_pl.latitude.values\nlons_pl = ds_pl.longitude.values\n\n# Levels sorted from high pressure (low altitude) → low pressure (high altitude)\nlevels_sorted = sorted(ds_pl.level.values.tolist(), reverse=True)\n\nu250   = ds_pl[\"u_component_of_wind\"].sel(level=250).squeeze()\nv250   = ds_pl[\"v_component_of_wind\"].sel(level=250).squeeze()\nwspd250 = np.sqrt(u250**2 + v250**2)\n\ngph500  = ds_pl[\"geopotential\"].sel(level=500).squeeze() / G  # metres\n\nprint(f\"2m temperature:    {float(t2m_c.min()):.1f}°C to {float(t2m_c.max()):.1f}°C\")\nprint(f\"10m wind speed:    {float(wspd10.min()):.1f}–{float(wspd10.max()):.1f} m/s\")\nprint(f\"250 hPa max wind:  {float(wspd250.max()):.1f} m/s\")\nprint(f\"500 hPa GPH range: {float(gph500.min()):.0f}–{float(gph500.max()):.0f} m\")","key":"C9GReKaVbR"},{"type":"outputs","id":"PT4g1kotRhxZtHRUZB5K-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"2m temperature:    -68.5°C to 46.0°C\n10m wind speed:    0.0–24.4 m/s\n250 hPa max wind:  81.7 m/s\n500 hPa GPH range: 4784–5959 m\n"},"children":[],"key":"KQnyWuUzeF"}],"key":"ZVZmclUQQH"}],"key":"vuqW82Imf7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Surface weather","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TUMX8ubSCW"}],"identifier":"surface-weather","label":"Surface weather","html_id":"surface-weather","implicit":true,"key":"Vq1TTYHkZu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Before climbing into the atmosphere, we look at what is happening at the\nEarth’s surface on this snapshot.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aV7njNQJSQ"}],"key":"tWSM6AxDrJ"}],"key":"NOAKIANV2m"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2m Temperature","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YeyWvDMGVy"}],"identifier":"id-2m-temperature","label":"2m Temperature","html_id":"id-2m-temperature","implicit":true,"key":"uK0EvgGuoJ"}],"key":"uokSHeozmO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:18.522067Z","iopub.status.busy":"2026-03-01T17:11:18.521981Z","iopub.status.idle":"2026-03-01T17:11:34.290624Z","shell.execute_reply":"2026-03-01T17:11:34.289867Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(16, 9), subplot_kw={\"projection\": ccrs.Robinson()})\n\nim = ax.pcolormesh(\n    lons_sfc, lats_sfc, t2m_c.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdYlBu_r\", vmin=-40, vmax=45, shading=\"auto\",\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\"--\")\nax.set_global()\nax.set_title(f\"ERA5 2m Temperature — {DATE} 12:00 UTC\", fontsize=14)\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.6)\ncbar.set_label(\"Temperature (°C)\")\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_surface_temperature.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"hGQ2BrqsLb"},{"type":"outputs","id":"w32nPWn1EZLVINnRiSCMt","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/760305152.py:18: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"Bzn1fRluKM"}],"key":"Z2XBXIV385"}],"key":"CbrJkXHoWM"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","alt":"ERA5 2m temperature on 2025-06-03 at 12:00 UTC.  The classic summer contrast\nbetween the warm continents (especially the Middle East and Central Asia) and the\ncooler oceans and polar regions is clearly visible.","data":{"altTextIsAutoGenerated":true},"key":"fGoqmldoLu","urlSource":"../../output/images/13_surface_temperature.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-surface-temperature","identifier":"fig-13-surface-temperature","html_id":"fig-13-surface-temperature","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"uvMVq0mfAa"},{"type":"text","value":"1","key":"w2xNhyYTyE"},{"type":"text","value":":","key":"lmvUSg3JU1"}],"template":"Figure %s:","key":"e2oSorp4pb"},{"type":"text","value":"ERA5 2m temperature on 2025-06-03 at 12:00 UTC.  The classic summer contrast\nbetween the warm continents (especially the Middle East and Central Asia) and the\ncooler oceans and polar regions is clearly visible.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x3Rkqug2JC"}],"key":"iE1WOZAPjP"}],"key":"azFP9EdYBO"}],"label":"fig-13-surface-temperature","identifier":"fig-13-surface-temperature","enumerator":"1","html_id":"fig-13-surface-temperature","key":"T1COHeJEj4"}],"key":"oITdouAJyp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10m Wind Speed","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XAwCSI09JQ"}],"identifier":"id-10m-wind-speed","label":"10m Wind Speed","html_id":"id-10m-wind-speed","implicit":true,"key":"a00ma9Ic7m"}],"key":"wruPHqv6oi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:34.292310Z","iopub.status.busy":"2026-03-01T17:11:34.292180Z","iopub.status.idle":"2026-03-01T17:11:50.574273Z","shell.execute_reply":"2026-03-01T17:11:50.573311Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"wspd10_c, lons10_c = add_cyclic_point(wspd10.values, coord=lons_sfc)\nu10_c, _           = add_cyclic_point(u10.values,    coord=lons_sfc)\nv10_c, _           = add_cyclic_point(v10.values,    coord=lons_sfc)\n\nstride     = 20  # 0.25° × 20 = 5° subsampling for arrows\nlons10_sub = lons10_c[::stride]\nlats10_sub = lats_sfc[::stride]\nu10_sub    = u10_c[::stride, ::stride]\nv10_sub    = v10_c[::stride, ::stride]\nwspd10_sub = np.sqrt(u10_sub**2 + v10_sub**2)\nwspd10_sub = np.where(wspd10_sub == 0, 1, wspd10_sub)\nu10_norm   = u10_sub / wspd10_sub\nv10_norm   = v10_sub / wspd10_sub\n\nfig = plt.figure(figsize=(16, 8))\nax = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\ncf = ax.contourf(\n    lons10_c, lats_sfc, wspd10_c,\n    levels=np.arange(0, 25, 2),\n    cmap=\"YlOrRd\", transform=ccrs.PlateCarree(), extend=\"max\",\n)\nax.quiver(\n    lons10_sub, lats10_sub, u10_norm, v10_norm,\n    transform=ccrs.PlateCarree(),\n    color=\"steelblue\", alpha=0.7, scale=80, width=0.002,\n    headwidth=3, headlength=3, headaxislength=3.75, regrid_shape=None,\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\")\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7)\nax.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\", zorder=0)\nax.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\", zorder=0)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90, 91,  30))\n\ncbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\", pad=0.03, fraction=0.04, aspect=40)\ncbar.set_label(\"10 m wind speed (m/s)\", fontsize=11)\nax.set_title(\n    f\"Surface wind — 10 m speed and direction\\n{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n    fontsize=13, pad=10,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_surface_wind.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"ZL80ZPEXi4"},{"type":"outputs","id":"EFhqrK-M0CHTUvmOMOidN","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Pl8D45WKzY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/2893093739.py:49: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"VVE9yeGIjG"}],"key":"EIlApSJwdQ"}],"key":"W2TlSsny4b"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_surface_wind-95319e4b3c6625c65805fc7e68e9fe0a.png","alt":"ERA5 10 m wind speed (filled contours) and direction (blue arrows) on\n2025-06-03 at 12:00 UTC.  The strongest surface winds are found over the\nstorm-track regions of the Southern Ocean and North Atlantic.  Blue arrows\nshow normalised wind direction; colour shows magnitude.","data":{"altTextIsAutoGenerated":true},"key":"Vi5TzIaIVl","urlSource":"../../output/images/13_surface_wind.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-surface-wind","identifier":"fig-13-surface-wind","html_id":"fig-13-surface-wind","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"sDDN2fRGJd"},{"type":"text","value":"2","key":"vT8g28rZua"},{"type":"text","value":":","key":"m4I2wb1DHn"}],"template":"Figure %s:","key":"j757Okec6o"},{"type":"text","value":"ERA5 10 m wind speed (filled contours) and direction (blue arrows) on\n2025-06-03 at 12:00 UTC.  The strongest surface winds are found over the\nstorm-track regions of the Southern Ocean and North Atlantic.  Blue arrows\nshow normalised wind direction; colour shows magnitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l6djuyjLFc"}],"key":"wG61f5Jb3M"}],"key":"haTcoOBCNI"}],"label":"fig-13-surface-wind","identifier":"fig-13-surface-wind","enumerator":"2","html_id":"fig-13-surface-wind","key":"Msu054QVMh"}],"key":"MsHBm2rWCH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cloud cover over satellite imagery","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BL9hCn7sOD"}],"identifier":"cloud-cover-over-satellite-imagery","label":"Cloud cover over satellite imagery","html_id":"cloud-cover-over-satellite-imagery","implicit":true,"key":"qxlVSr9bfA"}],"key":"ytpSJkk669"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:11:50.575513Z","iopub.status.busy":"2026-03-01T17:11:50.575416Z","iopub.status.idle":"2026-03-01T17:12:06.071669Z","shell.execute_reply":"2026-03-01T17:12:06.071010Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"cloud_cmap = LinearSegmentedColormap.from_list(\"clouds\", [\n    (1, 1, 1, 0),   # transparent where cloud-free\n    (1, 1, 1, 1),   # opaque white where fully overcast\n])\n\nfig, ax = plt.subplots(figsize=(16, 9), subplot_kw={\"projection\": ccrs.Robinson()})\nax.stock_img()\n\nax.pcolormesh(\n    lons_sfc, lats_sfc, tcc.values,\n    transform=ccrs.PlateCarree(),\n    cmap=cloud_cmap, vmin=0, vmax=1, shading=\"auto\",\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.4, color=\"0.3\")\nax.add_feature(cfeature.BORDERS,   linewidth=0.2, linestyle=\"--\", color=\"0.4\")\nax.set_global()\nax.set_title(f\"ERA5 Cloud Cover over Blue Marble — {DATE} 12:00 UTC\", fontsize=14)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_cloud_satellite.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"QQLY0cNwaD"},{"type":"outputs","id":"2IQzQKKddTZRkOSXivIBy","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Ju30y8Q4RA"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/880923943.py:21: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"nr0U22Yq7h"}],"key":"yPEji7Xgcx"}],"key":"a7uypZpSNK"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_cloud_satellite-b4737e22972b999986536e05ec4b5b7d.png","alt":"ERA5 total cloud cover overlaid on Blue Marble satellite imagery.  Cloud-free\nareas reveal the land/ocean surface; white patches mark frontal systems and\nconvective clouds over the tropics.","data":{"altTextIsAutoGenerated":true},"key":"zWhWgrTxIs","urlSource":"../../output/images/13_cloud_satellite.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-cloud-satellite","identifier":"fig-13-cloud-satellite","html_id":"fig-13-cloud-satellite","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"yFQv5rLI5D"},{"type":"text","value":"3","key":"MJw2jDTS2o"},{"type":"text","value":":","key":"UdtxvuxIff"}],"template":"Figure %s:","key":"lvi8gULMae"},{"type":"text","value":"ERA5 total cloud cover overlaid on Blue Marble satellite imagery.  Cloud-free\nareas reveal the land/ocean surface; white patches mark frontal systems and\nconvective clouds over the tropics.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KPwejoanjV"}],"key":"Ovz9RJLcWk"}],"key":"bPycrvcoqz"}],"label":"fig-13-cloud-satellite","identifier":"fig-13-cloud-satellite","enumerator":"3","html_id":"fig-13-cloud-satellite","key":"kkAJQgy4PB"}],"key":"l7uEoReHxx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What are pressure levels?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V1EBpJH4CO"}],"identifier":"what-are-pressure-levels","label":"What are pressure levels?","html_id":"what-are-pressure-levels","implicit":true,"key":"s920mCiL7B"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The atmosphere is divided into ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"frzBF84RGm"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"pressure levels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KiwtHbCGoz"}],"key":"sJvgsdG0ao"},{"type":"text","value":" — horizontal surfaces where\nair pressure has the same value everywhere.  Standard levels include\n1000 hPa (near sea level), 850 hPa (~1.5 km), 500 hPa (~5.5 km), and\n250 hPa (~10 km).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MIkmDEn7j9"}],"key":"y3RrpQsiDK"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"A crucial insight is that these surfaces are ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PGiU1tizDK"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"not flat","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OfaH6p3piP"}],"key":"b6xBl21B0J"},{"type":"text","value":".  Where the air\ncolumn is warm — and therefore expanded — a given pressure level sits\nhigher; where the air is cold and compressed, it sits lower.  These\nundulations (measured as ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ivQFW8uXcr"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"geopotential height","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"R5DAWllonl"}],"key":"XVXzJndtTc"},{"type":"text","value":", in metres) encode the\nlarge-scale temperature and pressure patterns that drive weather systems.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cSAft9mYxv"}],"key":"T5PKQyBzgD"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"The figure below shows the ERA5 data cross-sectioned along ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"lFxSJHSrDI"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"55°N","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"r2D2nSKktB"}],"key":"beHg5PqRY8"},{"type":"text","value":" — a\nlatitude that cuts through Iceland, the United Kingdom, central Europe,\nand central Russia.  Each coloured band is the atmospheric layer between\ntwo successive pressure levels.  Thicker bands indicate warmer (more\nexpanded) air; thinner bands indicate colder air.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"yUH4j25QLu"}],"key":"AGZrwzq01g"}],"key":"H8mbOxyAHm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:06.072999Z","iopub.status.busy":"2026-03-01T17:12:06.072897Z","iopub.status.idle":"2026-03-01T17:12:06.798397Z","shell.execute_reply":"2026-03-01T17:12:06.797626Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"LAT_TRANSECT = 55.0\n\n# Geopotential height in km at 55°N, all levels, all longitudes\ngph_transect = ds_pl[\"geopotential\"].sel(latitude=LAT_TRANSECT, method=\"nearest\").squeeze()\ngph_km       = gph_transect / G / 1000  # km\n\n# ERA5 uses 0–360° longitudes; convert to −180–180° and sort west→east\nlons_180 = np.where(lons_pl \u003e 180, lons_pl - 360, lons_pl)\nsort_idx  = np.argsort(lons_180)\nlons_sort = lons_180[sort_idx]\ngph_sort  = gph_km.isel(longitude=sort_idx)\n\n# Colour palette: cool (low levels, high pressure) → warm (high levels, low pressure)\nband_cmap   = plt.cm.coolwarm\nn_bands     = len(levels_sorted) - 1\nband_colors = [band_cmap(i / max(n_bands - 1, 1)) for i in range(n_bands)]\n\nfig = plt.figure(figsize=(22, 7))\ngs  = fig.add_gridspec(1, 5, wspace=0.45)\n\n# --- Left: world map showing the transect latitude ---\nax_map = fig.add_subplot(gs[0, :2], projection=ccrs.Robinson())\nax_map.set_global()\nax_map.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\")\nax_map.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\")\nax_map.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax_map.add_feature(cfeature.BORDERS,   linewidth=0.3, alpha=0.7)\nax_map.plot(\n    [-180, 180], [LAT_TRANSECT, LAT_TRANSECT],\n    color=\"crimson\", linewidth=2.5, transform=ccrs.PlateCarree(), zorder=5,\n)\nax_map.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                 linewidth=0.3, color=\"gray\", alpha=0.4, linestyle=\"--\")\nax_map.set_title(\n    f\"Cross-section location\\n(red line = {LAT_TRANSECT:.0f}°N)\",\n    fontsize=12, color=\"crimson\",\n)\n\n# --- Right: pressure level bands ---\nax_b = fig.add_subplot(gs[0, 2:])\n\nfor i in range(n_bands):\n    lower_lev = levels_sorted[i]       # higher pressure = lower altitude\n    upper_lev = levels_sorted[i + 1]   # lower pressure  = higher altitude\n    lower_h   = gph_sort.sel(level=lower_lev).values\n    upper_h   = gph_sort.sel(level=upper_lev).values\n    ax_b.fill_between(lons_sort, lower_h, upper_h,\n                      color=band_colors[i], alpha=0.65)\n\n# Pressure-surface lines and labels\nfor lev in levels_sorted:\n    h = gph_sort.sel(level=lev).values\n    ax_b.plot(lons_sort, h, color=\"black\", linewidth=0.8, alpha=0.7)\n    ax_b.text(lons_sort[-1] + 2, h[-1], f\" {lev} hPa\",\n              va=\"center\", fontsize=8, fontweight=\"bold\")\n\n# Shade the jet-stream zone (250–200 hPa) with a thin annotation\njet_low  = gph_sort.sel(level=250).values.mean()\njet_high = gph_sort.sel(level=200).values.mean()\nax_b.axhspan(jet_low, jet_high, color=\"gold\", alpha=0.25, zorder=0)\nax_b.text(lons_sort[0] + 2, (jet_low + jet_high) / 2,\n          \"← jet stream zone\", va=\"center\", fontsize=9,\n          color=\"goldenrod\", fontweight=\"bold\")\n\nax_b.set_xlabel(\"Longitude (°E)\", fontsize=12)\nax_b.set_ylabel(\"Geopotential height (km)\", fontsize=12)\nax_b.set_xlim(lons_sort.min(), lons_sort.max() + 14)\nax_b.grid(True, alpha=0.2)\nax_b.set_title(\n    f\"Atmospheric layers along {LAT_TRANSECT:.0f}°N — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_pressure_bands.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"nrEHJPD5e3"},{"type":"outputs","id":"SP9tJcqflmiKVDJt62GNp","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/388062872.py:74: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"MGcVvokmXY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/388062872.py:76: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"jEqmhzPvOg"}],"key":"ZOIVnEmAF5"}],"key":"mlJrWXvzAZ"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_pressure_bands-30e8a9eba5d5bf4385f5bf78696e67d2.png","alt":"Left: world map showing the cross-section location (red line = 55°N).\nRight: atmospheric layers along 55°N.  Each coloured band represents the\nlayer between two pressure levels; black lines are the actual geopotential\nheight of each surface.  Thicker bands indicate warmer (expanded) air.  The\ngold shading marks the jet-stream zone (~200–250 hPa, ~10–12 km altitude).\nNote how the pressure surfaces undulate by hundreds of metres — these waves\nare the Rossby waves that steer surface weather systems.","data":{"altTextIsAutoGenerated":true},"key":"wwvHqCkas6","urlSource":"../../output/images/13_pressure_bands.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-pressure-bands","identifier":"fig-13-pressure-bands","html_id":"fig-13-pressure-bands","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"SBZzmsGVtN"},{"type":"text","value":"4","key":"W37kZlSJnF"},{"type":"text","value":":","key":"L41aPK0SnB"}],"template":"Figure %s:","key":"ykIeS5kRXn"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Left:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JWbGLXEGkB"}],"key":"p0wTbEwEmX"},{"type":"text","value":" world map showing the cross-section location (red line = 55°N).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JYfvIGtjRu"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Right:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ILS6QeVKmc"}],"key":"HzStjow3ky"},{"type":"text","value":" atmospheric layers along 55°N.  Each coloured band represents the\nlayer between two pressure levels; black lines are the actual geopotential\nheight of each surface.  Thicker bands indicate warmer (expanded) air.  The\ngold shading marks the jet-stream zone (~200–250 hPa, ~10–12 km altitude).\nNote how the pressure surfaces undulate by hundreds of metres — these waves\nare the Rossby waves that steer surface weather systems.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BgHglP8Git"}],"key":"OjGD8tsitt"}],"key":"aeEJ5ksgB9"}],"label":"fig-13-pressure-bands","identifier":"fig-13-pressure-bands","enumerator":"4","html_id":"fig-13-pressure-bands","key":"PCtQMQ6xPK"}],"key":"ozgmO0Sk31"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The jet stream in 2D","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WfcoAYuauC"}],"identifier":"the-jet-stream-in-2d","label":"The jet stream in 2D","html_id":"the-jet-stream-in-2d","implicit":true,"key":"gKn87Tg7sL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N0m2U6F3Se"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"jet stream","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CPf5eqOXHA"}],"key":"HzKp7HXPEi"},{"type":"text","value":" is a narrow corridor of fast-moving air located near the\ntropopause, typically at 250 hPa (~10 km altitude).  Two jets exist in each\nhemisphere:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j6gNAao4bf"}],"key":"SqWKWxP4Es"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Polar front jet","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IFtyYHUK2L"}],"key":"uBsP0Aufml"},{"type":"text","value":" (~50–65°): marks the boundary between cold polar air\nand warmer mid-latitude air.  Its meanders steer surface weather systems.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oBwTq22T53"}],"key":"pkzS6JaIM1"}],"key":"rEtlHpB2oQ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Subtropical jet","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"P37LL7aFf8"}],"key":"uxdiwJ8CMX"},{"type":"text","value":" (~25–35°): driven by the Hadley cell; typically\nstronger in winter, weaker in summer.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"py17jj7hxU"}],"key":"BtcSVEUUXi"}],"key":"Q6fZYgC0BB"}],"key":"qaBj4OKZoH"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"On a summer snapshot like ours (June), the polar jet is weaker and displaced\npoleward.  We visualise it in two ways:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cEkwIcr6Jv"}],"key":"r79yYEJAnI"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Global Robinson map","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bM9aLkzzt6"}],"key":"Vkgv20uozY"},{"type":"text","value":" — 250 hPa wind speed in colour, with 500 hPa\ngeopotential height as contour lines to show the pressure wave pattern.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JXcvTnNt2W"}],"key":"LlBdJlduYy"}],"key":"VGqq48FhpY"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Polar (top-down) view","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iWYItJ4og7"}],"key":"lTZDDyvyvy"},{"type":"text","value":" — shows the jet stream as a ring around the\nNorth Pole.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Sb3rQ1uvlm"}],"key":"UlH6eqre4b"}],"key":"BoCLPt3g36"}],"key":"bhle0Sooad"}],"key":"a8ZeLKR6nQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global view: 250 hPa wind + 500 hPa geopotential","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V2RNvPvnaD"}],"identifier":"global-view-250-hpa-wind-500-hpa-geopotential","label":"Global view: 250 hPa wind + 500 hPa geopotential","html_id":"global-view-250-hpa-wind-500-hpa-geopotential","implicit":true,"key":"U8HRK2nN2j"}],"key":"HHbqEGSaIF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:06.799768Z","iopub.status.busy":"2026-03-01T17:12:06.799675Z","iopub.status.idle":"2026-03-01T17:12:17.329816Z","shell.execute_reply":"2026-03-01T17:12:17.329087Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"wspd250_c, lons250_c = add_cyclic_point(wspd250.values, coord=lons_pl)\ngph500_c,  _         = add_cyclic_point(gph500.values,  coord=lons_pl)\n\n# Geopotential-height contour levels in 80 m steps\nz500_levels = np.arange(\n    np.floor(float(gph500.min()) / 100) * 100,\n    np.ceil(float(gph500.max())  / 100) * 100 + 1,\n    80,\n)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\ncf = ax.contourf(\n    lons250_c, lats_pl, wspd250_c,\n    levels=np.arange(0, 85, 5),\n    cmap=\"hot_r\", transform=ccrs.PlateCarree(), extend=\"max\",\n)\ncs = ax.contour(\n    lons250_c, lats_pl, gph500_c,\n    levels=z500_levels,\n    colors=\"steelblue\", linewidths=0.8, alpha=0.7,\n    transform=ccrs.PlateCarree(),\n)\nax.clabel(cs, fmt=\"%d m\", fontsize=7, inline=True)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\")\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\ncbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\", pad=0.04, shrink=0.6)\ncbar.set_label(\"250 hPa wind speed (m/s)\")\nax.set_title(\n    f\"250 hPa wind speed + 500 hPa geopotential height — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_z500_wind250.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"TJ3trwNZj0"},{"type":"outputs","id":"RdD9onute8zQJhsDv2nTx","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/2006442886.py:45: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"hnWlCje24J"}],"key":"nh72jppAL4"}],"key":"hAhILxHsKE"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_z500_wind250-0f7e57f53197eaee4c792829f98046a4.png","alt":"250 hPa wind speed (filled, hot colourmap) with 500 hPa geopotential height\ncontours (blue lines, labelled in metres).  The jet stream appears as the orange/red\nband encircling the mid-latitudes.  The 500 hPa contours reveal the trough/ridge\nwave pattern that the jet stream follows: the jet accelerates through troughs\n(low geopotential) and decelerates through ridges (high geopotential).","data":{"altTextIsAutoGenerated":true},"key":"soJ6nbJ3BS","urlSource":"../../output/images/13_z500_wind250.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-z500-wind250","identifier":"fig-13-z500-wind250","html_id":"fig-13-z500-wind250","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"PWI9ZdMgwB"},{"type":"text","value":"5","key":"rgpJV4wpfb"},{"type":"text","value":":","key":"ut5jurWY9O"}],"template":"Figure %s:","key":"Cxzlun1Wjn"},{"type":"text","value":"250 hPa wind speed (filled, hot colourmap) with 500 hPa geopotential height\ncontours (blue lines, labelled in metres).  The jet stream appears as the orange/red\nband encircling the mid-latitudes.  The 500 hPa contours reveal the trough/ridge\nwave pattern that the jet stream follows: the jet accelerates through troughs\n(low geopotential) and decelerates through ridges (high geopotential).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u4KasUBo2E"}],"key":"pClF5xlnxz"}],"key":"yYEFBGyxYw"}],"label":"fig-13-z500-wind250","identifier":"fig-13-z500-wind250","enumerator":"5","html_id":"fig-13-z500-wind250","key":"M49C1cCcPA"}],"key":"s3qfIGK5t7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"500 hPa geopotential + 250 hPa jet stream footprint","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rnuu5JLEHz"}],"identifier":"id-500-hpa-geopotential-250-hpa-jet-stream-footprint","label":"500 hPa geopotential + 250 hPa jet stream footprint","html_id":"id-500-hpa-geopotential-250-hpa-jet-stream-footprint","implicit":true,"key":"JeNhz9EU8k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The same Z500 wave pattern as above, but now the 250 hPa wind speed is\ncollapsed to a binary mask: grid points where the jet core exceeds 30 m/s\nare filled in purple, while slower regions are transparent.  This style —\nborrowed from operational meteorological charts — immediately shows the\njet-stream corridor without the distraction of a continuous colour scale.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JNDk0aJCTG"}],"key":"SRa67aECwk"}],"key":"cwtEgnEUB8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:17.331260Z","iopub.status.busy":"2026-03-01T17:12:17.331159Z","iopub.status.idle":"2026-03-01T17:12:20.617587Z","shell.execute_reply":"2026-03-01T17:12:20.616596Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"JET_THRESHOLD = 30  # m/s — standard meteorological jet-stream criterion\n\n# Reuse cyclic arrays already computed above\nz500_levels   = np.arange(\n    np.floor(float(gph500.min()) / 60) * 60,\n    np.ceil(float(gph500.max())  / 60) * 60 + 1,\n    80,\n)\njet_masked_c = np.where(wspd250_c \u003e= JET_THRESHOLD, wspd250_c, np.nan)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\nax.add_feature(cfeature.OCEAN, facecolor=\"#d0e8f5\", zorder=0)\nax.add_feature(cfeature.LAND,  facecolor=\"#f0ede8\", zorder=0)\n\ncs = ax.contour(\n    lons250_c, lats_pl, gph500_c,\n    levels=z500_levels, colors=\"black\", linewidths=0.6,\n    transform=ccrs.PlateCarree(), zorder=3,\n)\nax.clabel(cs, fmt=\"%d m\", fontsize=7, inline=True, inline_spacing=3)\n\nax.contourf(\n    lons250_c, lats_pl, jet_masked_c,\n    levels=[JET_THRESHOLD, 300], colors=[\"mediumpurple\"], alpha=0.75,\n    transform=ccrs.PlateCarree(), zorder=4,\n)\nax.contour(\n    lons250_c, lats_pl, wspd250_c,\n    levels=[JET_THRESHOLD], colors=[\"rebeccapurple\"], linewidths=1.0,\n    transform=ccrs.PlateCarree(), zorder=5,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\", zorder=6)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7, zorder=6)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\nax.legend(\n    handles=[mpatches.Patch(facecolor=\"mediumpurple\", edgecolor=\"rebeccapurple\",\n                            alpha=0.75, label=f\"Jet stream ≥ {JET_THRESHOLD} m/s  (250 hPa)\")],\n    loc=\"lower left\", fontsize=10, framealpha=0.85,\n)\nax.set_title(\n    f\"500 hPa geopotential height (contours) + jet stream footprint — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_z500_jet_purple.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"zJsWMDRlTK"},{"type":"outputs","id":"8QCa9IsSoFGefX6WkP_WY","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"nhtgYwx2Xt"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/786794077.py:56: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"SBGFwiCTli"}],"key":"LpunPMBhF7"}],"key":"t3BqzHHoMt"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_z500_jet_purple-228b4cb0a74df55c77412e4fa44fed5f.png","alt":"500 hPa geopotential height (black contours, labelled in metres) with the\n250 hPa jet stream footprint (purple, ≥ 30 m/s).  The jet hugs the steepest\ngeopotential gradient, flowing fastest where contours are most tightly packed.\nTroughs (contours bending equatorward) and ridges (bending poleward) mark\nthe Rossby-wave pattern that steers the jet.","data":{"altTextIsAutoGenerated":true},"key":"btKFFBaXjf","urlSource":"../../output/images/13_z500_jet_purple.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-z500-jet-purple","identifier":"fig-13-z500-jet-purple","html_id":"fig-13-z500-jet-purple","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"o5P72kfgme"},{"type":"text","value":"6","key":"IZ8FRBx9Vx"},{"type":"text","value":":","key":"pUhPMffABI"}],"template":"Figure %s:","key":"HIFHr9xUZ0"},{"type":"text","value":"500 hPa geopotential height (black contours, labelled in metres) with the\n250 hPa jet stream footprint (purple, ≥ 30 m/s).  The jet hugs the steepest\ngeopotential gradient, flowing fastest where contours are most tightly packed.\nTroughs (contours bending equatorward) and ridges (bending poleward) mark\nthe Rossby-wave pattern that steers the jet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GB3zDsneD2"}],"key":"jjq6sN4SP5"}],"key":"aydJ2AbWAx"}],"label":"fig-13-z500-jet-purple","identifier":"fig-13-z500-jet-purple","enumerator":"6","html_id":"fig-13-z500-jet-purple","key":"RNdhe1di2I"}],"key":"vNfCh4WxT6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2m temperature + 500 hPa geopotential contours","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ca08hf7tbU"}],"identifier":"id-2m-temperature-500-hpa-geopotential-contours","label":"2m temperature + 500 hPa geopotential contours","html_id":"id-2m-temperature-500-hpa-geopotential-contours","implicit":true,"key":"h3rwhJGC41"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The Z500 wave pattern also reflects the surface temperature distribution —\nwarm air expands the lower troposphere and pushes pressure surfaces higher,\nwhile cold air compresses them.  Overlaying Z500 contours on 2m temperature\nmakes this connection explicit: ridges (high Z500) sit over warm air masses,\ntroughs (low Z500) over cold ones.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gYacH2fwdd"}],"key":"dNt2Wytrwa"}],"key":"X1MlhSNXau"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:20.619241Z","iopub.status.busy":"2026-03-01T17:12:20.619147Z","iopub.status.idle":"2026-03-01T17:12:36.817497Z","shell.execute_reply":"2026-03-01T17:12:36.816594Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"t2m_c_cyc, lons_t2m_c = add_cyclic_point(t2m_c.values, coord=lons_sfc)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\nim = ax.pcolormesh(\n    lons_t2m_c, lats_sfc, t2m_c_cyc,\n    cmap=\"RdBu_r\", vmin=-40, vmax=45,\n    transform=ccrs.PlateCarree(), shading=\"auto\",\n)\ncs = ax.contour(\n    lons250_c, lats_pl, gph500_c,\n    levels=z500_levels, colors=\"black\", linewidths=0.6,\n    transform=ccrs.PlateCarree(), zorder=3,\n)\nax.clabel(cs, fmt=\"%d m\", fontsize=7, inline=True, inline_spacing=3)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"0.15\", zorder=4)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\", color=\"0.35\", zorder=4)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.6)\ncbar.set_label(\"2m temperature (°C)\")\nax.set_title(\n    f\"500 hPa geopotential height (contours) + 2m temperature — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_t2m_z500.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"M3b8kWeKlJ"},{"type":"outputs","id":"YpJJE2Z5cQA6_xbfg1tu8","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"NuzHZwPjT6"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/3147655083.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"roBZRlyCql"}],"key":"w0UcnhDXQw"}],"key":"MoxDba0wYD"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_t2m_z500-03a08c92a8fe1b764b26a85c48826cd4.png","alt":"2m temperature (filled, red–blue scale) with 500 hPa geopotential height\ncontours (black).  Ridges (contours arching poleward) align with warm air\nmasses; troughs (contours dipping equatorward) sit over cold air.  The\ntight coupling between the upper-level wave pattern and the surface\ntemperature field is a key driver of both weather and energy demand.","data":{"altTextIsAutoGenerated":true},"key":"msrBJd3jq8","urlSource":"../../output/images/13_t2m_z500.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-t2m-z500","identifier":"fig-13-t2m-z500","html_id":"fig-13-t2m-z500","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"g15K3a6Wbh"},{"type":"text","value":"7","key":"FRCWfANcI8"},{"type":"text","value":":","key":"MZPOKwZHDA"}],"template":"Figure %s:","key":"gjarTl9KUZ"},{"type":"text","value":"2m temperature (filled, red–blue scale) with 500 hPa geopotential height\ncontours (black).  Ridges (contours arching poleward) align with warm air\nmasses; troughs (contours dipping equatorward) sit over cold air.  The\ntight coupling between the upper-level wave pattern and the surface\ntemperature field is a key driver of both weather and energy demand.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AnCzKLBcef"}],"key":"G6w38WzWVr"}],"key":"PLhbgmtx26"}],"label":"fig-13-t2m-z500","identifier":"fig-13-t2m-z500","enumerator":"7","html_id":"fig-13-t2m-z500","key":"LPPiY7MMN3"}],"key":"owYC9iX8Jg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2m temperature with 250 hPa jet stream core overlay","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h6cmhzN81b"}],"identifier":"id-2m-temperature-with-250-hpa-jet-stream-core-overlay","label":"2m temperature with 250 hPa jet stream core overlay","html_id":"id-2m-temperature-with-250-hpa-jet-stream-core-overlay","implicit":true,"key":"h5Wo5njWhR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The jet stream is the boundary between cold polar air and warm subtropical\nair.  Overlaying the jet core (\u003e 30 m/s, shown here as a white band that\nbrightens with wind speed) directly on the 2m temperature field makes this\nair-mass boundary visible: north of the jet lies colder, denser polar air;\nsouth of it lies warmer subtropical air.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lJpDgLR6V1"}],"key":"BhryrtLjTo"}],"key":"Qt2G3cumrF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:36.819157Z","iopub.status.busy":"2026-03-01T17:12:36.819053Z","iopub.status.idle":"2026-03-01T17:12:53.522681Z","shell.execute_reply":"2026-03-01T17:12:53.521774Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"jet_core_c  = np.where(wspd250_c \u003e JET_THRESHOLD, wspd250_c, np.nan)\njet_core_cmap = LinearSegmentedColormap.from_list(\"jet_core\", [\n    (0.2, 0.2, 0.2, 0.6),  # dark grey, semi-transparent at threshold\n    (1.0, 1.0, 1.0, 1.0),  # bright white at 80 m/s\n])\n\nfig = plt.figure(figsize=(16, 9))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\nim_temp = ax.pcolormesh(\n    lons_t2m_c, lats_sfc, t2m_c_cyc,\n    cmap=\"RdYlBu_r\", vmin=-40, vmax=45,\n    transform=ccrs.PlateCarree(), shading=\"auto\",\n)\nax.pcolormesh(\n    lons250_c, lats_pl, jet_core_c,\n    cmap=jet_core_cmap, vmin=JET_THRESHOLD, vmax=80,\n    transform=ccrs.PlateCarree(), shading=\"auto\",\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\")\n\ncbar = fig.colorbar(im_temp, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.6)\ncbar.set_label(\"Temperature (°C)\")\nax.set_title(\n    f\"2m temperature with jet stream core (\u003e {JET_THRESHOLD} m/s at 250 hPa) — {DATE} 12:00 UTC\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_t2m_jet_core.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"WoG3rgtbQi"},{"type":"outputs","id":"61IKt38cu7Z6lljfIYIfU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/2907177902.py:34: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"HSJk6Go1Xl"}],"key":"r3w5AIkSbO"}],"key":"hXuMUMpqCR"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_t2m_jet_core-5b7161509dd6ee9fbf9cc498a527393c.png","alt":"2m temperature (filled, RdYlBu_r) with the 250 hPa jet stream core overlaid\nas a white band (brightening with wind speed above 30 m/s).  The jet marks\nthe sharp boundary between cold polar air to the north and warm subtropical\nair to the south — a boundary that in winter can be associated with\ntemperature differences of 20–30 °C over just a few degrees of latitude.","data":{"altTextIsAutoGenerated":true},"key":"YgucpfPok2","urlSource":"../../output/images/13_t2m_jet_core.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-t2m-jet-core","identifier":"fig-13-t2m-jet-core","html_id":"fig-13-t2m-jet-core","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"dA0yY1K6Ts"},{"type":"text","value":"8","key":"pLDdyINdL4"},{"type":"text","value":":","key":"VFgA9bOLKh"}],"template":"Figure %s:","key":"c9fJGuIE27"},{"type":"text","value":"2m temperature (filled, RdYlBu_r) with the 250 hPa jet stream core overlaid\nas a white band (brightening with wind speed above 30 m/s).  The jet marks\nthe sharp boundary between cold polar air to the north and warm subtropical\nair to the south — a boundary that in winter can be associated with\ntemperature differences of 20–30 °C over just a few degrees of latitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H37uaZVUPu"}],"key":"SBDzTUtLUw"}],"key":"HjkiKPuoS3"}],"label":"fig-13-t2m-jet-core","identifier":"fig-13-t2m-jet-core","enumerator":"8","html_id":"fig-13-t2m-jet-core","key":"joOVxFZY2a"}],"key":"nQ7rmPAvZ5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Polar view: the jet stream as a ring around the North Pole","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCkg2kqDSu"}],"identifier":"polar-view-the-jet-stream-as-a-ring-around-the-north-pole","label":"Polar view: the jet stream as a ring around the North Pole","html_id":"polar-view-the-jet-stream-as-a-ring-around-the-north-pole","implicit":true,"key":"JRdmAWtf5s"}],"key":"hgduZBduZS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:12:53.523917Z","iopub.status.busy":"2026-03-01T17:12:53.523827Z","iopub.status.idle":"2026-03-01T17:13:03.650063Z","shell.execute_reply":"2026-03-01T17:13:03.649202Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Subsample for streamlines (dense grids overwhelm cartopy's streamplot)\nstep  = 8\nlons_sub = u250.longitude.values[::step]\nlats_sub = lats_pl[::step]\nu_sub    = u250.values[::step, ::step]\nv_sub    = v250.values[::step, ::step]\n\nfig, ax = plt.subplots(\n    figsize=(10, 10),\n    subplot_kw={\"projection\": ccrs.NorthPolarStereo()},\n)\n\nim = ax.pcolormesh(\n    lons_pl, lats_pl, wspd250.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"hot_r\", vmin=0, vmax=80, shading=\"auto\",\n)\nax.streamplot(\n    lons_sub, lats_sub, u_sub, v_sub,\n    transform=ccrs.PlateCarree(),\n    color=\"white\", linewidth=0.5, density=1.5, arrowsize=0.8,\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.5)\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, linestyle=\"--\")\nax.set_extent([-180, 180, 20, 90], crs=ccrs.PlateCarree())\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, shrink=0.7)\ncbar.set_label(\"250 hPa wind speed (m/s)\")\nax.set_title(\n    f\"Jet stream viewed from above — 250 hPa\\n{DATE} 12:00 UTC  |  ERA5\",\n    fontsize=13,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_jet_stream_polar.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"GSnmtWblYB"},{"type":"outputs","id":"CrKsTU-4p1ZV_2GfXMq3U","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/1322210975.py:36: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"HCqD7YsAq2"}],"key":"LH7S76z8r1"}],"key":"o6r0o1YWil"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_jet_stream_polar-1a30fbe8dd3c3babcc4fb680f07e0c90.png","alt":"The Northern Hemisphere jet stream viewed from directly above the North Pole\n(North Polar Stereographic projection).  Wind speed at 250 hPa is shown in\ncolour; white streamlines indicate wind direction.  The jet stream traces an\nirregular ring around the pole, with Rossby-wave meanders visible as north–south\nexcursions.  This “ring” perspective makes it clear why the jet stream is\nsometimes described as a three-dimensional tube encircling the planet.","data":{"altTextIsAutoGenerated":true},"key":"Ohxoxh0yve","urlSource":"../../output/images/13_jet_stream_polar.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-jet-stream-polar","identifier":"fig-13-jet-stream-polar","html_id":"fig-13-jet-stream-polar","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"mWkaOYnovd"},{"type":"text","value":"9","key":"hoz9S4YMQ5"},{"type":"text","value":":","key":"ACq5eZ82k4"}],"template":"Figure %s:","key":"PaZ42LEBMV"},{"type":"text","value":"The Northern Hemisphere jet stream viewed from directly above the North Pole\n(North Polar Stereographic projection).  Wind speed at 250 hPa is shown in\ncolour; white streamlines indicate wind direction.  The jet stream traces an\nirregular ring around the pole, with Rossby-wave meanders visible as north–south\nexcursions.  This “ring” perspective makes it clear why the jet stream is\nsometimes described as a three-dimensional tube encircling the planet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VoLWGPLP5b"}],"key":"FB9OBiTayP"}],"key":"XOcqPR6kQT"}],"label":"fig-13-jet-stream-polar","identifier":"fig-13-jet-stream-polar","enumerator":"9","html_id":"fig-13-jet-stream-polar","key":"x69HS8dObU"}],"key":"tPcbBbFVzt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Jet stream across altitude levels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GXYwJczgCJ"}],"identifier":"jet-stream-across-altitude-levels","label":"Jet stream across altitude levels","html_id":"jet-stream-across-altitude-levels","implicit":true,"key":"QbBqDUR4Bs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The figures above show the jet stream at a single pressure level (250 hPa).\nBut the jet has ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BOXYyBeSpK"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"vertical extent","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uDOf0qm0ZC"}],"key":"xoKJ4ivByJ"},{"type":"text","value":" — it intensifies from the mid-troposphere\nupward through the tropopause, then weakens in the stratosphere above.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eSq181Ff1b"}],"key":"T3U4W95URW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The animation below steps through all available pressure levels from\n850 hPa (~1.5 km, near-surface) to 100 hPa (~16 km, lower stratosphere).\nWatch how the fast-moving core (red/orange) emerges at mid-tropospheric\nlevels, peaks near 200–250 hPa, then fades in the stratosphere above.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j0yYz4k5dL"}],"key":"X2IiNkQ1kg"},{"type":"table","position":{"start":{"line":12,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Level (hPa)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qumowElKiL"}],"key":"w67ElxMUb8"},{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Approx. altitude","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EZ2J68Inor"}],"key":"AqkcDsxopx"},{"type":"tableCell","header":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"H6DPLEMfYb"}],"key":"PjvD8g168Q"}],"key":"VUpIhLr4a4"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"850","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zBrfsVcA8z"}],"key":"jGZV4CNPMN"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"~1.5 km","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mmUcpKPVxZ"}],"key":"dDdDlQ1dep"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"lower troposphere","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CjUT5wCyab"}],"key":"rl5Rmor2lS"}],"key":"dZzhSB51JE"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"500","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TfijaCxPGf"}],"key":"S0julHypZs"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"~5.5 km","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"WR3Dukn1GV"}],"key":"g61skgvVkU"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"mid-troposphere","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Iy9A5mQKfz"}],"key":"WGl8SImw2z"}],"key":"OF2oYSx3kW"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"400","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"h9EE4lFUmk"}],"key":"iztUUTGPxq"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"~7 km","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"XfJKa6YzPd"}],"key":"tUvkHixM7o"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"mid-troposphere","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"WKgXggl6fq"}],"key":"rU4hUcIkMu"}],"key":"B9s3xLPDzx"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"350","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"fPteNV3oXn"}],"key":"exo173ec3W"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"~8 km","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Xs5oqpcDl9"}],"key":"KDATtsnNYK"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"upper troposphere","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nntaXJVC9S"}],"key":"p4R2PkKAuR"}],"key":"D0TYJUYp0g"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"300","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SWTJ1zcAx3"}],"key":"k6xCYNf3Iv"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"~9 km","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"udGQpO3KnO"}],"key":"EF4x2bZ5aO"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"upper troposphere","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"PK7gKC5KNv"}],"key":"J8pbm7d7lY"}],"key":"EMHp6SM1Cc"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"250","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BR5N8zQ14j"}],"key":"OJnfcwW6ri"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"~10 km","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gNFlyCUJaj"}],"key":"Fv1lLPrpJQ"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"jet-stream core","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Mvm8YidY5C"}],"key":"CoFlhowur1"}],"key":"t8f6lB0ycX"}],"key":"nhTYAB89BT"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"225","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"LpiwNI7cWP"}],"key":"fOUwNALI5b"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"~11 km","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"tSzmPlb0fd"}],"key":"l3iRkJJF1p"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"jet-stream core","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"yc65myi5M5"}],"key":"X5LuNdzvng"}],"key":"ms6GMB72Kd"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"200","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"sfI249P1rZ"}],"key":"SrNCEuukNc"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"~12 km","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"pparxex6Ja"}],"key":"tC0XogQmSq"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"jet / tropopause","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"CTbUSu1Ynv"}],"key":"fyPJPEB0qk"}],"key":"LLVSSd3Qtx"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"175","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XT6aeltgBC"}],"key":"HEnYtAfkyJ"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"~13 km","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"c6HPDhE6qz"}],"key":"khxXvKHEcj"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"tropopause","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hbXnIUgIcN"}],"key":"cShwOQmUip"}],"key":"hmtrrEu4m3"},{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"150","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FfHplFLwFz"}],"key":"uo4rxnnHzQ"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"~14 km","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"QdsJTILjYn"}],"key":"spo2Wlmepq"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"lower stratosphere","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"n1PiHJUHy4"}],"key":"HrqbnYl5zq"}],"key":"R2dCYJap0Z"},{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"125","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"IVt5QVciQH"}],"key":"RTY6BeqqO6"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"~15 km","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"e5UkCWrdX1"}],"key":"UCziiL60rR"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"lower stratosphere","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"MnQECzaYPd"}],"key":"O8HfdEhh7W"}],"key":"cPRAjhUx75"},{"type":"tableRow","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"100","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"o1t7DaVnuu"}],"key":"HSdRFMAwxF"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"~16 km","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"pxVjblpK9L"}],"key":"QTDUE2YBO0"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"lower stratosphere","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"OMexsjOzT1"}],"key":"q4LIiV3fnl"}],"key":"mI7fGCqHLj"}],"key":"Hp9E98BHkX"}],"key":"sMhGDTzrMz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:13:03.651532Z","iopub.status.busy":"2026-03-01T17:13:03.651439Z","iopub.status.idle":"2026-03-01T17:14:38.541106Z","shell.execute_reply":"2026-03-01T17:14:38.540520Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"_ALT_LABELS = {\n    850: \"~1.5 km (lower troposphere)\",\n    500: \"~5.5 km (mid-troposphere)\",\n    400: \"~7 km\",\n    350: \"~8 km\",\n    300: \"~9 km (upper troposphere)\",\n    250: \"~10 km ★ jet-stream core\",\n    225: \"~11 km ★ jet-stream core\",\n    200: \"~12 km (jet / tropopause)\",\n    175: \"~13 km (tropopause)\",\n    150: \"~14 km (lower stratosphere)\",\n    125: \"~15 km\",\n    100: \"~16 km (lower stratosphere)\",\n}\n\ngif_frames_pl = []\n\nfor level in levels_sorted:\n    u_lev   = ds_pl[\"u_component_of_wind\"].sel(level=level).squeeze()\n    v_lev   = ds_pl[\"v_component_of_wind\"].sel(level=level).squeeze()\n    wspd_lv = np.sqrt(u_lev.values**2 + v_lev.values**2)\n\n    wspd_c, lons_c = add_cyclic_point(wspd_lv,       coord=lons_pl)\n    u_c,    _      = add_cyclic_point(u_lev.values,   coord=lons_pl)\n    v_c,    _      = add_cyclic_point(v_lev.values,   coord=lons_pl)\n\n    stride   = 20\n    lons_sub = lons_c[::stride]\n    lats_sub = lats_pl[::stride]\n    u_sub    = u_c[::stride, ::stride]\n    v_sub    = v_c[::stride, ::stride]\n    wspd_sub = np.sqrt(u_sub**2 + v_sub**2)\n    wspd_sub = np.where(wspd_sub == 0, 1, wspd_sub)\n    u_norm   = u_sub / wspd_sub\n    v_norm   = v_sub / wspd_sub\n\n    fig = plt.figure(figsize=(16, 8))\n    ax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\n    ax.set_global()\n\n    cf = ax.contourf(\n        lons_c, lats_pl, wspd_c,\n        levels=np.arange(0, 85, 5),\n        cmap=\"YlOrRd\", transform=ccrs.PlateCarree(), extend=\"max\",\n    )\n    ax.quiver(\n        lons_sub, lats_sub, u_norm, v_norm,\n        transform=ccrs.PlateCarree(),\n        color=\"steelblue\", alpha=0.7, scale=80, width=0.002,\n        headwidth=3, headlength=3, headaxislength=3.75, regrid_shape=None,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\")\n    ax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7)\n    ax.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\",  zorder=0)\n    ax.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\", zorder=0)\n\n    gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                      linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\n    gl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\n    gl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\n    cbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\",\n                        pad=0.03, fraction=0.04, aspect=40)\n    cbar.set_label(f\"Wind speed at {level} hPa (m/s)\", fontsize=11)\n    cbar.ax.tick_params(labelsize=9)\n\n    ax.set_title(\n        f\"Upper-level wind — {level} hPa  ({_ALT_LABELS.get(level, '')})\\n\"\n        f\"{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n        fontsize=13, pad=10,\n    )\n\n    fig.tight_layout()\n\n    buf = io.BytesIO()\n    fig.savefig(buf, format=\"png\", dpi=100, bbox_inches=\"tight\")\n    plt.close(fig)\n    buf.seek(0)\n    gif_frames_pl.append(Image.open(buf).copy())\n    print(f\"  pressure level frame: {level} hPa\")\n\nout_gif_pl = paths.images_path / \"13_pressure_levels_animation.gif\"\ngif_frames_pl[0].save(\n    out_gif_pl,\n    save_all=True,\n    append_images=gif_frames_pl[1:],\n    duration=700,   # ms per frame — slow enough to read the title\n    loop=0,\n)\nprint(f\"saved → {out_gif_pl.name}  ({len(gif_frames_pl)} frames)\")","key":"VaZtdwHMUw"},{"type":"outputs","id":"Z1yMaz9IS1KWB9RskokFQ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Ls4HpFZRwT"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 850 hPa\n"},"children":[],"key":"Mv8PmNBZPw"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"jDIl8XCUEe"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 500 hPa\n"},"children":[],"key":"vLIsgB1q90"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"eq6ljotd69"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 400 hPa\n"},"children":[],"key":"kvoLMMI4Fy"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"PwyAkDKWVN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 350 hPa\n"},"children":[],"key":"nqjDGSOzEB"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Ia1GrF0ea4"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 300 hPa\n"},"children":[],"key":"EeMRxHQ8A2"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"NoeF10BjiK"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 250 hPa\n"},"children":[],"key":"yL0EIuAqCx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"HLgwzVE0t6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 225 hPa\n"},"children":[],"key":"Ch8qRCrz8n"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"zJKu7s8h1k"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 200 hPa\n"},"children":[],"key":"CmNr9olHPM"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"X9KUMOGcLU"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 175 hPa\n"},"children":[],"key":"kPrjDcz3OW"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"R48gOpmqDz"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 150 hPa\n"},"children":[],"key":"cprHcHTnIP"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"KpgZWldxCY"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 125 hPa\n"},"children":[],"key":"ImNPsz2Hbv"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/crs.py:547: UserWarning: Some vectors at source domain corners may not have been transformed correctly\n  warnings.warn('Some vectors at source domain corners '\n/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"cjo4kYl4w8"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  pressure level frame: 100 hPa\n"},"children":[],"key":"MhJenLBlNh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"saved → 13_pressure_levels_animation.gif  (12 frames)\n"},"children":[],"key":"RmbKiLKXcV"}],"key":"Fh2irfXJp5"}],"key":"kfobaBWeCN"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_pressure_levels_a-e94991b9b187468f1f9ee013fcb40bc2.gif","alt":"Animation stepping from 850 hPa (near-surface) up to 100 hPa (lower stratosphere).\nThe jet stream emerges as the fast-moving core (orange/red) intensifies through the\nmid-troposphere, peaks at 200–250 hPa, then weakens in the stratosphere above.\nBlue arrows show wind direction.  This animation reveals the jet stream as a\nvertically coherent structure rather than just a surface phenomenon.","data":{"altTextIsAutoGenerated":true},"key":"JPh1WVbH4H","urlSource":"../../output/images/13_pressure_levels_animation.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-pressure-levels-animation","identifier":"fig-13-pressure-levels-animation","html_id":"fig-13-pressure-levels-animation","enumerator":"10","children":[{"type":"text","value":"Figure ","key":"yGCYjFQGYs"},{"type":"text","value":"10","key":"SdFHuhJoPd"},{"type":"text","value":":","key":"wEolqtgw6A"}],"template":"Figure %s:","key":"ySd4JWOmDg"},{"type":"text","value":"Animation stepping from 850 hPa (near-surface) up to 100 hPa (lower stratosphere).\nThe jet stream emerges as the fast-moving core (orange/red) intensifies through the\nmid-troposphere, peaks at 200–250 hPa, then weakens in the stratosphere above.\nBlue arrows show wind direction.  This animation reveals the jet stream as a\nvertically coherent structure rather than just a surface phenomenon.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GtwnbLglEd"}],"key":"yc9ZtaCTqr"}],"key":"SDWJ9Zm7Wb"}],"label":"fig-13-pressure-levels-animation","identifier":"fig-13-pressure-levels-animation","enumerator":"10","html_id":"fig-13-pressure-levels-animation","key":"DZX5D4hFEF"}],"key":"dR6BUuFjSl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vertical cross-sections","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CctTO0wKLw"}],"identifier":"vertical-cross-sections","label":"Vertical cross-sections","html_id":"vertical-cross-sections","implicit":true,"key":"dqffaQBADI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PHHs9xG7L7"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"vertical cross-section","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f5CFuPAhLV"}],"key":"xFu1hoG8nr"},{"type":"text","value":" cuts through the atmosphere at a fixed longitude\nand shows how wind speed and temperature vary simultaneously with latitude\n(x-axis) and altitude (y-axis).  This is the most direct way to see the jet\nstream’s three-dimensional shape.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EKDx2pR8wg"}],"key":"eW6i2mvSDn"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The y-axis uses ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OL0ch0rheL"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"geopotential height","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"IRsroAFKtB"}],"key":"KNMB6J4smu"},{"type":"text","value":" (km) so altitude increases naturally\nupward.  Each cross-section is paired with a world map highlighting the\nmeridian it was cut along.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"y6N0O8pyqm"}],"key":"lyDYuXR1i7"}],"key":"rEn76jp7Sr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cross-section helper","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pxnlYz4b80"}],"identifier":"cross-section-helper","label":"Cross-section helper","html_id":"cross-section-helper","implicit":true,"key":"DCl07lqL9L"}],"key":"ggv75sjGPy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:14:38.542472Z","iopub.status.busy":"2026-03-01T17:14:38.542345Z","iopub.status.idle":"2026-03-01T17:14:38.546985Z","shell.execute_reply":"2026-03-01T17:14:38.546414Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"def _fmt_cross_axes(ax):\n    ax.set_xlabel(\"Latitude (°)\", fontsize=10)\n    ax.set_ylabel(\"Geopotential height (km)\", fontsize=10)\n    ax.xaxis.set_major_formatter(mticker.FormatStrFormatter(\"%d°\"))\n    ax.xaxis.set_major_locator(mticker.MultipleLocator(15))\n    ax.grid(axis=\"x\", linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\n    ax.grid(axis=\"y\", linewidth=0.4, color=\"gray\", alpha=0.3, linestyle=\":\")\n\n\ndef _cross_section_data(ds_pl, lon_cut):\n    \"\"\"Extract and sort cross-section arrays for a given longitude.\"\"\"\n    ds_cut    = ds_pl.sel(longitude=lon_cut, method=\"nearest\")\n    lon_act   = float(ds_cut.longitude)\n    lon_plot  = lon_act if lon_act \u003c= 180 else lon_act - 360\n\n    u_cut  = ds_cut[\"u_component_of_wind\"].squeeze().values  # (level, lat)\n    v_cut  = ds_cut[\"v_component_of_wind\"].squeeze().values\n    z_cut  = ds_cut[\"geopotential\"].squeeze().values\n    t_cut  = ds_cut[\"temperature\"].squeeze().values\n    lats_c = ds_cut.latitude.values  # descending 90→−90\n\n    z_km       = z_cut / G / 1000\n    level_ord  = np.argsort(z_km.mean(axis=1))  # bottom → top\n\n    z_km_s  = z_km[level_ord][:, ::-1]                                # south→north\n    wspd_s  = np.sqrt(u_cut**2 + v_cut**2)[level_ord][:, ::-1]\n    t_s     = t_cut[level_ord][:, ::-1] - 273.15\n    lat_2d  = np.broadcast_to(lats_c[::-1], z_km_s.shape).copy()\n\n    return lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s","key":"JwzHcVnBMQ"},{"type":"outputs","id":"ofuuG0nofaDSBpeowi8Qq","children":[],"key":"AGm0P2XO3h"}],"key":"SX1sPffVDz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Static cross-section at 0 °E (prime meridian) with location map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YwoeWwICLq"}],"identifier":"static-cross-section-at-0-e-prime-meridian-with-location-map","label":"Static cross-section at 0 °E (prime meridian) with location map","html_id":"static-cross-section-at-0-e-prime-meridian-with-location-map","implicit":true,"key":"YyBv3t4haN"}],"key":"m4PXQyieyg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:14:38.548181Z","iopub.status.busy":"2026-03-01T17:14:38.548100Z","iopub.status.idle":"2026-03-01T17:14:39.361038Z","shell.execute_reply":"2026-03-01T17:14:39.360259Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"LON_STATIC = 0\nlon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s = _cross_section_data(ds_pl, LON_STATIC)\n\nfig = plt.figure(figsize=(22, 6))\ngs  = fig.add_gridspec(1, 10, wspace=0.5)\n\n# --- Location map ---\nax_map = fig.add_subplot(gs[0, :2], projection=ccrs.PlateCarree())\nax_map.set_global()\nax_map.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\")\nax_map.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\")\nax_map.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax_map.add_feature(cfeature.BORDERS,   linewidth=0.3, alpha=0.7)\nax_map.plot([lon_plot, lon_plot], [-90, 90],\n            color=\"crimson\", linewidth=2.5, transform=ccrs.PlateCarree(), zorder=5)\ngl_m = ax_map.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,\n                         linewidth=0.3, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl_m.top_labels   = False\ngl_m.right_labels = False\ngl_m.xlocator     = mticker.FixedLocator(range(-180, 181, 60))\ngl_m.ylocator     = mticker.FixedLocator(range(-90,  91,  30))\ngl_m.xlabel_style = {\"size\": 8}\ngl_m.ylabel_style = {\"size\": 8}\nax_map.set_title(\n    f\"Cross-section at\\n{lon_act:.0f}°E ({lon_plot:+.0f}°)\",\n    fontsize=10, color=\"crimson\",\n)\n\n# --- Wind speed ---\nax_w = fig.add_subplot(gs[0, 2:6])\ncf_w = ax_w.contourf(lat_2d, z_km_s, wspd_s,\n                     levels=np.arange(0, 85, 5), cmap=\"YlOrRd\", extend=\"max\")\ncs_w = ax_w.contour(lat_2d, z_km_s, wspd_s, levels=[30, 50, 70],\n                    colors=\"black\", linewidths=0.8, alpha=0.6)\nax_w.clabel(cs_w, fmt=\"%d m/s\", fontsize=8)\nfig.colorbar(cf_w, ax=ax_w, orientation=\"vertical\", pad=0.02,\n             fraction=0.03, aspect=30).set_label(\"Wind speed (m/s)\", fontsize=10)\n_fmt_cross_axes(ax_w)\nax_w.set_title(f\"Wind speed — {lon_act:.0f}°E ({lon_plot:+.0f}°)\", fontsize=11)\n\n# --- Temperature ---\nax_t = fig.add_subplot(gs[0, 6:10], sharey=ax_w)\ncf_t = ax_t.contourf(lat_2d, z_km_s, t_s,\n                     levels=np.arange(-80, 25, 5), cmap=\"RdBu_r\", extend=\"both\")\ncs_t = ax_t.contour(lat_2d, z_km_s, t_s, levels=np.arange(-80, 25, 10),\n                    colors=\"black\", linewidths=0.6, alpha=0.5)\nax_t.clabel(cs_t, fmt=\"%d°C\", fontsize=8)\nfig.colorbar(cf_t, ax=ax_t, orientation=\"vertical\", pad=0.02,\n             fraction=0.03, aspect=30).set_label(\"Temperature (°C)\", fontsize=10)\nax_t.set_xlabel(\"Latitude (°)\", fontsize=10)\nax_t.xaxis.set_major_formatter(mticker.FormatStrFormatter(\"%d°\"))\nax_t.xaxis.set_major_locator(mticker.MultipleLocator(15))\nax_t.grid(axis=\"x\", linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\nax_t.grid(axis=\"y\", linewidth=0.4, color=\"gray\", alpha=0.3, linestyle=\":\")\nax_t.tick_params(labelleft=False)\nax_t.set_title(f\"Temperature — {lon_act:.0f}°E ({lon_plot:+.0f}°)\", fontsize=11)\n\nfig.suptitle(\n    f\"Vertical cross-section at {lon_act:.0f}°E ({lon_plot:+.0f}°) — \"\n    f\"{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n    fontsize=13, y=1.02,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_cross_section_0E.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"cG7Aby0VzF"},{"type":"outputs","id":"mrAlcz3sGBavNhbVQ8B_S","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/3683643321.py:64: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"iV08u7uwGx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/3683643321.py:66: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"PNMPCBVcDa"}],"key":"M42on6DJuc"}],"key":"ZIhBPESNML"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_cross_section_0E-6e7a88cf6933d064344249f62ef10250.png","alt":"Vertical cross-section through the atmosphere at 0°E (prime meridian).\nLeft: location map with the section meridian (red).\nCentre: wind speed — the jet stream appears as the orange/red core at\n40–60°N between 8 and 14 km altitude.\nRight: temperature — the stratospheric warm layer above ~12 km and the\nsharp temperature gradient across the jet are clearly visible.","data":{"altTextIsAutoGenerated":true},"key":"zeMWzJBuMR","urlSource":"../../output/images/13_cross_section_0E.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-cross-section-0E","identifier":"fig-13-cross-section-0e","html_id":"fig-13-cross-section-0e","enumerator":"11","children":[{"type":"text","value":"Figure ","key":"CwT82RKrUb"},{"type":"text","value":"11","key":"Z93dwCDsYz"},{"type":"text","value":":","key":"safH5mNtop"}],"template":"Figure %s:","key":"ubrtjTfTIC"},{"type":"text","value":"Vertical cross-section through the atmosphere at 0°E (prime meridian).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YZshyfeerI"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Left:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fZMOixSHTh"}],"key":"MuRAYUMWYC"},{"type":"text","value":" location map with the section meridian (red).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H1x8lCYcUx"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Centre:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YKp8JCtatU"}],"key":"WR5Y2hXyLO"},{"type":"text","value":" wind speed — the jet stream appears as the orange/red core at\n40–60°N between 8 and 14 km altitude.\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HTLecWSwcn"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Right:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"otodd9JweA"}],"key":"IeadNTjdhg"},{"type":"text","value":" temperature — the stratospheric warm layer above ~12 km and the\nsharp temperature gradient across the jet are clearly visible.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NSFHZZpXyq"}],"key":"CN860pubY1"}],"key":"oXpyz0kloR"}],"label":"fig-13-cross-section-0E","identifier":"fig-13-cross-section-0e","enumerator":"11","html_id":"fig-13-cross-section-0e","key":"GDnY4WHtr4"}],"key":"fDHEGigVVS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Animation: cross-sections at every 5° longitude","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SKeEPsGAVO"}],"identifier":"animation-cross-sections-at-every-5-longitude","label":"Animation: cross-sections at every 5° longitude","html_id":"animation-cross-sections-at-every-5-longitude","implicit":true,"key":"oc4I8I76co"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The GIF below steps through all meridians in 5° increments, each frame\nshowing the wind-speed and temperature cross-section alongside a world map\nthat highlights the current longitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"htMbILT0PP"}],"key":"ZQ2fTSdJQD"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Watch the jet stream core (orange/red, 8–14 km) shift northward and\nsouthward as the section rotates around the globe, tracing the Rossby-wave\nmeanders of the jet.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"F8p6zDiFQB"}],"key":"llqu5ORcUM"}],"key":"hCnIGrWTHV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:14:39.362883Z","iopub.status.busy":"2026-03-01T17:14:39.362787Z","iopub.status.idle":"2026-03-01T17:15:02.427856Z","shell.execute_reply":"2026-03-01T17:15:02.427125Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gif_frames_cs = []\n\nfor lon_cut in range(0, 360, 5):\n    lon_act, lon_plot, lat_2d, z_km_s, wspd_s, t_s = _cross_section_data(ds_pl, lon_cut)\n\n    fig = plt.figure(figsize=(18, 5))\n    gs  = fig.add_gridspec(1, 10, wspace=0.5)\n\n    # Location map\n    ax_map = fig.add_subplot(gs[0, :2], projection=ccrs.Robinson())\n    ax_map.set_global()\n    ax_map.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\")\n    ax_map.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\")\n    ax_map.add_feature(cfeature.COASTLINE, linewidth=0.5)\n    ax_map.plot([lon_plot, lon_plot], [-90, 90],\n                color=\"crimson\", linewidth=2.5,\n                transform=ccrs.PlateCarree(), zorder=5)\n    ax_map.set_title(\n        f\"{lon_act:.0f}°E ({lon_plot:+.0f}°)\",\n        fontsize=9, color=\"crimson\",\n    )\n\n    # Wind speed\n    ax_w = fig.add_subplot(gs[0, 2:6])\n    cf_w = ax_w.contourf(lat_2d, z_km_s, wspd_s,\n                         levels=np.arange(0, 85, 5), cmap=\"YlOrRd\", extend=\"max\")\n    ax_w.contour(lat_2d, z_km_s, wspd_s, levels=[30, 50, 70],\n                 colors=\"black\", linewidths=0.8, alpha=0.6)\n    fig.colorbar(cf_w, ax=ax_w, fraction=0.04, pad=0.02,\n                 aspect=25).set_label(\"Wind speed (m/s)\", fontsize=9)\n    _fmt_cross_axes(ax_w)\n    ax_w.set_title(\"Wind speed\", fontsize=10)\n\n    # Temperature\n    ax_t = fig.add_subplot(gs[0, 6:10], sharey=ax_w)\n    cf_t = ax_t.contourf(lat_2d, z_km_s, t_s,\n                         levels=np.arange(-80, 25, 5), cmap=\"RdBu_r\", extend=\"both\")\n    ax_t.contour(lat_2d, z_km_s, t_s, levels=np.arange(-80, 25, 10),\n                 colors=\"black\", linewidths=0.6, alpha=0.5)\n    fig.colorbar(cf_t, ax=ax_t, fraction=0.04, pad=0.02,\n                 aspect=25).set_label(\"Temperature (°C)\", fontsize=9)\n    ax_t.set_xlabel(\"Latitude (°)\", fontsize=9)\n    ax_t.xaxis.set_major_formatter(mticker.FormatStrFormatter(\"%d°\"))\n    ax_t.xaxis.set_major_locator(mticker.MultipleLocator(15))\n    ax_t.grid(axis=\"x\", linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\n    ax_t.grid(axis=\"y\", linewidth=0.4, color=\"gray\", alpha=0.3, linestyle=\":\")\n    ax_t.tick_params(labelleft=False)\n    ax_t.set_title(\"Temperature\", fontsize=10)\n\n    fig.suptitle(\n        f\"Vertical cross-section at {lon_act:.0f}°E ({lon_plot:+.0f}°)  —  \"\n        f\"{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n        fontsize=11,\n    )\n    fig.tight_layout()\n\n    buf = io.BytesIO()\n    fig.savefig(buf, format=\"png\", dpi=90, bbox_inches=\"tight\")\n    plt.close(fig)\n    buf.seek(0)\n    gif_frames_cs.append(Image.open(buf).copy())\n    print(f\"  cross-section frame: {lon_act:.0f}°E\", end=\"\\r\")\n\nout_gif_cs = paths.images_path / \"13_cross_section_animation.gif\"\ngif_frames_cs[0].save(\n    out_gif_cs,\n    save_all=True,\n    append_images=gif_frames_cs[1:],\n    duration=200,   # ms per frame\n    loop=0,\n)\nprint(f\"\\nsaved → {out_gif_cs.name}  ({len(gif_frames_cs)} frames)\")","key":"z9YGDynkk6"},{"type":"outputs","id":"eUuJSCLPSwhK50MtNzVzz","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"PlOHHVJ9hM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 0°E\r"},"children":[],"key":"HgJECSwE1S"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"dvXKgyDmHh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 5°E\r"},"children":[],"key":"H87VOQE1we"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rh5RSp4KmP"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 10°E\r"},"children":[],"key":"loOSbEC3w4"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"sL1TCkO3MJ"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 15°E\r"},"children":[],"key":"Agcmu821Os"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"OGMJHgTV2v"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 20°E\r"},"children":[],"key":"Xhp5P7eSHH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"MfCY0t4P8P"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 25°E\r"},"children":[],"key":"XvprZkB1Ou"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"mBKIoLkUgi"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 30°E\r"},"children":[],"key":"T6ravDeLNt"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"JGUTDDAGUG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 35°E\r"},"children":[],"key":"c8fr8ztsBL"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Ce6ma9Pm33"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 40°E\r"},"children":[],"key":"uhI2mpBnh7"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"d3M8ndtAD0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 45°E\r"},"children":[],"key":"WXD9kieLRx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"OhSi144ylG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 50°E\r"},"children":[],"key":"b3hXrnzKjH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"ud5wNkUkAS"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 55°E\r"},"children":[],"key":"namYteo0CY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"kiCvhuYX8x"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 60°E\r"},"children":[],"key":"F5hCWVASwL"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"k1Hod91Ccs"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 65°E\r"},"children":[],"key":"KNXE2rJo1F"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"GtptWCKg6I"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 70°E\r"},"children":[],"key":"v9TjX7aJMN"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"KGxEd7ZYNK"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 75°E\r"},"children":[],"key":"FDgUJqkfjM"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"PD8xLK1xQ3"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 80°E\r"},"children":[],"key":"Sb8VuN7S6l"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"P5a6s5h2Md"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 85°E\r"},"children":[],"key":"gls3lOSgB0"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"MoaoVb1HX7"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 90°E\r"},"children":[],"key":"K6adnvzzZr"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rDh3TxiSJy"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 95°E\r"},"children":[],"key":"ap8NVeuRDf"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"LEwz2CJJ3X"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 100°E\r"},"children":[],"key":"KaOgA9mnFo"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"spoLU6YqWp"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 105°E\r"},"children":[],"key":"j3eFfwbSRP"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"n3V14v0mIN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 110°E\r"},"children":[],"key":"jQUWHlhxnj"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rYAv8JeUy9"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 115°E\r"},"children":[],"key":"ocs4WsvYMq"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"eybDVdsDfp"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 120°E\r"},"children":[],"key":"r60Rkf0h1q"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"CdYgeY1Tw0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 125°E\r"},"children":[],"key":"iRK7bpdWmk"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"I3YctC84Qo"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 130°E\r"},"children":[],"key":"wKgascWexK"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"gmpD1ysdb2"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 135°E\r"},"children":[],"key":"K4GLKgGeMH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"boL1jQ4htr"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 140°E\r"},"children":[],"key":"ArG28FP01d"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"oduuK1EReh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 145°E\r"},"children":[],"key":"T2klMxB5Jh"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"GY95u3C2ex"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 150°E\r"},"children":[],"key":"adYThJIxQ7"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Jv68Ye1pOi"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 155°E\r"},"children":[],"key":"IcvpyrMVSU"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"iWpbJSS0fk"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 160°E\r"},"children":[],"key":"K9q0CR3CD9"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"uiTPFhTWG0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 165°E\r"},"children":[],"key":"M6rHneqUQt"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Iw6ljtkVcL"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 170°E\r"},"children":[],"key":"b1B8kWeK1Q"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"xkun1USA7c"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 175°E\r"},"children":[],"key":"hNW2Sb6FL0"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"EVsnE2o0he"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 180°E\r"},"children":[],"key":"mZ0U9RHV8t"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"kNMuDOuBr2"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 185°E\r"},"children":[],"key":"vWxZh08uwA"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Y9Vx85vbCB"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 190°E\r"},"children":[],"key":"a33Supb5Vg"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"K2D8WqEIeT"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 195°E\r"},"children":[],"key":"fJVUekUOUN"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"VNmMvMiQu1"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 200°E\r"},"children":[],"key":"jzk6byRpY5"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"xVv7sMoGif"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 205°E\r"},"children":[],"key":"jOMgoT3t0m"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"Z5NO63tRo3"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 210°E\r"},"children":[],"key":"zT84yzcB1a"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rEwIB4t5aN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 215°E\r"},"children":[],"key":"DQBaKxFTrl"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"fUtbXVjswp"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 220°E\r"},"children":[],"key":"zXEc9tbWfj"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"pPnJx90Up6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 225°E\r"},"children":[],"key":"semNzw01K7"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"T1e1BeUHh8"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 230°E\r"},"children":[],"key":"cO2h91uvip"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"nwb0curH4Z"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 235°E\r"},"children":[],"key":"AcePWvkoTx"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"sSTCtEcR2l"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 240°E\r"},"children":[],"key":"EVsV6Tcgxb"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"yVhDOfeaHM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 245°E\r"},"children":[],"key":"yOgAoRCvaH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"zYcTmMdAPf"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 250°E\r"},"children":[],"key":"kqYdZdmsI9"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"ThzSGvIgBf"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 255°E\r"},"children":[],"key":"nix8rtL1mP"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"euMXBGv8iH"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 260°E\r"},"children":[],"key":"CLtnWkhxqX"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"lqBsXQ3IcV"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 265°E\r"},"children":[],"key":"FAdNGioXSA"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"nJyKwouvyr"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 270°E\r"},"children":[],"key":"ICsFwz7SeK"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"STc6FAsA48"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 275°E\r"},"children":[],"key":"QCVkRRcWGv"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rdjxscAGKG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 280°E\r"},"children":[],"key":"sS7r0DBszk"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"VB6oSIg0NM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 285°E\r"},"children":[],"key":"gk19tXuRrZ"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"P9rrMj8JKh"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 290°E\r"},"children":[],"key":"UbQPc3r2fk"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"W2xc38Pb6u"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 295°E\r"},"children":[],"key":"CWHaVLyWRU"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"TZUnIUjGAI"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 300°E\r"},"children":[],"key":"iFkdP2Wcgp"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"rmgXOMVGjF"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 305°E\r"},"children":[],"key":"C2E9rA1zcb"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"EzL8oQ9OxI"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 310°E\r"},"children":[],"key":"B6mKmrmA8O"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"G91C64oxy1"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 315°E\r"},"children":[],"key":"vGc0tKTGkY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"LRdX7olbha"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 320°E\r"},"children":[],"key":"rvi52CZOtB"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"WqiwtRAzxD"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 325°E\r"},"children":[],"key":"MeSfVzPQSE"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"JU24vBJocP"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 330°E\r"},"children":[],"key":"vIMZXFW5rr"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"uo1yuerzsk"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 335°E\r"},"children":[],"key":"Zjczjto6Q5"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"ehOAb9ALBN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 340°E\r"},"children":[],"key":"gzIEYnhA1i"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"qjPUiylc0f"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 345°E\r"},"children":[],"key":"ShCwkAKrmI"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"KnYhFRQFwc"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 350°E\r"},"children":[],"key":"SudushSFrT"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/645350947.py:55: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"BzublmS0sN"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"  cross-section frame: 355°E\r"},"children":[],"key":"HlqKxdrFCe"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\nsaved → 13_cross_section_animation.gif  (72 frames)\n"},"children":[],"key":"hSkvH7m06Z"}],"key":"Ut8sQEKBmX"}],"key":"atWuvLy1zU"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_cross_section_ani-c9d9196886036b3b8edd7b284f0419f4.gif","alt":"Vertical cross-sections rotating around the globe in 5° steps.  Each frame\nshows wind speed (centre) and temperature (right) vs. latitude and geopotential\nheight, paired with a world map highlighting the current meridian (red line).\nThe jet-stream core (orange/red at 8–14 km, 40–65°N) shifts north and south\nwith the Rossby-wave pattern as the section rotates — demonstrating the\njet’s three-dimensional tube-like shape encircling the Northern Hemisphere.","data":{"altTextIsAutoGenerated":true},"key":"kV470MJ1Om","urlSource":"../../output/images/13_cross_section_animation.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-cross-section-animation","identifier":"fig-13-cross-section-animation","html_id":"fig-13-cross-section-animation","enumerator":"12","children":[{"type":"text","value":"Figure ","key":"VzV101bui5"},{"type":"text","value":"12","key":"o4ISbPMuNx"},{"type":"text","value":":","key":"GD63aJ2EvW"}],"template":"Figure %s:","key":"PJrd1aDpWO"},{"type":"text","value":"Vertical cross-sections rotating around the globe in 5° steps.  Each frame\nshows wind speed (centre) and temperature (right) vs. latitude and geopotential\nheight, paired with a world map highlighting the current meridian (red line).\nThe jet-stream core (orange/red at 8–14 km, 40–65°N) shifts north and south\nwith the Rossby-wave pattern as the section rotates — demonstrating the\njet’s three-dimensional tube-like shape encircling the Northern Hemisphere.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CTOY7lHZI8"}],"key":"eMbltnnpuB"}],"key":"bLYutyDu0P"}],"label":"fig-13-cross-section-animation","identifier":"fig-13-cross-section-animation","enumerator":"12","html_id":"fig-13-cross-section-animation","key":"cc64B9vBuy"}],"key":"RZ5ADjVOvT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Column-maximum wind speed","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PKo4Jz04cm"}],"identifier":"column-maximum-wind-speed","label":"Column-maximum wind speed","html_id":"column-maximum-wind-speed","implicit":true,"key":"mXrsW5S7q1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"By taking the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gKhO2ZgXop"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"maximum wind speed across all pressure levels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"loHjLkM0hl"}],"key":"yei3j2Cpjb"},{"type":"text","value":" at each\nhorizontal grid point, we collapse the full vertical structure into a single\nmap that highlights every location where the jet core passes — regardless\nof its exact altitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YXwWRCiKSD"}],"key":"cpil1YjXyT"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Grid points where the jet tilts vertically or splits into multiple cores\nare still captured, making this a robust indicator of the jet’s\nhorizontal footprint.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BZD0oR8tgE"}],"key":"zxxJE6X2sC"}],"key":"RIwBEeHcLh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:02.429265Z","iopub.status.busy":"2026-03-01T17:15:02.429154Z","iopub.status.idle":"2026-03-01T17:15:02.600339Z","shell.execute_reply":"2026-03-01T17:15:02.599603Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"u_all    = ds_pl[\"u_component_of_wind\"].squeeze()  # (level, lat, lon)\nv_all    = ds_pl[\"v_component_of_wind\"].squeeze()\nwspd_all = np.sqrt(u_all**2 + v_all**2)\nwspd_max = wspd_all.max(dim=\"level\")\n\nprint(f\"Column-max wind range: {float(wspd_max.min()):.1f}–{float(wspd_max.max()):.1f} m/s\")","key":"OchkHauE8L"},{"type":"outputs","id":"Nvr7LP2yIUV9dZcUwAhAp","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Column-max wind range: 2.7–81.8 m/s\n"},"children":[],"key":"VTnFzJWbwQ"}],"key":"BNRctKPFd8"}],"key":"hDNkiryPyp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:02.601747Z","iopub.status.busy":"2026-03-01T17:15:02.601635Z","iopub.status.idle":"2026-03-01T17:15:12.588431Z","shell.execute_reply":"2026-03-01T17:15:12.587717Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"wspd_max_c, lons_max_c = add_cyclic_point(wspd_max.values, coord=lons_pl)\n\nfig = plt.figure(figsize=(16, 8))\nax  = fig.add_subplot(1, 1, 1, projection=ccrs.Robinson())\nax.set_global()\n\ncf = ax.contourf(\n    lons_max_c, lats_pl, wspd_max_c,\n    levels=np.arange(0, 85, 5),\n    cmap=\"YlOrRd\", transform=ccrs.PlateCarree(), extend=\"max\",\n)\n\n# Jet-stream footprint: contour line at 30 m/s threshold\nax.contour(\n    lons_max_c, lats_pl, wspd_max_c,\n    levels=[30],\n    colors=[\"mediumpurple\"], linewidths=1.5,\n    transform=ccrs.PlateCarree(),\n)\nlegend_el = [mpatches.Patch(facecolor=\"mediumpurple\", edgecolor=\"mediumpurple\",\n                             label=\"Jet-stream threshold (≥ 30 m/s)\")]\nax.legend(handles=legend_el, loc=\"lower left\", fontsize=10, framealpha=0.85)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6, color=\"black\")\nax.add_feature(cfeature.BORDERS,   linewidth=0.3, color=\"black\", alpha=0.7)\nax.add_feature(cfeature.OCEAN,     facecolor=\"aliceblue\",  zorder=0)\nax.add_feature(cfeature.LAND,      facecolor=\"whitesmoke\", zorder=0)\n\ngl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=False,\n                  linewidth=0.4, color=\"gray\", alpha=0.5, linestyle=\"--\")\ngl.xlocator = mticker.FixedLocator(range(-180, 181, 30))\ngl.ylocator = mticker.FixedLocator(range(-90,  91,  30))\n\ncbar = fig.colorbar(cf, ax=ax, orientation=\"horizontal\",\n                    pad=0.03, fraction=0.04, aspect=40)\ncbar.set_label(\"Column-maximum wind speed (m/s)\", fontsize=11)\ncbar.ax.tick_params(labelsize=9)\n\nax.set_title(\n    f\"Column-maximum wind speed (850–100 hPa)\\n{DATE} 12:00 UTC  |  ERA5 reanalysis\",\n    fontsize=13, pad=10,\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"13_jet_colmax.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"b06glUYNdz"},{"type":"outputs","id":"Dhj5-SSb88XWqWT18W5ys","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/chris/research/world-of-energy/.venv/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:143: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"witgwoTJdY"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_151767/4078208183.py:46: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"HWVwvYUhGM"}],"key":"auiQI5llro"}],"key":"bFBI6J8qWl"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/13_jet_colmax-a1333cf63885ae18d2e64e68cb987852.png","alt":"Column-maximum wind speed from 850 to 100 hPa.  By collapsing all altitude\nlevels into a single value per grid point, this map shows the horizontal\nfootprint of the jet stream regardless of where it sits vertically.  The\npurple contour marks the 30 m/s threshold commonly used to define the\njet-stream boundary.  In this summer snapshot, the jet is weaker than in\nwinter and displaced poleward, leaving a narrower and more fragmented footprint.","data":{"altTextIsAutoGenerated":true},"key":"GCfVt7MCZn","urlSource":"../../output/images/13_jet_colmax.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-13-jet-colmax","identifier":"fig-13-jet-colmax","html_id":"fig-13-jet-colmax","enumerator":"13","children":[{"type":"text","value":"Figure ","key":"Ue6pQ5jM7o"},{"type":"text","value":"13","key":"JzXAM8HUm7"},{"type":"text","value":":","key":"aE28mqa2xd"}],"template":"Figure %s:","key":"xU4YuuuBDv"},{"type":"text","value":"Column-maximum wind speed from 850 to 100 hPa.  By collapsing all altitude\nlevels into a single value per grid point, this map shows the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MxjYcTQxtv"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"horizontal\nfootprint","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"paxss3Rg2e"}],"key":"FQArCedDrH"},{"type":"text","value":" of the jet stream regardless of where it sits vertically.  The\npurple contour marks the 30 m/s threshold commonly used to define the\njet-stream boundary.  In this summer snapshot, the jet is weaker than in\nwinter and displaced poleward, leaving a narrower and more fragmented footprint.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lPkHMDPCUo"}],"key":"LSS1EeaGDM"}],"key":"WAHHngDSLg"}],"label":"fig-13-jet-colmax","identifier":"fig-13-jet-colmax","enumerator":"13","html_id":"fig-13-jet-colmax","key":"ZiEMgrXfue"}],"key":"qmR9c6e5o5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ex5SmGF5z6"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"gDrMaRYQOh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Combining the visualisations above builds a coherent picture of the jet\nstream as a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IbWQCdwMOa"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"three-dimensional structure","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l6A4ItgpAm"}],"key":"P9wehndV2r"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TUCVsdi0Ua"}],"key":"UXia3cuye6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"At the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jkrTlz1PNX"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"surface","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uOu5iJqxpm"}],"key":"AxS0LUaZGq"},{"type":"text","value":" (10 m wind, cloud cover, 2m temperature), the jet’s\ninfluence is indirect — it steers cyclones and anticyclones that modulate\nsurface conditions.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SXslrSiwI4"}],"key":"w4YSfUxFWL"}],"key":"FNCCh0qUOh"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gR0TymuxVi"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"mid-troposphere","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OwG9pkPhTj"}],"key":"Rk1sjtRLcp"},{"type":"text","value":" (500 hPa geopotential), the Rossby-wave pattern\nshows the large-scale trough/ridge structure that the jet follows.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EhzJtMJYsn"}],"key":"bFhV8caDOi"}],"key":"iiUDyTHR49"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"At ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oEbluNhbls"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"jet-stream altitude","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CdmvE70E7b"}],"key":"IFdw8Hazkn"},{"type":"text","value":" (200–250 hPa), the fast core is concentrated\nin a band 20–30° latitude wide, reaching 60–80 m/s in winter (weaker in\nthis June snapshot).","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ueZE1vbEPa"}],"key":"tmJgZDth30"}],"key":"obrf9lqAMr"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Vertical cross-sections","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"nuItFJ3mdS"}],"key":"CYkN9pTilW"},{"type":"text","value":" reveal the core sitting between ~8 and 14 km,\nwith the strongest winds near the tropopause (~200 hPa).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"c1UOiqPC3Z"}],"key":"nmAf1Gi2WY"}],"key":"Bg33htYWHJ"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"VVIPsMai8Q"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"polar view","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"JZen17WxjG"}],"key":"baT07xQmB7"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"gLmZmIFMKw"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"column-maximum map","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"y4A9tc5PEh"}],"key":"OtnfNICeYG"},{"type":"text","value":" show the jet’s horizontal\nfootprint as a ring around the Northern Hemisphere, punctuated by the\nRossby-wave meanders that connect upper-level dynamics to surface weather.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GM5QHRucSt"}],"key":"dd0MlxV7iG"}],"key":"CgLo5ibScz"}],"key":"g0U9XVOnSn"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"For energy systems, the key takeaway is that wind and solar availability\nacross Europe depend critically on the current state of this three-dimensional\njet — its latitude, its strength, and whether it is blocked or meandering.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QSheDs5Am3"}],"key":"iVM9YItAQ8"}],"key":"XnfUQujsL2"}],"key":"P2WxFecUHf"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Map Projections — ERA5 2 m Temperature","url":"/notebooks/projections","group":"Weather"},"next":{"title":"Weather Variability in Germany — Beyond the Seasonal Cycle","url":"/notebooks/germany-variations","group":"Weather"}}},"domain":"http://localhost:3000"},"project":{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"children":[{"file":"notebooks/03_smard_DE_prices.ipynb"},{"file":"notebooks/04_reconstruct_prices.ipynb"},{"file":"notebooks/05_load_seasonalities.ipynb"}],"title":"Electricity Prices"},{"children":[{"file":"notebooks/10_earth_seasons.ipynb"},{"file":"notebooks/12_projections.ipynb"},{"file":"notebooks/13_pressure_and_weather.ipynb"},{"file":"notebooks/17_germany_variations.ipynb"},{"file":"notebooks/18_nao_index.ipynb"},{"file":"notebooks/21_daily_jet_stream_animations.ipynb"}],"title":"Weather"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Electricity Prices"},{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5897d2d2ec58c9fc3341ae0ace50856b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-515875c959c281688fe9c9613ec1e24f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Weather"},{"slug":"notebooks.projections","title":"Map Projections — ERA5 2 m Temperature","description":"","date":"","thumbnail":"/world-of-energy/build/12_t2m_projections_o-458c35fb5ed415023332d684441d5a8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.pressure-and-weather","title":"Pressure Levels and the Jet Stream","description":"","date":"","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.germany-variations","title":"Weather Variability in Germany — Beyond the Seasonal Cycle","description":"","date":"","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nao-index","title":"Monthly ERA5 Reanalysis","description":"","date":"","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.daily-jet-stream-animations","title":"NAO and Jet Stream — Daily Evolution","description":"","date":"","thumbnail":"/world-of-energy/build/18_t2m_z500_2014-201-274e4fc869dc3f9bf6bb6a54f3cbd40c.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-9fcb1fdbd9556f4cf5f6a9c6156cb4a0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/world-of-energy/build/manifest-784E572C.js";
import * as route0 from "/world-of-energy/build/root-DSHAHCKW.js";
import * as route1 from "/world-of-energy/build/routes/$-NYGFW5Y3.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/world-of-energy/build/entry.client-PCJPW7TK.js");</script></body></html>
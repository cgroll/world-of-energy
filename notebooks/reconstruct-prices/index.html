<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Fossil Fuel Costs and Electricity Price Reconstruction - World of Energy</title><meta property="og:title" content="Fossil Fuel Costs and Electricity Price Reconstruction - World of Energy"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png"/><meta property="og:image" content="/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png"/><link rel="stylesheet" href="/world-of-energy/build/_assets/app-2K3KGISG.css"/><link rel="stylesheet" href="/world-of-energy/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/world-of-energy/favicon.ico"/><link rel="stylesheet" href="/world-of-energy/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/world-of-energy/"><div class="myst-home-link-logo mr-3 flex items-center dark:bg-white dark:rounded px-1"><img src="/world-of-energy/build/logo-4fc1371cfd231b110ea40f8fb3b0afff.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="World of Energy" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/world-of-energy/">World of Energy</a><a title="Electricity prices in Germany" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/notebooks/smard-de-prices">Electricity prices in Germany</a><a title="Fossil Fuel Costs and Electricity Price Reconstruction" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/notebooks/reconstruct-prices">Fossil Fuel Costs and Electricity Price Reconstruction</a><a title="Seasonality Heatmaps" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/notebooks/load-seasonalities">Seasonality Heatmaps</a><a title="Earth’s Seasons — From Sunlight to Vegetation" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/notebooks/earth-seasons">Earth’s Seasons — From Sunlight to Vegetation</a><a title="Resources" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/markdown/resources">Resources</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0 ml-3 xl:ml-0 mr-3 max-w-[350px]"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/cgroll/world-of-energy" title="GitHub Repository: cgroll/world-of-energy" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/04_reconstruct_prices.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Fossil Fuel Costs and Electricity Price Reconstruction</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Christian Groll</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><p>This notebook calculates the Short Run Marginal Costs (SRMC) of generating
electricity using hard coal and fossil gas, then uses a simplified merit
order model to reconstruct wholesale electricity prices.</p><h2 id="approach" class="relative group"><span class="heading-text">Approach</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#approach" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ol start="1"><li><p>Calculate <strong>SRMC</strong> for coal and gas power plants from commodity prices</p></li><li><p>Calculate <strong>Fossil Residual Load</strong>: the demand that must be met by fossil plants
after accounting for renewables and baseload generation</p></li></ol><div id="GfkfotMNX1" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>=</mo><mtext>Load</mtext><mo>−</mo><mo stretchy="false">(</mo><mtext>Wind</mtext><mo>+</mo><mtext>Solar</mtext><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mtext>Nuclear</mtext><mo>+</mo><mtext>Biomass</mtext><mo>+</mo><msub><mtext>Hydro</mtext><mrow><mi>R</mi><mi>o</mi><mi>R</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">RL_{fossil} = \text{Load} - (\text{Wind} + \text{Solar}) - (\text{Nuclear} + \text{Biomass} + \text{Hydro}_{RoR})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">oss</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">Load</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">Wind</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Solar</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">Nuclear</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">Biomass</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Hydro</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2342em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#GfkfotMNX1" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><ol start="3"><li><p>Determine which fossil fuel (coal or gas) is cheaper based on SRMC</p></li><li><p>Assign price based on merit order:</p><ul><li><p>If <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>≤</mo><mtext>cheaper capacity</mtext></mrow><annotation encoding="application/x-tex">RL_{fossil} \leq \text{cheaper capacity}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">oss</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">cheaper capacity</span></span></span></span></span></span>: price = cheaper SRMC</p></li><li><p>If <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>&gt;</mo><mtext>cheaper capacity</mtext></mrow><annotation encoding="application/x-tex">RL_{fossil} &gt; \text{cheaper capacity}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">oss</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">cheaper capacity</span></span></span></span></span></span>: price = more expensive SRMC</p></li></ul></li><li><p>Compare reconstructed prices with actual market prices</p></li></ol><h2 id="short-run-marginal-costs-srmc" class="relative group"><span class="heading-text">Short Run Marginal Costs (SRMC)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#short-run-marginal-costs-srmc" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The <strong>Short Run Marginal Cost (SRMC)</strong> represents the variable cost of producing
one additional MWh of electricity from a power plant. It determines the merit
order position of generators in wholesale electricity markets.</p><h3 id="components-of-srmc" class="relative group"><span class="heading-text">Components of SRMC</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#components-of-srmc" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>SRMC consists of three main components:</p><ol start="1"><li><p><strong>Fuel costs</strong> - The cost of the primary fuel (gas or coal) needed to
generate electricity, adjusted for plant efficiency.</p></li><li><p><strong>Carbon costs</strong> - The cost of CO2 emissions under the EU Emissions Trading
Scheme (EU ETS), based on the carbon intensity of the fuel.</p></li><li><p><strong>Variable O&amp;M costs</strong> - Operating and maintenance costs that vary with
electricity output.</p></li></ol><h3 id="price-references" class="relative group"><span class="heading-text">Price References</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#price-references" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Fossil Gas:</strong></p><ul><li><p>Dutch Title Transfer Facility (TTF) is the benchmark for gas traded in Europe</p></li><li><p>Other European hubs (CEGH VTP, THE, PSV, etc.) trade at spreads to TTF</p></li><li><p>Prices sourced from commodity exchanges (e.g., ICE, EEX)</p></li></ul><p><strong>Hard Coal:</strong></p><ul><li><p>API 2 Rotterdam is the benchmark for coal imported into Northwest Europe</p></li><li><p>Front month settlement prices in USD/metric ton</p></li><li><p>Thermal content approximately 6,000 kcal/kg (NAR)</p></li></ul><p><strong>Carbon:</strong></p><ul><li><p>EU ETS allowance prices (EUA) for the front December contract</p></li><li><p>Prices in EUR per tonne CO2</p></li></ul><h3 id="calculation-assumptions" class="relative group"><span class="heading-text">Calculation Assumptions</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#calculation-assumptions" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><table class=""><tbody><tr class=""><th class="">Parameter</th><th class="">Hard Coal</th><th class="">Fossil Gas</th></tr><tr class=""><td class="">Efficiency (HHV)</td><td class="">40%</td><td class="">50%</td></tr><tr class=""><td class="">Carbon intensity</td><td class="">0.83 tCO2/MWh</td><td class="">0.37 tCO2/MWh</td></tr><tr class=""><td class="">Variable O&amp;M</td><td class="">€2/MWh</td><td class="">€2/MWh</td></tr></tbody></table><p>The carbon intensity values represent emissions per MWh of electricity generated,
accounting for the power plant efficiency.</p><h3 id="why-srmc-matters" class="relative group"><span class="heading-text">Why SRMC Matters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#why-srmc-matters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In liberalized electricity markets, generators bid close to their marginal cost.
The SRMC comparison between coal and gas determines:</p><ul><li><p><strong>Fuel switching</strong> - When gas SRMC falls below coal, utilities switch from
coal to gas, reducing emissions</p></li><li><p><strong>Price formation</strong> - The highest SRMC plant needed to meet demand often
sets the wholesale electricity price</p></li><li><p><strong>Investment signals</strong> - Persistent SRMC relationships influence new build
decisions and plant retirements</p></li></ul><div id="oa2NhaXHvG" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score

from woe.paths import ProjPaths</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="p99I7NAo2HGbHcXOgO7tE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="srmc-calculation-parameters" class="relative group"><span class="heading-text">SRMC Calculation Parameters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#srmc-calculation-parameters" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="FEQoqs5qoi" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Power plant efficiency rates (Higher Heating Value / Gross Calorific Value)
COAL_EFFICIENCY = 0.40  # 40%
GAS_EFFICIENCY = 0.50  # 50%

# Carbon intensity (tCO2 per MWh of electricity generated)
COAL_CARBON_INTENSITY = 0.83  # tCO2/MWh
GAS_CARBON_INTENSITY = 0.37  # tCO2/MWh

# Variable Operating and Maintenance costs (EUR/MWh)
VOM_COST = 2.0

# Coal thermal content (MWh per metric ton)
# API 2 coal specification: 6,000 kcal/kg NAR
# 6,000 kcal/kg = 6,000,000 kcal/t ÷ 860,421 kcal/MWh ≈ 6.98 MWh/t
COAL_THERMAL_CONTENT = 6.98  # MWh/t

# EUR/USD exchange rate (approximate)
EURUSD_RATE = 1.08</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="C6DIniOE26qJB9KIw3HqJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="load-data" class="relative group"><span class="heading-text">Load Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="CPOEk5mTYM" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">paths = ProjPaths()
paths.images_path.mkdir(parents=True, exist_ok=True)

# Load generation and consumption data
print(&quot;Loading SMARD data...&quot;)
solar = pd.read_parquet(paths.smard_solar_file)
wind_onshore = pd.read_parquet(paths.smard_wind_onshore_file)
wind_offshore = pd.read_parquet(paths.smard_wind_offshore_file)
total_load = pd.read_parquet(paths.smard_total_load_file)
prices = pd.read_parquet(paths.smard_prices_file)
capacities = pd.read_parquet(paths.smard_capacities_file)

print(f&quot;Generation data: {solar.index.min()} to {solar.index.max()}&quot;)
print(f&quot;Prices: {prices.index.min()} to {prices.index.max()}&quot;)
print(f&quot;Capacities: {capacities.index.min()} to {capacities.index.max()}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="oRc7UWpI8q-IZqTWLQurz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="baseload-generation-data" class="relative group"><span class="heading-text">Baseload Generation Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#baseload-generation-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Nuclear, biomass, and hydro generation data for the fossil residual load calculation.</p><div id="E7vCVdWe1I" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;Loading baseload generation data...&quot;)
nuclear = pd.read_parquet(paths.smard_nuclear_file)
biomass = pd.read_parquet(paths.smard_biomass_file)
hydro = pd.read_parquet(paths.smard_hydro_file)

print(f&quot;Nuclear: {len(nuclear)} records&quot;)
print(f&quot;Biomass: {len(biomass)} records&quot;)
print(f&quot;Hydro: {len(hydro)} records&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="xlPGDpZF6CKBA1FptvMmf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="commodity-prices" class="relative group"><span class="heading-text">Commodity Prices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#commodity-prices" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="NF2jUIgMrL" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def load_investing_com_csv(filepath: str) -&gt; pd.Series:
    &quot;&quot;&quot;Load price data from Investing.com CSV export.&quot;&quot;&quot;
    df = pd.read_csv(
        filepath,
        encoding=&quot;utf-8-sig&quot;,
        parse_dates=[&quot;Date&quot;],
        dayfirst=False,
    )
    df = df.set_index(&quot;Date&quot;).sort_index()
    return df[&quot;Price&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Njwa3U66_6K3xL2iUGRft" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="E1jk4w00vC" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load commodity prices
print(&quot;Loading commodity prices...&quot;)
gas_df = pd.read_parquet(paths.ttf_gas_prices_file)
gas_prices = gas_df[&quot;Close&quot;].rename(&quot;gas_price&quot;)

coal_prices = load_investing_com_csv(paths.rotterdam_coal_prices_file).rename(
    &quot;coal_price&quot;
)

carbon_prices = load_investing_com_csv(paths.eu_carbon_prices_file).rename(
    &quot;carbon_price&quot;
)

print(f&quot;Gas prices: {gas_prices.index.min()} to {gas_prices.index.max()}&quot;)
print(f&quot;Coal prices: {coal_prices.index.min()} to {coal_prices.index.max()}&quot;)
print(f&quot;Carbon prices: {carbon_prices.index.min()} to {carbon_prices.index.max()}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="FcRe3qtapZOMbrP3Dc-6a" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="calculate-srmc" class="relative group"><span class="heading-text">Calculate SRMC</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#calculate-srmc" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="gas-srmc" class="relative group"><span class="heading-text">Gas SRMC</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#gas-srmc" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="slPuGv3ajE" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Gas SRMC</mtext><mo>=</mo><mfrac><mtext>Gas Price</mtext><mtext>Efficiency</mtext></mfrac><mo>+</mo><mtext>Carbon Intensity</mtext><mo>×</mo><mtext>Carbon Price</mtext><mo>+</mo><mtext>VOM</mtext></mrow><annotation encoding="application/x-tex">\text{Gas SRMC} = \frac{\text{Gas Price}}{\text{Efficiency}} + \text{Carbon Intensity} \times \text{Carbon Price} + \text{VOM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Gas SRMC</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2408em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Efficiency</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Gas Price</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Carbon Intensity</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">Carbon Price</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">VOM</span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#slPuGv3ajE" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><h3 id="coal-srmc" class="relative group"><span class="heading-text">Coal SRMC</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#coal-srmc" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="moyOVvDFlD" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Coal SRMC</mtext><mo>=</mo><mfrac><mtext>Coal Price (EUR/MWh)</mtext><mtext>Efficiency</mtext></mfrac><mo>+</mo><mtext>Carbon Intensity</mtext><mo>×</mo><mtext>Carbon Price</mtext><mo>+</mo><mtext>VOM</mtext></mrow><annotation encoding="application/x-tex">\text{Coal SRMC} = \frac{\text{Coal Price (EUR/MWh)}}{\text{Efficiency}} + \text{Carbon Intensity} \times \text{Carbon Price} + \text{VOM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Coal SRMC</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Efficiency</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Coal Price (EUR/MWh)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Carbon Intensity</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">Carbon Price</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">VOM</span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#moyOVvDFlD" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><p>Note: Coal prices in USD/t need to be converted to EUR/MWh using:</p><ul><li><p>Exchange rate (USD/EUR)</p></li><li><p>Thermal content (MWh/t)</p></li></ul><div id="Cr0m8AliSZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Combine commodity prices (daily)
commodity_prices = pd.concat(
    [gas_prices, coal_prices, carbon_prices], axis=1, join=&quot;inner&quot;
)
commodity_prices = commodity_prices.ffill()

# Convert coal from USD/t to EUR/MWh
coal_eur_mwh = commodity_prices[&quot;coal_price&quot;] / EURUSD_RATE / COAL_THERMAL_CONTENT

# Calculate SRMC components
gas_fuel_cost = commodity_prices[&quot;gas_price&quot;] / GAS_EFFICIENCY
coal_fuel_cost = coal_eur_mwh / COAL_EFFICIENCY

gas_carbon_cost = GAS_CARBON_INTENSITY * commodity_prices[&quot;carbon_price&quot;]
coal_carbon_cost = COAL_CARBON_INTENSITY * commodity_prices[&quot;carbon_price&quot;]

# Total SRMC (daily)
srmc_daily = pd.DataFrame(index=commodity_prices.index)
srmc_daily[&quot;gas_srmc&quot;] = gas_fuel_cost + gas_carbon_cost + VOM_COST
srmc_daily[&quot;coal_srmc&quot;] = coal_fuel_cost + coal_carbon_cost + VOM_COST

# Store components for analysis
srmc_daily[&quot;gas_fuel_cost&quot;] = gas_fuel_cost
srmc_daily[&quot;gas_carbon_cost&quot;] = gas_carbon_cost
srmc_daily[&quot;coal_fuel_cost&quot;] = coal_fuel_cost
srmc_daily[&quot;coal_carbon_cost&quot;] = coal_carbon_cost

print(&quot;SRMC Summary (EUR/MWh):&quot;)
print(srmc_daily[[&quot;gas_srmc&quot;, &quot;coal_srmc&quot;]].describe().round(2))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="aGtiUOM40rbEz57VeJvb3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="srmc-time-series" class="relative group"><span class="heading-text">SRMC Time Series</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#srmc-time-series" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="c09irjgr1I" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(14, 6))

ax.plot(srmc_daily.index, srmc_daily[&quot;gas_srmc&quot;], label=&quot;Gas SRMC&quot;, linewidth=1, alpha=0.8)
ax.plot(srmc_daily.index, srmc_daily[&quot;coal_srmc&quot;], label=&quot;Coal SRMC&quot;, linewidth=1, alpha=0.8)

ax.set_xlabel(&quot;Date&quot;)
ax.set_ylabel(&quot;SRMC (EUR/MWh)&quot;)
ax.set_title(&quot;Short Run Marginal Costs: Coal vs Gas&quot;)
ax.legend()
ax.grid(True, alpha=0.3)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_srmc_timeseries.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="aCN3sVauaNqBl6KU1PR-I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-srmc-timeseries" class="fig-figure"><img id="weExFNlPRF" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png" alt="Short Run Marginal Costs: Coal vs Gas" data-canonical-url="../../output/images/04_srmc_timeseries.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-srmc-timeseries" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->1<!-- -->:</a>Short Run Marginal Costs: Coal vs Gas</p></figcaption></figure><h2 id="monthly-average-srmc" class="relative group"><span class="heading-text">Monthly Average SRMC</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#monthly-average-srmc" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="bSvCvgq2AG" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">monthly_srmc = srmc_daily[[&quot;gas_srmc&quot;, &quot;coal_srmc&quot;]].resample(&quot;ME&quot;).mean()

fig, ax = plt.subplots(figsize=(14, 6))

ax.plot(
    monthly_srmc.index,
    monthly_srmc[&quot;gas_srmc&quot;],
    label=&quot;Gas SRMC&quot;,
    marker=&quot;o&quot;,
    markersize=3,
)
ax.plot(
    monthly_srmc.index,
    monthly_srmc[&quot;coal_srmc&quot;],
    label=&quot;Coal SRMC&quot;,
    marker=&quot;o&quot;,
    markersize=3,
)

ax.set_xlabel(&quot;Date&quot;)
ax.set_ylabel(&quot;SRMC (EUR/MWh)&quot;)
ax.set_title(&quot;Monthly Average Short Run Marginal Costs&quot;)
ax.legend()
ax.grid(True, alpha=0.3)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_monthly_srmc.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ABNEGZomGPzPIujozW6tp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-monthly-srmc" class="fig-figure"><img id="SPCI3bsfOH" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_monthly_srmc-7d64c8bf8a95ba0c0b474f5aa0059ef1.png" alt="Monthly Average Short Run Marginal Costs" data-canonical-url="../../output/images/04_monthly_srmc.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-monthly-srmc" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->2<!-- -->:</a>Monthly Average Short Run Marginal Costs</p></figcaption></figure><h2 id="fuel-switching-indicator" class="relative group"><span class="heading-text">Fuel Switching Indicator</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#fuel-switching-indicator" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>When gas SRMC is lower than coal SRMC, it is economically favorable to dispatch
gas plants over coal plants, leading to lower emissions. This “fuel switching”
is a key mechanism for carbon price effectiveness.</p><div id="ZWRQTAvFf1" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Calculate the spread (positive = gas cheaper than coal)
srmc_daily[&quot;spread&quot;] = srmc_daily[&quot;coal_srmc&quot;] - srmc_daily[&quot;gas_srmc&quot;]

fig, axes = plt.subplots(2, 1, figsize=(14, 10), sharex=True)

# SRMC comparison
ax1 = axes[0]
ax1.plot(srmc_daily.index, srmc_daily[&quot;gas_srmc&quot;], label=&quot;Gas SRMC&quot;, linewidth=1, alpha=0.8)
ax1.plot(srmc_daily.index, srmc_daily[&quot;coal_srmc&quot;], label=&quot;Coal SRMC&quot;, linewidth=1, alpha=0.8)
ax1.set_ylabel(&quot;SRMC (EUR/MWh)&quot;)
ax1.set_title(&quot;Short Run Marginal Costs and Fuel Switching&quot;)
ax1.legend()
ax1.grid(True, alpha=0.3)

# Spread (coal - gas)
ax2 = axes[1]
ax2.fill_between(
    srmc_daily.index,
    srmc_daily[&quot;spread&quot;],
    0,
    where=srmc_daily[&quot;spread&quot;] &gt;= 0,
    color=&quot;green&quot;,
    alpha=0.5,
    label=&quot;Gas cheaper (fuel switch)&quot;,
)
ax2.fill_between(
    srmc_daily.index,
    srmc_daily[&quot;spread&quot;],
    0,
    where=srmc_daily[&quot;spread&quot;] &lt; 0,
    color=&quot;red&quot;,
    alpha=0.5,
    label=&quot;Coal cheaper&quot;,
)
ax2.axhline(y=0, color=&quot;black&quot;, linestyle=&quot;-&quot;, linewidth=0.5)
ax2.set_xlabel(&quot;Date&quot;)
ax2.set_ylabel(&quot;Spread (EUR/MWh)&quot;)
ax2.set_title(&quot;Coal-Gas Spread (positive = gas cheaper)&quot;)
ax2.legend()
ax2.grid(True, alpha=0.3)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_fuel_switching.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="tYLNlpFdjKWAMlueqsg7v" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-fuel-switching" class="fig-figure"><img id="QsDC7gRPQ8" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_fuel_switching-b8bd6c024d0f6ee370f800af1d89afb0.png" alt="Short Run Marginal Costs and Fuel Switching Indicator" data-canonical-url="../../output/images/04_fuel_switching.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-fuel-switching" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->3<!-- -->:</a>Short Run Marginal Costs and Fuel Switching Indicator</p></figcaption></figure><h2 id="srmc-cost-components" class="relative group"><span class="heading-text">SRMC Cost Components</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#srmc-cost-components" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Breaking down the SRMC into its fuel and carbon cost components shows the
relative importance of each driver.</p><div id="LnJ3MaVVZ7" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# Gas SRMC components
ax1 = axes[0]
ax1.stackplot(
    srmc_daily.index,
    srmc_daily[&quot;gas_fuel_cost&quot;],
    srmc_daily[&quot;gas_carbon_cost&quot;],
    [VOM_COST] * len(srmc_daily),
    labels=[&quot;Fuel Cost&quot;, &quot;Carbon Cost&quot;, &quot;Variable O&amp;M&quot;],
    alpha=0.8,
)
ax1.set_xlabel(&quot;Date&quot;)
ax1.set_ylabel(&quot;Cost (EUR/MWh)&quot;)
ax1.set_title(&quot;Gas SRMC Components&quot;)
ax1.legend(loc=&quot;upper left&quot;)
ax1.grid(True, alpha=0.3)

# Coal SRMC components
ax2 = axes[1]
ax2.stackplot(
    srmc_daily.index,
    srmc_daily[&quot;coal_fuel_cost&quot;],
    srmc_daily[&quot;coal_carbon_cost&quot;],
    [VOM_COST] * len(srmc_daily),
    labels=[&quot;Fuel Cost&quot;, &quot;Carbon Cost&quot;, &quot;Variable O&amp;M&quot;],
    alpha=0.8,
)
ax2.set_xlabel(&quot;Date&quot;)
ax2.set_ylabel(&quot;Cost (EUR/MWh)&quot;)
ax2.set_title(&quot;Coal SRMC Components&quot;)
ax2.legend(loc=&quot;upper left&quot;)
ax2.grid(True, alpha=0.3)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_srmc_components.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="lKHGsee0FtQ3t_pjKk1L1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-srmc-components" class="fig-figure"><img id="JpbiMXXrvC" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_srmc_components-80a02da23aa6b5e5135476b7a9a45050.png" alt="SRMC Cost Components (Gas and Coal)" data-canonical-url="../../output/images/04_srmc_components.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-srmc-components" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->4<!-- -->:</a>SRMC Cost Components (Gas and Coal)</p></figcaption></figure><h2 id="combine-all-data" class="relative group"><span class="heading-text">Combine All Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#combine-all-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Align all data to hourly resolution by forward-filling daily/monthly data.</p><div id="gLN55RYj2f" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Combine generation data into single DataFrame
df = pd.concat(
    [
        solar.rename(columns={solar.columns[0]: &quot;solar&quot;}),
        wind_onshore.rename(columns={wind_onshore.columns[0]: &quot;wind_onshore&quot;}),
        wind_offshore.rename(columns={wind_offshore.columns[0]: &quot;wind_offshore&quot;}),
        total_load.rename(columns={total_load.columns[0]: &quot;total_load&quot;}),
        prices.rename(columns={prices.columns[0]: &quot;price&quot;}),
        nuclear.rename(columns={nuclear.columns[0]: &quot;nuclear&quot;}),
        biomass.rename(columns={biomass.columns[0]: &quot;biomass&quot;}),
        hydro.rename(columns={hydro.columns[0]: &quot;hydro&quot;}),
    ],
    axis=1,
)

# Drop rows with missing generation/price data
df = df.dropna()
print(f&quot;Combined hourly data: {len(df)} records&quot;)
print(f&quot;Date range: {df.index.min()} to {df.index.max()}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="KaSXFmDqDw9gY1OJS4agA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="mWrFhIDkrf" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Forward-fill SRMC to hourly
# Normalize index to date only for merging
df[&quot;date&quot;] = df.index.date
srmc_daily_reset = srmc_daily.copy()
srmc_daily_reset.index = srmc_daily_reset.index.date

df = df.merge(
    srmc_daily_reset[[&quot;gas_srmc&quot;, &quot;coal_srmc&quot;]],
    left_on=&quot;date&quot;,
    right_index=True,
    how=&quot;left&quot;,
)
df = df.drop(columns=[&quot;date&quot;])

# Forward-fill any gaps in SRMC
df[&quot;gas_srmc&quot;] = df[&quot;gas_srmc&quot;].ffill()
df[&quot;coal_srmc&quot;] = df[&quot;coal_srmc&quot;].ffill()

# Drop rows without SRMC data
df = df.dropna(subset=[&quot;gas_srmc&quot;, &quot;coal_srmc&quot;])
print(f&quot;After SRMC merge: {len(df)} records&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="wCW4kBvofYn_aGTZtqwjA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="E7JD3uEKRj" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Forward-fill capacities to hourly
# Capacities are monthly, so we need to reindex and forward-fill
capacities_hourly = capacities.reindex(df.index, method=&quot;ffill&quot;)

# Add relevant capacity columns to main DataFrame
df[&quot;capacity_coal&quot;] = (
    capacities_hourly[&quot;brown_coal&quot;].fillna(0)
    + capacities_hourly[&quot;hard_coal&quot;].fillna(0)
)
df[&quot;capacity_gas&quot;] = capacities_hourly[&quot;natural_gas&quot;].fillna(0)

# Drop rows without capacity data
df = df.dropna(subset=[&quot;capacity_coal&quot;, &quot;capacity_gas&quot;])
print(f&quot;After capacity merge: {len(df)} records&quot;)
print(f&quot;Final date range: {df.index.min()} to {df.index.max()}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Jn9Jn-zDtLSyX_5tm-oXB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="calculate-fossil-residual-load" class="relative group"><span class="heading-text">Calculate Fossil Residual Load</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#calculate-fossil-residual-load" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="hd50LHXO9v" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>=</mo><mtext>Load</mtext><mo>−</mo><mo stretchy="false">(</mo><mtext>Wind</mtext><mo>+</mo><mtext>Solar</mtext><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mtext>Nuclear</mtext><mo>+</mo><mtext>Biomass</mtext><mo>+</mo><mtext>Hydro</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">RL_{fossil} = \text{Load} - (\text{Wind} + \text{Solar}) - (\text{Nuclear} + \text{Biomass} + \text{Hydro})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">oss</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">Load</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">Wind</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Solar</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">Nuclear</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">Biomass</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Hydro</span></span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#hd50LHXO9v" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><div id="wzZ4HYQros" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Calculate components
df[&quot;wind&quot;] = df[&quot;wind_onshore&quot;] + df[&quot;wind_offshore&quot;]
df[&quot;renewables&quot;] = df[&quot;solar&quot;] + df[&quot;wind&quot;]
df[&quot;baseload&quot;] = df[&quot;nuclear&quot;] + df[&quot;biomass&quot;] + df[&quot;hydro&quot;]

# Residual load for fossil plants
df[&quot;rl_fossil&quot;] = df[&quot;total_load&quot;] - df[&quot;renewables&quot;] - df[&quot;baseload&quot;]

# Standard residual load (for comparison)
df[&quot;residual_load&quot;] = df[&quot;total_load&quot;] - df[&quot;renewables&quot;]

print(&quot;Fossil Residual Load Statistics (MW):&quot;)
print(df[&quot;rl_fossil&quot;].describe().round(0))

# Count negative fossil residual load hours
negative_hours = (df[&quot;rl_fossil&quot;] &lt; 0).sum()
print(f&quot;\nHours with negative RL_fossil: {negative_hours} ({100*negative_hours/len(df):.1f}%)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Snt-gNh1op-n6GTsimw64" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="reconstruct-prices-using-merit-order" class="relative group"><span class="heading-text">Reconstruct Prices Using Merit Order</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#reconstruct-prices-using-merit-order" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>For each hour:</p><ol start="1"><li><p>Determine which fuel (coal or gas) has lower SRMC</p></li><li><p>If fossil residual load can be met by cheaper fuel capacity alone, use cheaper SRMC</p></li><li><p>Otherwise, use more expensive SRMC as the marginal price</p></li></ol><div id="LwcmL0Tzh8" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def reconstruct_price(row):
    &quot;&quot;&quot;Reconstruct electricity price based on merit order.&quot;&quot;&quot;
    rl_fossil = row[&quot;rl_fossil&quot;]
    gas_srmc = row[&quot;gas_srmc&quot;]
    coal_srmc = row[&quot;coal_srmc&quot;]
    capacity_coal = row[&quot;capacity_coal&quot;]
    capacity_gas = row[&quot;capacity_gas&quot;]

    # Handle negative residual load (renewable surplus)
    if rl_fossil &lt;= 0:
        return 0.0  # Price floor at zero for simplicity

    # Determine merit order based on SRMC
    if coal_srmc &lt;= gas_srmc:
        # Coal is cheaper
        cheaper_srmc = coal_srmc
        expensive_srmc = gas_srmc
        cheaper_capacity = capacity_coal
    else:
        # Gas is cheaper
        cheaper_srmc = gas_srmc
        expensive_srmc = coal_srmc
        cheaper_capacity = capacity_gas

    # Assign price based on which fuel is marginal
    if rl_fossil &lt;= cheaper_capacity:
        return cheaper_srmc
    else:
        return expensive_srmc</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="OBNlO_UF_qjzkRCfYeMZS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="dDSI113yUI" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Apply reconstruction
print(&quot;Reconstructing prices...&quot;)
df[&quot;price_reconstructed&quot;] = df.apply(reconstruct_price, axis=1)

print(&quot;\nReconstructed Price Statistics (EUR/MWh):&quot;)
print(df[&quot;price_reconstructed&quot;].describe().round(2))

print(&quot;\nActual Price Statistics (EUR/MWh):&quot;)
print(df[&quot;price&quot;].describe().round(2))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="GViCo0rFdt7v1ifAwMxbZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="compare-reconstructed-vs-actual-prices" class="relative group"><span class="heading-text">Compare Reconstructed vs Actual Prices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#compare-reconstructed-vs-actual-prices" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="XWEtEPOjnq" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Time series comparison (monthly averages)
monthly = df[[&quot;price&quot;, &quot;price_reconstructed&quot;]].resample(&quot;ME&quot;).mean()

fig, ax = plt.subplots(figsize=(14, 6))

ax.plot(monthly.index, monthly[&quot;price&quot;], label=&quot;Actual Price&quot;, linewidth=2)
ax.plot(
    monthly.index,
    monthly[&quot;price_reconstructed&quot;],
    label=&quot;Reconstructed Price&quot;,
    linewidth=2,
    linestyle=&quot;--&quot;,
)

ax.set_xlabel(&quot;Date&quot;)
ax.set_ylabel(&quot;Price (EUR/MWh)&quot;)
ax.set_title(&quot;Monthly Average: Actual vs Reconstructed Electricity Prices&quot;)
ax.legend()
ax.grid(True, alpha=0.3)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_actual_vs_reconstructed.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="KxaUBJ5BYTPUsDQivr7Zi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-actual-vs-reconstructed" class="fig-figure"><img id="lwHWdwHQf7" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_actual_vs_reconst-59c1f441b1bf422f460295c9b61555dc.png" alt="Monthly Average: Actual vs Reconstructed Electricity Prices" data-canonical-url="../../output/images/04_actual_vs_reconstructed.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-actual-vs-reconstructed" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->5<!-- -->:</a>Monthly Average: Actual vs Reconstructed Electricity Prices</p></figcaption></figure><h2 id="scatterplots" class="relative group"><span class="heading-text">Scatterplots</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#scatterplots" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="opuskl5cgR" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Sample data for scatterplots (performance)
sample_size = min(50000, len(df))
sample = df.sample(sample_size, random_state=42)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="SPevmd15L8AOZJWbjtwru" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="reconstructed-prices-vs-actual-prices" class="relative group"><span class="heading-text">Reconstructed Prices vs Actual Prices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#reconstructed-prices-vs-actual-prices" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="kBfNxPTMsV" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(10, 10))

ax.scatter(
    sample[&quot;price_reconstructed&quot;],
    sample[&quot;price&quot;],
    alpha=0.1,
    s=1,
)

# Add 45-degree line
price_range = [
    min(sample[&quot;price&quot;].min(), sample[&quot;price_reconstructed&quot;].min()),
    max(sample[&quot;price&quot;].max(), sample[&quot;price_reconstructed&quot;].max()),
]
ax.plot(price_range, price_range, &quot;r--&quot;, linewidth=1, label=&quot;Perfect fit&quot;)

ax.set_xlabel(&quot;Reconstructed Price (EUR/MWh)&quot;)
ax.set_ylabel(&quot;Actual Price (EUR/MWh)&quot;)
ax.set_title(&quot;Reconstructed vs Actual Electricity Prices&quot;)
ax.legend()
ax.grid(True, alpha=0.3)

# Add R² annotation
r2_reconstructed = r2_score(df[&quot;price&quot;], df[&quot;price_reconstructed&quot;])
ax.text(
    0.05,
    0.95,
    f&quot;R² = {r2_reconstructed:.3f}&quot;,
    transform=ax.transAxes,
    fontsize=12,
    verticalalignment=&quot;top&quot;,
    bbox=dict(boxstyle=&quot;round&quot;, facecolor=&quot;wheat&quot;, alpha=0.5),
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_scatter_reconstructed_vs_actual.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4BncUoCoCMm6XscgpStcU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-scatter-reconstructed-vs-actual" class="fig-figure"><img id="mqvFujRZCL" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_scatter_reconstru-3807b5d2b92c2dd23f52d2da17053f65.png" alt="Reconstructed vs Actual Electricity Prices" data-canonical-url="../../output/images/04_scatter_reconstructed_vs_actual.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-scatter-reconstructed-vs-actual" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->6<!-- -->:</a>Reconstructed vs Actual Electricity Prices</p></figcaption></figure><h3 id="residual-load-vs-actual-prices" class="relative group"><span class="heading-text">Residual Load vs Actual Prices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#residual-load-vs-actual-prices" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="DIRphjmLEX" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(10, 10))

ax.scatter(
    sample[&quot;residual_load&quot;],
    sample[&quot;price&quot;],
    alpha=0.1,
    s=1,
)

ax.set_xlabel(&quot;Residual Load (MW)&quot;)
ax.set_ylabel(&quot;Actual Price (EUR/MWh)&quot;)
ax.set_title(&quot;Residual Load vs Electricity Price&quot;)
ax.grid(True, alpha=0.3)

# Add correlation
corr = df[&quot;residual_load&quot;].corr(df[&quot;price&quot;])
ax.text(
    0.05,
    0.95,
    f&quot;Correlation: {corr:.3f}&quot;,
    transform=ax.transAxes,
    fontsize=12,
    verticalalignment=&quot;top&quot;,
    bbox=dict(boxstyle=&quot;round&quot;, facecolor=&quot;wheat&quot;, alpha=0.5),
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_scatter_residual_load_vs_price.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="v_5V-_Hvz3f3KZC9wV31F" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-scatter-residual-load-vs-price" class="fig-figure"><img id="ChyMvf6bQJ" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_scatter_residual_-b3f53f01abdbe566ddaf78ed1a84353d.png" alt="Residual Load vs Electricity Price" data-canonical-url="../../output/images/04_scatter_residual_load_vs_price.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-scatter-residual-load-vs-price" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->7<!-- -->:</a>Residual Load vs Electricity Price</p></figcaption></figure><h3 id="fossil-residual-load-vs-actual-prices" class="relative group"><span class="heading-text">Fossil Residual Load vs Actual Prices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#fossil-residual-load-vs-actual-prices" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div id="Bes3eExMks" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(10, 10))

ax.scatter(
    sample[&quot;rl_fossil&quot;],
    sample[&quot;price&quot;],
    alpha=0.1,
    s=1,
)

ax.set_xlabel(&quot;Fossil Residual Load (MW)&quot;)
ax.set_ylabel(&quot;Actual Price (EUR/MWh)&quot;)
ax.set_title(&quot;Fossil Residual Load vs Electricity Price&quot;)
ax.grid(True, alpha=0.3)

# Add correlation
corr_fossil = df[&quot;rl_fossil&quot;].corr(df[&quot;price&quot;])
ax.text(
    0.05,
    0.95,
    f&quot;Correlation: {corr_fossil:.3f}&quot;,
    transform=ax.transAxes,
    fontsize=12,
    verticalalignment=&quot;top&quot;,
    bbox=dict(boxstyle=&quot;round&quot;, facecolor=&quot;wheat&quot;, alpha=0.5),
)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_scatter_fossil_rl_vs_price.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="0SJmug1beoGzhs6y4xfIr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-scatter-fossil-rl-vs-price" class="fig-figure"><img id="nTJe30am6u" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_scatter_fossil_rl-33366361e25afc827765da32f8e00a86.png" alt="Fossil Residual Load vs Electricity Price" data-canonical-url="../../output/images/04_scatter_fossil_rl_vs_price.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-scatter-fossil-rl-vs-price" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->8<!-- -->:</a>Fossil Residual Load vs Electricity Price</p></figcaption></figure><h2 id="variance-explained-r" class="relative group"><span class="heading-text">Variance Explained (R²)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#variance-explained-r" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>How much of the price variation is explained by each model?</p><div id="Mqar60zm5O" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Prepare data for regression (drop NaN and infinite values)
df_clean = df[[&quot;price&quot;, &quot;residual_load&quot;, &quot;rl_fossil&quot;, &quot;price_reconstructed&quot;]].copy()
df_clean = df_clean.replace([np.inf, -np.inf], np.nan).dropna()

X_residual = df_clean[[&quot;residual_load&quot;]].values
X_fossil = df_clean[[&quot;rl_fossil&quot;]].values
X_reconstructed = df_clean[[&quot;price_reconstructed&quot;]].values
y = df_clean[&quot;price&quot;].values

# Fit linear models
model_residual = LinearRegression().fit(X_residual, y)
model_fossil = LinearRegression().fit(X_fossil, y)

# Calculate R² scores
r2_residual = model_residual.score(X_residual, y)
r2_fossil = model_fossil.score(X_fossil, y)
r2_reconstructed = r2_score(y, df_clean[&quot;price_reconstructed&quot;].values)

print(&quot;=&quot; * 60)
print(&quot;VARIANCE EXPLAINED (R²)&quot;)
print(&quot;=&quot; * 60)
print(f&quot;\nResidual Load (linear regression):      R² = {r2_residual:.4f}&quot;)
print(f&quot;Fossil Residual Load (linear regression): R² = {r2_fossil:.4f}&quot;)
print(f&quot;Reconstructed Prices (merit order model): R² = {r2_reconstructed:.4f}&quot;)
print()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="8b9-xtTHEJhXUFz93Eru7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="summary-statistics" class="relative group"><span class="heading-text">Summary Statistics</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#summary-statistics" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="QGFfkEbWkL" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Calculate additional metrics
mae = np.abs(df_clean[&quot;price&quot;] - df_clean[&quot;price_reconstructed&quot;]).mean()
rmse = np.sqrt(((df_clean[&quot;price&quot;] - df_clean[&quot;price_reconstructed&quot;]) ** 2).mean())

print(&quot;=&quot; * 60)
print(&quot;MODEL PERFORMANCE SUMMARY&quot;)
print(&quot;=&quot; * 60)
print(f&quot;\nMean Absolute Error (MAE):     {mae:.2f} EUR/MWh&quot;)
print(f&quot;Root Mean Square Error (RMSE): {rmse:.2f} EUR/MWh&quot;)
print(f&quot;\nActual price mean:        {df_clean[&#x27;price&#x27;].mean():.2f} EUR/MWh&quot;)
print(f&quot;Reconstructed price mean: {df_clean[&#x27;price_reconstructed&#x27;].mean():.2f} EUR/MWh&quot;)
print()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ei2rCj8VqVIdtVgR1IdZ0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="comparison-chart-what-explains-price-variation" class="relative group"><span class="heading-text">Comparison Chart: What Explains Price Variation?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#comparison-chart-what-explains-price-variation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="KsEob64uJg" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(10, 6))

models = [&quot;Residual Load\n(Linear)&quot;, &quot;Fossil RL\n(Linear)&quot;, &quot;Merit Order\n(Reconstructed)&quot;]
r2_values = [r2_residual, r2_fossil, r2_reconstructed]
colors = [&quot;#3498db&quot;, &quot;#2ecc71&quot;, &quot;#e74c3c&quot;]

bars = ax.bar(models, r2_values, color=colors, edgecolor=&quot;black&quot;, linewidth=1.2)

# Add value labels on bars
for bar, val in zip(bars, r2_values):
    height = bar.get_height()
    ax.text(
        bar.get_x() + bar.get_width() / 2.0,
        height + 0.01,
        f&quot;{val:.3f}&quot;,
        ha=&quot;center&quot;,
        va=&quot;bottom&quot;,
        fontsize=12,
        fontweight=&quot;bold&quot;,
    )

ax.set_ylabel(&quot;R² (Variance Explained)&quot;)
ax.set_title(&quot;How Much Price Variation is Explained?&quot;)
ax.set_ylim(0, 1.0)
ax.grid(True, alpha=0.3, axis=&quot;y&quot;)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;04_r2_comparison.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="pJGeOOu1g6xhMKlqyWXMG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><figure id="fig-04-r2-comparison" class="fig-figure"><img id="MRdVOwwPWx" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/04_r2_comparison-8c02c080b6d4da9e6a1c02835887621d.png" alt="How Much Price Variation is Explained?" data-canonical-url="../../output/images/04_r2_comparison.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-04-r2-comparison" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->9<!-- -->:</a>How Much Price Variation is Explained?</p></figcaption></figure><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/world-of-energy/notebooks/smard-de-prices"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">World of Energy</div>Electricity prices in Germany</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/world-of-energy/notebooks/load-seasonalities"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">World of Energy</div>Seasonality Heatmaps</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/world-of-energy/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-G62B6HZR.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/world-of-energy/build/root-PMP5BIHC.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-IX5KPAHP.js"/><link rel="modulepreload" href="/world-of-energy/build/routes/$-5ZLZ2O3Y.js"/><script>window.__remixContext = {"url":"/notebooks/reconstruct-prices","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.0","options":{"favicon":"/world-of-energy/build/fav-d1f706d5ae83b104d8ce59ecaa00fb68.ico","logo":"/world-of-energy/build/logo-4fc1371cfd231b110ea40f8fb3b0afff.png","folders":true},"nav":[],"actions":[],"projects":[{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"file":"notebooks/03_smard_DE_prices.md"},{"file":"notebooks/04_reconstruct_prices.md"},{"file":"notebooks/05_load_seasonalities.md"},{"file":"notebooks/10_earth_seasons.md"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5ef501a78015a82b19733ef7d68ea017.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-6ae980e49592e22ddf14629d80218276.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.earth-seasons","title":"Earth’s Seasons — From Sunlight to Vegetation","description":"","date":"","thumbnail":"/world-of-energy/build/10_sunlight_animatio-f6ac1e7f74d4bb303b286ea8782c1a27.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-128c8ed537da4ffc471b65ee69218b24.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/world-of-energy"},"routes/$":{"config":{"version":3,"myst":"1.8.0","options":{"favicon":"/world-of-energy/build/fav-d1f706d5ae83b104d8ce59ecaa00fb68.ico","logo":"/world-of-energy/build/logo-4fc1371cfd231b110ea40f8fb3b0afff.png","folders":true},"nav":[],"actions":[],"projects":[{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"file":"notebooks/03_smard_DE_prices.md"},{"file":"notebooks/04_reconstruct_prices.md"},{"file":"notebooks/05_load_seasonalities.md"},{"file":"notebooks/10_earth_seasons.md"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5ef501a78015a82b19733ef7d68ea017.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-6ae980e49592e22ddf14629d80218276.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.earth-seasons","title":"Earth’s Seasons — From Sunlight to Vegetation","description":"","date":"","thumbnail":"/world-of-energy/build/10_sunlight_animatio-f6ac1e7f74d4bb303b286ea8782c1a27.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-128c8ed537da4ffc471b65ee69218b24.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":3,"kind":"Notebook","sha256":"db644d2a67eb3a78b93cbf272d76a76b5f78a1e773e244817a054345a20b40df","slug":"notebooks.reconstruct-prices","location":"/notebooks/04_reconstruct_prices.md","dependencies":[],"frontmatter":{"title":"Fossil Fuel Costs and Electricity Price Reconstruction","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"text_representation":{"format_name":"percent"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/04_reconstruct_prices.md","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/04_reconstruct_prices.md","thumbnail":"/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png","exports":[{"format":"md","filename":"04_reconstruct_prices.md","url":"/world-of-energy/build/04_reconstruct_price-f0fe1cab85f32ac2bf813a8feaf81a2c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"This notebook calculates the Short Run Marginal Costs (SRMC) of generating\nelectricity using hard coal and fossil gas, then uses a simplified merit\norder model to reconstruct wholesale electricity prices.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YBnVWhneon"}],"key":"xtwpXBuf2A"},{"type":"heading","depth":2,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Approach","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"LS6JrWCacg"}],"identifier":"approach","label":"Approach","html_id":"approach","implicit":true,"key":"XtP6WXnJdB"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Calculate ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"qU92tAkI3a"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"SRMC","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"mSPk1u1uPf"}],"key":"TgY3nTK8pr"},{"type":"text","value":" for coal and gas power plants from commodity prices","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"fdx2cYiQuZ"}],"key":"c16YgVrBFa"}],"key":"PY5rDxw8pV"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Calculate ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"KpkZEIXU8S"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Fossil Residual Load","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"gTs6diJeRm"}],"key":"y7l4Up99N5"},{"type":"text","value":": the demand that must be met by fossil plants\nafter accounting for renewables and baseload generation","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"FdFYwFT0Pw"}],"key":"yrFyYpkPyK"}],"key":"cJuVDBkwLm"}],"key":"zGWBwbYd6w"},{"type":"math","value":"RL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro}_{RoR})","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eR\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eL\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmtext\u003eLoad\u003c/mtext\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003eWind\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eSolar\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003eNuclear\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eBiomass\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eHydro\u003c/mtext\u003e\u003cmrow\u003e\u003cmi\u003eR\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003eR\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eRL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro}_{RoR})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eL\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eoss\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eLoad\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eWind\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eSolar\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eNuclear\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eBiomass\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eHydro\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2342em;\"\u003e\u003cspan style=\"top:-2.4559em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eo\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2441em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"GfkfotMNX1"},{"type":"list","ordered":true,"start":3,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Determine which fossil fuel (coal or gas) is cheaper based on SRMC","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"w0mQkDA3gF"}],"key":"cnO6tC9D4N"}],"key":"aNiNIxDdAY"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Assign price based on merit order:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ZybpEYIu3i"}],"key":"ZUFkgWR3Kb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"oqjl4xdJyH"},{"type":"inlineMath","value":"RL_{fossil} \\leq \\text{cheaper capacity}","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eR\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eL\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmtext\u003echeaper capacity\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eRL_{fossil} \\leq \\text{cheaper capacity}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eL\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eoss\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003echeaper capacity\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Po72RrnSIz"},{"type":"text","value":": price = cheaper SRMC","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"u52wJ5KBod"}],"key":"SCiVkrbRHy"}],"key":"eO6iWk7qeH"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"FlakWdWsy8"},{"type":"inlineMath","value":"RL_{fossil} \u003e \\text{cheaper capacity}","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eR\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eL\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmtext\u003echeaper capacity\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eRL_{fossil} \u0026gt; \\text{cheaper capacity}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eL\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eoss\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003echeaper capacity\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"l11wrstY8U"},{"type":"text","value":": price = more expensive SRMC","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"tnWX6iqHBr"}],"key":"EAxNvFWx83"}],"key":"EBLBsySkMS"}],"key":"z1rV2luxKf"}],"key":"WI98tGvE3c"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Compare reconstructed prices with actual market prices","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"mDgZ7qiqBv"}],"key":"Q9TAOalonY"}],"key":"EsvQNsCQPe"}],"key":"LLdjHPUNT1"}],"key":"YuAGT4PJCD"},{"type":"block","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Short Run Marginal Costs (SRMC)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"yUtAm00iw4"}],"identifier":"short-run-marginal-costs-srmc","label":"Short Run Marginal Costs (SRMC)","html_id":"short-run-marginal-costs-srmc","implicit":true,"key":"S2Kqwrufp9"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"tRSp2SQvQs"},{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Short Run Marginal Cost (SRMC)","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"lcMtVUf6cz"}],"key":"zC43y5kn4N"},{"type":"text","value":" represents the variable cost of producing\none additional MWh of electricity from a power plant. It determines the merit\norder position of generators in wholesale electricity markets.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"PeYhdcLgKW"}],"key":"FfCgx0DQxk"},{"type":"heading","depth":3,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Components of SRMC","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Vnf1rZ3cfb"}],"identifier":"components-of-srmc","label":"Components of SRMC","html_id":"components-of-srmc","implicit":true,"key":"Hc47QVUQ7X"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"SRMC consists of three main components:","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"jlvSxcbbMh"}],"key":"IAfNlKLUvc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":46,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"Fuel costs","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"iQfbbemS31"}],"key":"oJvCXrT8H4"},{"type":"text","value":" - The cost of the primary fuel (gas or coal) needed to\ngenerate electricity, adjusted for plant efficiency.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"FXZM2RR2sn"}],"key":"vt7DjvZQ8Q"}],"key":"nkciVwuixd"},{"type":"listItem","spread":true,"position":{"start":{"line":49,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"strong","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Carbon costs","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Cx0LH9o0Me"}],"key":"gxJdFT0ZeV"},{"type":"text","value":" - The cost of CO2 emissions under the EU Emissions Trading\nScheme (EU ETS), based on the carbon intensity of the fuel.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"yIXsmdiXaH"}],"key":"zJMBFdtpyR"}],"key":"cSwAuOcmEC"},{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"strong","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Variable O\u0026M costs","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"zuKaGHl5ss"}],"key":"A57n94gbZ2"},{"type":"text","value":" - Operating and maintenance costs that vary with\nelectricity output.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"TnR9g6gcEQ"}],"key":"JIwQoopeXe"}],"key":"f1ilolJ8Vu"}],"key":"Y2abSmt0UQ"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Price References","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"Z1j5ltOYrp"}],"identifier":"price-references","label":"Price References","html_id":"price-references","implicit":true,"key":"uVpSildGbd"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"strong","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Fossil Gas:","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"tPVGwQkFV5"}],"key":"cJq4M7RcFG"}],"key":"SHF34CLXWJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":58,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Dutch Title Transfer Facility (TTF) is the benchmark for gas traded in Europe","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"VW7yzgbSsl"}],"key":"o4zTfUOJgt"}],"key":"Hczz7YbhVw"},{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Other European hubs (CEGH VTP, THE, PSV, etc.) trade at spreads to TTF","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Xbz4OCtlpp"}],"key":"Vmr48c8Qd4"}],"key":"G7QmWe5AaC"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prices sourced from commodity exchanges (e.g., ICE, EEX)","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"VsuSvGGCkk"}],"key":"XDI9hsJYEE"}],"key":"kM1WDea9Hb"}],"key":"ZbXZizFQQ2"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"strong","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Hard Coal:","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"iZY9zE5U3Z"}],"key":"rUmixpD1io"}],"key":"I0hGPvgGfr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":63,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"API 2 Rotterdam is the benchmark for coal imported into Northwest Europe","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"N2rye3PAmX"}],"key":"dXvH6eOgoE"}],"key":"mazkIpnu8d"},{"type":"listItem","spread":true,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Front month settlement prices in USD/metric ton","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"mgSNFiodTq"}],"key":"gp8ZVSFlnX"}],"key":"ciK9AV3oTJ"},{"type":"listItem","spread":true,"position":{"start":{"line":65,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Thermal content approximately 6,000 kcal/kg (NAR)","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"Cpw2zVWUef"}],"key":"MgvOzR5TfV"}],"key":"rYlw60IM1n"}],"key":"Ou5VUiaBuI"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Carbon:","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"J1eMdE0kii"}],"key":"TqspwXm7Cg"}],"key":"M9xPFDYzIV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":68,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"EU ETS allowance prices (EUA) for the front December contract","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"XA2FbfqUkf"}],"key":"UNQhlgCq5y"}],"key":"vK7o0asSVx"},{"type":"listItem","spread":true,"position":{"start":{"line":69,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prices in EUR per tonne CO2","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"JR11Wkb1Ze"}],"key":"WVCeGJSx3q"}],"key":"ns70HkipOM"}],"key":"CY0VYJtRVH"},{"type":"heading","depth":3,"position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"Calculation Assumptions","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"GdWtdkjlU1"}],"identifier":"calculation-assumptions","label":"Calculation Assumptions","html_id":"calculation-assumptions","implicit":true,"key":"ggLrnu0KSS"},{"type":"table","position":{"start":{"line":73,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Parameter","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"Fgs4MvPRqH"}],"key":"lkIxfGIsHU"},{"type":"tableCell","header":true,"position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Hard Coal","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"UZKJReXY5r"}],"key":"q2yXDlDEbA"},{"type":"tableCell","header":true,"position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Fossil Gas","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"T9bguxd1yO"}],"key":"XzldBIS41l"}],"key":"bokyam8juw"},{"type":"tableRow","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Efficiency (HHV)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"XoCYF8hk5Y"}],"key":"sZsB2zz4wT"},{"type":"tableCell","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"40%","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"VhDjSMfwjU"}],"key":"Jhz2zFTKvI"},{"type":"tableCell","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"50%","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"pxDPDRZQHi"}],"key":"Yx2EifrX8D"}],"key":"nDZhBG784a"},{"type":"tableRow","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Carbon intensity","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"HjONbqXBsO"}],"key":"fYxYRRDJzQ"},{"type":"tableCell","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"0.83 tCO2/MWh","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"KXDRDTJdIQ"}],"key":"h5RmEOJAbj"},{"type":"tableCell","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"0.37 tCO2/MWh","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"xMkh9oojwA"}],"key":"eTXlBTMP1V"}],"key":"b6ECj3oyhV"},{"type":"tableRow","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Variable O\u0026M","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"MUUl6HQSBr"}],"key":"WP1j9aQXSN"},{"type":"tableCell","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"€2/MWh","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"SvvJABGX1s"}],"key":"CRRXy2r1Qu"},{"type":"tableCell","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"€2/MWh","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"wKgCZBN0xI"}],"key":"gdef5e3c6Q"}],"key":"mNdyGmcroR"}],"key":"usm55OhXzL"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The carbon intensity values represent emissions per MWh of electricity generated,\naccounting for the power plant efficiency.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"EA5qLb7Kxa"}],"key":"grmklMfB9N"},{"type":"heading","depth":3,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Why SRMC Matters","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"EuE8xytx4w"}],"identifier":"why-srmc-matters","label":"Why SRMC Matters","html_id":"why-srmc-matters","implicit":true,"key":"pT2TZbnOo0"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"In liberalized electricity markets, generators bid close to their marginal cost.\nThe SRMC comparison between coal and gas determines:","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Y5b45blAsb"}],"key":"xHaoByfKJz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":87,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Fuel switching","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"uIWsio6p27"}],"key":"KjLETGql7K"},{"type":"text","value":" - When gas SRMC falls below coal, utilities switch from\ncoal to gas, reducing emissions","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"eOBZAt0iov"}],"key":"N9Oe44aDNA"}],"key":"S6jvP6kIei"},{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Price formation","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"wWGlEeFSyV"}],"key":"kqM0FVm0Aa"},{"type":"text","value":" - The highest SRMC plant needed to meet demand often\nsets the wholesale electricity price","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"u62jO8rota"}],"key":"NJ0z3ApSKz"}],"key":"B4ZUDwxvWt"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Investment signals","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"aFFG7AuFCu"}],"key":"iCUJmxXxNo"},{"type":"text","value":" - Persistent SRMC relationships influence new build\ndecisions and plant retirements","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"egc4e1BHW7"}],"key":"UMKek01wCd"}],"key":"e8IkHDDvDi"}],"key":"FSPJq9SeBT"}],"key":"kOVBbqWIm0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score\n\nfrom woe.paths import ProjPaths","key":"BZPmiLUQJy"},{"type":"outputs","id":"p99I7NAo2HGbHcXOgO7tE","children":[],"key":"BMX0nkM5hl"}],"key":"oa2NhaXHvG"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"SRMC Calculation Parameters","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"z3Q6GoNDaO"}],"identifier":"srmc-calculation-parameters","label":"SRMC Calculation Parameters","html_id":"srmc-calculation-parameters","implicit":true,"key":"nuL6I3Xhy3"}],"key":"QvgzEfK7Nn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Power plant efficiency rates (Higher Heating Value / Gross Calorific Value)\nCOAL_EFFICIENCY = 0.40  # 40%\nGAS_EFFICIENCY = 0.50  # 50%\n\n# Carbon intensity (tCO2 per MWh of electricity generated)\nCOAL_CARBON_INTENSITY = 0.83  # tCO2/MWh\nGAS_CARBON_INTENSITY = 0.37  # tCO2/MWh\n\n# Variable Operating and Maintenance costs (EUR/MWh)\nVOM_COST = 2.0\n\n# Coal thermal content (MWh per metric ton)\n# API 2 coal specification: 6,000 kcal/kg NAR\n# 6,000 kcal/kg = 6,000,000 kcal/t ÷ 860,421 kcal/MWh ≈ 6.98 MWh/t\nCOAL_THERMAL_CONTENT = 6.98  # MWh/t\n\n# EUR/USD exchange rate (approximate)\nEURUSD_RATE = 1.08","key":"wSrvBIfmJn"},{"type":"outputs","id":"C6DIniOE26qJB9KIw3HqJ","children":[],"key":"MDp3Fit5B5"}],"key":"FEQoqs5qoi"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Load Data","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"Oys919X3W5"}],"identifier":"load-data","label":"Load Data","html_id":"load-data","implicit":true,"key":"DLGUuEaIbd"}],"key":"WdMUN6bAb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"paths = ProjPaths()\npaths.images_path.mkdir(parents=True, exist_ok=True)\n\n# Load generation and consumption data\nprint(\"Loading SMARD data...\")\nsolar = pd.read_parquet(paths.smard_solar_file)\nwind_onshore = pd.read_parquet(paths.smard_wind_onshore_file)\nwind_offshore = pd.read_parquet(paths.smard_wind_offshore_file)\ntotal_load = pd.read_parquet(paths.smard_total_load_file)\nprices = pd.read_parquet(paths.smard_prices_file)\ncapacities = pd.read_parquet(paths.smard_capacities_file)\n\nprint(f\"Generation data: {solar.index.min()} to {solar.index.max()}\")\nprint(f\"Prices: {prices.index.min()} to {prices.index.max()}\")\nprint(f\"Capacities: {capacities.index.min()} to {capacities.index.max()}\")","key":"mCiIuzXON7"},{"type":"outputs","id":"oRc7UWpI8q-IZqTWLQurz","children":[],"key":"VNz0R9WbvD"}],"key":"CPOEk5mTYM"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Baseload Generation Data","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"o1RP2OB47b"}],"identifier":"baseload-generation-data","label":"Baseload Generation Data","html_id":"baseload-generation-data","implicit":true,"key":"EVcUmJN75q"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"Nuclear, biomass, and hydro generation data for the fossil residual load calculation.","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"gg8m9a9qBU"}],"key":"xAmWDv157A"}],"key":"uuQV8sbhYo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Loading baseload generation data...\")\nnuclear = pd.read_parquet(paths.smard_nuclear_file)\nbiomass = pd.read_parquet(paths.smard_biomass_file)\nhydro = pd.read_parquet(paths.smard_hydro_file)\n\nprint(f\"Nuclear: {len(nuclear)} records\")\nprint(f\"Biomass: {len(biomass)} records\")\nprint(f\"Hydro: {len(hydro)} records\")","key":"ZV8GhHcF9u"},{"type":"outputs","id":"xlPGDpZF6CKBA1FptvMmf","children":[],"key":"MCLtLWgOVS"}],"key":"E7vCVdWe1I"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"Commodity Prices","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"NkM6DDn9b7"}],"identifier":"commodity-prices","label":"Commodity Prices","html_id":"commodity-prices","implicit":true,"key":"XiBc3xiXoS"}],"key":"c057oqTMCL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def load_investing_com_csv(filepath: str) -\u003e pd.Series:\n    \"\"\"Load price data from Investing.com CSV export.\"\"\"\n    df = pd.read_csv(\n        filepath,\n        encoding=\"utf-8-sig\",\n        parse_dates=[\"Date\"],\n        dayfirst=False,\n    )\n    df = df.set_index(\"Date\").sort_index()\n    return df[\"Price\"]","key":"WwhQBd7zZy"},{"type":"outputs","id":"Njwa3U66_6K3xL2iUGRft","children":[],"key":"xLa5nMthmo"}],"key":"NF2jUIgMrL"},{"type":"block","children":[],"key":"sPbKR68uBr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load commodity prices\nprint(\"Loading commodity prices...\")\ngas_df = pd.read_parquet(paths.ttf_gas_prices_file)\ngas_prices = gas_df[\"Close\"].rename(\"gas_price\")\n\ncoal_prices = load_investing_com_csv(paths.rotterdam_coal_prices_file).rename(\n    \"coal_price\"\n)\n\ncarbon_prices = load_investing_com_csv(paths.eu_carbon_prices_file).rename(\n    \"carbon_price\"\n)\n\nprint(f\"Gas prices: {gas_prices.index.min()} to {gas_prices.index.max()}\")\nprint(f\"Coal prices: {coal_prices.index.min()} to {coal_prices.index.max()}\")\nprint(f\"Carbon prices: {carbon_prices.index.min()} to {carbon_prices.index.max()}\")","key":"PF9xx60zCY"},{"type":"outputs","id":"FcRe3qtapZOMbrP3Dc-6a","children":[],"key":"lp9X1QUHOD"}],"key":"E1jk4w00vC"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Calculate SRMC","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"EFMaIctTiE"}],"identifier":"calculate-srmc","label":"Calculate SRMC","html_id":"calculate-srmc","implicit":true,"key":"AjB9q8ktw8"},{"type":"heading","depth":3,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Gas SRMC","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"dwmAlCgjMq"}],"identifier":"gas-srmc","label":"Gas SRMC","html_id":"gas-srmc","implicit":true,"key":"juJDPbU6UA"},{"type":"math","value":"\\text{Gas SRMC} = \\frac{\\text{Gas Price}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eGas SRMC\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmtext\u003eGas Price\u003c/mtext\u003e\u003cmtext\u003eEfficiency\u003c/mtext\u003e\u003c/mfrac\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eCarbon Intensity\u003c/mtext\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmtext\u003eCarbon Price\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eVOM\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Gas SRMC} = \\frac{\\text{Gas Price}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eGas SRMC\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.2408em;vertical-align:-0.8804em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eEfficiency\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eGas Price\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCarbon Intensity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCarbon Price\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eVOM\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"slPuGv3ajE"},{"type":"heading","depth":3,"position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Coal SRMC","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"VzQCqzzWoX"}],"identifier":"coal-srmc","label":"Coal SRMC","html_id":"coal-srmc","implicit":true,"key":"kx7rqbJ2AS"},{"type":"math","value":"\\text{Coal SRMC} = \\frac{\\text{Coal Price (EUR/MWh)}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eCoal SRMC\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmtext\u003eCoal Price (EUR/MWh)\u003c/mtext\u003e\u003cmtext\u003eEfficiency\u003c/mtext\u003e\u003c/mfrac\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eCarbon Intensity\u003c/mtext\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmtext\u003eCarbon Price\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eVOM\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Coal SRMC} = \\frac{\\text{Coal Price (EUR/MWh)}}{\\text{Efficiency}} + \\text{Carbon Intensity} \\times \\text{Carbon Price} + \\text{VOM}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCoal SRMC\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.3074em;vertical-align:-0.8804em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.427em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eEfficiency\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCoal Price (EUR/MWh)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCarbon Intensity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCarbon Price\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eVOM\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"moyOVvDFlD"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Note: Coal prices in USD/t need to be converted to EUR/MWh using:","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"NPW7bXjsTD"}],"key":"Dpk2NvBuHP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":205,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Exchange rate (USD/EUR)","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"uhKxmFGn0t"}],"key":"gsCZsJmgT3"}],"key":"e5BoDsV0aR"},{"type":"listItem","spread":true,"position":{"start":{"line":206,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Thermal content (MWh/t)","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"feXPtH6jk3"}],"key":"C7kr9wjsLm"}],"key":"DmqXIiGNkP"}],"key":"lhCHhj2Qsv"}],"key":"QNgf4kPU2M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Combine commodity prices (daily)\ncommodity_prices = pd.concat(\n    [gas_prices, coal_prices, carbon_prices], axis=1, join=\"inner\"\n)\ncommodity_prices = commodity_prices.ffill()\n\n# Convert coal from USD/t to EUR/MWh\ncoal_eur_mwh = commodity_prices[\"coal_price\"] / EURUSD_RATE / COAL_THERMAL_CONTENT\n\n# Calculate SRMC components\ngas_fuel_cost = commodity_prices[\"gas_price\"] / GAS_EFFICIENCY\ncoal_fuel_cost = coal_eur_mwh / COAL_EFFICIENCY\n\ngas_carbon_cost = GAS_CARBON_INTENSITY * commodity_prices[\"carbon_price\"]\ncoal_carbon_cost = COAL_CARBON_INTENSITY * commodity_prices[\"carbon_price\"]\n\n# Total SRMC (daily)\nsrmc_daily = pd.DataFrame(index=commodity_prices.index)\nsrmc_daily[\"gas_srmc\"] = gas_fuel_cost + gas_carbon_cost + VOM_COST\nsrmc_daily[\"coal_srmc\"] = coal_fuel_cost + coal_carbon_cost + VOM_COST\n\n# Store components for analysis\nsrmc_daily[\"gas_fuel_cost\"] = gas_fuel_cost\nsrmc_daily[\"gas_carbon_cost\"] = gas_carbon_cost\nsrmc_daily[\"coal_fuel_cost\"] = coal_fuel_cost\nsrmc_daily[\"coal_carbon_cost\"] = coal_carbon_cost\n\nprint(\"SRMC Summary (EUR/MWh):\")\nprint(srmc_daily[[\"gas_srmc\", \"coal_srmc\"]].describe().round(2))","key":"rzsQSNv27T"},{"type":"outputs","id":"aGtiUOM40rbEz57VeJvb3","children":[],"key":"LFmCpguL7v"}],"key":"Cr0m8AliSZ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"SRMC Time Series","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"jYcX4zfDy4"}],"identifier":"srmc-time-series","label":"SRMC Time Series","html_id":"srmc-time-series","implicit":true,"key":"EwZtghF5HK"}],"key":"xlqOqRcRRz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(14, 6))\n\nax.plot(srmc_daily.index, srmc_daily[\"gas_srmc\"], label=\"Gas SRMC\", linewidth=1, alpha=0.8)\nax.plot(srmc_daily.index, srmc_daily[\"coal_srmc\"], label=\"Coal SRMC\", linewidth=1, alpha=0.8)\n\nax.set_xlabel(\"Date\")\nax.set_ylabel(\"SRMC (EUR/MWh)\")\nax.set_title(\"Short Run Marginal Costs: Coal vs Gas\")\nax.legend()\nax.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_srmc_timeseries.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"QqIBCCw86c"},{"type":"outputs","id":"aCN3sVauaNqBl6KU1PR-I","children":[],"key":"yBM86UfhhJ"}],"key":"c09irjgr1I"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png","alt":"Short Run Marginal Costs: Coal vs Gas","data":{"altTextIsAutoGenerated":true},"key":"weExFNlPRF","urlSource":"../../output/images/04_srmc_timeseries.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-srmc-timeseries","identifier":"fig-04-srmc-timeseries","html_id":"fig-04-srmc-timeseries","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"mSvFOBq99m"},{"type":"text","value":"1","key":"tRGi0805bK"},{"type":"text","value":":","key":"n7JlQF0pAs"}],"template":"Figure %s:","key":"tChv9ThxpJ"},{"type":"text","value":"Short Run Marginal Costs: Coal vs Gas","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"XUJ611ZpT0"}],"key":"fWYJDnG2tp"}],"key":"pHmIUto9A6"}],"label":"fig-04-srmc-timeseries","identifier":"fig-04-srmc-timeseries","enumerator":"1","html_id":"fig-04-srmc-timeseries","key":"NVWmdOVLWF"}],"key":"cFDOSETcvp"},{"type":"block","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"Monthly Average SRMC","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"zqrdJXyR4B"}],"identifier":"monthly-average-srmc","label":"Monthly Average SRMC","html_id":"monthly-average-srmc","implicit":true,"key":"LrfEXMwbCX"}],"key":"mN0xVv1ROV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"monthly_srmc = srmc_daily[[\"gas_srmc\", \"coal_srmc\"]].resample(\"ME\").mean()\n\nfig, ax = plt.subplots(figsize=(14, 6))\n\nax.plot(\n    monthly_srmc.index,\n    monthly_srmc[\"gas_srmc\"],\n    label=\"Gas SRMC\",\n    marker=\"o\",\n    markersize=3,\n)\nax.plot(\n    monthly_srmc.index,\n    monthly_srmc[\"coal_srmc\"],\n    label=\"Coal SRMC\",\n    marker=\"o\",\n    markersize=3,\n)\n\nax.set_xlabel(\"Date\")\nax.set_ylabel(\"SRMC (EUR/MWh)\")\nax.set_title(\"Monthly Average Short Run Marginal Costs\")\nax.legend()\nax.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_monthly_srmc.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"imSIHZEh83"},{"type":"outputs","id":"ABNEGZomGPzPIujozW6tp","children":[],"key":"a2ktNAWWuH"}],"key":"bSvCvgq2AG"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_monthly_srmc-7d64c8bf8a95ba0c0b474f5aa0059ef1.png","alt":"Monthly Average Short Run Marginal Costs","data":{"altTextIsAutoGenerated":true},"key":"SPCI3bsfOH","urlSource":"../../output/images/04_monthly_srmc.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-monthly-srmc","identifier":"fig-04-monthly-srmc","html_id":"fig-04-monthly-srmc","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"avmqDrRPnP"},{"type":"text","value":"2","key":"yjcFa0Zo9Y"},{"type":"text","value":":","key":"c2HCfrzOzV"}],"template":"Figure %s:","key":"AglsR80ZPW"},{"type":"text","value":"Monthly Average Short Run Marginal Costs","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"LzyEx79gy6"}],"key":"b0zGxXMboH"}],"key":"mLZzTUDxja"}],"label":"fig-04-monthly-srmc","identifier":"fig-04-monthly-srmc","enumerator":"2","html_id":"fig-04-monthly-srmc","key":"crcXoiVI0O"}],"key":"RZO7dWoxHX"},{"type":"block","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"Fuel Switching Indicator","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"mveVtnqEBy"}],"identifier":"fuel-switching-indicator","label":"Fuel Switching Indicator","html_id":"fuel-switching-indicator","implicit":true,"key":"PfCnx30tKh"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"When gas SRMC is lower than coal SRMC, it is economically favorable to dispatch\ngas plants over coal plants, leading to lower emissions. This “fuel switching”\nis a key mechanism for carbon price effectiveness.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"Th7MYHzW9m"}],"key":"KvLXE6xzVO"}],"key":"eiI7l17OOT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate the spread (positive = gas cheaper than coal)\nsrmc_daily[\"spread\"] = srmc_daily[\"coal_srmc\"] - srmc_daily[\"gas_srmc\"]\n\nfig, axes = plt.subplots(2, 1, figsize=(14, 10), sharex=True)\n\n# SRMC comparison\nax1 = axes[0]\nax1.plot(srmc_daily.index, srmc_daily[\"gas_srmc\"], label=\"Gas SRMC\", linewidth=1, alpha=0.8)\nax1.plot(srmc_daily.index, srmc_daily[\"coal_srmc\"], label=\"Coal SRMC\", linewidth=1, alpha=0.8)\nax1.set_ylabel(\"SRMC (EUR/MWh)\")\nax1.set_title(\"Short Run Marginal Costs and Fuel Switching\")\nax1.legend()\nax1.grid(True, alpha=0.3)\n\n# Spread (coal - gas)\nax2 = axes[1]\nax2.fill_between(\n    srmc_daily.index,\n    srmc_daily[\"spread\"],\n    0,\n    where=srmc_daily[\"spread\"] \u003e= 0,\n    color=\"green\",\n    alpha=0.5,\n    label=\"Gas cheaper (fuel switch)\",\n)\nax2.fill_between(\n    srmc_daily.index,\n    srmc_daily[\"spread\"],\n    0,\n    where=srmc_daily[\"spread\"] \u003c 0,\n    color=\"red\",\n    alpha=0.5,\n    label=\"Coal cheaper\",\n)\nax2.axhline(y=0, color=\"black\", linestyle=\"-\", linewidth=0.5)\nax2.set_xlabel(\"Date\")\nax2.set_ylabel(\"Spread (EUR/MWh)\")\nax2.set_title(\"Coal-Gas Spread (positive = gas cheaper)\")\nax2.legend()\nax2.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_fuel_switching.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"PmcOr9T3jI"},{"type":"outputs","id":"tYLNlpFdjKWAMlueqsg7v","children":[],"key":"Ab57xg4Svs"}],"key":"ZWRQTAvFf1"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_fuel_switching-b8bd6c024d0f6ee370f800af1d89afb0.png","alt":"Short Run Marginal Costs and Fuel Switching Indicator","data":{"altTextIsAutoGenerated":true},"key":"QsDC7gRPQ8","urlSource":"../../output/images/04_fuel_switching.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-fuel-switching","identifier":"fig-04-fuel-switching","html_id":"fig-04-fuel-switching","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"wNcFNHda0C"},{"type":"text","value":"3","key":"D8ISNzMcmi"},{"type":"text","value":":","key":"yQnOO5APCI"}],"template":"Figure %s:","key":"ZIilXMpF4X"},{"type":"text","value":"Short Run Marginal Costs and Fuel Switching Indicator","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"fRuXCNopcL"}],"key":"IYxEIdCsDw"}],"key":"fr9fNxgW5X"}],"label":"fig-04-fuel-switching","identifier":"fig-04-fuel-switching","enumerator":"3","html_id":"fig-04-fuel-switching","key":"jpMdYLyUVG"}],"key":"i3NAGMhQ2b"},{"type":"block","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"SRMC Cost Components","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"jfGn8b0ABB"}],"identifier":"srmc-cost-components","label":"SRMC Cost Components","html_id":"srmc-cost-components","implicit":true,"key":"vl43qYS4Hx"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Breaking down the SRMC into its fuel and carbon cost components shows the\nrelative importance of each driver.","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"vlEATl09HI"}],"key":"gH6cKtl6w5"}],"key":"pR9gn4RBkX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# Gas SRMC components\nax1 = axes[0]\nax1.stackplot(\n    srmc_daily.index,\n    srmc_daily[\"gas_fuel_cost\"],\n    srmc_daily[\"gas_carbon_cost\"],\n    [VOM_COST] * len(srmc_daily),\n    labels=[\"Fuel Cost\", \"Carbon Cost\", \"Variable O\u0026M\"],\n    alpha=0.8,\n)\nax1.set_xlabel(\"Date\")\nax1.set_ylabel(\"Cost (EUR/MWh)\")\nax1.set_title(\"Gas SRMC Components\")\nax1.legend(loc=\"upper left\")\nax1.grid(True, alpha=0.3)\n\n# Coal SRMC components\nax2 = axes[1]\nax2.stackplot(\n    srmc_daily.index,\n    srmc_daily[\"coal_fuel_cost\"],\n    srmc_daily[\"coal_carbon_cost\"],\n    [VOM_COST] * len(srmc_daily),\n    labels=[\"Fuel Cost\", \"Carbon Cost\", \"Variable O\u0026M\"],\n    alpha=0.8,\n)\nax2.set_xlabel(\"Date\")\nax2.set_ylabel(\"Cost (EUR/MWh)\")\nax2.set_title(\"Coal SRMC Components\")\nax2.legend(loc=\"upper left\")\nax2.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_srmc_components.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"pXlUBHm8In"},{"type":"outputs","id":"lKHGsee0FtQ3t_pjKk1L1","children":[],"key":"PKzWQmwipe"}],"key":"LnJ3MaVVZ7"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_srmc_components-80a02da23aa6b5e5135476b7a9a45050.png","alt":"SRMC Cost Components (Gas and Coal)","data":{"altTextIsAutoGenerated":true},"key":"JpbiMXXrvC","urlSource":"../../output/images/04_srmc_components.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-srmc-components","identifier":"fig-04-srmc-components","html_id":"fig-04-srmc-components","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"QEoU5CFVwW"},{"type":"text","value":"4","key":"tJT6dvHLPD"},{"type":"text","value":":","key":"N8M9cADt7e"}],"template":"Figure %s:","key":"MTPy7WiMdz"},{"type":"text","value":"SRMC Cost Components (Gas and Coal)","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"Ci4D4fwB7o"}],"key":"E2KX2K2dot"}],"key":"c51wjkMrp4"}],"label":"fig-04-srmc-components","identifier":"fig-04-srmc-components","enumerator":"4","html_id":"fig-04-srmc-components","key":"VzXEfxXSjK"}],"key":"QInYpunVP1"},{"type":"block","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"children":[{"type":"text","value":"Combine All Data","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"maXyM21aJG"}],"identifier":"combine-all-data","label":"Combine All Data","html_id":"combine-all-data","implicit":true,"key":"kBnRLAE2Kz"},{"type":"paragraph","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"children":[{"type":"text","value":"Align all data to hourly resolution by forward-filling daily/monthly data.","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"LYaPR6gXpt"}],"key":"arAiCGouTw"}],"key":"FXZHF3bUUM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Combine generation data into single DataFrame\ndf = pd.concat(\n    [\n        solar.rename(columns={solar.columns[0]: \"solar\"}),\n        wind_onshore.rename(columns={wind_onshore.columns[0]: \"wind_onshore\"}),\n        wind_offshore.rename(columns={wind_offshore.columns[0]: \"wind_offshore\"}),\n        total_load.rename(columns={total_load.columns[0]: \"total_load\"}),\n        prices.rename(columns={prices.columns[0]: \"price\"}),\n        nuclear.rename(columns={nuclear.columns[0]: \"nuclear\"}),\n        biomass.rename(columns={biomass.columns[0]: \"biomass\"}),\n        hydro.rename(columns={hydro.columns[0]: \"hydro\"}),\n    ],\n    axis=1,\n)\n\n# Drop rows with missing generation/price data\ndf = df.dropna()\nprint(f\"Combined hourly data: {len(df)} records\")\nprint(f\"Date range: {df.index.min()} to {df.index.max()}\")","key":"CiM8AxCkde"},{"type":"outputs","id":"KaSXFmDqDw9gY1OJS4agA","children":[],"key":"mKI6Z3jmuY"}],"key":"gLN55RYj2f"},{"type":"block","children":[],"key":"lsMFIcbjdt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Forward-fill SRMC to hourly\n# Normalize index to date only for merging\ndf[\"date\"] = df.index.date\nsrmc_daily_reset = srmc_daily.copy()\nsrmc_daily_reset.index = srmc_daily_reset.index.date\n\ndf = df.merge(\n    srmc_daily_reset[[\"gas_srmc\", \"coal_srmc\"]],\n    left_on=\"date\",\n    right_index=True,\n    how=\"left\",\n)\ndf = df.drop(columns=[\"date\"])\n\n# Forward-fill any gaps in SRMC\ndf[\"gas_srmc\"] = df[\"gas_srmc\"].ffill()\ndf[\"coal_srmc\"] = df[\"coal_srmc\"].ffill()\n\n# Drop rows without SRMC data\ndf = df.dropna(subset=[\"gas_srmc\", \"coal_srmc\"])\nprint(f\"After SRMC merge: {len(df)} records\")","key":"DTii1COCk3"},{"type":"outputs","id":"wCW4kBvofYn_aGTZtqwjA","children":[],"key":"MI0YPQVqVd"}],"key":"mWrFhIDkrf"},{"type":"block","children":[],"key":"O0uNEHlT05"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Forward-fill capacities to hourly\n# Capacities are monthly, so we need to reindex and forward-fill\ncapacities_hourly = capacities.reindex(df.index, method=\"ffill\")\n\n# Add relevant capacity columns to main DataFrame\ndf[\"capacity_coal\"] = (\n    capacities_hourly[\"brown_coal\"].fillna(0)\n    + capacities_hourly[\"hard_coal\"].fillna(0)\n)\ndf[\"capacity_gas\"] = capacities_hourly[\"natural_gas\"].fillna(0)\n\n# Drop rows without capacity data\ndf = df.dropna(subset=[\"capacity_coal\", \"capacity_gas\"])\nprint(f\"After capacity merge: {len(df)} records\")\nprint(f\"Final date range: {df.index.min()} to {df.index.max()}\")","key":"ByeI6oYyye"},{"type":"outputs","id":"Jn9Jn-zDtLSyX_5tm-oXB","children":[],"key":"b2HAVXXnnc"}],"key":"E7JD3uEKRj"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"Calculate Fossil Residual Load","position":{"start":{"line":486,"column":1},"end":{"line":486,"column":1}},"key":"um9jKEwek6"}],"identifier":"calculate-fossil-residual-load","label":"Calculate Fossil Residual Load","html_id":"calculate-fossil-residual-load","implicit":true,"key":"rdPwLXmHpv"},{"type":"math","value":"RL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro})","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eR\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eL\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmtext\u003eLoad\u003c/mtext\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003eWind\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eSolar\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003eNuclear\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eBiomass\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eHydro\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eRL_{fossil} = \\text{Load} - (\\text{Wind} + \\text{Solar}) - (\\text{Nuclear} + \\text{Biomass} + \\text{Hydro})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eL\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eoss\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eLoad\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eWind\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eSolar\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eNuclear\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eBiomass\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eHydro\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"hd50LHXO9v"}],"key":"BCwJA9Ttgz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate components\ndf[\"wind\"] = df[\"wind_onshore\"] + df[\"wind_offshore\"]\ndf[\"renewables\"] = df[\"solar\"] + df[\"wind\"]\ndf[\"baseload\"] = df[\"nuclear\"] + df[\"biomass\"] + df[\"hydro\"]\n\n# Residual load for fossil plants\ndf[\"rl_fossil\"] = df[\"total_load\"] - df[\"renewables\"] - df[\"baseload\"]\n\n# Standard residual load (for comparison)\ndf[\"residual_load\"] = df[\"total_load\"] - df[\"renewables\"]\n\nprint(\"Fossil Residual Load Statistics (MW):\")\nprint(df[\"rl_fossil\"].describe().round(0))\n\n# Count negative fossil residual load hours\nnegative_hours = (df[\"rl_fossil\"] \u003c 0).sum()\nprint(f\"\\nHours with negative RL_fossil: {negative_hours} ({100*negative_hours/len(df):.1f}%)\")","key":"Mf2BoaCXqe"},{"type":"outputs","id":"Snt-gNh1op-n6GTsimw64","children":[],"key":"deg7P7fUSN"}],"key":"wzZ4HYQros"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":510,"column":1},"end":{"line":510,"column":1}},"children":[{"type":"text","value":"Reconstruct Prices Using Merit Order","position":{"start":{"line":510,"column":1},"end":{"line":510,"column":1}},"key":"bZOiCMqDKu"}],"identifier":"reconstruct-prices-using-merit-order","label":"Reconstruct Prices Using Merit Order","html_id":"reconstruct-prices-using-merit-order","implicit":true,"key":"hsAacMJQrc"},{"type":"paragraph","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"text","value":"For each hour:","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"alyh460yKf"}],"key":"kvItmF0Po2"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":513,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Determine which fuel (coal or gas) has lower SRMC","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"hvNf7badD1"}],"key":"AdWcVDRPbT"}],"key":"sLfD3ju7Cu"},{"type":"listItem","spread":true,"position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If fossil residual load can be met by cheaper fuel capacity alone, use cheaper SRMC","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"XA6ozsdeqT"}],"key":"zUkKcTwwS6"}],"key":"qt479qKbJU"},{"type":"listItem","spread":true,"position":{"start":{"line":515,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Otherwise, use more expensive SRMC as the marginal price","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"key":"g3cg6vLD1U"}],"key":"Nzzrmmx7Kc"}],"key":"fD8Tvwiopx"}],"key":"H6D6JM6jx0"}],"key":"IIwsvUctdj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def reconstruct_price(row):\n    \"\"\"Reconstruct electricity price based on merit order.\"\"\"\n    rl_fossil = row[\"rl_fossil\"]\n    gas_srmc = row[\"gas_srmc\"]\n    coal_srmc = row[\"coal_srmc\"]\n    capacity_coal = row[\"capacity_coal\"]\n    capacity_gas = row[\"capacity_gas\"]\n\n    # Handle negative residual load (renewable surplus)\n    if rl_fossil \u003c= 0:\n        return 0.0  # Price floor at zero for simplicity\n\n    # Determine merit order based on SRMC\n    if coal_srmc \u003c= gas_srmc:\n        # Coal is cheaper\n        cheaper_srmc = coal_srmc\n        expensive_srmc = gas_srmc\n        cheaper_capacity = capacity_coal\n    else:\n        # Gas is cheaper\n        cheaper_srmc = gas_srmc\n        expensive_srmc = coal_srmc\n        cheaper_capacity = capacity_gas\n\n    # Assign price based on which fuel is marginal\n    if rl_fossil \u003c= cheaper_capacity:\n        return cheaper_srmc\n    else:\n        return expensive_srmc","key":"hXaMY7Kq0K"},{"type":"outputs","id":"OBNlO_UF_qjzkRCfYeMZS","children":[],"key":"ooqFwQ78jD"}],"key":"LwcmL0Tzh8"},{"type":"block","children":[],"key":"AGz9ZHnUTM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply reconstruction\nprint(\"Reconstructing prices...\")\ndf[\"price_reconstructed\"] = df.apply(reconstruct_price, axis=1)\n\nprint(\"\\nReconstructed Price Statistics (EUR/MWh):\")\nprint(df[\"price_reconstructed\"].describe().round(2))\n\nprint(\"\\nActual Price Statistics (EUR/MWh):\")\nprint(df[\"price\"].describe().round(2))","key":"hSFIKU5jm6"},{"type":"outputs","id":"GViCo0rFdt7v1ifAwMxbZ","children":[],"key":"Kz5jb92nPW"}],"key":"dDSI113yUI"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"children":[{"type":"text","value":"Compare Reconstructed vs Actual Prices","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"QlNmhmyWTs"}],"identifier":"compare-reconstructed-vs-actual-prices","label":"Compare Reconstructed vs Actual Prices","html_id":"compare-reconstructed-vs-actual-prices","implicit":true,"key":"JipWolIhFW"}],"key":"tCXae43EuE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Time series comparison (monthly averages)\nmonthly = df[[\"price\", \"price_reconstructed\"]].resample(\"ME\").mean()\n\nfig, ax = plt.subplots(figsize=(14, 6))\n\nax.plot(monthly.index, monthly[\"price\"], label=\"Actual Price\", linewidth=2)\nax.plot(\n    monthly.index,\n    monthly[\"price_reconstructed\"],\n    label=\"Reconstructed Price\",\n    linewidth=2,\n    linestyle=\"--\",\n)\n\nax.set_xlabel(\"Date\")\nax.set_ylabel(\"Price (EUR/MWh)\")\nax.set_title(\"Monthly Average: Actual vs Reconstructed Electricity Prices\")\nax.legend()\nax.grid(True, alpha=0.3)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_actual_vs_reconstructed.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"vLeroFEMW0"},{"type":"outputs","id":"KxaUBJ5BYTPUsDQivr7Zi","children":[],"key":"hQ5HDHfyad"}],"key":"XWEtEPOjnq"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_actual_vs_reconst-59c1f441b1bf422f460295c9b61555dc.png","alt":"Monthly Average: Actual vs Reconstructed Electricity Prices","data":{"altTextIsAutoGenerated":true},"key":"lwHWdwHQf7","urlSource":"../../output/images/04_actual_vs_reconstructed.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-actual-vs-reconstructed","identifier":"fig-04-actual-vs-reconstructed","html_id":"fig-04-actual-vs-reconstructed","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"INTIfygiEh"},{"type":"text","value":"5","key":"KCO0Zp0Ww4"},{"type":"text","value":":","key":"EdtrWNgPax"}],"template":"Figure %s:","key":"ykXBuPgqBb"},{"type":"text","value":"Monthly Average: Actual vs Reconstructed Electricity Prices","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"UcPa0H1G7X"}],"key":"uAUMIAvaTi"}],"key":"wrqORLGr88"}],"label":"fig-04-actual-vs-reconstructed","identifier":"fig-04-actual-vs-reconstructed","enumerator":"5","html_id":"fig-04-actual-vs-reconstructed","key":"LOCa3Bt9an"}],"key":"aP9ZXJMpcy"},{"type":"block","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"children":[{"type":"text","value":"Scatterplots","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"dRZeGxO3sY"}],"identifier":"scatterplots","label":"Scatterplots","html_id":"scatterplots","implicit":true,"key":"spxmOFX6Zn"}],"key":"AaoZwmpWa6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Sample data for scatterplots (performance)\nsample_size = min(50000, len(df))\nsample = df.sample(sample_size, random_state=42)","key":"FA0ImmYqnY"},{"type":"outputs","id":"SPevmd15L8AOZJWbjtwru","children":[],"key":"wBOaor615z"}],"key":"opuskl5cgR"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"children":[{"type":"text","value":"Reconstructed Prices vs Actual Prices","position":{"start":{"line":604,"column":1},"end":{"line":604,"column":1}},"key":"e7qvVKsU0u"}],"identifier":"reconstructed-prices-vs-actual-prices","label":"Reconstructed Prices vs Actual Prices","html_id":"reconstructed-prices-vs-actual-prices","implicit":true,"key":"ViYn30MaG2"}],"key":"Lu4MpUdDCK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 10))\n\nax.scatter(\n    sample[\"price_reconstructed\"],\n    sample[\"price\"],\n    alpha=0.1,\n    s=1,\n)\n\n# Add 45-degree line\nprice_range = [\n    min(sample[\"price\"].min(), sample[\"price_reconstructed\"].min()),\n    max(sample[\"price\"].max(), sample[\"price_reconstructed\"].max()),\n]\nax.plot(price_range, price_range, \"r--\", linewidth=1, label=\"Perfect fit\")\n\nax.set_xlabel(\"Reconstructed Price (EUR/MWh)\")\nax.set_ylabel(\"Actual Price (EUR/MWh)\")\nax.set_title(\"Reconstructed vs Actual Electricity Prices\")\nax.legend()\nax.grid(True, alpha=0.3)\n\n# Add R² annotation\nr2_reconstructed = r2_score(df[\"price\"], df[\"price_reconstructed\"])\nax.text(\n    0.05,\n    0.95,\n    f\"R² = {r2_reconstructed:.3f}\",\n    transform=ax.transAxes,\n    fontsize=12,\n    verticalalignment=\"top\",\n    bbox=dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5),\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_scatter_reconstructed_vs_actual.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"oIVP6w8mA9"},{"type":"outputs","id":"4BncUoCoCMm6XscgpStcU","children":[],"key":"P20euiNRmk"}],"key":"kBfNxPTMsV"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_scatter_reconstru-3807b5d2b92c2dd23f52d2da17053f65.png","alt":"Reconstructed vs Actual Electricity Prices","data":{"altTextIsAutoGenerated":true},"key":"mqvFujRZCL","urlSource":"../../output/images/04_scatter_reconstructed_vs_actual.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-scatter-reconstructed-vs-actual","identifier":"fig-04-scatter-reconstructed-vs-actual","html_id":"fig-04-scatter-reconstructed-vs-actual","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"Y7JcDs5bov"},{"type":"text","value":"6","key":"c86AAjzTn8"},{"type":"text","value":":","key":"i6gFyUV5Fv"}],"template":"Figure %s:","key":"jGCxrsRqxm"},{"type":"text","value":"Reconstructed vs Actual Electricity Prices","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"HByQQysFjh"}],"key":"tCqI3M5Ouo"}],"key":"N2DZnIM8a8"}],"label":"fig-04-scatter-reconstructed-vs-actual","identifier":"fig-04-scatter-reconstructed-vs-actual","enumerator":"6","html_id":"fig-04-scatter-reconstructed-vs-actual","key":"BJDDWRz9bq"}],"key":"ycYjpUN5nO"},{"type":"block","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"children":[{"type":"text","value":"Residual Load vs Actual Prices","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"bo9YEudmgJ"}],"identifier":"residual-load-vs-actual-prices","label":"Residual Load vs Actual Prices","html_id":"residual-load-vs-actual-prices","implicit":true,"key":"U4DxHJQRYT"}],"key":"Jqpn2002gN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 10))\n\nax.scatter(\n    sample[\"residual_load\"],\n    sample[\"price\"],\n    alpha=0.1,\n    s=1,\n)\n\nax.set_xlabel(\"Residual Load (MW)\")\nax.set_ylabel(\"Actual Price (EUR/MWh)\")\nax.set_title(\"Residual Load vs Electricity Price\")\nax.grid(True, alpha=0.3)\n\n# Add correlation\ncorr = df[\"residual_load\"].corr(df[\"price\"])\nax.text(\n    0.05,\n    0.95,\n    f\"Correlation: {corr:.3f}\",\n    transform=ax.transAxes,\n    fontsize=12,\n    verticalalignment=\"top\",\n    bbox=dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5),\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_scatter_residual_load_vs_price.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"D9Z3FRAbos"},{"type":"outputs","id":"v_5V-_Hvz3f3KZC9wV31F","children":[],"key":"m3QAGvTcBl"}],"key":"DIRphjmLEX"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_scatter_residual_-b3f53f01abdbe566ddaf78ed1a84353d.png","alt":"Residual Load vs Electricity Price","data":{"altTextIsAutoGenerated":true},"key":"ChyMvf6bQJ","urlSource":"../../output/images/04_scatter_residual_load_vs_price.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-scatter-residual-load-vs-price","identifier":"fig-04-scatter-residual-load-vs-price","html_id":"fig-04-scatter-residual-load-vs-price","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"MEYHEJmMhl"},{"type":"text","value":"7","key":"rrwz3X9gnI"},{"type":"text","value":":","key":"Z0uS4kXlxB"}],"template":"Figure %s:","key":"anREfvF7iS"},{"type":"text","value":"Residual Load vs Electricity Price","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"key":"jgHgsZoyqj"}],"key":"U2NRW1MMTz"}],"key":"jPIEnmFmrM"}],"label":"fig-04-scatter-residual-load-vs-price","identifier":"fig-04-scatter-residual-load-vs-price","enumerator":"7","html_id":"fig-04-scatter-residual-load-vs-price","key":"Vs1k8IEPbr"}],"key":"LSiGv8BoPi"},{"type":"block","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"children":[{"type":"text","value":"Fossil Residual Load vs Actual Prices","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"key":"ExiFJ5TVsU"}],"identifier":"fossil-residual-load-vs-actual-prices","label":"Fossil Residual Load vs Actual Prices","html_id":"fossil-residual-load-vs-actual-prices","implicit":true,"key":"XVo2Jg6A7P"}],"key":"ImjpYxd76e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 10))\n\nax.scatter(\n    sample[\"rl_fossil\"],\n    sample[\"price\"],\n    alpha=0.1,\n    s=1,\n)\n\nax.set_xlabel(\"Fossil Residual Load (MW)\")\nax.set_ylabel(\"Actual Price (EUR/MWh)\")\nax.set_title(\"Fossil Residual Load vs Electricity Price\")\nax.grid(True, alpha=0.3)\n\n# Add correlation\ncorr_fossil = df[\"rl_fossil\"].corr(df[\"price\"])\nax.text(\n    0.05,\n    0.95,\n    f\"Correlation: {corr_fossil:.3f}\",\n    transform=ax.transAxes,\n    fontsize=12,\n    verticalalignment=\"top\",\n    bbox=dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5),\n)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_scatter_fossil_rl_vs_price.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"eFCpc93wXx"},{"type":"outputs","id":"0SJmug1beoGzhs6y4xfIr","children":[],"key":"bW4cZO1yUR"}],"key":"Bes3eExMks"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_scatter_fossil_rl-33366361e25afc827765da32f8e00a86.png","alt":"Fossil Residual Load vs Electricity Price","data":{"altTextIsAutoGenerated":true},"key":"nTJe30am6u","urlSource":"../../output/images/04_scatter_fossil_rl_vs_price.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-scatter-fossil-rl-vs-price","identifier":"fig-04-scatter-fossil-rl-vs-price","html_id":"fig-04-scatter-fossil-rl-vs-price","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"EeWOJAcqif"},{"type":"text","value":"8","key":"wnTWiMcYy9"},{"type":"text","value":":","key":"q8Xmubnbxs"}],"template":"Figure %s:","key":"s1izWGTuY9"},{"type":"text","value":"Fossil Residual Load vs Electricity Price","position":{"start":{"line":730,"column":1},"end":{"line":730,"column":1}},"key":"l5huo6jJap"}],"key":"gwCcilIJuC"}],"key":"SjOVnyC065"}],"label":"fig-04-scatter-fossil-rl-vs-price","identifier":"fig-04-scatter-fossil-rl-vs-price","enumerator":"8","html_id":"fig-04-scatter-fossil-rl-vs-price","key":"FyA3K99dUr"}],"key":"yrYuHywGUT"},{"type":"block","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":735,"column":1},"end":{"line":735,"column":1}},"children":[{"type":"text","value":"Variance Explained (R²)","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":1}},"key":"lPmQ5BTIBh"}],"identifier":"variance-explained-r","label":"Variance Explained (R²)","html_id":"variance-explained-r","implicit":true,"key":"eV8OOIa29x"},{"type":"paragraph","position":{"start":{"line":737,"column":1},"end":{"line":737,"column":1}},"children":[{"type":"text","value":"How much of the price variation is explained by each model?","position":{"start":{"line":737,"column":1},"end":{"line":737,"column":1}},"key":"neOgFhdxww"}],"key":"rDM1ZIHcLA"}],"key":"abWbwT04JG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Prepare data for regression (drop NaN and infinite values)\ndf_clean = df[[\"price\", \"residual_load\", \"rl_fossil\", \"price_reconstructed\"]].copy()\ndf_clean = df_clean.replace([np.inf, -np.inf], np.nan).dropna()\n\nX_residual = df_clean[[\"residual_load\"]].values\nX_fossil = df_clean[[\"rl_fossil\"]].values\nX_reconstructed = df_clean[[\"price_reconstructed\"]].values\ny = df_clean[\"price\"].values\n\n# Fit linear models\nmodel_residual = LinearRegression().fit(X_residual, y)\nmodel_fossil = LinearRegression().fit(X_fossil, y)\n\n# Calculate R² scores\nr2_residual = model_residual.score(X_residual, y)\nr2_fossil = model_fossil.score(X_fossil, y)\nr2_reconstructed = r2_score(y, df_clean[\"price_reconstructed\"].values)\n\nprint(\"=\" * 60)\nprint(\"VARIANCE EXPLAINED (R²)\")\nprint(\"=\" * 60)\nprint(f\"\\nResidual Load (linear regression):      R² = {r2_residual:.4f}\")\nprint(f\"Fossil Residual Load (linear regression): R² = {r2_fossil:.4f}\")\nprint(f\"Reconstructed Prices (merit order model): R² = {r2_reconstructed:.4f}\")\nprint()","key":"q2kdUiMwiH"},{"type":"outputs","id":"8b9-xtTHEJhXUFz93Eru7","children":[],"key":"HPL7Ul7ILY"}],"key":"Mqar60zm5O"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"children":[{"type":"text","value":"Summary Statistics","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"key":"byKfEXdxU7"}],"identifier":"summary-statistics","label":"Summary Statistics","html_id":"summary-statistics","implicit":true,"key":"kKz7JiBkJ5"}],"key":"INVhoMO3uq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate additional metrics\nmae = np.abs(df_clean[\"price\"] - df_clean[\"price_reconstructed\"]).mean()\nrmse = np.sqrt(((df_clean[\"price\"] - df_clean[\"price_reconstructed\"]) ** 2).mean())\n\nprint(\"=\" * 60)\nprint(\"MODEL PERFORMANCE SUMMARY\")\nprint(\"=\" * 60)\nprint(f\"\\nMean Absolute Error (MAE):     {mae:.2f} EUR/MWh\")\nprint(f\"Root Mean Square Error (RMSE): {rmse:.2f} EUR/MWh\")\nprint(f\"\\nActual price mean:        {df_clean['price'].mean():.2f} EUR/MWh\")\nprint(f\"Reconstructed price mean: {df_clean['price_reconstructed'].mean():.2f} EUR/MWh\")\nprint()","key":"ElPHhp5zao"},{"type":"outputs","id":"ei2rCj8VqVIdtVgR1IdZ0","children":[],"key":"mcagdBFNKx"}],"key":"QGFfkEbWkL"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"children":[{"type":"text","value":"Comparison Chart: What Explains Price Variation?","position":{"start":{"line":784,"column":1},"end":{"line":784,"column":1}},"key":"bK5Ylmc01l"}],"identifier":"comparison-chart-what-explains-price-variation","label":"Comparison Chart: What Explains Price Variation?","html_id":"comparison-chart-what-explains-price-variation","implicit":true,"key":"U9T0MVy6Yo"}],"key":"x3bJcQULBC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(10, 6))\n\nmodels = [\"Residual Load\\n(Linear)\", \"Fossil RL\\n(Linear)\", \"Merit Order\\n(Reconstructed)\"]\nr2_values = [r2_residual, r2_fossil, r2_reconstructed]\ncolors = [\"#3498db\", \"#2ecc71\", \"#e74c3c\"]\n\nbars = ax.bar(models, r2_values, color=colors, edgecolor=\"black\", linewidth=1.2)\n\n# Add value labels on bars\nfor bar, val in zip(bars, r2_values):\n    height = bar.get_height()\n    ax.text(\n        bar.get_x() + bar.get_width() / 2.0,\n        height + 0.01,\n        f\"{val:.3f}\",\n        ha=\"center\",\n        va=\"bottom\",\n        fontsize=12,\n        fontweight=\"bold\",\n    )\n\nax.set_ylabel(\"R² (Variance Explained)\")\nax.set_title(\"How Much Price Variation is Explained?\")\nax.set_ylim(0, 1.0)\nax.grid(True, alpha=0.3, axis=\"y\")\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"04_r2_comparison.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"eEa4hPzBOW"},{"type":"outputs","id":"pJGeOOu1g6xhMKlqyWXMG","children":[],"key":"hEn5tJfNon"}],"key":"KsEob64uJg"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/04_r2_comparison-8c02c080b6d4da9e6a1c02835887621d.png","alt":"How Much Price Variation is Explained?","data":{"altTextIsAutoGenerated":true},"key":"MRdVOwwPWx","urlSource":"../../output/images/04_r2_comparison.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-04-r2-comparison","identifier":"fig-04-r2-comparison","html_id":"fig-04-r2-comparison","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"aWlZvqnPvz"},{"type":"text","value":"9","key":"KdvCxGOXSq"},{"type":"text","value":":","key":"XxG6arUNch"}],"template":"Figure %s:","key":"LwG39gOUL0"},{"type":"text","value":"How Much Price Variation is Explained?","position":{"start":{"line":820,"column":1},"end":{"line":820,"column":1}},"key":"C58uqAb9Xm"}],"key":"F3jjPbPa5l"}],"key":"nljkOdTe2W"}],"label":"fig-04-r2-comparison","identifier":"fig-04-r2-comparison","enumerator":"9","html_id":"fig-04-r2-comparison","key":"I1OqxrjGBX"}],"key":"dW81UUzshr"}],"key":"x0DQk4PqBM"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Electricity prices in Germany","url":"/notebooks/smard-de-prices","group":"World of Energy"},"next":{"title":"Seasonality Heatmaps","url":"/notebooks/load-seasonalities","group":"World of Energy"}}},"domain":"http://localhost:3000"},"project":{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"file":"notebooks/03_smard_DE_prices.md"},{"file":"notebooks/04_reconstruct_prices.md"},{"file":"notebooks/05_load_seasonalities.md"},{"file":"notebooks/10_earth_seasons.md"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5ef501a78015a82b19733ef7d68ea017.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-0aa572ebe6fd3aa09439c4280cca615e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-6ae980e49592e22ddf14629d80218276.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.earth-seasons","title":"Earth’s Seasons — From Sunlight to Vegetation","description":"","date":"","thumbnail":"/world-of-energy/build/10_sunlight_animatio-f6ac1e7f74d4bb303b286ea8782c1a27.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-128c8ed537da4ffc471b65ee69218b24.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/world-of-energy/build/manifest-54BD5942.js";
import * as route0 from "/world-of-energy/build/root-PMP5BIHC.js";
import * as route1 from "/world-of-energy/build/routes/$-5ZLZ2O3Y.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/world-of-energy/build/entry.client-PCJPW7TK.js");</script></body></html>
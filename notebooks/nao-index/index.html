<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Monthly ERA5 Reanalysis - World of Energy</title><meta property="og:title" content="Monthly ERA5 Reanalysis - World of Energy"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png"/><meta property="og:image" content="/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png"/><link rel="stylesheet" href="/world-of-energy/build/_assets/app-BWFVNXVE.css"/><link rel="stylesheet" href="/world-of-energy/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/world-of-energy/favicon.ico"/><link rel="stylesheet" href="/world-of-energy/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/world-of-energy/"><div class="myst-home-link-logo mr-3 flex items-center dark:bg-white dark:rounded px-1"><img src="/world-of-energy/build/logo-aeda1ffb023693e5d517d4bd730a35ad.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="World of Energy" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/world-of-energy/">World of Energy</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Electricity Prices" class="block break-words rounded py-2 grow cursor-pointer">Electricity Prices</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Weather" class="block break-words rounded py-2 grow cursor-pointer">Weather</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Resources" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/world-of-energy/markdown/resources">Resources</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0 ml-3 xl:ml-0 mr-3 max-w-[350px]"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/cgroll/world-of-energy" title="GitHub Repository: cgroll/world-of-energy" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/18_nao_index.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Monthly ERA5 Reanalysis</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Christian Groll</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="Q0fuybc8RM" class="myst-jp-nb-block relative group/block"><p>This notebook loads the monthly ERA5 reanalysis data downloaded from the
Copernicus Climate Data Store and stored as a Zarr archive.  It visualises
2 m temperature on a Robinson projection.</p></div><div id="B1fCpllUjY" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
import pandas as pd
import xarray as xr
import matplotlib.pyplot as plt
import cartopy.crs as ccrs
import cartopy.feature as cfeature

from woe.paths import ProjPaths

paths = ProjPaths()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="oU9DBrPZ2UZN0QBt1LTNb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YPMg1ywwgz" class="myst-jp-nb-block relative group/block"><h2 id="load-zarr-store" class="relative group"><span class="heading-text">Load Zarr store</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-zarr-store" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="HG391tFGZm" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ds = xr.open_zarr(paths.era5_monthly_zarr_path)
print(f&quot;Variables:   {list(ds.data_vars)}&quot;)
print(f&quot;Dimensions:  {dict(ds.dims)}&quot;)
print(f&quot;Time range:  {ds.time.values[0]} → {ds.time.values[-1]}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="KJgzuKbfIZvCy_VJkTD7y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Variables:   [&#x27;msl&#x27;, &#x27;sf&#x27;, &#x27;ssrd&#x27;, &#x27;t2m&#x27;, &#x27;tp&#x27;, &#x27;u&#x27;, &#x27;u100&#x27;, &#x27;v&#x27;, &#x27;v100&#x27;, &#x27;z&#x27;]
Dimensions:  {&#x27;time&#x27;: 1020, &#x27;latitude&#x27;: 241, &#x27;longitude&#x27;: 521, &#x27;pressure_level&#x27;: 2}
Time range:  1940-01-01T00:00:00.000000000 → 2024-12-01T00:00:00.000000000
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/589452295.py:3: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  print(f&quot;Dimensions:  {dict(ds.dims)}&quot;)
</span></code></pre></div></div></div></div><div id="vGOVScSqq4" class="myst-jp-nb-block relative group/block"><h2 id="id-2-m-temperature-january-2025" class="relative group"><span class="heading-text">2 m temperature — January 2025</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-m-temperature-january-2025" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="tw8nodd4wF" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">DATE = &quot;2024-01&quot;
t2m = ds[&quot;t2m&quot;].sel(time=DATE).squeeze() - 273.15  # K → °C

fig, ax = plt.subplots(
    figsize=(14, 7),
    subplot_kw={&quot;projection&quot;: ccrs.Robinson()},
)

im = ax.pcolormesh(
    t2m.longitude,
    t2m.latitude,
    t2m.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;RdBu_r&quot;,
    vmin=-40,
    vmax=40,
)

ax.add_feature(cfeature.COASTLINE, linewidth=0.6)
ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;:&quot;)
ax.gridlines(linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)

cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.04, fraction=0.04)
cbar.set_label(&quot;2 m temperature (°C)&quot;)

ax.set_title(f&quot;ERA5 monthly mean 2 m temperature — {DATE}&quot;, fontsize=13)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_era5_t2m_2025_01.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="_1MkUZQx3ykWw96-UUaik" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/998238027.py:30: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="eTClwt78Jm" class="myst-jp-nb-block relative group/block"><figure id="fig-15-era5-t2m-2025-01" class="fig-figure"><img id="knSHlordPC" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png" alt="ERA5 monthly mean 2 m temperature for January 2025 on a Robinson projection." data-canonical-url="../../output/images/15_era5_t2m_2025_01.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-era5-t2m-2025-01" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->1<!-- -->:</a>ERA5 monthly mean 2 m temperature for January 2025 on a Robinson projection.</p></figcaption></figure></div><div id="LCwRfRBNMs" class="myst-jp-nb-block relative group/block"><h2 id="id-2-m-temperature-january-2025-europe-lambert-conformal" class="relative group"><span class="heading-text">2 m temperature — January 2025 (Europe, Lambert Conformal)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-m-temperature-january-2025-europe-lambert-conformal" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="LSfRuU6wp8" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">proj = ccrs.LambertConformal(central_longitude=10, central_latitude=50)

fig, ax = plt.subplots(figsize=(10, 9), subplot_kw={&quot;projection&quot;: proj})

ax.set_extent([-25, 45, 30, 72], crs=ccrs.PlateCarree())

im = ax.pcolormesh(
    t2m.longitude,
    t2m.latitude,
    t2m.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;RdBu_r&quot;,
    vmin=-25,
    vmax=25,
)

ax.add_feature(cfeature.COASTLINE, linewidth=0.7)
ax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=&quot;:&quot;)
ax.add_feature(cfeature.LAND, facecolor=&quot;none&quot;, edgecolor=&quot;none&quot;)
gl = ax.gridlines(draw_labels=True, linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)
gl.top_labels = False
gl.right_labels = False

cbar = fig.colorbar(im, ax=ax, orientation=&quot;vertical&quot;, pad=0.04, fraction=0.03)
cbar.set_label(&quot;2 m temperature (°C)&quot;)

ax.set_title(f&quot;ERA5 monthly mean 2 m temperature — {DATE}&quot;, fontsize=13)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_era5_t2m_europe_2025_01.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="p5STavZO1nLwmaCB886mm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/1397142229.py:31: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="Dua6ZrQTxd" class="myst-jp-nb-block relative group/block"><figure id="fig-15-era5-t2m-europe-2025-01" class="fig-figure"><img id="ScBA1pLENg" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_era5_t2m_europe_2-3541fafadf5580ac9cb825247a15bb82.png" alt="ERA5 monthly mean 2 m temperature for January 2025 over Europe on a Lambert
Conformal projection." data-canonical-url="../../output/images/15_era5_t2m_europe_2025_01.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-era5-t2m-europe-2025-01" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->2<!-- -->:</a>ERA5 monthly mean 2 m temperature for January 2025 over Europe on a Lambert
Conformal projection.</p></figcaption></figure></div><div id="VOLsruNa0v" class="myst-jp-nb-block relative group/block"><h2 id="id-2-m-temperature-january-2025-full-domain-plate-carr-e" class="relative group"><span class="heading-text">2 m temperature — January 2025 (full domain, Plate Carrée)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-m-temperature-january-2025-full-domain-plate-carr-e" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="GIdNKNCpGS" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># BOUNDING_BOX = [North=80, West=-90, South=20, East=40]
fig, ax = plt.subplots(
    figsize=(14, 7),
    subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()},
)

ax.set_extent([-90, 40, 20, 80], crs=ccrs.PlateCarree())

im = ax.pcolormesh(
    t2m.longitude,
    t2m.latitude,
    t2m.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;RdBu_r&quot;,
    vmin=-40,
    vmax=40,
)

ax.add_feature(cfeature.COASTLINE, linewidth=0.6)
ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;:&quot;)
gl = ax.gridlines(draw_labels=True, linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)
gl.top_labels = False
gl.right_labels = False

cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.05, fraction=0.04)
cbar.set_label(&quot;2 m temperature (°C)&quot;)

ax.set_title(f&quot;ERA5 monthly mean 2 m temperature — {DATE}&quot;, fontsize=13)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_era5_t2m_domain_2025_01.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="6Unc5vHhO38AtFQYS5uei" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/3612606417.py:32: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="phDKmAmH4M" class="myst-jp-nb-block relative group/block"><figure id="fig-15-era5-t2m-domain-2025-01" class="fig-figure"><img id="tNbRwv2Ov0" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_era5_t2m_domain_2-c95aba02c2e34ae6c1df7e6ccc126d68.png" alt="ERA5 monthly mean 2 m temperature for January 2025 on a Plate Carrée projection
showing the full downloaded domain." data-canonical-url="../../output/images/15_era5_t2m_domain_2025_01.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-era5-t2m-domain-2025-01" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->3<!-- -->:</a>ERA5 monthly mean 2 m temperature for January 2025 on a Plate Carrée projection
showing the full downloaded domain.</p></figcaption></figure></div><div id="D8USWNHo83" class="myst-jp-nb-block relative group/block"><h2 id="winter-nao-index-1940-2024" class="relative group"><span class="heading-text">Winter NAO Index (1940–2024)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#winter-nao-index-1940-2024" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The station-based North Atlantic Oscillation (NAO) index is the standardised
mean-sea-level pressure (MSLP) difference between the Azores (Ponta Delgada)
and Iceland (Reykjavik), following the Hurrell (1995) definition.</p><p>Positive NAO winters bring stronger-than-normal westerlies across the North
Atlantic, resulting in warmer and wetter conditions over northern Europe.
Negative NAO winters are associated with blocking and cold-air outbreaks.</p><p><strong>Method:</strong></p><ol start="1"><li><p>Filter monthly ERA5 MSLP to DJF months only.</p></li><li><p>Resample with <code>YS-DEC</code> so that Dec(N), Jan(N+1), Feb(N+1) form one
season labelled by year N — identical to the Hurrell convention.</p></li><li><p>Drop boundary seasons with fewer than 3 months (first and last groups
are partial because the dataset starts in January 1940).</p></li><li><p>Snap to the nearest ERA5 grid point for each station.</p></li><li><p>Normalise each series independently (subtract mean, divide by std).</p></li><li><p>NAO index = Azores normalised − Iceland normalised.</p></li></ol></div><div id="cyn0hwxTpj" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># ERA5 short name for mean sea level pressure is &#x27;msl&#x27;
msl = ds[&quot;msl&quot;]

# --- Step 1: keep only DJF months ---
is_djf = msl[&quot;time.month&quot;].isin([12, 1, 2])
winter_mslp = msl.sel(time=is_djf)

# --- Step 2: resample into DJF seasons anchored at December ---
winter_means = winter_mslp.resample(time=&quot;YS-DEC&quot;).mean()
winter_counts = winter_mslp.resample(time=&quot;YS-DEC&quot;).count(dim=&quot;time&quot;)

# --- Step 3: drop incomplete boundary seasons (&lt; 3 months) ---
# Use a single reference point to get a 1-D count series for the time mask.
_count_ref = winter_counts.isel(latitude=0, longitude=0, drop=True)
complete = _count_ref == 3
winter_means = winter_means.sel(time=complete)

# --- Step 4: extract station points (nearest ERA5 grid point) ---
# Ponta Delgada, São Miguel, Azores: 37.74°N, 25.67°W
# Reykjavik, Iceland:               64.13°N, 21.90°W
azores  = winter_means.sel(latitude=37.74, longitude=-25.67, method=&quot;nearest&quot;)
iceland = winter_means.sel(latitude=64.13, longitude=-21.90, method=&quot;nearest&quot;)

# --- Step 5: standardise each series over its full period ---
azores_norm  = (azores  - azores.mean(&quot;time&quot;))  / azores.std(&quot;time&quot;)
iceland_norm = (iceland - iceland.mean(&quot;time&quot;)) / iceland.std(&quot;time&quot;)

# --- Step 6: NAO index ---
nao = (azores_norm - iceland_norm).compute()

years  = nao.time.dt.year.values
values = nao.values

print(f&quot;NAO index: {len(years)} winters ({years[0]}/{years[0]+1} – {years[-1]}/{years[-1]+1})&quot;)
print(f&quot;Mean: {values.mean():.3f}  Std: {values.std():.3f}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ogx4cjB322ZgU-TUn22bB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>NAO index: 84 winters (1940/1941 – 2023/2024)
Mean: 0.000  Std: 1.827
</span></code></pre></div></div></div></div><div id="KKHSFDFgu3" class="myst-jp-nb-block relative group/block"><h3 id="nao-bar-chart" class="relative group"><span class="heading-text">NAO bar chart</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#nao-bar-chart" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="D3T1ll6t4B" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># 9-year centred running mean to show decadal variability
nao_smooth = nao.rolling(time=9, center=True, min_periods=5).mean().values

bar_colors = np.where(values &gt;= 0, &quot;crimson&quot;, &quot;steelblue&quot;)

fig, ax = plt.subplots(figsize=(14, 5))

ax.bar(years, values, color=bar_colors, width=0.85, alpha=0.80,
       label=&quot;Annual DJF NAO&quot;)
ax.plot(years, nao_smooth, color=&quot;black&quot;, linewidth=2.0, zorder=3,
        label=&quot;9-yr running mean&quot;)
ax.axhline(0, color=&quot;black&quot;, linewidth=0.8, zorder=4)

ax.set_title(
    &quot;Winter (DJF) North Atlantic Oscillation Index — ERA5 1940–2024&quot;,
    fontsize=13, fontweight=&quot;bold&quot;,
)
ax.set_ylabel(&quot;Standardised NAO Index&quot;)
ax.set_xlabel(&quot;Winter Start Year&quot;)
ax.legend(loc=&quot;upper right&quot;, framealpha=0.9)
ax.grid(axis=&quot;y&quot;, alpha=0.3)

# Annotate the reference stations
station_text = (
    &quot;Azores: Ponta Delgada (37.74°N, 25.67°W)\n&quot;
    &quot;Iceland: Reykjavik (64.13°N, 21.90°W)&quot;
)
ax.text(0.01, 0.03, station_text, transform=ax.transAxes,
        fontsize=8, color=&quot;gray&quot;, va=&quot;bottom&quot;)

fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_nao_index.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="frZELCZHGg2faTgrjyRMx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/2529726766.py:33: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="uFOacCdd8q" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-index" class="fig-figure"><img id="EFVcgvEglK" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_index-b14ffaad83ae35dc6887cd0e05fec9b0.png" alt="Winter (DJF) NAO index derived from ERA5 MSLP, 1940–2024. Red bars indicate
positive-phase winters (stronger westerlies, milder northern Europe); blue bars
indicate negative-phase winters (weaker westerlies, cold-air outbreaks). The
black line is a 9-year centred running mean highlighting decadal variability." data-canonical-url="../../output/images/15_nao_index.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-index" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->4<!-- -->:</a>Winter (DJF) NAO index derived from ERA5 MSLP, 1940–2024. Red bars indicate
positive-phase winters (stronger westerlies, milder northern Europe); blue bars
indicate negative-phase winters (weaker westerlies, cold-air outbreaks). The
black line is a 9-year centred running mean highlighting decadal variability.</p></figcaption></figure></div><div id="gOgbk6CGeT" class="myst-jp-nb-block relative group/block"><h2 id="spatial-correlation-nao-vs-winter-2-m-temperature" class="relative group"><span class="heading-text">Spatial correlation: NAO vs winter 2 m temperature</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#spatial-correlation-nao-vs-winter-2-m-temperature" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Each grid point shows the Pearson <em>r</em> between the DJF NAO index and the
local DJF-mean 2 m temperature over 1940–2024.  Red (positive correlation)
means the location warms during NAO+ winters; blue means it cools.</p><p>The canonical NAO fingerprint is visible: warming over northern Europe and
the North Atlantic, and cooling over the Mediterranean and parts of
north-eastern North America.</p><p>Reuses the <code>complete</code> season mask from the NAO section to guarantee
identical time axes before calling <code>xr.corr</code>.</p></div><div id="Tmd1NNFgZL" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Build DJF mean temperature with the same resampling and completeness filter
winter_t2m_means = (
    ds[&quot;t2m&quot;]
    .sel(time=ds.time.dt.month.isin([12, 1, 2]))
    .resample(time=&quot;YS-DEC&quot;)
    .mean()
    .sel(time=complete)  # same incomplete-season mask as the NAO index
)

# Pearson r at every grid point along the shared time dimension
print(&quot;Computing spatial correlation …&quot;)
corr_map = xr.corr(nao, winter_t2m_means, dim=&quot;time&quot;).compute()
print(&quot;Done.&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Vt78ySi_nvrxfFl9TN3Cf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Computing spatial correlation …
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Done.
</span></code></pre></div></div></div></div><div id="mcLBW2t8O9" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">proj = ccrs.Orthographic(central_longitude=-10, central_latitude=55)
fig, ax = plt.subplots(figsize=(10, 8), subplot_kw={&quot;projection&quot;: proj})

ax.set_extent([-90, 40, 20, 80], crs=ccrs.PlateCarree())

im = ax.pcolormesh(
    corr_map.longitude,
    corr_map.latitude,
    corr_map.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;RdBu_r&quot;,
    vmin=-0.8,
    vmax=0.8,
)

ax.add_feature(cfeature.COASTLINE, linewidth=0.7)
ax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=&quot;:&quot;)
ax.gridlines(linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)

cbar = fig.colorbar(
    im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.04, fraction=0.04, shrink=0.85
)
cbar.set_label(&quot;Pearson r — NAO index vs DJF 2 m temperature&quot;)

ax.set_title(
    &quot;NAO impact on winter (DJF) 2 m temperature — ERA5 1940–2024&quot;,
    fontsize=13,
    fontweight=&quot;bold&quot;,
)

fig.tight_layout()
fig.savefig(
    paths.images_path / &quot;15_nao_t2m_correlation.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;
)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="QSyHxB4NqMrTVASOSz5C0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/222178718.py:35: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="kgd31x7AYf" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-t2m-correlation" class="fig-figure"><img id="JItIjw4itz" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_t2m_correlati-c7f944204829c531578258d4ecab5541.png" alt="Pearson correlation between the DJF NAO index and ERA5 DJF 2 m temperature,
1940–2024.  Red shading indicates regions that are warmer than average during
NAO+ winters; blue shading indicates cooler regions." data-canonical-url="../../output/images/15_nao_t2m_correlation.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-t2m-correlation" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->5<!-- -->:</a>Pearson correlation between the DJF NAO index and ERA5 DJF 2 m temperature,
1940–2024.  Red shading indicates regions that are warmer than average during
NAO+ winters; blue shading indicates cooler regions.</p></figcaption></figure></div><div id="iAqIQsYj1E" class="myst-jp-nb-block relative group/block"><h2 id="germany-djf-temperature-vs-nao-index" class="relative group"><span class="heading-text">Germany DJF temperature vs NAO index</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#germany-djf-temperature-vs-nao-index" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Load the Germany spatial-mean 2 m temperature produced by
<code>16_dev_germany_weather.py</code>, apply the identical YS-DEC resampling used for
the NAO index, and scatter the two series against each other.</p></div><div id="X2jSW38hkj" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load Germany monthly spatial-mean temperature (mean aggregation, K → °C)
df_de = pd.read_parquet(paths.era5_germany_monthly_ts_file)
t2m_de_monthly = df_de[&quot;t2m&quot;] - 273.15  # K → °C

# Filter to DJF and resample with YS-DEC (same convention as NAO index)
is_djf_de = t2m_de_monthly.index.month.isin([12, 1, 2])
t2m_de_djf_monthly = t2m_de_monthly[is_djf_de]
t2m_de_djf = t2m_de_djf_monthly.resample(&quot;YS-DEC&quot;).mean()
counts_de   = t2m_de_djf_monthly.resample(&quot;YS-DEC&quot;).count()
t2m_de_djf  = t2m_de_djf[counts_de == 3]

# NAO as a pandas Series indexed by the season&#x27;s December date (YS-DEC labels)
nao_series = pd.Series(values, index=pd.DatetimeIndex(nao.time.values))

# Align on the shared index (inner join → only seasons present in both)
combined = pd.DataFrame({&quot;nao&quot;: nao_series, &quot;t2m_de&quot;: t2m_de_djf}).dropna()
print(f&quot;Aligned seasons: {len(combined)}  &quot;
      f&quot;({combined.index.year[0]}/{combined.index.year[0]+1} – &quot;
      f&quot;{combined.index.year[-1]}/{combined.index.year[-1]+1})&quot;)

# Pearson correlation and OLS trend line
pearson_r = combined[&quot;nao&quot;].corr(combined[&quot;t2m_de&quot;])
m_slope, m_intercept = np.polyfit(combined[&quot;nao&quot;], combined[&quot;t2m_de&quot;], 1)
print(f&quot;Pearson r (NAO vs Germany DJF T2m): {pearson_r:.3f}&quot;)
print(f&quot;OLS slope:                           {m_slope:+.2f} °C per σ of NAO&quot;)

x_fit = np.linspace(combined[&quot;nao&quot;].min(), combined[&quot;nao&quot;].max(), 100)

fig, ax = plt.subplots(figsize=(7, 6))

sc = ax.scatter(
    combined[&quot;nao&quot;], combined[&quot;t2m_de&quot;],
    c=combined.index.year, cmap=&quot;plasma&quot;,
    s=45, alpha=0.85, zorder=3,
)
ax.plot(x_fit, m_slope * x_fit + m_intercept,
        color=&quot;crimson&quot;, linewidth=1.8, zorder=4,
        label=f&quot;OLS: {m_slope:+.2f} °C / σ  (r = {pearson_r:.2f})&quot;)
ax.axhline(combined[&quot;t2m_de&quot;].mean(), color=&quot;gray&quot;, linewidth=0.8,
           linestyle=&quot;--&quot;, alpha=0.6)
ax.axvline(0, color=&quot;gray&quot;, linewidth=0.8, linestyle=&quot;--&quot;, alpha=0.6)

cbar = fig.colorbar(sc, ax=ax, label=&quot;Winter start year&quot;)
ax.set_xlabel(&quot;DJF NAO Index (standardised)&quot;)
ax.set_ylabel(&quot;Germany DJF mean 2 m temperature (°C)&quot;)
ax.set_title(
    &quot;Germany winter temperature vs NAO index\n&quot;
    &quot;ERA5 DJF seasons, 1940–2024&quot;,
    fontsize=12,
)
ax.legend(loc=&quot;upper left&quot;)
ax.grid(linewidth=0.4, alpha=0.5)
fig.tight_layout()

fig.savefig(paths.images_path / &quot;15_nao_germany_t2m.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="d4ZTMf_XIdTLocuoIiWot" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Aligned seasons: 84  (1940/1941 – 2023/2024)
Pearson r (NAO vs Germany DJF T2m): 0.592
OLS slope:                           +0.65 °C per σ of NAO
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/4076361068.py:56: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="jUqqKityE8" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-germany-t2m" class="fig-figure"><img id="UcDRFTtBuw" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_germany_t2m-3e12c5cbb0458a737a96e051fe83139f.png" alt="Scatter plot of Germany DJF mean 2 m temperature against the ERA5-derived
NAO index, 1940–2024.  Each point is one winter season, coloured by year.
The crimson line is an OLS regression; the slope (°C per σ of NAO) quantifies
how much Germany warms for each standard-deviation increase in the NAO index." data-canonical-url="../../output/images/15_nao_germany_t2m.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-germany-t2m" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->6<!-- -->:</a>Scatter plot of Germany DJF mean 2 m temperature against the ERA5-derived
NAO index, 1940–2024.  Each point is one winter season, coloured by year.
The crimson line is an OLS regression; the slope (°C per σ of NAO) quantifies
how much Germany warms for each standard-deviation increase in the NAO index.</p></figcaption></figure></div><div id="qkO0Mb1Dus" class="myst-jp-nb-block relative group/block"><h2 id="djf-temperature-maps-extreme-nao-winters" class="relative group"><span class="heading-text">DJF temperature maps — extreme NAO winters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#djf-temperature-maps-extreme-nao-winters" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Full spatial field of ERA5 DJF mean 2 m temperature for the winters with the
highest and lowest NAO index in the record (1940–2024).  Uses the same
<code>winter_t2m_means</code> DataArray (already filtered to complete DJF seasons) that
was used for the NAO computation.</p></div><div id="dJqs6kq7Vd" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">idx_max = int(np.argmax(values))
idx_min = int(np.argmin(values))
year_max, nao_max = years[idx_max], values[idx_max]
year_min, nao_min = years[idx_min], values[idx_min]

print(f&quot;Max NAO winter: {year_max}/{year_max+1}  NAO = {nao_max:+.2f} σ&quot;)
print(f&quot;Min NAO winter: {year_min}/{year_min+1}  NAO = {nao_min:+.2f} σ&quot;)

t2m_max_field = (winter_t2m_means.sel(time=nao.time[idx_max]) - 273.15).compute()
t2m_min_field = (winter_t2m_means.sel(time=nao.time[idx_min]) - 273.15).compute()

fig, axes = plt.subplots(
    1, 2, figsize=(18, 6),
    subplot_kw={&quot;projection&quot;: ccrs.Robinson()},
)

for ax, t2m, year, nao_val, label in [
    (axes[0], t2m_max_field, year_max, nao_max, &quot;Maximum NAO&quot;),
    (axes[1], t2m_min_field, year_min, nao_min, &quot;Minimum NAO&quot;),
]:
    im = ax.pcolormesh(
        t2m.longitude, t2m.latitude, t2m.values,
        transform=ccrs.PlateCarree(),
        cmap=&quot;RdBu_r&quot;, vmin=-40, vmax=40,
    )
    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)
    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;:&quot;)
    ax.gridlines(linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)
    ax.set_title(
        f&quot;{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)&quot;,
        fontsize=12, fontweight=&quot;bold&quot;,
    )

fig.colorbar(
    im, ax=axes, orientation=&quot;horizontal&quot;, pad=0.04, fraction=0.03,
    label=&quot;DJF mean 2 m temperature (°C)&quot;,
)
fig.suptitle(
    &quot;ERA5 DJF mean 2 m temperature — extreme NAO winters&quot;,
    fontsize=13, fontweight=&quot;bold&quot;,
)
fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_nao_extreme_winters.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Tf0IZ58p0zIWFelzrL13t" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Max NAO winter: 2014/2015  NAO = +3.98 σ
Min NAO winter: 2009/2010  NAO = -4.96 σ
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/1871928241.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/1871928241.py:44: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="IsG3K92MGT" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-extreme-winters" class="fig-figure"><img id="MqrzbAjBfC" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_extreme_winte-48af8b0066a7c9d2d82f4bc2781189fd.png" alt="ERA5 DJF mean 2 m temperature for the winter with the highest NAO index
(left) and lowest NAO index (right) in the 1940–2024 record.  The contrast
between the two panels illustrates the NAO’s influence on winter temperatures
across the North Atlantic–European sector." data-canonical-url="../../output/images/15_nao_extreme_winters.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-extreme-winters" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->7<!-- -->:</a>ERA5 DJF mean 2 m temperature for the winter with the highest NAO index
(left) and lowest NAO index (right) in the 1940–2024 record.  The contrast
between the two panels illustrates the NAO’s influence on winter temperatures
across the North Atlantic–European sector.</p></figcaption></figure></div><div id="c9O4BfeS04" class="myst-jp-nb-block relative group/block"><h2 id="temperature-difference-max-nao-minus-min-nao-winter" class="relative group"><span class="heading-text">Temperature difference: max-NAO minus min-NAO winter</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#temperature-difference-max-nao-minus-min-nao-winter" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="QQQA6sYDbr" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">t2m_diff = t2m_max_field - t2m_min_field  # signed: positive = warmer in NAO+ winter

vabs = float(np.abs(t2m_diff.values).max())

fig, ax = plt.subplots(
    figsize=(14, 7),
    subplot_kw={&quot;projection&quot;: ccrs.Robinson()},
)

im = ax.pcolormesh(
    t2m_diff.longitude, t2m_diff.latitude, t2m_diff.values,
    transform=ccrs.PlateCarree(),
    cmap=&quot;RdBu_r&quot;, vmin=-vabs, vmax=vabs,
)
ax.add_feature(cfeature.COASTLINE, linewidth=0.6)
ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;:&quot;)
ax.gridlines(linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)

cbar = fig.colorbar(im, ax=ax, orientation=&quot;horizontal&quot;, pad=0.04, fraction=0.04)
cbar.set_label(&quot;Temperature difference (°C)  [max-NAO minus min-NAO]&quot;)

ax.set_title(
    f&quot;DJF temperature difference: {year_max}/{year_max+1} (NAO={nao_max:+.2f}σ)&quot;
    f&quot;  minus  {year_min}/{year_min+1} (NAO={nao_min:+.2f}σ)&quot;,
    fontsize=12, fontweight=&quot;bold&quot;,
)
fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_nao_extreme_diff.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="gCkxwZ1M1IXK9RyyRUp63" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/3030458549.py:29: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="A3srXIrTii" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-extreme-diff" class="fig-figure"><img id="VpUIKjDzLE" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_extreme_diff-82476b047e76421c5e3bce3522ad8c4d.png" alt="Signed temperature difference between the maximum-NAO and minimum-NAO DJF
seasons in the ERA5 record.  Red indicates regions that were warmer during
the NAO+ winter; blue indicates regions that were colder." data-canonical-url="../../output/images/15_nao_extreme_diff.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-extreme-diff" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->8<!-- -->:</a>Signed temperature difference between the maximum-NAO and minimum-NAO DJF
seasons in the ERA5 record.  Red indicates regions that were warmer during
the NAO+ winter; blue indicates regions that were colder.</p></figcaption></figure></div><div id="XbqTTa7AVi" class="myst-jp-nb-block relative group/block"><h2 id="id-250-hpa-wind-speed-extreme-nao-winters" class="relative group"><span class="heading-text">250 hPa wind speed — extreme NAO winters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-250-hpa-wind-speed-extreme-nao-winters" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>DJF mean 250 hPa wind speed (jet stream level) for the max-NAO and min-NAO
winters.  U and V components are resampled with the same YS-DEC convention
and completeness mask before computing speed = √(u² + v²).  Wind direction
is overlaid as thinned quiver arrows.</p></div><div id="UNZn5EiVYz" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Build DJF mean U and V at 250 hPa with the same season mask as the NAO index
def _djf_season_mean(da):
    return (
        da.sel(time=ds.time.dt.month.isin([12, 1, 2]))
        .resample(time=&quot;YS-DEC&quot;)
        .mean()
        .sel(time=complete)
    )

u250 = _djf_season_mean(ds[&quot;u&quot;].sel(pressure_level=250))
v250 = _djf_season_mean(ds[&quot;v&quot;].sel(pressure_level=250))

# Select the two extreme seasons and compute wind speed
u_max = u250.sel(time=nao.time[idx_max]).compute()
v_max = v250.sel(time=nao.time[idx_max]).compute()
u_min = u250.sel(time=nao.time[idx_min]).compute()
v_min = v250.sel(time=nao.time[idx_min]).compute()

wspd_max = np.sqrt(u_max**2 + v_max**2)
wspd_min = np.sqrt(u_min**2 + v_min**2)

vmax_wspd = float(max(wspd_max.values.max(), wspd_min.values.max()))

# Thin the quiver grid to avoid overplotting (every Nth point)
N = 6
lons_q = wspd_max.longitude.values[::N]
lats_q = wspd_max.latitude.values[::N]

fig, axes = plt.subplots(
    1, 2, figsize=(18, 6),
    subplot_kw={&quot;projection&quot;: ccrs.Robinson()},
)

for ax, wspd, u_q, v_q, year, nao_val, label in [
    (axes[0], wspd_max, u_max.values[::N, ::N], v_max.values[::N, ::N],
     year_max, nao_max, &quot;Maximum NAO&quot;),
    (axes[1], wspd_min, u_min.values[::N, ::N], v_min.values[::N, ::N],
     year_min, nao_min, &quot;Minimum NAO&quot;),
]:
    im = ax.pcolormesh(
        wspd.longitude, wspd.latitude, wspd.values,
        transform=ccrs.PlateCarree(),
        cmap=&quot;YlOrRd&quot;, vmin=0, vmax=vmax_wspd,
    )
    ax.quiver(
        lons_q, lats_q, u_q, v_q,
        transform=ccrs.PlateCarree(),
        scale=2000, width=0.001, color=&quot;black&quot;, alpha=0.55,
    )
    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)
    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;:&quot;)
    ax.gridlines(linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)
    ax.set_title(
        f&quot;{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)&quot;,
        fontsize=12, fontweight=&quot;bold&quot;,
    )

fig.colorbar(
    im, ax=axes, orientation=&quot;horizontal&quot;, pad=0.04, fraction=0.03,
    label=&quot;250 hPa wind speed (m/s)&quot;,
)
fig.suptitle(
    &quot;ERA5 DJF mean 250 hPa wind speed — extreme NAO winters&quot;,
    fontsize=13, fontweight=&quot;bold&quot;,
)
fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_nao_extreme_250hpa_wind.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="lp4uDjsupbfRNb12MFiWg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/3770676322.py:66: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/3770676322.py:68: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="RaWmlpMJO7" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-extreme-250hpa-wind" class="fig-figure"><img id="fNBKkcbOne" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_extreme_250hp-68683ca8804154fd2821c8f29ef654da.png" alt="DJF mean 250 hPa wind speed for the maximum-NAO (left) and minimum-NAO
(right) winters in the ERA5 record.  Colour shows wind speed; arrows show
wind direction (thinned for clarity).  The NAO+ winter typically shows a
stronger, more zonally oriented jet stream over the North Atlantic." data-canonical-url="../../output/images/15_nao_extreme_250hpa_wind.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-extreme-250hpa-wind" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->9<!-- -->:</a>DJF mean 250 hPa wind speed for the maximum-NAO (left) and minimum-NAO
(right) winters in the ERA5 record.  Colour shows wind speed; arrows show
wind direction (thinned for clarity).  The NAO+ winter typically shows a
stronger, more zonally oriented jet stream over the North Atlantic.</p></figcaption></figure></div><div id="MzVUEg664o" class="myst-jp-nb-block relative group/block"><h2 id="id-500-hpa-geopotential-height-extreme-nao-winters" class="relative group"><span class="heading-text">500 hPa geopotential height — extreme NAO winters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-500-hpa-geopotential-height-extreme-nao-winters" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>DJF mean 500 hPa geopotential height (Z500) for the max-NAO and min-NAO
winters.  Geopotential (m²/s²) is converted to geopotential height (m) by
dividing by g = 9.80665 m/s².  Filled contours show height; contour lines
highlight the main ridges and troughs.</p></div><div id="vMtSLxk1Re" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">G = 9.80665  # standard gravity m/s²

z500_max = (_djf_season_mean(ds[&quot;z&quot;].sel(pressure_level=500))
            .sel(time=nao.time[idx_max]).compute() / G)
z500_min = (_djf_season_mean(ds[&quot;z&quot;].sel(pressure_level=500))
            .sel(time=nao.time[idx_min]).compute() / G)

# Shared colour scale anchored to the combined range
vmin_z = float(min(z500_max.values.min(), z500_min.values.min()))
vmax_z = float(max(z500_max.values.max(), z500_min.values.max()))

fig, axes = plt.subplots(
    1, 2, figsize=(18, 6),
    subplot_kw={&quot;projection&quot;: ccrs.Robinson()},
)

for ax, z500, year, nao_val, label in [
    (axes[0], z500_max, year_max, nao_max, &quot;Maximum NAO&quot;),
    (axes[1], z500_min, year_min, nao_min, &quot;Minimum NAO&quot;),
]:
    lons = z500.longitude.values
    lats = z500.latitude.values

    im = ax.pcolormesh(
        lons, lats, z500.values,
        transform=ccrs.PlateCarree(),
        cmap=&quot;RdBu_r&quot;, vmin=vmin_z, vmax=vmax_z,
    )
    # Contour lines every 80 m
    cs = ax.contour(
        lons, lats, z500.values,
        levels=np.arange(np.floor(vmin_z / 80) * 80,
                         np.ceil(vmax_z / 80) * 80 + 1, 80),
        colors=&quot;black&quot;, linewidths=0.6, alpha=0.6,
        transform=ccrs.PlateCarree(),
    )
    ax.clabel(cs, fmt=&quot;%d&quot;, fontsize=7, inline=True)
    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)
    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=&quot;:&quot;)
    ax.gridlines(linewidth=0.3, color=&quot;gray&quot;, alpha=0.5)

    # NAO station markers
    for (lon, lat, name) in [
        (-25.67, 37.74, &quot;Azores&quot;),
        (-21.90, 64.13, &quot;Iceland&quot;),
    ]:
        ax.plot(lon, lat, transform=ccrs.PlateCarree(),
                marker=&quot;*&quot;, markersize=10, color=&quot;gold&quot;,
                markeredgecolor=&quot;black&quot;, markeredgewidth=0.6, zorder=5)
        ax.text(lon + 1.5, lat, name, transform=ccrs.PlateCarree(),
                fontsize=8, fontweight=&quot;bold&quot;, color=&quot;black&quot;,
                va=&quot;center&quot;, zorder=5)

    ax.set_title(
        f&quot;{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)&quot;,
        fontsize=12, fontweight=&quot;bold&quot;,
    )

fig.colorbar(
    im, ax=axes, orientation=&quot;horizontal&quot;, pad=0.04, fraction=0.03,
    label=&quot;500 hPa geopotential height (m)&quot;,
)
fig.suptitle(
    &quot;ERA5 DJF mean 500 hPa geopotential height — extreme NAO winters&quot;,
    fontsize=13, fontweight=&quot;bold&quot;,
)
fig.tight_layout()
fig.savefig(paths.images_path / &quot;15_nao_extreme_z500.png&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="15u-afI6CzTcwp-vjtiP5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/4231438911.py:67: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_152300/4231438911.py:69: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</span></code></pre></div></div></div></div><div id="g7ctKapUHq" class="myst-jp-nb-block relative group/block"><figure id="fig-15-nao-extreme-z500" class="fig-figure"><img id="ieG8WxNQeT" style="margin-left:auto;margin-right:auto" src="/world-of-energy/build/15_nao_extreme_z500-7b32cd030d4b12ab12548a756f6f4933.png" alt="DJF mean 500 hPa geopotential height for the maximum-NAO (left) and
minimum-NAO (right) winters.  Contour lines are drawn every 80 m.  The
NAO+ pattern shows higher geopotential over the Azores and lower over
Iceland, steering mild Atlantic air into Europe; NAO− reverses this,
favouring blocking and cold-air advection." data-canonical-url="../../output/images/15_nao_extreme_z500.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-15-nao-extreme-z500" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->10<!-- -->:</a>DJF mean 500 hPa geopotential height for the maximum-NAO (left) and
minimum-NAO (right) winters.  Contour lines are drawn every 80 m.  The
NAO+ pattern shows higher geopotential over the Azores and lower over
Iceland, steering mild Atlantic air into Europe; NAO− reverses this,
favouring blocking and cold-air advection.</p></figcaption></figure></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/world-of-energy/notebooks/germany-variations"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Weather</div>Weather Variability in Germany — Beyond the Seasonal Cycle</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/world-of-energy/notebooks/daily-jet-stream-animations"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Weather</div>NAO and Jet Stream — Daily Evolution</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/world-of-energy/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-XSZVU6CB.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/world-of-energy/build/root-DSHAHCKW.js"/><link rel="modulepreload" href="/world-of-energy/build/_shared/chunk-XFQAC62S.js"/><link rel="modulepreload" href="/world-of-energy/build/routes/$-NYGFW5Y3.js"/><script>window.__remixContext = {"url":"/notebooks/nao-index","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.0","options":{"favicon":"/world-of-energy/build/fav-dd7901f3f2cf8291caeff4207192226e.ico","logo":"/world-of-energy/build/logo-aeda1ffb023693e5d517d4bd730a35ad.png","folders":true},"nav":[],"actions":[],"projects":[{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"children":[{"file":"notebooks/03_smard_DE_prices.ipynb"},{"file":"notebooks/04_reconstruct_prices.ipynb"},{"file":"notebooks/05_load_seasonalities.ipynb"}],"title":"Electricity Prices"},{"children":[{"file":"notebooks/10_earth_seasons.ipynb"},{"file":"notebooks/12_projections.ipynb"},{"file":"notebooks/13_pressure_and_weather.ipynb"},{"file":"notebooks/17_germany_variations.ipynb"},{"file":"notebooks/18_nao_index.ipynb"},{"file":"notebooks/21_daily_jet_stream_animations.ipynb"}],"title":"Weather"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Electricity Prices"},{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5897d2d2ec58c9fc3341ae0ace50856b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-515875c959c281688fe9c9613ec1e24f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Weather"},{"slug":"notebooks.projections","title":"Map Projections — ERA5 2 m Temperature","description":"","date":"","thumbnail":"/world-of-energy/build/12_t2m_projections_o-458c35fb5ed415023332d684441d5a8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.pressure-and-weather","title":"Pressure Levels and the Jet Stream","description":"","date":"","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.germany-variations","title":"Weather Variability in Germany — Beyond the Seasonal Cycle","description":"","date":"","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nao-index","title":"Monthly ERA5 Reanalysis","description":"","date":"","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.daily-jet-stream-animations","title":"NAO and Jet Stream — Daily Evolution","description":"","date":"","thumbnail":"/world-of-energy/build/18_t2m_z500_2014-201-274e4fc869dc3f9bf6bb6a54f3cbd40c.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-9fcb1fdbd9556f4cf5f6a9c6156cb4a0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/world-of-energy"},"routes/$":{"config":{"version":3,"myst":"1.8.0","options":{"favicon":"/world-of-energy/build/fav-dd7901f3f2cf8291caeff4207192226e.ico","logo":"/world-of-energy/build/logo-aeda1ffb023693e5d517d4bd730a35ad.png","folders":true},"nav":[],"actions":[],"projects":[{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"children":[{"file":"notebooks/03_smard_DE_prices.ipynb"},{"file":"notebooks/04_reconstruct_prices.ipynb"},{"file":"notebooks/05_load_seasonalities.ipynb"}],"title":"Electricity Prices"},{"children":[{"file":"notebooks/10_earth_seasons.ipynb"},{"file":"notebooks/12_projections.ipynb"},{"file":"notebooks/13_pressure_and_weather.ipynb"},{"file":"notebooks/17_germany_variations.ipynb"},{"file":"notebooks/18_nao_index.ipynb"},{"file":"notebooks/21_daily_jet_stream_animations.ipynb"}],"title":"Weather"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Electricity Prices"},{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5897d2d2ec58c9fc3341ae0ace50856b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-515875c959c281688fe9c9613ec1e24f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Weather"},{"slug":"notebooks.projections","title":"Map Projections — ERA5 2 m Temperature","description":"","date":"","thumbnail":"/world-of-energy/build/12_t2m_projections_o-458c35fb5ed415023332d684441d5a8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.pressure-and-weather","title":"Pressure Levels and the Jet Stream","description":"","date":"","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.germany-variations","title":"Weather Variability in Germany — Beyond the Seasonal Cycle","description":"","date":"","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nao-index","title":"Monthly ERA5 Reanalysis","description":"","date":"","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.daily-jet-stream-animations","title":"NAO and Jet Stream — Daily Evolution","description":"","date":"","thumbnail":"/world-of-energy/build/18_t2m_z500_2014-201-274e4fc869dc3f9bf6bb6a54f3cbd40c.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-9fcb1fdbd9556f4cf5f6a9c6156cb4a0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":3,"kind":"Notebook","sha256":"06454858fdf712723fe5115de4ea1da09b65eac683b660e6f53f6ff299d28c88","slug":"notebooks.nao-index","location":"/notebooks/18_nao_index.ipynb","dependencies":[],"frontmatter":{"title":"Monthly ERA5 Reanalysis","content_includes_title":false,"kernelspec":{"name":"world-of-energy","display_name":"World of Energy","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","numbering":{"title":{"offset":1}},"source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/18_nao_index.ipynb","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/18_nao_index.ipynb","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","exports":[{"format":"ipynb","filename":"18_nao_index.ipynb","url":"/world-of-energy/build/18_nao_index-dc71eb77444f930ee7862b52e2463ba8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook loads the monthly ERA5 reanalysis data downloaded from the\nCopernicus Climate Data Store and stored as a Zarr archive.  It visualises\n2 m temperature on a Robinson projection.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WajRhxRGhR"}],"key":"AkGeqQ1r62"}],"key":"Q0fuybc8RM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:28.442338Z","iopub.status.busy":"2026-03-01T17:15:28.442101Z","iopub.status.idle":"2026-03-01T17:15:29.036485Z","shell.execute_reply":"2026-03-01T17:15:29.035530Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport xarray as xr\nimport matplotlib.pyplot as plt\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\n\nfrom woe.paths import ProjPaths\n\npaths = ProjPaths()","key":"STJI4EDmVh"},{"type":"outputs","id":"oU9DBrPZ2UZN0QBt1LTNb","children":[],"key":"HfUElr30cz"}],"key":"B1fCpllUjY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load Zarr store","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nLwAG8jOlC"}],"identifier":"load-zarr-store","label":"Load Zarr store","html_id":"load-zarr-store","implicit":true,"key":"EfvSZQ2dYn"}],"key":"YPMg1ywwgz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:29.038014Z","iopub.status.busy":"2026-03-01T17:15:29.037802Z","iopub.status.idle":"2026-03-01T17:15:29.349999Z","shell.execute_reply":"2026-03-01T17:15:29.349272Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds = xr.open_zarr(paths.era5_monthly_zarr_path)\nprint(f\"Variables:   {list(ds.data_vars)}\")\nprint(f\"Dimensions:  {dict(ds.dims)}\")\nprint(f\"Time range:  {ds.time.values[0]} → {ds.time.values[-1]}\")","key":"AgQCuPQ6pn"},{"type":"outputs","id":"KJgzuKbfIZvCy_VJkTD7y","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Variables:   ['msl', 'sf', 'ssrd', 't2m', 'tp', 'u', 'u100', 'v', 'v100', 'z']\nDimensions:  {'time': 1020, 'latitude': 241, 'longitude': 521, 'pressure_level': 2}\nTime range:  1940-01-01T00:00:00.000000000 → 2024-12-01T00:00:00.000000000\n"},"children":[],"key":"ptA5MGMtFe"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/589452295.py:3: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  print(f\"Dimensions:  {dict(ds.dims)}\")\n"},"children":[],"key":"v9izcG1sQS"}],"key":"QJVNaBfjpw"}],"key":"HG391tFGZm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2 m temperature — January 2025","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Omroroey5t"}],"identifier":"id-2-m-temperature-january-2025","label":"2 m temperature — January 2025","html_id":"id-2-m-temperature-january-2025","implicit":true,"key":"dnts59SIcG"}],"key":"vGOVScSqq4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:29.351362Z","iopub.status.busy":"2026-03-01T17:15:29.351142Z","iopub.status.idle":"2026-03-01T17:15:29.920971Z","shell.execute_reply":"2026-03-01T17:15:29.920074Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"DATE = \"2024-01\"\nt2m = ds[\"t2m\"].sel(time=DATE).squeeze() - 273.15  # K → °C\n\nfig, ax = plt.subplots(\n    figsize=(14, 7),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nim = ax.pcolormesh(\n    t2m.longitude,\n    t2m.latitude,\n    t2m.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-40,\n    vmax=40,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\nax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.04, fraction=0.04)\ncbar.set_label(\"2 m temperature (°C)\")\n\nax.set_title(f\"ERA5 monthly mean 2 m temperature — {DATE}\", fontsize=13)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_era5_t2m_2025_01.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"Rimrx4XRzx"},{"type":"outputs","id":"_1MkUZQx3ykWw96-UUaik","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/998238027.py:30: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"TgGi5xhTc0"}],"key":"Gm3bZgrDb6"}],"key":"tw8nodd4wF"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","alt":"ERA5 monthly mean 2 m temperature for January 2025 on a Robinson projection.","data":{"altTextIsAutoGenerated":true},"key":"knSHlordPC","urlSource":"../../output/images/15_era5_t2m_2025_01.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-era5-t2m-2025-01","identifier":"fig-15-era5-t2m-2025-01","html_id":"fig-15-era5-t2m-2025-01","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"YItqlJqYOV"},{"type":"text","value":"1","key":"pzrJOM7U2W"},{"type":"text","value":":","key":"WOmHvQhbZu"}],"template":"Figure %s:","key":"ojVWlf64P8"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for January 2025 on a Robinson projection.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sX8EsGbBtW"}],"key":"NTDBFZAMt9"}],"key":"mQe4VYe1ua"}],"label":"fig-15-era5-t2m-2025-01","identifier":"fig-15-era5-t2m-2025-01","enumerator":"1","html_id":"fig-15-era5-t2m-2025-01","key":"PaY4B7p5dX"}],"key":"eTClwt78Jm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2 m temperature — January 2025 (Europe, Lambert Conformal)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SWUwXLoVWf"}],"identifier":"id-2-m-temperature-january-2025-europe-lambert-conformal","label":"2 m temperature — January 2025 (Europe, Lambert Conformal)","html_id":"id-2-m-temperature-january-2025-europe-lambert-conformal","implicit":true,"key":"uWYtH5nDyv"}],"key":"LCwRfRBNMs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:29.922296Z","iopub.status.busy":"2026-03-01T17:15:29.922192Z","iopub.status.idle":"2026-03-01T17:15:32.375110Z","shell.execute_reply":"2026-03-01T17:15:32.374568Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"proj = ccrs.LambertConformal(central_longitude=10, central_latitude=50)\n\nfig, ax = plt.subplots(figsize=(10, 9), subplot_kw={\"projection\": proj})\n\nax.set_extent([-25, 45, 30, 72], crs=ccrs.PlateCarree())\n\nim = ax.pcolormesh(\n    t2m.longitude,\n    t2m.latitude,\n    t2m.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-25,\n    vmax=25,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.7)\nax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=\":\")\nax.add_feature(cfeature.LAND, facecolor=\"none\", edgecolor=\"none\")\ngl = ax.gridlines(draw_labels=True, linewidth=0.3, color=\"gray\", alpha=0.5)\ngl.top_labels = False\ngl.right_labels = False\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"vertical\", pad=0.04, fraction=0.03)\ncbar.set_label(\"2 m temperature (°C)\")\n\nax.set_title(f\"ERA5 monthly mean 2 m temperature — {DATE}\", fontsize=13)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_era5_t2m_europe_2025_01.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"fUHR6a1N79"},{"type":"outputs","id":"p5STavZO1nLwmaCB886mm","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/1397142229.py:31: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"DLNTU9T5Lv"}],"key":"Yh8P6JGtOR"}],"key":"LSfRuU6wp8"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_era5_t2m_europe_2-3541fafadf5580ac9cb825247a15bb82.png","alt":"ERA5 monthly mean 2 m temperature for January 2025 over Europe on a Lambert\nConformal projection.","data":{"altTextIsAutoGenerated":true},"key":"ScBA1pLENg","urlSource":"../../output/images/15_era5_t2m_europe_2025_01.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-era5-t2m-europe-2025-01","identifier":"fig-15-era5-t2m-europe-2025-01","html_id":"fig-15-era5-t2m-europe-2025-01","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"cpsJhmcH05"},{"type":"text","value":"2","key":"LkP5Pl6gM3"},{"type":"text","value":":","key":"V57Q95XU1B"}],"template":"Figure %s:","key":"tM9a9I5YGc"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for January 2025 over Europe on a Lambert\nConformal projection.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bG9ozYL3cf"}],"key":"q3tnFgFaMg"}],"key":"vEWh4u6iRX"}],"label":"fig-15-era5-t2m-europe-2025-01","identifier":"fig-15-era5-t2m-europe-2025-01","enumerator":"2","html_id":"fig-15-era5-t2m-europe-2025-01","key":"fpqtTn0RQx"}],"key":"Dua6ZrQTxd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2 m temperature — January 2025 (full domain, Plate Carrée)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m0dElhvfec"}],"identifier":"id-2-m-temperature-january-2025-full-domain-plate-carr-e","label":"2 m temperature — January 2025 (full domain, Plate Carrée)","html_id":"id-2-m-temperature-january-2025-full-domain-plate-carr-e","implicit":true,"key":"gEMd8qibOo"}],"key":"VOLsruNa0v"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:32.376390Z","iopub.status.busy":"2026-03-01T17:15:32.376301Z","iopub.status.idle":"2026-03-01T17:15:32.773325Z","shell.execute_reply":"2026-03-01T17:15:32.772533Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# BOUNDING_BOX = [North=80, West=-90, South=20, East=40]\nfig, ax = plt.subplots(\n    figsize=(14, 7),\n    subplot_kw={\"projection\": ccrs.PlateCarree()},\n)\n\nax.set_extent([-90, 40, 20, 80], crs=ccrs.PlateCarree())\n\nim = ax.pcolormesh(\n    t2m.longitude,\n    t2m.latitude,\n    t2m.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-40,\n    vmax=40,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\ngl = ax.gridlines(draw_labels=True, linewidth=0.3, color=\"gray\", alpha=0.5)\ngl.top_labels = False\ngl.right_labels = False\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.05, fraction=0.04)\ncbar.set_label(\"2 m temperature (°C)\")\n\nax.set_title(f\"ERA5 monthly mean 2 m temperature — {DATE}\", fontsize=13)\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_era5_t2m_domain_2025_01.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"fqiPoQRN7u"},{"type":"outputs","id":"6Unc5vHhO38AtFQYS5uei","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/3612606417.py:32: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"uAmmj9NahV"}],"key":"kCc3bqVLow"}],"key":"GIdNKNCpGS"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_era5_t2m_domain_2-c95aba02c2e34ae6c1df7e6ccc126d68.png","alt":"ERA5 monthly mean 2 m temperature for January 2025 on a Plate Carrée projection\nshowing the full downloaded domain.","data":{"altTextIsAutoGenerated":true},"key":"tNbRwv2Ov0","urlSource":"../../output/images/15_era5_t2m_domain_2025_01.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-era5-t2m-domain-2025-01","identifier":"fig-15-era5-t2m-domain-2025-01","html_id":"fig-15-era5-t2m-domain-2025-01","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"pg5YMfdWvB"},{"type":"text","value":"3","key":"th9YObC8qy"},{"type":"text","value":":","key":"Ix8Oe4xhrj"}],"template":"Figure %s:","key":"GETAIitxWj"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for January 2025 on a Plate Carrée projection\nshowing the full downloaded domain.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rzkZ5VlbI2"}],"key":"cDVzMOweHG"}],"key":"R1AJvRIK4g"}],"label":"fig-15-era5-t2m-domain-2025-01","identifier":"fig-15-era5-t2m-domain-2025-01","enumerator":"3","html_id":"fig-15-era5-t2m-domain-2025-01","key":"Hx4qpgiP1U"}],"key":"phDKmAmH4M"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Winter NAO Index (1940–2024)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xsKEq6TdPy"}],"identifier":"winter-nao-index-1940-2024","label":"Winter NAO Index (1940–2024)","html_id":"winter-nao-index-1940-2024","implicit":true,"key":"qZAY9GU2DU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The station-based North Atlantic Oscillation (NAO) index is the standardised\nmean-sea-level pressure (MSLP) difference between the Azores (Ponta Delgada)\nand Iceland (Reykjavik), following the Hurrell (1995) definition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JxaU9HmPLx"}],"key":"nQYxjFdNTi"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Positive NAO winters bring stronger-than-normal westerlies across the North\nAtlantic, resulting in warmer and wetter conditions over northern Europe.\nNegative NAO winters are associated with blocking and cold-air outbreaks.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gzdaU5ldwt"}],"key":"NgbehLKQUg"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Method:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tebyvP0b3W"}],"key":"yriHIRYZPo"}],"key":"EQEow1oAoT"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Filter monthly ERA5 MSLP to DJF months only.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"iG73luvbUB"}],"key":"S4jqHNgYaH"}],"key":"GsjKc71Oof"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Resample with ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"E2OvgPCs3g"},{"type":"inlineCode","value":"YS-DEC","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"BjoaL0QgGh"},{"type":"text","value":" so that Dec(N), Jan(N+1), Feb(N+1) form one\nseason labelled by year N — identical to the Hurrell convention.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FbUcy4kSUi"}],"key":"ygjk0l7VBx"}],"key":"u7pUGo2rSZ"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Drop boundary seasons with fewer than 3 months (first and last groups\nare partial because the dataset starts in January 1940).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"B1FsAiYfj9"}],"key":"T3LkKhEOY9"}],"key":"Ac2ymQ2OwA"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Snap to the nearest ERA5 grid point for each station.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"np9wtWc7tD"}],"key":"tmU1ega2DW"}],"key":"yuKI6w2cu6"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Normalise each series independently (subtract mean, divide by std).","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"vC5dIzdPyX"}],"key":"zV8di5p4o6"}],"key":"OKdJH195Ln"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"NAO index = Azores normalised − Iceland normalised.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"RwldAkHxuD"}],"key":"lSaBqDQn0e"}],"key":"KHYYouDtJT"}],"key":"SPTiIaW479"}],"key":"D8USWNHo83"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:32.774830Z","iopub.status.busy":"2026-03-01T17:15:32.774741Z","iopub.status.idle":"2026-03-01T17:15:33.781748Z","shell.execute_reply":"2026-03-01T17:15:33.781083Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# ERA5 short name for mean sea level pressure is 'msl'\nmsl = ds[\"msl\"]\n\n# --- Step 1: keep only DJF months ---\nis_djf = msl[\"time.month\"].isin([12, 1, 2])\nwinter_mslp = msl.sel(time=is_djf)\n\n# --- Step 2: resample into DJF seasons anchored at December ---\nwinter_means = winter_mslp.resample(time=\"YS-DEC\").mean()\nwinter_counts = winter_mslp.resample(time=\"YS-DEC\").count(dim=\"time\")\n\n# --- Step 3: drop incomplete boundary seasons (\u003c 3 months) ---\n# Use a single reference point to get a 1-D count series for the time mask.\n_count_ref = winter_counts.isel(latitude=0, longitude=0, drop=True)\ncomplete = _count_ref == 3\nwinter_means = winter_means.sel(time=complete)\n\n# --- Step 4: extract station points (nearest ERA5 grid point) ---\n# Ponta Delgada, São Miguel, Azores: 37.74°N, 25.67°W\n# Reykjavik, Iceland:               64.13°N, 21.90°W\nazores  = winter_means.sel(latitude=37.74, longitude=-25.67, method=\"nearest\")\niceland = winter_means.sel(latitude=64.13, longitude=-21.90, method=\"nearest\")\n\n# --- Step 5: standardise each series over its full period ---\nazores_norm  = (azores  - azores.mean(\"time\"))  / azores.std(\"time\")\niceland_norm = (iceland - iceland.mean(\"time\")) / iceland.std(\"time\")\n\n# --- Step 6: NAO index ---\nnao = (azores_norm - iceland_norm).compute()\n\nyears  = nao.time.dt.year.values\nvalues = nao.values\n\nprint(f\"NAO index: {len(years)} winters ({years[0]}/{years[0]+1} – {years[-1]}/{years[-1]+1})\")\nprint(f\"Mean: {values.mean():.3f}  Std: {values.std():.3f}\")","key":"VJiGoUqhii"},{"type":"outputs","id":"ogx4cjB322ZgU-TUn22bB","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"NAO index: 84 winters (1940/1941 – 2023/2024)\nMean: 0.000  Std: 1.827\n"},"children":[],"key":"o8yEJOZF7I"}],"key":"MVhwYhXzHQ"}],"key":"cyn0hwxTpj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NAO bar chart","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q0EEEZPXA4"}],"identifier":"nao-bar-chart","label":"NAO bar chart","html_id":"nao-bar-chart","implicit":true,"key":"E2rpWxvtyQ"}],"key":"KKHSFDFgu3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:33.782829Z","iopub.status.busy":"2026-03-01T17:15:33.782739Z","iopub.status.idle":"2026-03-01T17:15:33.959587Z","shell.execute_reply":"2026-03-01T17:15:33.959216Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# 9-year centred running mean to show decadal variability\nnao_smooth = nao.rolling(time=9, center=True, min_periods=5).mean().values\n\nbar_colors = np.where(values \u003e= 0, \"crimson\", \"steelblue\")\n\nfig, ax = plt.subplots(figsize=(14, 5))\n\nax.bar(years, values, color=bar_colors, width=0.85, alpha=0.80,\n       label=\"Annual DJF NAO\")\nax.plot(years, nao_smooth, color=\"black\", linewidth=2.0, zorder=3,\n        label=\"9-yr running mean\")\nax.axhline(0, color=\"black\", linewidth=0.8, zorder=4)\n\nax.set_title(\n    \"Winter (DJF) North Atlantic Oscillation Index — ERA5 1940–2024\",\n    fontsize=13, fontweight=\"bold\",\n)\nax.set_ylabel(\"Standardised NAO Index\")\nax.set_xlabel(\"Winter Start Year\")\nax.legend(loc=\"upper right\", framealpha=0.9)\nax.grid(axis=\"y\", alpha=0.3)\n\n# Annotate the reference stations\nstation_text = (\n    \"Azores: Ponta Delgada (37.74°N, 25.67°W)\\n\"\n    \"Iceland: Reykjavik (64.13°N, 21.90°W)\"\n)\nax.text(0.01, 0.03, station_text, transform=ax.transAxes,\n        fontsize=8, color=\"gray\", va=\"bottom\")\n\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_index.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"hlF2lRNMXC"},{"type":"outputs","id":"frZELCZHGg2faTgrjyRMx","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/2529726766.py:33: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"os146CtbOW"}],"key":"lbfw906mTu"}],"key":"D3T1ll6t4B"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_index-b14ffaad83ae35dc6887cd0e05fec9b0.png","alt":"Winter (DJF) NAO index derived from ERA5 MSLP, 1940–2024. Red bars indicate\npositive-phase winters (stronger westerlies, milder northern Europe); blue bars\nindicate negative-phase winters (weaker westerlies, cold-air outbreaks). The\nblack line is a 9-year centred running mean highlighting decadal variability.","data":{"altTextIsAutoGenerated":true},"key":"EFVcgvEglK","urlSource":"../../output/images/15_nao_index.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-index","identifier":"fig-15-nao-index","html_id":"fig-15-nao-index","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"HMRjAHZnvN"},{"type":"text","value":"4","key":"m790BFrnbL"},{"type":"text","value":":","key":"judv22zp6W"}],"template":"Figure %s:","key":"UfwGNnVBq1"},{"type":"text","value":"Winter (DJF) NAO index derived from ERA5 MSLP, 1940–2024. Red bars indicate\npositive-phase winters (stronger westerlies, milder northern Europe); blue bars\nindicate negative-phase winters (weaker westerlies, cold-air outbreaks). The\nblack line is a 9-year centred running mean highlighting decadal variability.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HfdU5MgBHA"}],"key":"xB0iep6L0L"}],"key":"qznhw7bV1t"}],"label":"fig-15-nao-index","identifier":"fig-15-nao-index","enumerator":"4","html_id":"fig-15-nao-index","key":"av2quw6A3o"}],"key":"uFOacCdd8q"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spatial correlation: NAO vs winter 2 m temperature","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xtVKQPVF5U"}],"identifier":"spatial-correlation-nao-vs-winter-2-m-temperature","label":"Spatial correlation: NAO vs winter 2 m temperature","html_id":"spatial-correlation-nao-vs-winter-2-m-temperature","implicit":true,"key":"qNk2aF28LC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Each grid point shows the Pearson ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WQR7ziMmPa"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"r","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XrsfjBCyHM"}],"key":"Gg8c6Yt4ky"},{"type":"text","value":" between the DJF NAO index and the\nlocal DJF-mean 2 m temperature over 1940–2024.  Red (positive correlation)\nmeans the location warms during NAO+ winters; blue means it cools.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Eq3qhUACx2"}],"key":"k6newbjan5"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The canonical NAO fingerprint is visible: warming over northern Europe and\nthe North Atlantic, and cooling over the Mediterranean and parts of\nnorth-eastern North America.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lOFNUWnrv2"}],"key":"a6o31pbJzd"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Reuses the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RHqv8RkM8s"},{"type":"inlineCode","value":"complete","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"iqlmhPoktH"},{"type":"text","value":" season mask from the NAO section to guarantee\nidentical time axes before calling ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ci79SUIbgU"},{"type":"inlineCode","value":"xr.corr","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JSgNmNDRpL"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VLbD2cAwKo"}],"key":"dbWRamVo99"}],"key":"gOgbk6CGeT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:33.961074Z","iopub.status.busy":"2026-03-01T17:15:33.960985Z","iopub.status.idle":"2026-03-01T17:15:35.417278Z","shell.execute_reply":"2026-03-01T17:15:35.416508Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Build DJF mean temperature with the same resampling and completeness filter\nwinter_t2m_means = (\n    ds[\"t2m\"]\n    .sel(time=ds.time.dt.month.isin([12, 1, 2]))\n    .resample(time=\"YS-DEC\")\n    .mean()\n    .sel(time=complete)  # same incomplete-season mask as the NAO index\n)\n\n# Pearson r at every grid point along the shared time dimension\nprint(\"Computing spatial correlation …\")\ncorr_map = xr.corr(nao, winter_t2m_means, dim=\"time\").compute()\nprint(\"Done.\")","key":"ZtZZuvY9Z9"},{"type":"outputs","id":"Vt78ySi_nvrxfFl9TN3Cf","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Computing spatial correlation …\n"},"children":[],"key":"q7BkcSyht3"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Done.\n"},"children":[],"key":"p2tO88zfb1"}],"key":"c4nsjKPBhH"}],"key":"Tmd1NNFgZL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:35.418493Z","iopub.status.busy":"2026-03-01T17:15:35.418410Z","iopub.status.idle":"2026-03-01T17:15:36.119446Z","shell.execute_reply":"2026-03-01T17:15:36.118996Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"proj = ccrs.Orthographic(central_longitude=-10, central_latitude=55)\nfig, ax = plt.subplots(figsize=(10, 8), subplot_kw={\"projection\": proj})\n\nax.set_extent([-90, 40, 20, 80], crs=ccrs.PlateCarree())\n\nim = ax.pcolormesh(\n    corr_map.longitude,\n    corr_map.latitude,\n    corr_map.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\",\n    vmin=-0.8,\n    vmax=0.8,\n)\n\nax.add_feature(cfeature.COASTLINE, linewidth=0.7)\nax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=\":\")\nax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\ncbar = fig.colorbar(\n    im, ax=ax, orientation=\"horizontal\", pad=0.04, fraction=0.04, shrink=0.85\n)\ncbar.set_label(\"Pearson r — NAO index vs DJF 2 m temperature\")\n\nax.set_title(\n    \"NAO impact on winter (DJF) 2 m temperature — ERA5 1940–2024\",\n    fontsize=13,\n    fontweight=\"bold\",\n)\n\nfig.tight_layout()\nfig.savefig(\n    paths.images_path / \"15_nao_t2m_correlation.png\", dpi=150, bbox_inches=\"tight\"\n)\nplt.show()","key":"lfPBE0Kqfj"},{"type":"outputs","id":"QSyHxB4NqMrTVASOSz5C0","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/222178718.py:35: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"hL5kY5ebTZ"}],"key":"GBjjRpV2wK"}],"key":"mcLBW2t8O9"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_t2m_correlati-c7f944204829c531578258d4ecab5541.png","alt":"Pearson correlation between the DJF NAO index and ERA5 DJF 2 m temperature,\n1940–2024.  Red shading indicates regions that are warmer than average during\nNAO+ winters; blue shading indicates cooler regions.","data":{"altTextIsAutoGenerated":true},"key":"JItIjw4itz","urlSource":"../../output/images/15_nao_t2m_correlation.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-t2m-correlation","identifier":"fig-15-nao-t2m-correlation","html_id":"fig-15-nao-t2m-correlation","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"dH46i2fwgS"},{"type":"text","value":"5","key":"UGZ4TeSFe4"},{"type":"text","value":":","key":"imPvxkxifx"}],"template":"Figure %s:","key":"Flk3BDrnqw"},{"type":"text","value":"Pearson correlation between the DJF NAO index and ERA5 DJF 2 m temperature,\n1940–2024.  Red shading indicates regions that are warmer than average during\nNAO+ winters; blue shading indicates cooler regions.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q7vvODkyNe"}],"key":"OEHQ1xBJuv"}],"key":"O4oP2JtBq8"}],"label":"fig-15-nao-t2m-correlation","identifier":"fig-15-nao-t2m-correlation","enumerator":"5","html_id":"fig-15-nao-t2m-correlation","key":"ykoQvTZFiC"}],"key":"kgd31x7AYf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Germany DJF temperature vs NAO index","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JdqfNEQwNC"}],"identifier":"germany-djf-temperature-vs-nao-index","label":"Germany DJF temperature vs NAO index","html_id":"germany-djf-temperature-vs-nao-index","implicit":true,"key":"zndqsqAfpS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Load the Germany spatial-mean 2 m temperature produced by\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o5xFRkZt4S"},{"type":"inlineCode","value":"16_dev_germany_weather.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wQ8rESFW5M"},{"type":"text","value":", apply the identical YS-DEC resampling used for\nthe NAO index, and scatter the two series against each other.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wgl9psjtSv"}],"key":"CBz8LHaF27"}],"key":"iAqIQsYj1E"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:36.120846Z","iopub.status.busy":"2026-03-01T17:15:36.120761Z","iopub.status.idle":"2026-03-01T17:15:36.318065Z","shell.execute_reply":"2026-03-01T17:15:36.317539Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load Germany monthly spatial-mean temperature (mean aggregation, K → °C)\ndf_de = pd.read_parquet(paths.era5_germany_monthly_ts_file)\nt2m_de_monthly = df_de[\"t2m\"] - 273.15  # K → °C\n\n# Filter to DJF and resample with YS-DEC (same convention as NAO index)\nis_djf_de = t2m_de_monthly.index.month.isin([12, 1, 2])\nt2m_de_djf_monthly = t2m_de_monthly[is_djf_de]\nt2m_de_djf = t2m_de_djf_monthly.resample(\"YS-DEC\").mean()\ncounts_de   = t2m_de_djf_monthly.resample(\"YS-DEC\").count()\nt2m_de_djf  = t2m_de_djf[counts_de == 3]\n\n# NAO as a pandas Series indexed by the season's December date (YS-DEC labels)\nnao_series = pd.Series(values, index=pd.DatetimeIndex(nao.time.values))\n\n# Align on the shared index (inner join → only seasons present in both)\ncombined = pd.DataFrame({\"nao\": nao_series, \"t2m_de\": t2m_de_djf}).dropna()\nprint(f\"Aligned seasons: {len(combined)}  \"\n      f\"({combined.index.year[0]}/{combined.index.year[0]+1} – \"\n      f\"{combined.index.year[-1]}/{combined.index.year[-1]+1})\")\n\n# Pearson correlation and OLS trend line\npearson_r = combined[\"nao\"].corr(combined[\"t2m_de\"])\nm_slope, m_intercept = np.polyfit(combined[\"nao\"], combined[\"t2m_de\"], 1)\nprint(f\"Pearson r (NAO vs Germany DJF T2m): {pearson_r:.3f}\")\nprint(f\"OLS slope:                           {m_slope:+.2f} °C per σ of NAO\")\n\nx_fit = np.linspace(combined[\"nao\"].min(), combined[\"nao\"].max(), 100)\n\nfig, ax = plt.subplots(figsize=(7, 6))\n\nsc = ax.scatter(\n    combined[\"nao\"], combined[\"t2m_de\"],\n    c=combined.index.year, cmap=\"plasma\",\n    s=45, alpha=0.85, zorder=3,\n)\nax.plot(x_fit, m_slope * x_fit + m_intercept,\n        color=\"crimson\", linewidth=1.8, zorder=4,\n        label=f\"OLS: {m_slope:+.2f} °C / σ  (r = {pearson_r:.2f})\")\nax.axhline(combined[\"t2m_de\"].mean(), color=\"gray\", linewidth=0.8,\n           linestyle=\"--\", alpha=0.6)\nax.axvline(0, color=\"gray\", linewidth=0.8, linestyle=\"--\", alpha=0.6)\n\ncbar = fig.colorbar(sc, ax=ax, label=\"Winter start year\")\nax.set_xlabel(\"DJF NAO Index (standardised)\")\nax.set_ylabel(\"Germany DJF mean 2 m temperature (°C)\")\nax.set_title(\n    \"Germany winter temperature vs NAO index\\n\"\n    \"ERA5 DJF seasons, 1940–2024\",\n    fontsize=12,\n)\nax.legend(loc=\"upper left\")\nax.grid(linewidth=0.4, alpha=0.5)\nfig.tight_layout()\n\nfig.savefig(paths.images_path / \"15_nao_germany_t2m.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"xync4dU48S"},{"type":"outputs","id":"d4ZTMf_XIdTLocuoIiWot","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Aligned seasons: 84  (1940/1941 – 2023/2024)\nPearson r (NAO vs Germany DJF T2m): 0.592\nOLS slope:                           +0.65 °C per σ of NAO\n"},"children":[],"key":"Wq7Cu2Gw1a"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/4076361068.py:56: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"LmwjD84c40"}],"key":"dy6wTRx8bE"}],"key":"X2jSW38hkj"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_germany_t2m-3e12c5cbb0458a737a96e051fe83139f.png","alt":"Scatter plot of Germany DJF mean 2 m temperature against the ERA5-derived\nNAO index, 1940–2024.  Each point is one winter season, coloured by year.\nThe crimson line is an OLS regression; the slope (°C per σ of NAO) quantifies\nhow much Germany warms for each standard-deviation increase in the NAO index.","data":{"altTextIsAutoGenerated":true},"key":"UcDRFTtBuw","urlSource":"../../output/images/15_nao_germany_t2m.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-germany-t2m","identifier":"fig-15-nao-germany-t2m","html_id":"fig-15-nao-germany-t2m","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"RDEhysmqgz"},{"type":"text","value":"6","key":"xTzRlwghAL"},{"type":"text","value":":","key":"IkfKwvpN5s"}],"template":"Figure %s:","key":"CskiJZYa1R"},{"type":"text","value":"Scatter plot of Germany DJF mean 2 m temperature against the ERA5-derived\nNAO index, 1940–2024.  Each point is one winter season, coloured by year.\nThe crimson line is an OLS regression; the slope (°C per σ of NAO) quantifies\nhow much Germany warms for each standard-deviation increase in the NAO index.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NXu42fbLZr"}],"key":"m2K89bcYVj"}],"key":"Y3WoRVd3dH"}],"label":"fig-15-nao-germany-t2m","identifier":"fig-15-nao-germany-t2m","enumerator":"6","html_id":"fig-15-nao-germany-t2m","key":"OkF8pqMEBX"}],"key":"jUqqKityE8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DJF temperature maps — extreme NAO winters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pFkBa2Otcn"}],"identifier":"djf-temperature-maps-extreme-nao-winters","label":"DJF temperature maps — extreme NAO winters","html_id":"djf-temperature-maps-extreme-nao-winters","implicit":true,"key":"nDte6Ddzp5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Full spatial field of ERA5 DJF mean 2 m temperature for the winters with the\nhighest and lowest NAO index in the record (1940–2024).  Uses the same\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G8mh42dmfc"},{"type":"inlineCode","value":"winter_t2m_means","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m6Q8f1Wyzw"},{"type":"text","value":" DataArray (already filtered to complete DJF seasons) that\nwas used for the NAO computation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uT6jQk9poD"}],"key":"yLBbOcnPFq"}],"key":"qkO0Mb1Dus"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:36.319498Z","iopub.status.busy":"2026-03-01T17:15:36.319403Z","iopub.status.idle":"2026-03-01T17:15:36.913722Z","shell.execute_reply":"2026-03-01T17:15:36.913085Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"idx_max = int(np.argmax(values))\nidx_min = int(np.argmin(values))\nyear_max, nao_max = years[idx_max], values[idx_max]\nyear_min, nao_min = years[idx_min], values[idx_min]\n\nprint(f\"Max NAO winter: {year_max}/{year_max+1}  NAO = {nao_max:+.2f} σ\")\nprint(f\"Min NAO winter: {year_min}/{year_min+1}  NAO = {nao_min:+.2f} σ\")\n\nt2m_max_field = (winter_t2m_means.sel(time=nao.time[idx_max]) - 273.15).compute()\nt2m_min_field = (winter_t2m_means.sel(time=nao.time[idx_min]) - 273.15).compute()\n\nfig, axes = plt.subplots(\n    1, 2, figsize=(18, 6),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nfor ax, t2m, year, nao_val, label in [\n    (axes[0], t2m_max_field, year_max, nao_max, \"Maximum NAO\"),\n    (axes[1], t2m_min_field, year_min, nao_min, \"Minimum NAO\"),\n]:\n    im = ax.pcolormesh(\n        t2m.longitude, t2m.latitude, t2m.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"RdBu_r\", vmin=-40, vmax=40,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n    ax.set_title(\n        f\"{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)\",\n        fontsize=12, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"DJF mean 2 m temperature (°C)\",\n)\nfig.suptitle(\n    \"ERA5 DJF mean 2 m temperature — extreme NAO winters\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_winters.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"FuaIgtyLaT"},{"type":"outputs","id":"Tf0IZ58p0zIWFelzrL13t","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Max NAO winter: 2014/2015  NAO = +3.98 σ\nMin NAO winter: 2009/2010  NAO = -4.96 σ\n"},"children":[],"key":"TC8pxX3tFE"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/1871928241.py:42: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"RKJ7guC8sd"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/1871928241.py:44: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"GUrcNTK0mG"}],"key":"EdVXDYnZvL"}],"key":"dJqs6kq7Vd"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_winte-48af8b0066a7c9d2d82f4bc2781189fd.png","alt":"ERA5 DJF mean 2 m temperature for the winter with the highest NAO index\n(left) and lowest NAO index (right) in the 1940–2024 record.  The contrast\nbetween the two panels illustrates the NAO’s influence on winter temperatures\nacross the North Atlantic–European sector.","data":{"altTextIsAutoGenerated":true},"key":"MqrzbAjBfC","urlSource":"../../output/images/15_nao_extreme_winters.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-winters","identifier":"fig-15-nao-extreme-winters","html_id":"fig-15-nao-extreme-winters","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"jhSgL16PUW"},{"type":"text","value":"7","key":"EiAvClzENE"},{"type":"text","value":":","key":"eTj3pv9nJQ"}],"template":"Figure %s:","key":"TBXkwUQRKg"},{"type":"text","value":"ERA5 DJF mean 2 m temperature for the winter with the highest NAO index\n(left) and lowest NAO index (right) in the 1940–2024 record.  The contrast\nbetween the two panels illustrates the NAO’s influence on winter temperatures\nacross the North Atlantic–European sector.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U8I9nuvM94"}],"key":"R4BFKidV3D"}],"key":"bp7NRC0fng"}],"label":"fig-15-nao-extreme-winters","identifier":"fig-15-nao-extreme-winters","enumerator":"7","html_id":"fig-15-nao-extreme-winters","key":"qo85QBGnw9"}],"key":"IsG3K92MGT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Temperature difference: max-NAO minus min-NAO winter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vMpkXBu5VH"}],"identifier":"temperature-difference-max-nao-minus-min-nao-winter","label":"Temperature difference: max-NAO minus min-NAO winter","html_id":"temperature-difference-max-nao-minus-min-nao-winter","implicit":true,"key":"lBAAfaYTwU"}],"key":"c9O4BfeS04"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:36.915156Z","iopub.status.busy":"2026-03-01T17:15:36.915068Z","iopub.status.idle":"2026-03-01T17:15:37.228743Z","shell.execute_reply":"2026-03-01T17:15:37.228249Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"t2m_diff = t2m_max_field - t2m_min_field  # signed: positive = warmer in NAO+ winter\n\nvabs = float(np.abs(t2m_diff.values).max())\n\nfig, ax = plt.subplots(\n    figsize=(14, 7),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nim = ax.pcolormesh(\n    t2m_diff.longitude, t2m_diff.latitude, t2m_diff.values,\n    transform=ccrs.PlateCarree(),\n    cmap=\"RdBu_r\", vmin=-vabs, vmax=vabs,\n)\nax.add_feature(cfeature.COASTLINE, linewidth=0.6)\nax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\nax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\ncbar = fig.colorbar(im, ax=ax, orientation=\"horizontal\", pad=0.04, fraction=0.04)\ncbar.set_label(\"Temperature difference (°C)  [max-NAO minus min-NAO]\")\n\nax.set_title(\n    f\"DJF temperature difference: {year_max}/{year_max+1} (NAO={nao_max:+.2f}σ)\"\n    f\"  minus  {year_min}/{year_min+1} (NAO={nao_min:+.2f}σ)\",\n    fontsize=12, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_diff.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"GI2biiBOOt"},{"type":"outputs","id":"gCkxwZ1M1IXK9RyyRUp63","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/3030458549.py:29: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"aMN54ryo8R"}],"key":"cYtfWuGiY1"}],"key":"QQQA6sYDbr"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_diff-82476b047e76421c5e3bce3522ad8c4d.png","alt":"Signed temperature difference between the maximum-NAO and minimum-NAO DJF\nseasons in the ERA5 record.  Red indicates regions that were warmer during\nthe NAO+ winter; blue indicates regions that were colder.","data":{"altTextIsAutoGenerated":true},"key":"VpUIKjDzLE","urlSource":"../../output/images/15_nao_extreme_diff.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-diff","identifier":"fig-15-nao-extreme-diff","html_id":"fig-15-nao-extreme-diff","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"R3z1qWv0MC"},{"type":"text","value":"8","key":"bWKPhg06qF"},{"type":"text","value":":","key":"mooqdInFhh"}],"template":"Figure %s:","key":"R0HvQvs2N0"},{"type":"text","value":"Signed temperature difference between the maximum-NAO and minimum-NAO DJF\nseasons in the ERA5 record.  Red indicates regions that were warmer during\nthe NAO+ winter; blue indicates regions that were colder.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VvIH97bh45"}],"key":"rYcIZIsMpa"}],"key":"Pb6O72YtiW"}],"label":"fig-15-nao-extreme-diff","identifier":"fig-15-nao-extreme-diff","enumerator":"8","html_id":"fig-15-nao-extreme-diff","key":"hXI6q0JKoQ"}],"key":"A3srXIrTii"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"250 hPa wind speed — extreme NAO winters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ICQ7eJAna7"}],"identifier":"id-250-hpa-wind-speed-extreme-nao-winters","label":"250 hPa wind speed — extreme NAO winters","html_id":"id-250-hpa-wind-speed-extreme-nao-winters","implicit":true,"key":"c53XQMpSVu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"DJF mean 250 hPa wind speed (jet stream level) for the max-NAO and min-NAO\nwinters.  U and V components are resampled with the same YS-DEC convention\nand completeness mask before computing speed = √(u² + v²).  Wind direction\nis overlaid as thinned quiver arrows.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GMDmpeHXFf"}],"key":"ZcQa5dwDoz"}],"key":"XbqTTa7AVi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:37.229967Z","iopub.status.busy":"2026-03-01T17:15:37.229881Z","iopub.status.idle":"2026-03-01T17:15:38.954955Z","shell.execute_reply":"2026-03-01T17:15:38.954279Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Build DJF mean U and V at 250 hPa with the same season mask as the NAO index\ndef _djf_season_mean(da):\n    return (\n        da.sel(time=ds.time.dt.month.isin([12, 1, 2]))\n        .resample(time=\"YS-DEC\")\n        .mean()\n        .sel(time=complete)\n    )\n\nu250 = _djf_season_mean(ds[\"u\"].sel(pressure_level=250))\nv250 = _djf_season_mean(ds[\"v\"].sel(pressure_level=250))\n\n# Select the two extreme seasons and compute wind speed\nu_max = u250.sel(time=nao.time[idx_max]).compute()\nv_max = v250.sel(time=nao.time[idx_max]).compute()\nu_min = u250.sel(time=nao.time[idx_min]).compute()\nv_min = v250.sel(time=nao.time[idx_min]).compute()\n\nwspd_max = np.sqrt(u_max**2 + v_max**2)\nwspd_min = np.sqrt(u_min**2 + v_min**2)\n\nvmax_wspd = float(max(wspd_max.values.max(), wspd_min.values.max()))\n\n# Thin the quiver grid to avoid overplotting (every Nth point)\nN = 6\nlons_q = wspd_max.longitude.values[::N]\nlats_q = wspd_max.latitude.values[::N]\n\nfig, axes = plt.subplots(\n    1, 2, figsize=(18, 6),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nfor ax, wspd, u_q, v_q, year, nao_val, label in [\n    (axes[0], wspd_max, u_max.values[::N, ::N], v_max.values[::N, ::N],\n     year_max, nao_max, \"Maximum NAO\"),\n    (axes[1], wspd_min, u_min.values[::N, ::N], v_min.values[::N, ::N],\n     year_min, nao_min, \"Minimum NAO\"),\n]:\n    im = ax.pcolormesh(\n        wspd.longitude, wspd.latitude, wspd.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"YlOrRd\", vmin=0, vmax=vmax_wspd,\n    )\n    ax.quiver(\n        lons_q, lats_q, u_q, v_q,\n        transform=ccrs.PlateCarree(),\n        scale=2000, width=0.001, color=\"black\", alpha=0.55,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n    ax.set_title(\n        f\"{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)\",\n        fontsize=12, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"250 hPa wind speed (m/s)\",\n)\nfig.suptitle(\n    \"ERA5 DJF mean 250 hPa wind speed — extreme NAO winters\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_250hpa_wind.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"v7Dq6aqWS7"},{"type":"outputs","id":"lp4uDjsupbfRNb12MFiWg","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/3770676322.py:66: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"UMEXnwb1ys"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/3770676322.py:68: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"YD6QLhvqvR"}],"key":"soRKYySoSx"}],"key":"UNZn5EiVYz"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_250hp-68683ca8804154fd2821c8f29ef654da.png","alt":"DJF mean 250 hPa wind speed for the maximum-NAO (left) and minimum-NAO\n(right) winters in the ERA5 record.  Colour shows wind speed; arrows show\nwind direction (thinned for clarity).  The NAO+ winter typically shows a\nstronger, more zonally oriented jet stream over the North Atlantic.","data":{"altTextIsAutoGenerated":true},"key":"fNBKkcbOne","urlSource":"../../output/images/15_nao_extreme_250hpa_wind.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-250hpa-wind","identifier":"fig-15-nao-extreme-250hpa-wind","html_id":"fig-15-nao-extreme-250hpa-wind","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"TaPqJuRdaR"},{"type":"text","value":"9","key":"xDXeAtggAJ"},{"type":"text","value":":","key":"yoqJMxfxHP"}],"template":"Figure %s:","key":"o6mTXan91S"},{"type":"text","value":"DJF mean 250 hPa wind speed for the maximum-NAO (left) and minimum-NAO\n(right) winters in the ERA5 record.  Colour shows wind speed; arrows show\nwind direction (thinned for clarity).  The NAO+ winter typically shows a\nstronger, more zonally oriented jet stream over the North Atlantic.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L2oRJel0f2"}],"key":"GUsKGwG3YX"}],"key":"RgIuEKRciB"}],"label":"fig-15-nao-extreme-250hpa-wind","identifier":"fig-15-nao-extreme-250hpa-wind","enumerator":"9","html_id":"fig-15-nao-extreme-250hpa-wind","key":"zPShIschmA"}],"key":"RaWmlpMJO7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"500 hPa geopotential height — extreme NAO winters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B8efSapg37"}],"identifier":"id-500-hpa-geopotential-height-extreme-nao-winters","label":"500 hPa geopotential height — extreme NAO winters","html_id":"id-500-hpa-geopotential-height-extreme-nao-winters","implicit":true,"key":"pKJ5TUA4Ek"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"DJF mean 500 hPa geopotential height (Z500) for the max-NAO and min-NAO\nwinters.  Geopotential (m²/s²) is converted to geopotential height (m) by\ndividing by g = 9.80665 m/s².  Filled contours show height; contour lines\nhighlight the main ridges and troughs.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z5XFQdgkiu"}],"key":"ofQSfCBwk7"}],"key":"MzVUEg664o"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:38.956194Z","iopub.status.busy":"2026-03-01T17:15:38.956107Z","iopub.status.idle":"2026-03-01T17:15:40.528045Z","shell.execute_reply":"2026-03-01T17:15:40.527217Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"G = 9.80665  # standard gravity m/s²\n\nz500_max = (_djf_season_mean(ds[\"z\"].sel(pressure_level=500))\n            .sel(time=nao.time[idx_max]).compute() / G)\nz500_min = (_djf_season_mean(ds[\"z\"].sel(pressure_level=500))\n            .sel(time=nao.time[idx_min]).compute() / G)\n\n# Shared colour scale anchored to the combined range\nvmin_z = float(min(z500_max.values.min(), z500_min.values.min()))\nvmax_z = float(max(z500_max.values.max(), z500_min.values.max()))\n\nfig, axes = plt.subplots(\n    1, 2, figsize=(18, 6),\n    subplot_kw={\"projection\": ccrs.Robinson()},\n)\n\nfor ax, z500, year, nao_val, label in [\n    (axes[0], z500_max, year_max, nao_max, \"Maximum NAO\"),\n    (axes[1], z500_min, year_min, nao_min, \"Minimum NAO\"),\n]:\n    lons = z500.longitude.values\n    lats = z500.latitude.values\n\n    im = ax.pcolormesh(\n        lons, lats, z500.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"RdBu_r\", vmin=vmin_z, vmax=vmax_z,\n    )\n    # Contour lines every 80 m\n    cs = ax.contour(\n        lons, lats, z500.values,\n        levels=np.arange(np.floor(vmin_z / 80) * 80,\n                         np.ceil(vmax_z / 80) * 80 + 1, 80),\n        colors=\"black\", linewidths=0.6, alpha=0.6,\n        transform=ccrs.PlateCarree(),\n    )\n    ax.clabel(cs, fmt=\"%d\", fontsize=7, inline=True)\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.6)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.3, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n\n    # NAO station markers\n    for (lon, lat, name) in [\n        (-25.67, 37.74, \"Azores\"),\n        (-21.90, 64.13, \"Iceland\"),\n    ]:\n        ax.plot(lon, lat, transform=ccrs.PlateCarree(),\n                marker=\"*\", markersize=10, color=\"gold\",\n                markeredgecolor=\"black\", markeredgewidth=0.6, zorder=5)\n        ax.text(lon + 1.5, lat, name, transform=ccrs.PlateCarree(),\n                fontsize=8, fontweight=\"bold\", color=\"black\",\n                va=\"center\", zorder=5)\n\n    ax.set_title(\n        f\"{label}: {year}/{year+1}  (NAO = {nao_val:+.2f} σ)\",\n        fontsize=12, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"500 hPa geopotential height (m)\",\n)\nfig.suptitle(\n    \"ERA5 DJF mean 500 hPa geopotential height — extreme NAO winters\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"15_nao_extreme_z500.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"KXpV381BUb"},{"type":"outputs","id":"15u-afI6CzTcwp-vjtiP5","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/4231438911.py:67: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"O7FwDYliFz"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152300/4231438911.py:69: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"RurAfqzmrW"}],"key":"nbiUTKilFl"}],"key":"vMtSLxk1Re"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/15_nao_extreme_z500-7b32cd030d4b12ab12548a756f6f4933.png","alt":"DJF mean 500 hPa geopotential height for the maximum-NAO (left) and\nminimum-NAO (right) winters.  Contour lines are drawn every 80 m.  The\nNAO+ pattern shows higher geopotential over the Azores and lower over\nIceland, steering mild Atlantic air into Europe; NAO− reverses this,\nfavouring blocking and cold-air advection.","data":{"altTextIsAutoGenerated":true},"key":"ieG8WxNQeT","urlSource":"../../output/images/15_nao_extreme_z500.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-15-nao-extreme-z500","identifier":"fig-15-nao-extreme-z500","html_id":"fig-15-nao-extreme-z500","enumerator":"10","children":[{"type":"text","value":"Figure ","key":"YRptpzKPpT"},{"type":"text","value":"10","key":"a8zc52ZGtz"},{"type":"text","value":":","key":"AaSvOIwVQR"}],"template":"Figure %s:","key":"O3iCb5PSWP"},{"type":"text","value":"DJF mean 500 hPa geopotential height for the maximum-NAO (left) and\nminimum-NAO (right) winters.  Contour lines are drawn every 80 m.  The\nNAO+ pattern shows higher geopotential over the Azores and lower over\nIceland, steering mild Atlantic air into Europe; NAO− reverses this,\nfavouring blocking and cold-air advection.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dQKbOlhbuh"}],"key":"i4qS2aHz0R"}],"key":"kLdvuaSDtO"}],"label":"fig-15-nao-extreme-z500","identifier":"fig-15-nao-extreme-z500","enumerator":"10","html_id":"fig-15-nao-extreme-z500","key":"g2CLxT4lr7"}],"key":"g7ctKapUHq"}],"key":"D1piZNkEeF"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Weather Variability in Germany — Beyond the Seasonal Cycle","url":"/notebooks/germany-variations","group":"Weather"},"next":{"title":"NAO and Jet Stream — Daily Evolution","url":"/notebooks/daily-jet-stream-animations","group":"Weather"}}},"domain":"http://localhost:3000"},"project":{"title":"World of Energy","authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","toc":[{"file":"markdown/index.md"},{"children":[{"file":"notebooks/03_smard_DE_prices.ipynb"},{"file":"notebooks/04_reconstruct_prices.ipynb"},{"file":"notebooks/05_load_seasonalities.ipynb"}],"title":"Electricity Prices"},{"children":[{"file":"notebooks/10_earth_seasons.ipynb"},{"file":"notebooks/12_projections.ipynb"},{"file":"notebooks/13_pressure_and_weather.ipynb"},{"file":"notebooks/17_germany_variations.ipynb"},{"file":"notebooks/18_nao_index.ipynb"},{"file":"notebooks/21_daily_jet_stream_animations.ipynb"}],"title":"Weather"},{"file":"markdown/resources.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Electricity Prices"},{"slug":"notebooks.smard-de-prices","title":"Electricity prices in Germany","description":"","date":"","thumbnail":"/world-of-energy/build/03_hourly_prices-5897d2d2ec58c9fc3341ae0ace50856b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.reconstruct-prices","title":"Fossil Fuel Costs and Electricity Price Reconstruction","description":"","date":"","thumbnail":"/world-of-energy/build/04_srmc_timeseries-7becdada14104111de2d25436943272c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.load-seasonalities","title":"Seasonality Heatmaps","description":"","date":"","thumbnail":"/world-of-energy/build/05_seasonality_solar-515875c959c281688fe9c9613ec1e24f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Weather"},{"slug":"notebooks.projections","title":"Map Projections — ERA5 2 m Temperature","description":"","date":"","thumbnail":"/world-of-energy/build/12_t2m_projections_o-458c35fb5ed415023332d684441d5a8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.pressure-and-weather","title":"Pressure Levels and the Jet Stream","description":"","date":"","thumbnail":"/world-of-energy/build/13_surface_temperatu-de44c4d103daaf92f1e9e8064b4a06a2.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.germany-variations","title":"Weather Variability in Germany — Beyond the Seasonal Cycle","description":"","date":"","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.nao-index","title":"Monthly ERA5 Reanalysis","description":"","date":"","thumbnail":"/world-of-energy/build/15_era5_t2m_2025_01-058722cac980b7d5838c6c856cbbb235.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.daily-jet-stream-animations","title":"NAO and Jet Stream — Daily Evolution","description":"","date":"","thumbnail":"/world-of-energy/build/18_t2m_z500_2014-201-274e4fc869dc3f9bf6bb6a54f3cbd40c.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"markdown.resources","title":"Resources","description":"","date":"","thumbnail":"/world-of-energy/build/2026-02-05-12-15-50-9fcb1fdbd9556f4cf5f6a9c6156cb4a0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/world-of-energy/build/manifest-784E572C.js";
import * as route0 from "/world-of-energy/build/root-DSHAHCKW.js";
import * as route1 from "/world-of-energy/build/routes/$-NYGFW5Y3.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/world-of-energy/build/entry.client-PCJPW7TK.js");</script></body></html>
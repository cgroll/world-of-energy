{"version":3,"kind":"Notebook","sha256":"eef88734af87d122e63b5f938fce342afd32e8a7093920292d0817ae48357ee7","slug":"notebooks.germany-variations","location":"/notebooks/17_germany_variations.ipynb","dependencies":[],"frontmatter":{"title":"Weather Variability in Germany — Beyond the Seasonal Cycle","content_includes_title":false,"kernelspec":{"name":"world-of-energy","display_name":"World of Energy","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","numbering":{"title":{"offset":1}},"source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/17_germany_variations.ipynb","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/17_germany_variations.ipynb","thumbnail":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","exports":[{"format":"ipynb","filename":"17_germany_variations.ipynb","url":"/world-of-energy/build/17_germany_variation-59ab4621e37c793d4e4f5852ccd5eb21.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Monthly ERA5 climatology tells us what is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RNTkYLetZj"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"typical","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NO8QpuBHTJ"}],"key":"QcjbzDuy5A"},{"type":"text","value":" for each calendar month,\nbut the actual value in any given year can differ substantially from that\nmean.  This notebook shows the full spread of monthly values (1940–2024)\nfor temperature, wind speed, and solar radiation, and then analyses\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vt2baSThUd"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dunkelflaute","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BgdK7TC4Vg"}],"key":"MkIJ0EtJmS"},{"type":"text","value":" — months when both wind power and solar power potential\nare simultaneously very low.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kzhIIUYDKk"}],"key":"OhfFxnT5CS"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Data source:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PGy2SIdlPg"}],"key":"fjXHswsVFk"},{"type":"text","value":" ERA5 monthly Germany spatial means\n(","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZPRJQPeieL"},{"type":"inlineCode","value":"16_compute_germany_time_series.py","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"iwJBL7IGbq"},{"type":"text","value":")","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"YBG2mgrY3F"}],"key":"KvlvGINq2G"},{"type":"table","position":{"start":{"line":13,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Variable","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vCsolQAms7"}],"key":"FXFSSGmUYi"},{"type":"tableCell","header":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"ERA5 field","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"PYRwfXhLCi"}],"key":"gOROYykJGZ"},{"type":"tableCell","header":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Unit","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LpPp35qjR4"}],"key":"Z946X2aM0z"}],"key":"QwJwntHVQh"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"2 m temperature","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"iHsqUP35lI"}],"key":"kwCxEsSevC"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineCode","value":"t2m","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TIQmFzbSdc"}],"key":"U4b3fDGgRY"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"°C","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"r1r42lbelw"}],"key":"O11Yipvxqe"}],"key":"cPqLYiMLpV"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"100 m wind speed","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"xcX8Fu9CmB"}],"key":"WrvE5Z94zv"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"inlineCode","value":"wind_speed_100m","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"EN9CCUcdT2"}],"key":"fK0BJxyHhE"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"m/s","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"X7As5OjgAd"}],"key":"DTHur1Dee7"}],"key":"DW8OJ0Ov78"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Solar radiation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"LCSAZZp3IA"}],"key":"BDZdXFWlM6"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"ssrd","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MNjHU2CAsO"}],"key":"CPfIFPd4zg"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"kWh/m²/day","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"sEE2Jw5Hd6"}],"key":"JQjdE7U160"}],"key":"rrykZ92UeJ"}],"key":"yDlIzUYjVT"}],"key":"j1HOc73kMO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:18.166081Z","iopub.status.busy":"2026-03-01T17:15:18.165988Z","iopub.status.idle":"2026-03-01T17:15:18.796288Z","shell.execute_reply":"2026-03-01T17:15:18.795237Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.colors as mcolors\nimport xarray as xr\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\n\nfrom woe.paths import ProjPaths\n\npaths = ProjPaths()","key":"ttfowewauf"},{"type":"outputs","id":"8tLExFBgHKjuwjqctkem7","children":[],"key":"w4W7UTUSpG"}],"key":"rDpzXTPimg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:18.797906Z","iopub.status.busy":"2026-03-01T17:15:18.797631Z","iopub.status.idle":"2026-03-01T17:15:18.827315Z","shell.execute_reply":"2026-03-01T17:15:18.826688Z"},"lines_to_next_cell":1},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load Germany monthly time series produced by 16_compute_germany_time_series.py\ndf = pd.read_parquet(paths.era5_germany_monthly_ts_file)\n\n# Derived columns\ndf[\"t2m_c\"]    = df[\"t2m\"] - 273.15      # K → °C\ndf[\"ssrd_kwh\"] = df[\"ssrd\"] / 3.6e6     # J/m² (daily mean) → kWh/m²/day\ndf[\"month\"]    = df.index.month\ndf[\"year\"]     = df.index.year\n\nMONTH_LABELS = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n\nprint(f\"Loaded {len(df)} monthly records, \"\n      f\"{df['year'].min()}–{df['year'].max()}\")\nprint(f\"Columns: {list(df.columns)}\")","key":"BMMz3GAHEc"},{"type":"outputs","id":"AZx7g3ABaGXJcjEIFV1RX","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Loaded 1020 monthly records, 1940–2024\nColumns: ['msl', 't2m', 'tp', 'sf', 'ssrd', 'wind_speed_100m', 'z_250hpa', 'wind_speed_250hpa', 'z_500hpa', 'wind_speed_500hpa', 't2m_c', 'ssrd_kwh', 'month', 'year']\n"},"children":[],"key":"zuQOS84Ke1"}],"key":"qW2StQ929W"}],"key":"H7fq2H8vGd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:18.828736Z","iopub.status.busy":"2026-03-01T17:15:18.828647Z","iopub.status.idle":"2026-03-01T17:15:18.833433Z","shell.execute_reply":"2026-03-01T17:15:18.833013Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def jitter_plot(ax, df, var, ylabel, title,\n                cmap=\"RdBu_r\", vmin=None, vmax=None,\n                hline=None, hline_label=None):\n    \"\"\"Jitter plot: one dot per year for each calendar month.\n\n    Dots are coloured by the variable value.  The black horizontal bar\n    marks the calendar-month median.\n    \"\"\"\n    rng = np.random.default_rng(42)\n    vals = df[var].values\n    if vmin is None:\n        vmin = np.percentile(vals, 2)\n    if vmax is None:\n        vmax = np.percentile(vals, 98)\n\n    norm = mcolors.Normalize(vmin=vmin, vmax=vmax)\n    cmap_obj = plt.get_cmap(cmap)\n\n    for m in range(1, 13):\n        data = df.loc[df[\"month\"] == m, var].values\n        x = m + rng.uniform(-0.28, 0.28, len(data))\n        ax.scatter(x, data, c=cmap_obj(norm(data)),\n                   s=16, alpha=0.80, zorder=3, linewidths=0)\n        med = np.median(data)\n        ax.plot([m - 0.32, m + 0.32], [med, med],\n                color=\"black\", linewidth=1.8, zorder=4)\n\n    if hline is not None:\n        ax.axhline(hline, color=\"#3a8abf\", linewidth=1.0,\n                   linestyle=\"--\", alpha=0.7, label=hline_label)\n        if hline_label:\n            ax.legend(fontsize=8, loc=\"upper right\")\n\n    ax.set_xticks(range(1, 13))\n    ax.set_xticklabels(MONTH_LABELS)\n    ax.set_ylabel(ylabel)\n    ax.set_title(title, fontsize=11, fontweight=\"bold\")\n    ax.grid(axis=\"y\", linewidth=0.4, alpha=0.4)\n    ax.set_xlim(0.5, 12.5)","key":"LvmS4G5uax"},{"type":"outputs","id":"oX_0P4lEElwnxbrM8rYm_","children":[],"key":"ahjBgLKOLr"}],"key":"epJILgEXPw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2 m temperature by calendar month","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"chNj3viki3"}],"identifier":"id-2-m-temperature-by-calendar-month","label":"2 m temperature by calendar month","html_id":"id-2-m-temperature-by-calendar-month","implicit":true,"key":"B78SmlE2Ej"}],"key":"N2ZbnR4VOt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:18.835009Z","iopub.status.busy":"2026-03-01T17:15:18.834844Z","iopub.status.idle":"2026-03-01T17:15:19.017551Z","shell.execute_reply":"2026-03-01T17:15:19.016915Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(13, 5))\njitter_plot(\n    ax, df, \"t2m_c\",\n    ylabel=\"2 m temperature (°C)\",\n    title=\"ERA5 monthly 2 m temperature by month — Germany (one dot per year)\",\n    cmap=\"RdYlBu_r\",\n    hline=0, hline_label=\"0 °C\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"17_germany_t2m_jitter.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"c5zYio0xlY"},{"type":"outputs","id":"HbUYyREirSn1x3dpesHKl","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/1352232890.py:11: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"whOIdXsBlj"}],"key":"bzdPtprpnE"}],"key":"ttezo58SY5"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/17_germany_t2m_jitte-615552217df485bdcf8ff4e491e0de99.png","alt":"ERA5 monthly mean 2 m temperature for Germany (spatial mean), 1940–2024.\nEach dot is one year; the black bar marks the calendar-month median.\nThe spread within each month shows the substantial year-to-year variability\ndriven by atmospheric circulation patterns such as the NAO and blocking events.","data":{"altTextIsAutoGenerated":true},"key":"ls1gcaKRdT","urlSource":"../../output/images/17_germany_t2m_jitter.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-17-germany-t2m-jitter","identifier":"fig-17-germany-t2m-jitter","html_id":"fig-17-germany-t2m-jitter","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"rMTtxAPfY5"},{"type":"text","value":"1","key":"RKMViJILmX"},{"type":"text","value":":","key":"WBGTO9Ejgb"}],"template":"Figure %s:","key":"ON9aOK1FHK"},{"type":"text","value":"ERA5 monthly mean 2 m temperature for Germany (spatial mean), 1940–2024.\nEach dot is one year; the black bar marks the calendar-month median.\nThe spread within each month shows the substantial year-to-year variability\ndriven by atmospheric circulation patterns such as the NAO and blocking events.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cGQklkHZGQ"}],"key":"VgGbWOAfIK"}],"key":"eZN22WZ2m8"}],"label":"fig-17-germany-t2m-jitter","identifier":"fig-17-germany-t2m-jitter","enumerator":"1","html_id":"fig-17-germany-t2m-jitter","key":"IYnRWdiWh6"}],"key":"j2PTiou7fR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"100 m wind speed by calendar month","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O13nry6Y8d"}],"identifier":"id-100-m-wind-speed-by-calendar-month","label":"100 m wind speed by calendar month","html_id":"id-100-m-wind-speed-by-calendar-month","implicit":true,"key":"VfCw7i3xWC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"100 m wind speed is the most direct ERA5 proxy for wind-turbine output.\nWind is strongest in winter but shows large year-to-year scatter in every\nseason, driven by variability in the jet stream and Atlantic storm tracks.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UXXCrS5w1Q"}],"key":"lFhlKv1Cz3"}],"key":"pewKvMGH2u"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:19.019136Z","iopub.status.busy":"2026-03-01T17:15:19.019040Z","iopub.status.idle":"2026-03-01T17:15:19.177895Z","shell.execute_reply":"2026-03-01T17:15:19.176995Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(13, 5))\njitter_plot(\n    ax, df, \"wind_speed_100m\",\n    ylabel=\"100 m wind speed (m/s)\",\n    title=\"ERA5 monthly 100 m wind speed by month — Germany (one dot per year)\",\n    cmap=\"viridis\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"17_germany_wind_jitter.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"jZql90cO6l"},{"type":"outputs","id":"rHfuT62gO_hAaUhnJHWbS","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/1978199033.py:10: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"zZPfHFyHOj"}],"key":"o0CM80mdLN"}],"key":"o1Pbd1UbpD"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/17_germany_wind_jitt-840e3485650156c695ff28cd878e027d.png","alt":"ERA5 monthly mean 100 m wind speed for Germany (spatial mean), 1940–2024.\nWinter months (Nov–Feb) are on average windiest but also show the largest\nabsolute spread.  Low-wind winter months are potential Dunkelflaute candidates.","data":{"altTextIsAutoGenerated":true},"key":"FBjzmIDX73","urlSource":"../../output/images/17_germany_wind_jitter.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-17-germany-wind-jitter","identifier":"fig-17-germany-wind-jitter","html_id":"fig-17-germany-wind-jitter","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"pDT8nC9wEA"},{"type":"text","value":"2","key":"ckmUPyvjnQ"},{"type":"text","value":":","key":"eyssMzuGLa"}],"template":"Figure %s:","key":"PPYwHOzme8"},{"type":"text","value":"ERA5 monthly mean 100 m wind speed for Germany (spatial mean), 1940–2024.\nWinter months (Nov–Feb) are on average windiest but also show the largest\nabsolute spread.  Low-wind winter months are potential Dunkelflaute candidates.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v8eu8I4z4L"}],"key":"MFpu17npGV"}],"key":"s1sKKxd4ev"}],"label":"fig-17-germany-wind-jitter","identifier":"fig-17-germany-wind-jitter","enumerator":"2","html_id":"fig-17-germany-wind-jitter","key":"KmcI3P4FeH"}],"key":"IZJWPozgxn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Surface solar radiation by calendar month","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iirZOMYhfg"}],"identifier":"surface-solar-radiation-by-calendar-month","label":"Surface solar radiation by calendar month","html_id":"surface-solar-radiation-by-calendar-month","implicit":true,"key":"zhc3j2Dw5w"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Monthly mean surface solar radiation (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qTrL0Z6wB7"},{"type":"inlineCode","value":"ssrd","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vSm0UKh3wd"},{"type":"text","value":"), converted to kWh/m²/day,\nis a proxy for photovoltaic output potential.  The near-zero winter values\nreflect Germany’s high latitude (~47–55°N) and the short winter day length.\nSummer months show remarkably little year-to-year spread compared with wind.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"isFmsEKF61"}],"key":"IdP87rt7fc"}],"key":"jA4ZyCT1Gf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:19.179125Z","iopub.status.busy":"2026-03-01T17:15:19.179035Z","iopub.status.idle":"2026-03-01T17:15:19.331108Z","shell.execute_reply":"2026-03-01T17:15:19.330019Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(13, 5))\njitter_plot(\n    ax, df, \"ssrd_kwh\",\n    ylabel=\"Surface solar radiation (kWh/m²/day)\",\n    title=\"ERA5 monthly surface solar radiation by month — Germany (one dot per year)\",\n    cmap=\"plasma\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"17_germany_ssrd_jitter.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"wwvT0nvsum"},{"type":"outputs","id":"Q-b5MNQZkO9Zht_ZvpDXU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/1200298036.py:10: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"RZHpwkiWwy"}],"key":"LgffK1qpVi"}],"key":"urXiYQNkrB"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/17_germany_ssrd_jitt-c2a687b45c217c4d233af9c4fbd90f0f.png","alt":"ERA5 monthly mean surface solar radiation downwards for Germany, 1940–2024.\nThe seasonal cycle dominates: values approach zero in December and peak in\nJune–July.  Year-to-year variability is moderate in summer (cloud-cover\ndifferences) but negligible in winter where solar geometry constrains output.","data":{"altTextIsAutoGenerated":true},"key":"iCgOTH5oIB","urlSource":"../../output/images/17_germany_ssrd_jitter.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-17-germany-ssrd-jitter","identifier":"fig-17-germany-ssrd-jitter","html_id":"fig-17-germany-ssrd-jitter","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"CDnv2yoYml"},{"type":"text","value":"3","key":"zXOegHQCBU"},{"type":"text","value":":","key":"auj7WtNnVF"}],"template":"Figure %s:","key":"aFy2uhHbF8"},{"type":"text","value":"ERA5 monthly mean surface solar radiation downwards for Germany, 1940–2024.\nThe seasonal cycle dominates: values approach zero in December and peak in\nJune–July.  Year-to-year variability is moderate in summer (cloud-cover\ndifferences) but negligible in winter where solar geometry constrains output.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b4JlFHr1q7"}],"key":"CS0kxB0ctl"}],"key":"wdmS7C5n5l"}],"label":"fig-17-germany-ssrd-jitter","identifier":"fig-17-germany-ssrd-jitter","enumerator":"3","html_id":"fig-17-germany-ssrd-jitter","key":"zq5tR3xJwG"}],"key":"zHFlSu4pmr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dunkelflaute analysis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iDr2uU0UNT"}],"identifier":"dunkelflaute-analysis","label":"Dunkelflaute analysis","html_id":"dunkelflaute-analysis","implicit":true,"key":"nkOUkMqY8u"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dunkelflaute","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bP3h7REf87"}],"key":"i1vAf6FdBV"},{"type":"text","value":" (lit. “dark doldrums”) describes periods when both wind and\nsolar renewable generation are simultaneously very low — a critical stress\nscenario for a power system with high renewable penetration.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OHB1OJN2a1"}],"key":"XfS0210Nte"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Definition used here:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z5jVxvuSSw"}],"key":"VZ9xGAuzdp"},{"type":"text","value":" a month is classified as Dunkelflaute when\nGermany-mean 100 m wind speed ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hjoFbQpdsY"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"and","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nXyHTgmNeC"}],"key":"djDbLROdnB"},{"type":"text","value":" surface solar radiation are both\nbelow their respective 25th percentiles computed over all 1020 months\n(1940–2024).  This captures the joint bottom-quartile tail of both\nresource distributions.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"guoyXBxhGX"}],"key":"gkos9hui6G"}],"key":"M8jYTEqems"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:19.332603Z","iopub.status.busy":"2026-03-01T17:15:19.332511Z","iopub.status.idle":"2026-03-01T17:15:19.339631Z","shell.execute_reply":"2026-03-01T17:15:19.338997Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# --- Dunkelflaute thresholds ---\np25_wind  = df[\"wind_speed_100m\"].quantile(0.25)\np25_solar = df[\"ssrd_kwh\"].quantile(0.25)\n\ndf[\"dunkelflaute\"] = (\n    (df[\"wind_speed_100m\"] < p25_wind) &\n    (df[\"ssrd_kwh\"]        < p25_solar)\n)\n\nn_df  = df[\"dunkelflaute\"].sum()\nfrac  = n_df / len(df)\nprint(f\"Thresholds — wind: {p25_wind:.2f} m/s,  solar: {p25_solar:.3f} kWh/m²/day\")\nprint(f\"Dunkelflaute months: {n_df} / {len(df)}  ({100*frac:.1f} %)\")\nprint(\"\\nCount per calendar month:\")\nprint(df.groupby(\"month\")[\"dunkelflaute\"].sum().to_string())","key":"ReCGUuOE1M"},{"type":"outputs","id":"rFrUrpLILRCbeyWpz-6Xq","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Thresholds — wind: 1.56 m/s,  solar: 1.268 kWh/m²/day\nDunkelflaute months: 20 / 1020  (2.0 %)\n\nCount per calendar month:\nmonth\n1     9\n2     0\n3     0\n4     0\n5     0\n6     0\n7     0\n8     0\n9     0\n10    0\n11    8\n12    3\n"},"children":[],"key":"oVCHmQ6X9p"}],"key":"mSkz2RdnXx"}],"key":"Eh4CaU80QE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:19.340925Z","iopub.status.busy":"2026-03-01T17:15:19.340842Z","iopub.status.idle":"2026-03-01T17:15:19.701745Z","shell.execute_reply":"2026-03-01T17:15:19.701269Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# 12 perceptually distinct colours for the months (cyclic HSV)\nMONTH_COLORS = plt.get_cmap(\"hsv\")(np.linspace(0, 1, 13))[:12]\n\nfig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# --- Left: wind vs solar scatter, coloured by calendar month ---\nax = axes[0]\nfor m in range(1, 13):\n    sel = df[df[\"month\"] == m]\n    ax.scatter(\n        sel[\"wind_speed_100m\"], sel[\"ssrd_kwh\"],\n        color=MONTH_COLORS[m - 1], s=14, alpha=0.75,\n        label=MONTH_LABELS[m - 1], zorder=3, linewidths=0,\n    )\n\n# Dunkelflaute quadrant shading\nax.axvline(p25_wind,  color=\"gray\", linewidth=0.9, linestyle=\"--\", alpha=0.6)\nax.axhline(p25_solar, color=\"gray\", linewidth=0.9, linestyle=\"--\", alpha=0.6)\nxmax = df[\"wind_speed_100m\"].max() * 1.05\nymax = df[\"ssrd_kwh\"].max() * 1.05\nax.fill_betweenx(\n    [0, p25_solar], 0, p25_wind,\n    color=\"steelblue\", alpha=0.15, zorder=1,\n)\nax.text(\n    p25_wind * 0.48, p25_solar * 0.50,\n    \"Dunkelflaute\\nzone\",\n    ha=\"center\", va=\"center\",\n    fontsize=9, color=\"steelblue\", fontweight=\"bold\",\n)\nax.set_xlabel(\"100 m wind speed (m/s)\")\nax.set_ylabel(\"Surface solar radiation (kWh/m²/day)\")\nax.set_title(\n    \"Wind vs solar — Germany monthly means\\n(coloured by calendar month)\",\n    fontsize=10, fontweight=\"bold\",\n)\nax.legend(title=\"Month\", ncol=2, fontsize=7, title_fontsize=8,\n          loc=\"upper right\", framealpha=0.9)\nax.set_xlim(0, xmax)\nax.set_ylim(0, ymax)\nax.grid(linewidth=0.4, alpha=0.4)\n\n# --- Right: Dunkelflaute frequency by calendar month ---\nax2 = axes[1]\nfreq = df.groupby(\"month\")[\"dunkelflaute\"].mean() * 100\nbar_colors = [MONTH_COLORS[m - 1] for m in freq.index]\nax2.bar(freq.index, freq.values, color=bar_colors, width=0.7, alpha=0.85, zorder=3)\nax2.axhline(frac * 100, color=\"black\", linewidth=1.0, linestyle=\"--\", alpha=0.6,\n            label=f\"Overall rate ({frac*100:.1f}%)\")\nax2.set_xticks(range(1, 13))\nax2.set_xticklabels(MONTH_LABELS)\nax2.set_ylabel(\"Frequency of Dunkelflaute years (%)\")\nax2.set_title(\n    \"Dunkelflaute frequency by calendar month\\n\"\n    \"(wind < p25 AND solar < p25, ERA5 1940–2024)\",\n    fontsize=10, fontweight=\"bold\",\n)\nax2.grid(axis=\"y\", linewidth=0.4, alpha=0.4)\nax2.legend(fontsize=8)\n\nfig.suptitle(\"Dunkelflaute analysis — Germany ERA5 1940–2024\",\n             fontsize=12, fontweight=\"bold\")\nfig.tight_layout()\nfig.savefig(paths.images_path / \"17_germany_dunkelflaute.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"cvTv1wQDjL"},{"type":"outputs","id":"na2viY2CiyHTrbdCHX0Jo","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/626485424.py:65: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"YspJ1OCfMX"}],"key":"GllCK2TE97"}],"key":"trcf9QVnEf"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/17_germany_dunkelfla-97db44dcc03dcae33617fbe1e631f985.png","alt":"Left: scatter of Germany monthly 100 m wind speed vs surface solar\nradiation, 1940–2024, coloured by calendar month.  The shaded blue quadrant\nmarks the Dunkelflaute zone (both resources below their 25th percentile).\nRight: fraction of years in each calendar month that fell into the\nDunkelflaute zone.  Dunkelflaute events are overwhelmingly concentrated in\nNovember–January, when solar output is structurally near zero and wind can\nalso be suppressed by blocking anticyclones.","data":{"altTextIsAutoGenerated":true},"key":"dgpmTa9KaJ","urlSource":"../../output/images/17_germany_dunkelflaute.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-17-germany-dunkelflaute","identifier":"fig-17-germany-dunkelflaute","html_id":"fig-17-germany-dunkelflaute","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"VPiIeeVGJ3"},{"type":"text","value":"4","key":"jpLg7F2uZ0"},{"type":"text","value":":","key":"c8jSt6F89Y"}],"template":"Figure %s:","key":"fEZ3PlPfrS"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Left:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l2ElUVFS9T"}],"key":"PJ7NcxOiiy"},{"type":"text","value":" scatter of Germany monthly 100 m wind speed vs surface solar\nradiation, 1940–2024, coloured by calendar month.  The shaded blue quadrant\nmarks the Dunkelflaute zone (both resources below their 25th percentile).\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wn0eEd26DN"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Right:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CyDTWQX59P"}],"key":"D0JigE02b1"},{"type":"text","value":" fraction of years in each calendar month that fell into the\nDunkelflaute zone.  Dunkelflaute events are overwhelmingly concentrated in\nNovember–January, when solar output is structurally near zero and wind can\nalso be suppressed by blocking anticyclones.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZYoDG3qoa5"}],"key":"ak5cNHkkem"}],"key":"LBspsahhf2"}],"label":"fig-17-germany-dunkelflaute","identifier":"fig-17-germany-dunkelflaute","enumerator":"4","html_id":"fig-17-germany-dunkelflaute","key":"gcaPIVAYUZ"}],"key":"DYy1bSP8p5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Case studies: cold vs warm January","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RGuBZByl4o"}],"identifier":"case-studies-cold-vs-warm-january","label":"Case studies: cold vs warm January","html_id":"case-studies-cold-vs-warm-january","implicit":true,"key":"zPinHrlaYV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To show how the large-scale circulation drives extreme temperature anomalies\nwe compare January 1963 (coldest: Germany mean −7.3 °C, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AUNO83XQy1"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Big Freeze","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WDU0FNGDU3"}],"key":"YVw2cUt4Cz"},{"type":"text","value":",\ncaused by a blocking anticyclone funnelling Arctic/Siberian air into central\nEurope) against January 2007 (warmest: Germany mean +4.9 °C, associated with\na strongly positive NAO and persistent westerly flow from the Atlantic).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UJW3rrk7rm"}],"key":"wNtJPwUOOe"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Both months are shown with identical colour scales so differences are\nimmediately comparable.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fI4tYkVLu5"}],"key":"qftD1insCx"}],"key":"WlrWEVcaC8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:19.702921Z","iopub.status.busy":"2026-03-01T17:15:19.702830Z","iopub.status.idle":"2026-03-01T17:15:19.706486Z","shell.execute_reply":"2026-03-01T17:15:19.706054Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"COLD_YEAR = 1963\nWARM_YEAR = 2007\nG = 9.80665  # standard gravity (m/s2)\n\nt2m_cold_de = float(df.loc[f\"{COLD_YEAR}-01-01\", \"t2m_c\"])\nt2m_warm_de = float(df.loc[f\"{WARM_YEAR}-01-01\", \"t2m_c\"])\nprint(f\"Cold case: January {COLD_YEAR}  Germany mean = {t2m_cold_de:.1f} °C\")\nprint(f\"Warm case: January {WARM_YEAR}  Germany mean = {t2m_warm_de:.1f} °C\")","key":"dggbhic8ol"},{"type":"outputs","id":"T8Uk7vV4ciQNi4My74u3c","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Cold case: January 1963  Germany mean = -7.3 °C\nWarm case: January 2007  Germany mean = 4.9 °C\n"},"children":[],"key":"B38AMRRmcL"}],"key":"e8yAXzXunw"}],"key":"X0l69rVKBX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:19.707620Z","iopub.status.busy":"2026-03-01T17:15:19.707536Z","iopub.status.idle":"2026-03-01T17:15:20.351710Z","shell.execute_reply":"2026-03-01T17:15:20.351149Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load spatial ERA5 fields for both case months\nds = xr.open_zarr(paths.era5_monthly_zarr_path)\n\ndef _load_fields(year):\n    date = f\"{year}-01\"\n    t2m  = (ds[\"t2m\"].sel(time=date).squeeze() - 273.15).compute()\n    z500 = (ds[\"z\"].sel(time=date, pressure_level=500).squeeze() / G).compute()\n    u250 = ds[\"u\"].sel(time=date, pressure_level=250).squeeze().compute()\n    v250 = ds[\"v\"].sel(time=date, pressure_level=250).squeeze().compute()\n    wspd = np.sqrt(u250**2 + v250**2)\n    return t2m, z500, u250, v250, wspd\n\nt2m_cold, z500_cold, u250_cold, v250_cold, wspd250_cold = _load_fields(COLD_YEAR)\nt2m_warm, z500_warm, u250_warm, v250_warm, wspd250_warm = _load_fields(WARM_YEAR)\n\n# Shared colour and contour limits (computed across both months)\nT2M_VMIN, T2M_VMAX = -40, 20\nWIND_VMAX = max(float(wspd250_cold.max()), float(wspd250_warm.max()))\n\n_z_all_min = min(float(z500_cold.min()), float(z500_warm.min()))\n_z_all_max = max(float(z500_cold.max()), float(z500_warm.max()))\nZ500_LEVELS = np.arange(\n    np.floor(_z_all_min / 80) * 80,\n    np.ceil(_z_all_max  / 80) * 80 + 1,\n    80,\n)\n\nprint(f\"Shared wind vmax: {WIND_VMAX:.1f} m/s\")\nprint(f\"Z500 levels: {Z500_LEVELS[0]:.0f} … {Z500_LEVELS[-1]:.0f} m \"\n      f\"({len(Z500_LEVELS)} contours)\")","key":"CsIUfprY2s"},{"type":"outputs","id":"n1SvqNCa8TYjSSt6QGLK3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Shared wind vmax: 54.4 m/s\nZ500 levels: 4960 … 5920 m (13 contours)\n"},"children":[],"key":"uSNyjxw9HC"}],"key":"FGzdfBNV5N"}],"key":"gudOV1TDQR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:20.353217Z","iopub.status.busy":"2026-03-01T17:15:20.352997Z","iopub.status.idle":"2026-03-01T17:15:20.356545Z","shell.execute_reply":"2026-03-01T17:15:20.356079Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Shared map settings\nPROJ   = ccrs.Orthographic(central_longitude=-10, central_latitude=55)\nEXTENT = [-90, 40, 20, 80]   # W, E, S, N  (PlateCarree)\nN = 5  # quiver thinning factor\n\nlons_q = u250_cold.longitude.values[::N]\nlats_q = u250_cold.latitude.values[::N]","key":"AJ3isTsvMe"},{"type":"outputs","id":"kmCh-ves7Zn0nqbOfQb1W","children":[],"key":"bQkbEbdE0s"}],"key":"s60hiayULm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2 m temperature — cold vs warm January","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x8EKrOZHYQ"}],"identifier":"id-2-m-temperature-cold-vs-warm-january","label":"2 m temperature — cold vs warm January","html_id":"id-2-m-temperature-cold-vs-warm-january","implicit":true,"key":"UAJCRM9AbW"}],"key":"AA8dGTZhAm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:20.357903Z","iopub.status.busy":"2026-03-01T17:15:20.357749Z","iopub.status.idle":"2026-03-01T17:15:21.946723Z","shell.execute_reply":"2026-03-01T17:15:21.945741Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(\n    1, 2, figsize=(18, 8),\n    subplot_kw={\"projection\": PROJ},\n)\n\ncases_t2m = [\n    (axes[0], t2m_cold, z500_cold, COLD_YEAR, t2m_cold_de),\n    (axes[1], t2m_warm, z500_warm, WARM_YEAR, t2m_warm_de),\n]\n\nfor ax, t2m, z500, year, t2m_de in cases_t2m:\n    ax.set_extent(EXTENT, crs=ccrs.PlateCarree())\n    im = ax.pcolormesh(\n        t2m.longitude, t2m.latitude, t2m.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"RdYlBu_r\", vmin=T2M_VMIN, vmax=T2M_VMAX,\n    )\n    cs = ax.contour(\n        z500.longitude, z500.latitude, z500.values,\n        levels=Z500_LEVELS,\n        colors=\"black\", linewidths=0.6, alpha=0.55,\n        transform=ccrs.PlateCarree(),\n    )\n    ax.clabel(cs, fmt=\"%d\", fontsize=7, inline=True)\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.7)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n    ax.plot(10.5, 51.2, transform=ccrs.PlateCarree(),\n            marker=\"*\", markersize=11, color=\"gold\",\n            markeredgecolor=\"black\", markeredgewidth=0.6, zorder=5)\n    ax.text(12.5, 51.2, \"Germany\", transform=ccrs.PlateCarree(),\n            fontsize=9, fontweight=\"bold\", color=\"black\", va=\"center\", zorder=5)\n    ax.set_title(\n        f\"January {year}  (Germany mean: {t2m_de:+.1f} °C)\\nZ500 contours every 80 m\",\n        fontsize=11, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"2 m temperature (°C)\",\n)\nfig.suptitle(\n    \"ERA5 2 m temperature — cold vs warm January\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"17_january_t2m_comparison.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"SRPhg2NW04"},{"type":"outputs","id":"SpfMV_WL2yHkzIpHdjaR2","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/515674607.py:46: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"cKEVlFIpO3"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/515674607.py:48: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"rO4GNui783"}],"key":"H2sDRs348g"}],"key":"WiasI0U56y"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/17_january_t2m_compa-97f112d1d2d9f12d36442df59811b3ef.png","alt":"ERA5 2 m temperature for January 1963 (left, cold) and January 2007 (right,\nwarm) on an orthographic projection.  Both panels share the same colour scale\nand Z500 contour levels (every 80 m, black lines) to make comparison direct.\nIn 1963 a blocking ridge over Scandinavia/Russia channels Arctic air into\ncentral Europe (deep blue over Germany); in 2007 a strongly positive NAO\ndrives mild Atlantic westerlies across the continent (orange-yellow over\nwestern Europe).","data":{"altTextIsAutoGenerated":true},"key":"cxNWHZQ4G1","urlSource":"../../output/images/17_january_t2m_comparison.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-17-january-t2m-comparison","identifier":"fig-17-january-t2m-comparison","html_id":"fig-17-january-t2m-comparison","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"VkFdyjqmBV"},{"type":"text","value":"5","key":"tmIQl36cTr"},{"type":"text","value":":","key":"CxHeldqsBA"}],"template":"Figure %s:","key":"N9vaf4YJpH"},{"type":"text","value":"ERA5 2 m temperature for January 1963 (left, cold) and January 2007 (right,\nwarm) on an orthographic projection.  Both panels share the same colour scale\nand Z500 contour levels (every 80 m, black lines) to make comparison direct.\nIn 1963 a blocking ridge over Scandinavia/Russia channels Arctic air into\ncentral Europe (deep blue over Germany); in 2007 a strongly positive NAO\ndrives mild Atlantic westerlies across the continent (orange-yellow over\nwestern Europe).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CxPLREVlIm"}],"key":"zMMQDghT5a"}],"key":"RPNfEQOYV6"}],"label":"fig-17-january-t2m-comparison","identifier":"fig-17-january-t2m-comparison","enumerator":"5","html_id":"fig-17-january-t2m-comparison","key":"i7p2UOtHZU"}],"key":"RyE7gPJTPu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"250 hPa wind speed and Z500 — cold vs warm January","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jexD4iCvCy"}],"identifier":"id-250-hpa-wind-speed-and-z500-cold-vs-warm-january","label":"250 hPa wind speed and Z500 — cold vs warm January","html_id":"id-250-hpa-wind-speed-and-z500-cold-vs-warm-january","implicit":true,"key":"W8XiYxAOJ9"}],"key":"utBNi67Am9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2026-03-01T17:15:21.948363Z","iopub.status.busy":"2026-03-01T17:15:21.948167Z","iopub.status.idle":"2026-03-01T17:15:23.373035Z","shell.execute_reply":"2026-03-01T17:15:23.372354Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(\n    1, 2, figsize=(18, 8),\n    subplot_kw={\"projection\": PROJ},\n)\n\ncases_wind = [\n    (axes[0], wspd250_cold, z500_cold, u250_cold, v250_cold, COLD_YEAR),\n    (axes[1], wspd250_warm, z500_warm, u250_warm, v250_warm, WARM_YEAR),\n]\n\nfor ax, wspd, z500, u250, v250, year in cases_wind:\n    ax.set_extent(EXTENT, crs=ccrs.PlateCarree())\n    im = ax.pcolormesh(\n        wspd.longitude, wspd.latitude, wspd.values,\n        transform=ccrs.PlateCarree(),\n        cmap=\"plasma\", vmin=0, vmax=WIND_VMAX,\n    )\n    cs = ax.contour(\n        z500.longitude, z500.latitude, z500.values,\n        levels=Z500_LEVELS,\n        colors=\"white\", linewidths=0.8, alpha=0.65,\n        transform=ccrs.PlateCarree(),\n    )\n    ax.clabel(cs, fmt=\"%d\", fontsize=7, inline=True, colors=\"white\")\n    ax.quiver(\n        lons_q, lats_q,\n        u250.values[::N, ::N], v250.values[::N, ::N],\n        transform=ccrs.PlateCarree(),\n        scale=2500, width=0.0012, color=\"white\", alpha=0.65,\n    )\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.7)\n    ax.add_feature(cfeature.BORDERS, linewidth=0.4, linestyle=\":\")\n    ax.gridlines(linewidth=0.3, color=\"gray\", alpha=0.5)\n    ax.set_title(\n        f\"January {year}\\nZ500 contours every 80 m  |  arrows = wind direction\",\n        fontsize=11, fontweight=\"bold\",\n    )\n\nfig.colorbar(\n    im, ax=axes, orientation=\"horizontal\", pad=0.04, fraction=0.03,\n    label=\"250 hPa wind speed (m/s)\",\n)\nfig.suptitle(\n    \"250 hPa wind speed and Z500 — cold vs warm January\",\n    fontsize=13, fontweight=\"bold\",\n)\nfig.tight_layout()\nfig.savefig(paths.images_path / \"17_january_250hpa_comparison.png\", dpi=150, bbox_inches=\"tight\")\nplt.show()","key":"vEY8Igsl2M"},{"type":"outputs","id":"g-AhEfMp9oZd_uMypoWjJ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/1397589112.py:47: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.tight_layout()\n"},"children":[],"key":"hOc9tYwbYy"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_152177/1397589112.py:49: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown\n  plt.show()\n"},"children":[],"key":"gvDjZx2zul"}],"key":"yWP3MKOc2r"}],"key":"DROTJXktfZ"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/17_january_250hpa_co-a1eca393d3cb3227f1d2852271695b52.png","alt":"250 hPa wind speed (colour; shared plasma scale) and Z500 contours (white,\nevery 80 m) for January 1963 (left) and January 2007 (right).  White arrows\nshow wind direction.  In 1963 the jet is displaced southward and weakened\nover central Europe due to the blocking ridge; in 2007 the jet is strong and\ndirected straight at Europe, advecting mild air from the Atlantic.","data":{"altTextIsAutoGenerated":true},"key":"AnYKlu8qKu","urlSource":"../../output/images/17_january_250hpa_comparison.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-17-january-250hpa-comparison","identifier":"fig-17-january-250hpa-comparison","html_id":"fig-17-january-250hpa-comparison","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"tUe0LoyfPz"},{"type":"text","value":"6","key":"FrlLmhqvqP"},{"type":"text","value":":","key":"eMp2GTYvSd"}],"template":"Figure %s:","key":"x50HLJlAbJ"},{"type":"text","value":"250 hPa wind speed (colour; shared plasma scale) and Z500 contours (white,\nevery 80 m) for January 1963 (left) and January 2007 (right).  White arrows\nshow wind direction.  In 1963 the jet is displaced southward and weakened\nover central Europe due to the blocking ridge; in 2007 the jet is strong and\ndirected straight at Europe, advecting mild air from the Atlantic.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X7NBhXdly3"}],"key":"F1Rbkr3fhv"}],"key":"vhnNCYA7wA"}],"label":"fig-17-january-250hpa-comparison","identifier":"fig-17-january-250hpa-comparison","enumerator":"6","html_id":"fig-17-january-250hpa-comparison","key":"dqbhIAhEmN"}],"key":"EVj26LSGGW"}],"key":"iCsXdXk61x"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Pressure Levels and the Jet Stream","url":"/notebooks/pressure-and-weather","group":"Weather"},"next":{"title":"Monthly ERA5 Reanalysis","url":"/notebooks/nao-index","group":"Weather"}}},"domain":"http://localhost:3000"}
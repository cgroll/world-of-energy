{"version":3,"kind":"Notebook","sha256":"274f7c66771eab2dff8b148f4b4f73e63ed2673d9d3e578e608ec60c62456817","slug":"notebooks.earth-seasons","location":"/notebooks/10_earth_seasons.md","dependencies":[],"frontmatter":{"title":"Earth’s Seasons — From Sunlight to Vegetation","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"text_representation":{"format_name":"percent"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Christian Groll","given":"Christian","family":"Groll"},"name":"Christian Groll","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/cgroll/world-of-energy","copyright":"2026","source_url":"https://github.com/cgroll/world-of-energy/blob/main/book/notebooks/10_earth_seasons.md","edit_url":"https://github.com/cgroll/world-of-energy/edit/main/book/notebooks/10_earth_seasons.md","thumbnail":"/world-of-energy/build/10_sunlight_animatio-f6ac1e7f74d4bb303b286ea8782c1a27.gif","exports":[{"format":"md","filename":"10_earth_seasons.md","url":"/world-of-energy/build/10_earth_seasons-9a8a7d9f5e85fb24d3a26e3e340f4520.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Why do we have seasons? The answer lies in a single geometric fact: the\nEarth’s rotation axis is tilted by about ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AEqT8A4UlA"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"23.4°","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"XbrabEOcdv"}],"key":"kaHlCuUBBu"},{"type":"text","value":" relative to the plane of\nits orbit around the Sun. As the Earth travels along its annual orbit, this\ntilt causes different hemispheres to lean toward or away from the Sun,\nchanging both the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"XP4EBGfgGC"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"angle","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NWENtXMeDz"}],"key":"iCJCABLH5O"},{"type":"text","value":" at which sunlight strikes the surface and the\n","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ejQxdqd4lf"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"number of hours","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CaNr1DmnoU"}],"key":"RbI9IbJQfw"},{"type":"text","value":" of daylight each location receives.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OO2vb1FqfG"}],"key":"JUSO92s1DF"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"This chapter traces the chain of consequences:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ADrZ81uWJ4"}],"key":"y29hKGuVA9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Sunlight geometry","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"IBBEfYYGkV"}],"key":"eFoWY1nY6m"},{"type":"text","value":" — how the Sun illuminates different parts of the\nEarth during the day, and how this pattern shifts between summer and winter.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"gFpfhD9p2w"}],"key":"JJvmGCsuxj"}],"key":"i9nEdDG0J6"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The subsolar point","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hLEDOBkkB7"}],"key":"nGFj26Jzsj"},{"type":"text","value":" — the latitude where the Sun is directly overhead,\nand how it migrates between the Tropics over the year.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"BGeu2VGuQO"}],"key":"l6ZnjoZvht"}],"key":"XoRm4Xh9cu"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Solar elevation","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"alRIfwtidB"}],"key":"Nuz0Z2aZM5"},{"type":"text","value":" — the angle of the Sun above the horizon for any\nlocation and time, which determines how concentrated the incoming energy is.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Zs88cDOFvP"}],"key":"bHpjOg1ELb"}],"key":"bVCwGiQXKV"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Temperature","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"gzKgerptCO"}],"key":"FTodBWgAQA"},{"type":"text","value":" — how the uneven distribution of sunlight drives the\nglobal temperature pattern, both over the course of a day and across seasons.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"lwNwOVwz53"}],"key":"HNnvS2uLjU"}],"key":"lHPTP57UPd"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Vegetation","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"RmLawtpxWl"}],"key":"LNi7eNuoam"},{"type":"text","value":" — how the resulting temperature and moisture patterns\ncontrol where and when vegetation grows, visible from space as a seasonal\n“green wave”.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"vzdKvVBugb"}],"key":"spPGvVkJNt"}],"key":"NcqnoHM5CX"}],"key":"Yud8JkOekM"}],"key":"lWnmPgb8Nt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import calendar\nimport math\nimport os\nfrom datetime import datetime, date, timedelta\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nfrom cartopy.feature.nightshade import Nightshade\nfrom matplotlib.animation import FuncAnimation, PillowWriter\nfrom PIL import Image, ImageDraw\n\nfrom woe.paths import ProjPaths\n\npaths = ProjPaths()","key":"f3a6RMkvc9"},{"type":"outputs","id":"WUL-237gOgn099XOgowuE","children":[],"key":"HSPCmmhVwh"}],"key":"pA6sTAED7B"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Sunlight on Earth — the day cycle","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"p09ppiYbiJ"}],"identifier":"sunlight-on-earth-the-day-cycle","label":"Sunlight on Earth — the day cycle","html_id":"sunlight-on-earth-the-day-cycle","implicit":true,"key":"QUIxCYO4Jk"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"At any given moment, exactly half of the Earth is illuminated by the Sun.\nBut the angle at which sunlight arrives varies enormously by latitude and\ntime of day. Near the equator, sunlight can arrive nearly ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"BeiYXMdl5w"},{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"vertically","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"OwSUi3uwEk"}],"key":"pFx0rWswUI"},{"type":"text","value":",\nconcentrating its energy on a small area. Near the poles, it arrives at a\n","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"L0GQAwGsb4"},{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"shallow angle","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"xG7hVcC1y0"}],"key":"gyaFBO2zm7"},{"type":"text","value":", spreading the same energy over a much larger area — which\nis why polar regions are cold even when they receive 24 hours of daylight in\nsummer.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"xgkh7C3zwt"}],"key":"yef9dQiZLw"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"The two animations below show the illumination pattern over 24 hours on\nthe ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"FV8JEds2X8"},{"type":"strong","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"summer solstice","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"pljMcHQV3e"}],"key":"Buzrq8hd95"},{"type":"text","value":" (June 21) and the ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"iEAtPAHRK4"},{"type":"strong","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"winter solstice","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"VnlfFl6hFL"}],"key":"sXDH4wAint"},{"type":"text","value":" (December 21).\nThe contrast is striking: in June, the North Pole enjoys continuous daylight\nwhile the South Pole is in complete darkness. In December, the situation is\nreversed.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"OMEp5cFNCA"}],"key":"jeYZ5gUk9P"}],"key":"IFECePOQIe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dates = [datetime(2025, 6, 21), datetime(2025, 12, 21)]\nn_frames = 64\nframe_hours = np.linspace(0, 24, n_frames, endpoint=False)\n\n\ndef create_sunlight_animation(anim_date, output_path):\n    fig, ax = plt.subplots(figsize=(16, 9), subplot_kw={\"projection\": ccrs.Robinson()})\n    fig.patch.set_facecolor(\"black\")\n\n    def draw_frame(fractional_hour):\n        ax.clear()\n        h = int(fractional_hour)\n        m = int((fractional_hour - h) * 60)\n        obs_time = datetime(anim_date.year, anim_date.month, anim_date.day, h, m, 0)\n\n        # Solar geometry\n        day_of_year = obs_time.timetuple().tm_yday\n        declination = 23.44 * np.sin(np.radians(360 / 365 * (day_of_year - 81)))\n        hours_utc = obs_time.hour + obs_time.minute / 60\n        subsolar_lon = 180 - (hours_utc / 24) * 360\n\n        ax.stock_img()\n        ax.add_feature(Nightshade(obs_time, alpha=0.4))\n\n        # Subsolar point marker\n        ax.plot(\n            subsolar_lon, declination,\n            marker=\"*\", markersize=18, color=\"yellow\", markeredgecolor=\"orange\",\n            markeredgewidth=0.8, transform=ccrs.PlateCarree(), zorder=10,\n        )\n\n        # Declination latitude line\n        ax.plot(\n            [-180, 180], [declination, declination],\n            color=\"yellow\", linewidth=1.2, linestyle=\"--\", alpha=0.7,\n            transform=ccrs.PlateCarree(), zorder=9,\n        )\n        # Equator\n        ax.plot(\n            [-180, 180], [0, 0],\n            color=\"white\", linewidth=0.6, linestyle=\":\", alpha=0.5,\n            transform=ccrs.PlateCarree(), zorder=9,\n        )\n\n        ax.add_feature(cfeature.COASTLINE, linewidth=0.4, color=\"0.3\")\n        ax.set_global()\n        ax.set_facecolor(\"black\")\n        ax.set_title(\n            f\"Sunlight on Earth — {obs_time:%Y-%m-%d %H:%M} UTC — \"\n            f\"Subsolar point {declination:.1f}°N, {subsolar_lon:.1f}°E\",\n            fontsize=13, color=\"white\", pad=12,\n        )\n\n    anim = FuncAnimation(fig, draw_frame, frames=list(frame_hours), interval=1000 / 15)\n    anim.save(str(output_path), writer=PillowWriter(fps=15), dpi=120, savefig_kwargs={\"facecolor\": \"black\"})\n    plt.close(fig)\n    print(f\"Saved animation to {output_path}\")\n\n\nfor d in dates:\n    suffix = f\"{d:%Y_%m_%d}\"\n    create_sunlight_animation(d, paths.images_path / f\"10_sunlight_animation_{suffix}.gif\")","key":"AkrwSSBT4C"},{"type":"outputs","id":"iBjOF1V6x3lP6TxOQieyM","children":[],"key":"oADdUXIWFL"}],"key":"QWvpCSr6ii"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_sunlight_animatio-f6ac1e7f74d4bb303b286ea8782c1a27.gif","alt":"Sunlight on Earth over 24 hours on 2025-06-21 (summer solstice). The yellow\nstar marks the subsolar point; the dashed line shows the solar declination\nlatitude (~23.4°N). Notice that the Arctic never enters darkness.","data":{"altTextIsAutoGenerated":true},"key":"AFeRN55Kdq","urlSource":"../../output/images/10_sunlight_animation_2025_06_21.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-sunlight-summer","identifier":"fig-10-sunlight-summer","html_id":"fig-10-sunlight-summer","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"ViXYdz92n9"},{"type":"text","value":"1","key":"pjp72WFW8C"},{"type":"text","value":":","key":"x6J96s0E9z"}],"template":"Figure %s:","key":"FaFTpj80JO"},{"type":"text","value":"Sunlight on Earth over 24 hours on 2025-06-21 (summer solstice). The yellow\nstar marks the subsolar point; the dashed line shows the solar declination\nlatitude (~23.4°N). Notice that the Arctic never enters darkness.","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"wHVa59ZOa3"}],"key":"zhtWH9ST18"}],"key":"Riqp7BvfjT"}],"label":"fig-10-sunlight-summer","identifier":"fig-10-sunlight-summer","enumerator":"1","html_id":"fig-10-sunlight-summer","key":"oe0rfIJqKA"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_sunlight_animatio-9529d05e261afc575ecd198349935301.gif","alt":"Winter solstice (2025-12-21). The subsolar point has moved to ~23.4°S.\nNow it is the Antarctic that enjoys continuous daylight, while the Arctic\nremains in polar night.","data":{"altTextIsAutoGenerated":true},"key":"M4Vqfha1pU","urlSource":"../../output/images/10_sunlight_animation_2025_12_21.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-sunlight-winter","identifier":"fig-10-sunlight-winter","html_id":"fig-10-sunlight-winter","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"ruimKlqaK6"},{"type":"text","value":"2","key":"VU9Vxkmmgg"},{"type":"text","value":":","key":"EvhCuxXmCS"}],"template":"Figure %s:","key":"XDKtmgqAxT"},{"type":"text","value":"Winter solstice (2025-12-21). The subsolar point has moved to ~23.4°S.\nNow it is the Antarctic that enjoys continuous daylight, while the Arctic\nremains in polar night.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"RsBTMyjj2p"}],"key":"N4TnnWaeBi"}],"key":"hnmF44R3Vw"}],"label":"fig-10-sunlight-winter","identifier":"fig-10-sunlight-winter","enumerator":"2","html_id":"fig-10-sunlight-winter","key":"mi95ae4Ud9"}],"key":"ILjQlWxhaD"},{"type":"block","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"The subsolar point and its annual migration","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"SuYnKZ92ZX"}],"identifier":"the-subsolar-point-and-its-annual-migration","label":"The subsolar point and its annual migration","html_id":"the-subsolar-point-and-its-annual-migration","implicit":true,"key":"a1oGntS2sg"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"sm1ej11wcJ"},{"type":"strong","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"subsolar point","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"kTCBcAAJvO"}],"key":"oNJOWF7cpZ"},{"type":"text","value":" is the location on Earth where the Sun is directly\noverhead — i.e. the solar elevation is exactly 90°. Its latitude equals the\n","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"nybefXBHaA"},{"type":"strong","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"solar declination","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"R9CP5M9DRr"}],"key":"hfSymKE9qE"},{"type":"text","value":", which can be approximated as:","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"JOYgIbrk5X"}],"key":"oBFQnASrOt"},{"type":"math","value":"\\delta = 23.44° \\times \\sin\\!\\left(\\frac{360°}{365} \\times (d - 81)\\right)","position":{"start":{"line":156,"column":1},"end":{"line":158,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>23.44</mn><mi mathvariant=\"normal\">°</mi><mo>×</mo><mi>sin</mi><mo>⁡</mo><mtext> ⁣</mtext><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mn>360</mn><mi mathvariant=\"normal\">°</mi></mrow><mn>365</mn></mfrac><mo>×</mo><mo stretchy=\"false\">(</mo><mi>d</mi><mo>−</mo><mn>81</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\delta = 23.44° \\times \\sin\\!\\left(\\frac{360°}{365} \\times (d - 81)\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord\">23.44°</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">365</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">360°</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">81</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"1","key":"BnuzyI91fF"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"cfJB6slrLx"},{"type":"inlineMath","value":"d","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"q83HYEMXMn"},{"type":"text","value":" is the day of the year (so ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"Fi5axu4sDn"},{"type":"inlineMath","value":"d = 81","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>81</mn></mrow><annotation encoding=\"application/x-tex\">d = 81</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">81</span></span></span></span>","key":"gOu0aisgP5"},{"type":"text","value":" corresponds to the spring\nequinox around March 22, when ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"ag3KDdaPi0"},{"type":"inlineMath","value":"\\delta = 0","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\delta = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"UpxTstyDdE"},{"type":"text","value":").","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"KRY0qm8qH9"}],"key":"eSMNkxTI1i"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"Over the course of a year, the subsolar latitude oscillates between the\n","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"NIIC0pk9Nd"},{"type":"strong","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Tropic of Cancer","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"PUSoD4pUcy"}],"key":"QhooTpJ456"},{"type":"text","value":" (~23.4°N, around June 21) and the ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"lsDZCmfwgb"},{"type":"strong","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Tropic of\nCapricorn","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"TgFmkQb5uz"}],"key":"qQEphtDRdV"},{"type":"text","value":" (~23.4°S, around December 21). The animation below shows one\nframe per week, tracing this migration at solar noon (12:00 UTC).","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"VzLTxvjLb0"}],"key":"h0w6mvkEU5"}],"key":"E0XUnRLdd6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"weeks = np.arange(0, 52)\nweek_dates = [datetime(2025, 1, 1) + timedelta(weeks=int(w)) for w in weeks]\n\nfig, ax = plt.subplots(figsize=(16, 9), subplot_kw={\"projection\": ccrs.Robinson()})\nfig.patch.set_facecolor(\"black\")\n\n\ndef draw_subsolar_frame(i):\n    ax.clear()\n    d = week_dates[i]\n    obs_time = datetime(d.year, d.month, d.day, 12, 0, 0)\n\n    day_of_year = obs_time.timetuple().tm_yday\n    declination = 23.44 * np.sin(np.radians(360 / 365 * (day_of_year - 81)))\n    subsolar_lon = 0.0  # at 12:00 UTC\n\n    ax.stock_img()\n    ax.add_feature(Nightshade(obs_time, alpha=0.3))\n\n    # Declination latitude line\n    ax.plot(\n        [-180, 180], [declination, declination],\n        color=\"yellow\", linewidth=2, linestyle=\"--\", alpha=0.9,\n        transform=ccrs.PlateCarree(), zorder=9,\n    )\n    # Subsolar point\n    ax.plot(\n        subsolar_lon, declination,\n        marker=\"*\", markersize=20, color=\"yellow\", markeredgecolor=\"orange\",\n        markeredgewidth=0.8, transform=ccrs.PlateCarree(), zorder=10,\n    )\n\n    # Tropic lines\n    for tropic_lat in [23.44, -23.44]:\n        ax.plot(\n            [-180, 180], [tropic_lat, tropic_lat],\n            color=\"white\", linewidth=0.5, linestyle=\":\", alpha=0.4,\n            transform=ccrs.PlateCarree(), zorder=8,\n        )\n    # Equator\n    ax.plot(\n        [-180, 180], [0, 0],\n        color=\"white\", linewidth=0.6, linestyle=\":\", alpha=0.5,\n        transform=ccrs.PlateCarree(), zorder=8,\n    )\n\n    ax.add_feature(cfeature.COASTLINE, linewidth=0.4, color=\"0.3\")\n    ax.set_global()\n    ax.set_facecolor(\"black\")\n    ax.set_title(\n        f\"Subsolar Latitude — {obs_time:%Y-%m-%d} (week {i + 1}/52) — \"\n        f\"Declination {declination:.1f}°{'N' if declination >= 0 else 'S'}\",\n        fontsize=13, color=\"white\", pad=12,\n    )\n\n\nanim = FuncAnimation(fig, draw_subsolar_frame, frames=len(week_dates), interval=1000 / 15)\noutput_file = paths.images_path / \"10_subsolar_migration.gif\"\nanim.save(str(output_file), writer=PillowWriter(fps=15), dpi=120, savefig_kwargs={\"facecolor\": \"black\"})\nplt.close(fig)\nprint(f\"Saved animation to {output_file}\")","key":"BPVENWlHAT"},{"type":"outputs","id":"z0hbcXqIX_XtTeIIPQtvl","children":[],"key":"G563Ar4lqR"}],"key":"mrhTjlzA33"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_subsolar_migratio-f99617e145893c0da042d69165d501d9.gif","alt":"Migration of the subsolar latitude over the year (one frame per week). The\nyellow dashed line shows where the Sun is directly overhead at noon UTC. It\noscillates between the Tropic of Cancer (~23.4°N in June) and the Tropic of\nCapricorn (~23.4°S in December).","data":{"altTextIsAutoGenerated":true},"key":"sNQfOdGUtE","urlSource":"../../output/images/10_subsolar_migration.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-subsolar-migration","identifier":"fig-10-subsolar-migration","html_id":"fig-10-subsolar-migration","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"vHi1LYONc8"},{"type":"text","value":"3","key":"ek2mNsg79T"},{"type":"text","value":":","key":"GR8j4mT8xs"}],"template":"Figure %s:","key":"hg6qHAE7o4"},{"type":"text","value":"Migration of the subsolar latitude over the year (one frame per week). The\nyellow dashed line shows where the Sun is directly overhead at noon UTC. It\noscillates between the Tropic of Cancer (~23.4°N in June) and the Tropic of\nCapricorn (~23.4°S in December).","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"pwO845FyGr"}],"key":"ntHrmEUSut"}],"key":"AGz6VF3c7C"}],"label":"fig-10-subsolar-migration","identifier":"fig-10-subsolar-migration","enumerator":"3","html_id":"fig-10-subsolar-migration","key":"Z7cVRIMRWo"}],"key":"fcsQMzBUI7"},{"type":"block","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"Solar elevation — the Sun’s angle above the horizon","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"hEVDymsvED"}],"identifier":"solar-elevation-the-suns-angle-above-the-horizon","label":"Solar elevation — the Sun’s angle above the horizon","html_id":"solar-elevation-the-suns-angle-above-the-horizon","implicit":true,"key":"ryWbdGrM9S"},{"type":"paragraph","position":{"start":{"line":244,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"yhCQazpoDT"},{"type":"strong","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"solar elevation","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"iCIIF0SVYx"}],"key":"GyxWtWUEw5"},{"type":"text","value":" (or altitude angle) is the angle of the Sun above\nthe horizon, measured from 0° (sunrise/sunset) to 90° (directly overhead).\nIt determines how much energy a square metre of surface receives: a high\nSun concentrates light into a small area, while a low Sun spreads it thin.","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"lwNbJd0h6D"}],"key":"wYFUURU2sr"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"For any location (latitude ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"y4bm4VCiR4"},{"type":"inlineMath","value":"\\varphi","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>φ</mi></mrow><annotation encoding=\"application/x-tex\">\\varphi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">φ</span></span></span></span>","key":"IvhpJLKq96"},{"type":"text","value":") and time, the elevation ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"qXqkW2XzxA"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"GuPyvPxpIZ"},{"type":"text","value":" is:","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"SiZnros2Uo"}],"key":"rzjc3YTq0K"},{"type":"math","value":"\\sin(\\alpha) = \\sin(\\varphi)\\,\\sin(\\delta) + \\cos(\\varphi)\\,\\cos(\\delta)\\,\\cos(h)","position":{"start":{"line":251,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>α</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>φ</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>δ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>φ</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>δ</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin(\\alpha) = \\sin(\\varphi)\\,\\sin(\\delta) + \\cos(\\varphi)\\,\\cos(\\delta)\\,\\cos(h)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">φ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">φ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"gbDDhBNM4G"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"jjS1PY4Xs8"},{"type":"inlineMath","value":"\\delta","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi></mrow><annotation encoding=\"application/x-tex\">\\delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span></span></span></span>","key":"bNKYqP3sgw"},{"type":"text","value":" is the solar declination (computed above) and ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"QB4kugYPzH"},{"type":"inlineMath","value":"h","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"qbwhOZ4QM8"},{"type":"text","value":" is the\n","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"xtBtNML24g"},{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"hour angle","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"Fr6ppxa061"}],"key":"odGVBbXieG"},{"type":"text","value":" — the Sun’s angular displacement from local solar noon\n(","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"esJNIwFLlC"},{"type":"inlineMath","value":"h = 0","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"LmfScCmCRT"},{"type":"text","value":" at noon, 15° per hour).","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"Pvv0OMZ1y1"}],"key":"DzYXfAm0q8"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"The heatmaps below show solar elevation for every day of the year and every\nminute of the day, for two cities at very different latitudes: ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"cpzq7WQEfF"},{"type":"strong","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Munich","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"tZmdTpRrHE"}],"key":"Y1OMOBcKLO"},{"type":"text","value":"\n(48.1°N) and ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"uB4kie6xZo"},{"type":"strong","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Sydney","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"E0hfDGmYBQ"}],"key":"GLrKLtzyeK"},{"type":"text","value":" (33.9°S). Grey areas indicate nighttime (elevation\nbelow 0°).","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"mQ6ajzHQgF"}],"key":"VARx9u4wD2"}],"key":"ayJcIlrUlj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"locations = [\n    {\"name\": \"Munich\", \"lat\": 48.14, \"lon\": 11.58, \"utc_offset\": 1, \"tz_label\": \"CET\"},\n    {\"name\": \"Sydney\", \"lat\": -33.87, \"lon\": 151.21, \"utc_offset\": 11, \"tz_label\": \"AEDT\"},\n]\n\ndays = np.arange(1, 366)\nhours_of_day = np.arange(0, 24, 1 / 60)  # one-minute resolution\nday_grid, hour_grid = np.meshgrid(days, hours_of_day)\n\n# Solar declination (same for all locations)\ndeclination_rad = np.radians(\n    23.44 * np.sin(np.radians(360 / 365 * (day_grid - 81)))\n)\n\nmonth_starts = [1, 32, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335]\nmonth_labels = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n\nfor loc in locations:\n    lat_rad = np.radians(loc[\"lat\"])\n\n    local_hours = hours_of_day\n    utc_hours = local_hours - loc[\"utc_offset\"]\n    day_grid_loc, utc_hour_grid = np.meshgrid(days, utc_hours)\n    _, local_hour_grid = np.meshgrid(days, local_hours)\n\n    # Hour angle: sun's angular displacement from solar noon\n    solar_hour = utc_hour_grid + loc[\"lon\"] / 15\n    hour_angle_rad = np.radians(15 * (solar_hour - 12))\n\n    # Solar elevation\n    sin_elev = (\n        np.sin(lat_rad) * np.sin(declination_rad)\n        + np.cos(lat_rad) * np.cos(declination_rad) * np.cos(hour_angle_rad)\n    )\n    elevation_deg = np.degrees(np.arcsin(np.clip(sin_elev, -1, 1)))\n    elevation_deg = np.where(elevation_deg < 0, np.nan, elevation_deg)\n\n    fig, ax = plt.subplots(figsize=(14, 6))\n\n    cmap = plt.cm.YlOrRd.copy()\n    cmap.set_bad(\"0.15\")\n\n    im = ax.pcolormesh(\n        day_grid_loc, local_hour_grid, elevation_deg,\n        cmap=cmap, vmin=0, vmax=70, shading=\"auto\",\n    )\n\n    cb = fig.colorbar(im, ax=ax, pad=0.02)\n    cb.set_label(\"Solar elevation (°)\", fontsize=11)\n\n    ax.set_xticks(month_starts)\n    ax.set_xticklabels(month_labels)\n    ax.set_yticks(range(0, 25, 3))\n    ax.set_ylabel(f\"Hour of day ({loc['tz_label']}, UTC{loc['utc_offset']:+d})\", fontsize=11)\n    ax.set_xlabel(\"Day of year\", fontsize=11)\n    ax.set_title(\n        f\"Solar Elevation — {loc['name']} ({abs(loc['lat']):.1f}°{'N' if loc['lat'] >= 0 else 'S'}, \"\n        f\"{abs(loc['lon']):.1f}°{'E' if loc['lon'] >= 0 else 'W'})\",\n        fontsize=13,\n    )\n\n    fig.tight_layout()\n    filename = f\"10_elevation_heatmap_{loc['name'].lower()}.png\"\n    fig.savefig(paths.images_path / filename, dpi=150, bbox_inches=\"tight\")\n    plt.show()","key":"whHlLw7cpc"},{"type":"outputs","id":"0kv-Ewn_psjaMA3s5GYLO","children":[],"key":"AQqQn1cteB"}],"key":"mbtOPOgLZB"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_elevation_heatmap-67a9c6f443907a7253b86cb8fc07b13b.png","alt":"Solar elevation at Munich (48.1°N, 11.6°E) for every day and minute of\nthe year. In summer, the Sun reaches ~65° and daylight lasts over 16 hours.\nIn winter, the maximum elevation drops to ~18° with less than 8 hours of\ndaylight. Grey areas indicate nighttime.","data":{"altTextIsAutoGenerated":true},"key":"ZfZkMgDEWB","urlSource":"../../output/images/10_elevation_heatmap_munich.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-elevation-munich","identifier":"fig-10-elevation-munich","html_id":"fig-10-elevation-munich","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"aWqzgc7tVb"},{"type":"text","value":"4","key":"KhCbDnJcm8"},{"type":"text","value":":","key":"Mnb0l8nYMd"}],"template":"Figure %s:","key":"RYYa1Gs2Qp"},{"type":"text","value":"Solar elevation at Munich (48.1°N, 11.6°E) for every day and minute of\nthe year. In summer, the Sun reaches ~65° and daylight lasts over 16 hours.\nIn winter, the maximum elevation drops to ~18° with less than 8 hours of\ndaylight. Grey areas indicate nighttime.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"RP43NfsR2H"}],"key":"dab5erekzE"}],"key":"f4XQ7gR2Rw"}],"label":"fig-10-elevation-munich","identifier":"fig-10-elevation-munich","enumerator":"4","html_id":"fig-10-elevation-munich","key":"rHJx5jMlFk"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_elevation_heatmap-c51f99f402fd97b9d877c559e6a7b54e.png","alt":"Solar elevation at Sydney (33.9°S, 151.2°E). Being in the Southern\nHemisphere, Sydney’s seasons are inverted — longest days around December,\nshortest in June. The higher maximum elevation (~80°) reflects its lower\nlatitude compared to Munich, and the seasonal daylight variation is less\nextreme.","data":{"altTextIsAutoGenerated":true},"key":"DMcXRC1IO0","urlSource":"../../output/images/10_elevation_heatmap_sydney.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":343,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-elevation-sydney","identifier":"fig-10-elevation-sydney","html_id":"fig-10-elevation-sydney","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"FmyCsPep44"},{"type":"text","value":"5","key":"mTaYXKrY0s"},{"type":"text","value":":","key":"Fd9M3udR0I"}],"template":"Figure %s:","key":"igVLtEOD8q"},{"type":"text","value":"Solar elevation at Sydney (33.9°S, 151.2°E). Being in the Southern\nHemisphere, Sydney’s seasons are inverted — longest days around December,\nshortest in June. The higher maximum elevation (~80°) reflects its lower\nlatitude compared to Munich, and the seasonal daylight variation is less\nextreme.","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"GNGAFFDzHg"}],"key":"QBXKQRFVXx"}],"key":"bQjRsWftB7"}],"label":"fig-10-elevation-sydney","identifier":"fig-10-elevation-sydney","enumerator":"5","html_id":"fig-10-elevation-sydney","key":"FXJogQmUQo"}],"key":"qRTWGGJ0KQ"},{"type":"block","position":{"start":{"line":350,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"Global temperatures — the diurnal cycle","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"kUrUXRJumj"}],"identifier":"global-temperatures-the-diurnal-cycle","label":"Global temperatures — the diurnal cycle","html_id":"global-temperatures-the-diurnal-cycle","implicit":true,"key":"yN6kbPGNRq"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"The varying sunlight intensity directly drives temperature patterns across\nthe globe. To observe this, we use ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"kQlmIFKlv2"},{"type":"strong","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"ERA5 reanalysis data","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"pWPIr5AdRj"}],"key":"g4VBSxqgYJ"},{"type":"text","value":" — a global\ngridded dataset produced by the European Centre for Medium-Range Weather\nForecasts (ECMWF) that combines weather observations with numerical models.\nThe variable shown is ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"Gd9wkvuxkv"},{"type":"strong","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"2-metre temperature","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"NXGhVSsj3X"}],"key":"QJ9MJV3y7k"},{"type":"text","value":" (the air temperature at 2 m\nabove the surface), which is the standard measure of surface air temperature.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"ig6IIZk6XW"}],"key":"rl9PfZinWw"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"Note that this dataset is ","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"tlElj3pHUa"},{"type":"strong","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"ERA5-Land","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"tEotlI5kJb"}],"key":"MJeMGKI9mV"},{"type":"text","value":", which only covers land surfaces —\noceans appear black (no data). A key feature visible in the animation is how\nquickly continents heat and cool: land has a low heat capacity, so\ntemperatures swing sharply between day and night. Oceans, by contrast, change\ntemperature much more slowly, which is why coastal cities have milder\nclimates than continental interiors.","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"qLLfQZjm1s"}],"key":"WVjn2E8Fpn"}],"key":"Wkhq4tvA1Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import ee\nimport geemap\nfrom dotenv import load_dotenv\n\nload_dotenv()\nee.Initialize(project=os.environ[\"EE_GCP_PROJECT_ID\"])","key":"zktrGtY0cF"},{"type":"outputs","id":"aVvoVGba3nPjnogJ69Mi9","children":[],"key":"uHKFY8JaI5"}],"key":"G2LXudjI8o"},{"type":"block","children":[],"key":"pgrfDZhZTF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"era5 = ee.ImageCollection(\"ECMWF/ERA5_LAND/HOURLY\").select(\"temperature_2m\")\n\nstart = \"2024-01-01\"\nend = \"2025-01-01\"\nera5_year = era5.filterDate(start, end)\n\n# Build a 24-image collection: one mean image per UTC hour\nhourly_images = []\nfor hour in range(24):\n    hourly_mean = (\n        era5_year\n        .filter(ee.Filter.calendarRange(hour, hour, \"hour\"))\n        .mean()\n        .subtract(273.15)  # K -> °C\n    )\n    hourly_mean = hourly_mean.set(\"hour\", hour).set(\"label\", f\"{hour:02d}:00 UTC\")\n    hourly_images.append(hourly_mean)\n\ncol = ee.ImageCollection(hourly_images)\nprint(f\"Collection size: {col.size().getInfo()} images\")","key":"N6k5jQzdzG"},{"type":"outputs","id":"Sc6iZxB4Cf2-NzB4D8Bmz","children":[],"key":"A6xcJwJ430"}],"key":"Rn5wGkBQ66"},{"type":"block","children":[],"key":"ZRoXaR0VEd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"vis_params = {\n    \"min\": -40,\n    \"max\": 40,\n    \"palette\": [\n        \"#313695\", \"#4575b4\", \"#74add1\", \"#abd9e9\",\n        \"#e0f3f8\", \"#ffffbf\", \"#fee090\", \"#fdae61\",\n        \"#f46d43\", \"#d73027\", \"#a50026\",\n    ],\n    \"dimensions\": 800,\n    \"framesPerSecond\": 3,\n}\n\ngif_path = str(paths.images_path / \"10_ee_temperature_by_hour.gif\")\n\ngeemap.download_ee_video(col, vis_params, gif_path)\nprint(f\"GIF saved to {gif_path}\")","key":"HRYXn4yolX"},{"type":"outputs","id":"901hwV-1OFrS1DOhPVjcx","children":[],"key":"OUKLsGVF5m"}],"key":"lNNr5NmJIY"},{"type":"block","children":[],"key":"sW2RUK32NN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"labels = [f\"{h:02d}:00 UTC\" for h in range(24)]\n\ngeemap.add_text_to_gif(\n    gif_path,\n    gif_path,\n    xy=(\"5%\", \"90%\"),\n    text_sequence=labels,\n    font_size=20,\n    font_color=\"white\",\n    add_progress_bar=True,\n    progress_bar_color=\"cyan\",\n    progress_bar_height=5,\n)\nprint(f\"Annotated GIF saved to {gif_path}\")","key":"ISZffQA1TX"},{"type":"outputs","id":"aPxDRzUryv6WkoFfQW_Fa","children":[],"key":"mJZHTpJTqE"}],"key":"cHJ2hG1iBV"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_ee_temperature_by-211eef374055df20ea4ed82cbf482009.gif","alt":"Average 2-metre temperature by hour of day (UTC), computed from a full year\nof ERA5-Land reanalysis data. The “heat wave” sweeps westward as the Sun\nmoves, and the large day-night temperature swing over continents is clearly\nvisible. Oceans appear black because ERA5-Land only covers land surfaces.","data":{"altTextIsAutoGenerated":true},"key":"mN6POi68Pu","urlSource":"../../output/images/10_ee_temperature_by_hour.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":438,"column":1},"end":{"line":441,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-temperature-diurnal","identifier":"fig-10-temperature-diurnal","html_id":"fig-10-temperature-diurnal","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"Xt3RvcLUom"},{"type":"text","value":"6","key":"dTjwpfIlHU"},{"type":"text","value":":","key":"cF7rDsnDnX"}],"template":"Figure %s:","key":"RmejgMbUjR"},{"type":"text","value":"Average 2-metre temperature by hour of day (UTC), computed from a full year\nof ERA5-Land reanalysis data. The “heat wave” sweeps westward as the Sun\nmoves, and the large day-night temperature swing over continents is clearly\nvisible. Oceans appear black because ERA5-Land only covers land surfaces.","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"r5bet9cAEo"}],"key":"IgzxIsvfcw"}],"key":"stIylFxuWB"}],"label":"fig-10-temperature-diurnal","identifier":"fig-10-temperature-diurnal","enumerator":"6","html_id":"fig-10-temperature-diurnal","key":"yykhHrOquH"}],"key":"Gp0OkddrHh"},{"type":"block","position":{"start":{"line":444,"column":1},"end":{"line":444,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"Global temperatures — the seasonal cycle","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"kB23g7SNA5"}],"identifier":"global-temperatures-the-seasonal-cycle","label":"Global temperatures — the seasonal cycle","html_id":"global-temperatures-the-seasonal-cycle","implicit":true,"key":"ieXksuIblz"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":453,"column":1}},"children":[{"type":"text","value":"Over the course of months, the sustained difference in sunlight between\nhemispheres creates the familiar ","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"ktkusCBHXV"},{"type":"strong","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"seasons","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"K85w4p4JU2"}],"key":"JGsd2EuQZw"},{"type":"text","value":". Note that temperature extremes\ntypically lag the solstices by about 4–6 weeks — this ","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"tiT9USkK5G"},{"type":"strong","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"thermal lag","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"lmE1dROtuP"}],"key":"juvNjT06SW"},{"type":"text","value":" occurs\nbecause the Earth’s surface and atmosphere take time to heat up and cool\ndown, similar to how the hottest part of the day is usually mid-afternoon\nrather than noon.","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"tk8XSgGkGR"}],"key":"egiZDdWun6"},{"type":"paragraph","position":{"start":{"line":455,"column":1},"end":{"line":458,"column":1}},"children":[{"type":"text","value":"The ocean again plays a moderating role: maritime and coastal climates have\nmilder seasonal swings, while continental interiors (like Siberia or central\nCanada) experience the most extreme temperature differences between summer\nand winter.","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"anEf47LqId"}],"key":"s1jxOzCYbr"}],"key":"Wyx6FyrVTE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"monthly_images = []\nmonthly_labels = []\nfor month in range(1, 13):\n    month_slices = []\n    for year in range(2022, 2025):\n        days_in_month = calendar.monthrange(year, month)[1]\n        m_start = f\"{year}-{month:02d}-01\"\n        m_end = f\"{year}-{month:02d}-{days_in_month:02d}T23:59\"\n        month_slices.append(\n            era5.filterDate(m_start, m_end)\n            .filter(ee.Filter.calendarRange(12, 12, \"hour\"))\n        )\n    merged = month_slices[0]\n    for s in month_slices[1:]:\n        merged = merged.merge(s)\n    monthly_mean = merged.mean().subtract(273.15)\n    label = calendar.month_abbr[month]\n    monthly_mean = monthly_mean.set(\"month\", month).set(\"label\", label)\n    monthly_images.append(monthly_mean)\n    monthly_labels.append(label)\n\ncol_monthly = ee.ImageCollection(monthly_images)\nprint(f\"Monthly collection size: {col_monthly.size().getInfo()} images\")","key":"YWoMBUoFui"},{"type":"outputs","id":"zGzMTobpx1Tsj0hAoDIWK","children":[],"key":"wNd0UYoDGW"}],"key":"V0MW8NYs84"},{"type":"block","children":[],"key":"GKb1W95RNc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"vis_params_monthly = {\n    \"min\": -40,\n    \"max\": 40,\n    \"palette\": [\n        \"#313695\", \"#4575b4\", \"#74add1\", \"#abd9e9\",\n        \"#e0f3f8\", \"#ffffbf\", \"#fee090\", \"#fdae61\",\n        \"#f46d43\", \"#d73027\", \"#a50026\",\n    ],\n    \"dimensions\": 600,\n    \"framesPerSecond\": 1,\n}\n\ngif_monthly_path = str(paths.images_path / \"10_ee_temperature_by_month.gif\")\n\ngeemap.download_ee_video(col_monthly, vis_params_monthly, gif_monthly_path)\nprint(f\"Monthly GIF saved to {gif_monthly_path}\")","key":"RPbvyBHuTW"},{"type":"outputs","id":"OU2yesLqTWK380U2OydGu","children":[],"key":"cPWHfOle6j"}],"key":"hAEEHg2ryy"},{"type":"block","children":[],"key":"k56Tshx2SU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"geemap.add_text_to_gif(\n    gif_monthly_path,\n    gif_monthly_path,\n    xy=(\"5%\", \"90%\"),\n    text_sequence=monthly_labels,\n    font_size=20,\n    font_color=\"white\",\n    add_progress_bar=True,\n    progress_bar_color=\"cyan\",\n    progress_bar_height=5,\n)\nprint(f\"Annotated monthly GIF saved to {gif_monthly_path}\")","key":"I92RAJPCHX"},{"type":"outputs","id":"QTmoADdb5py-96K-mfB8L","children":[],"key":"vs01Ela13t"}],"key":"VToeicWIsw"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_ee_temperature_by-1e5b4f8857b75d008f3c824cafda653a.gif","alt":"Average 2-metre temperature by month, computed from ERA5-Land noon snapshots\nacross 2022–2024. The hemispheric temperature contrast shifts as the\nsubsolar latitude migrates. Continental interiors show the most extreme\nseasonal swings. Oceans are not shown (ERA5-Land covers land only).","data":{"altTextIsAutoGenerated":true},"key":"CNkwv3DAls","urlSource":"../../output/images/10_ee_temperature_by_month.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":522,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-temperature-seasonal","identifier":"fig-10-temperature-seasonal","html_id":"fig-10-temperature-seasonal","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"B9fFskFWv0"},{"type":"text","value":"7","key":"osOYgXns1L"},{"type":"text","value":":","key":"BWjWvWV9kF"}],"template":"Figure %s:","key":"xb4leNMIWj"},{"type":"text","value":"Average 2-metre temperature by month, computed from ERA5-Land noon snapshots\nacross 2022–2024. The hemispheric temperature contrast shifts as the\nsubsolar latitude migrates. Continental interiors show the most extreme\nseasonal swings. Oceans are not shown (ERA5-Land covers land only).","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"OcqvpoiQzx"}],"key":"cvHP3n8XHk"}],"key":"xgzqfz476P"}],"label":"fig-10-temperature-seasonal","identifier":"fig-10-temperature-seasonal","enumerator":"7","html_id":"fig-10-temperature-seasonal","key":"YvVKnqr7tr"}],"key":"iTRVboHbRh"},{"type":"block","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"children":[{"type":"text","value":"Vegetation — the seasonal green wave","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"bn0dEYTnVt"}],"identifier":"vegetation-the-seasonal-green-wave","label":"Vegetation — the seasonal green wave","html_id":"vegetation-the-seasonal-green-wave","implicit":true,"key":"u9TXLNdUak"},{"type":"paragraph","position":{"start":{"line":532,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"text","value":"The temperature and moisture patterns driven by the Sun’s position have a\ndirect and visible impact on vegetation. We can observe this from space\nusing the ","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"MCXQC71uS3"},{"type":"strong","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"text","value":"Normalized Difference Vegetation Index (NDVI)","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"wHmdCzAHt2"}],"key":"m8kWBQjNGj"},{"type":"text","value":", computed from\nsatellite imagery as:","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"NKOxIAK0ZE"}],"key":"Dh7nY46Cce"},{"type":"math","value":"\\text{NDVI} = \\frac{\\text{NIR} - \\text{Red}}{\\text{NIR} + \\text{Red}}","position":{"start":{"line":537,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>NDVI</mtext><mo>=</mo><mfrac><mrow><mtext>NIR</mtext><mo>−</mo><mtext>Red</mtext></mrow><mrow><mtext>NIR</mtext><mo>+</mo><mtext>Red</mtext></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\text{NDVI} = \\frac{\\text{NIR} - \\text{Red}}{\\text{NIR} + \\text{Red}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">NDVI</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1408em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">NIR</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">Red</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">NIR</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">Red</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"tSTZmyX8pZ"},{"type":"paragraph","position":{"start":{"line":541,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"where NIR is near-infrared reflectance and Red is visible red reflectance.\nHealthy green vegetation ","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"s26FMhys2g"},{"type":"strong","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"children":[{"type":"text","value":"strongly reflects","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"v3jgZBIgFN"}],"key":"UC8n36yqgt"},{"type":"text","value":" near-infrared light (which\nit doesn’t need) and ","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"fnkyF2XjZ7"},{"type":"strong","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"children":[{"type":"text","value":"absorbs","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"nBeo1Q7Lkc"}],"key":"RCZAZRxbIk"},{"type":"text","value":" red light (which it uses for\nphotosynthesis). This makes NDVI a reliable indicator of vegetation health:","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"RAk5TymeYC"}],"key":"uLeu1oPrIm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":546,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":546,"column":1},"end":{"line":547,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"NDVI > 0.6","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"oOmWIR5fmn"}],"key":"jkLeXsq8n9"},{"type":"text","value":" — dense, healthy vegetation (tropical forests, croplands\nin growing season)","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"L55aQl3d3m"}],"key":"vqXgE0ODXp"}],"key":"bWjlo7gqgH"},{"type":"listItem","spread":true,"position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"text","value":"NDVI 0.2–0.6","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"key":"dtDZE66i0y"}],"key":"vOJBS1upC4"},{"type":"text","value":" — moderate vegetation (grasslands, sparse forests)","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"key":"R7CfIJjj0B"}],"key":"JF5wlCkurX"}],"key":"I5btcPFPbu"},{"type":"listItem","spread":true,"position":{"start":{"line":549,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"children":[{"type":"text","value":"NDVI < 0.1","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"CvEnl5JPPx"}],"key":"dtMVxPtCUp"},{"type":"text","value":" — bare soil, water, snow, or desert","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"QXYuUAatgu"}],"key":"bbdIji02vT"}],"key":"VpPM76Waol"}],"key":"M8b47OFdMd"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":555,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"uQizKXnIr4"},{"type":"strong","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"children":[{"type":"text","value":"MODIS Terra","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"FeDsyps3YF"}],"key":"ipHITmrWye"},{"type":"text","value":" 16-day NDVI composites (MOD13A2, 1 km resolution)\nto build a multi-year median for each 16-day period, producing ~23 frames\nthat reveal the seasonal “green wave”. The wave tracks the subsolar latitude\n— as warmth and moisture arrive, vegetation pulses to life. We overlay the\nsubsolar declination line (yellow dashed) to make this connection visible.","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"DSl8wzvZjJ"}],"key":"ticuwOeOLR"}],"key":"MdrOm4maq1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ndvi_col = ee.ImageCollection(\"MODIS/061/MOD13A2\").select(\"NDVI\")\n\nndvi_col = ndvi_col.map(\n    lambda img: img.set(\n        \"doy\", ee.Date(img.get(\"system:time_start\")).getRelative(\"day\", \"year\")\n    )\n)\n\n# Use one year as the DOY template (23 composites, every 16 days)\ndistinct_doy = ndvi_col.filterDate(\"2020-01-01\", \"2021-01-01\")\n\n# Join all years by matching DOY, then take the median\njoin_filter = ee.Filter.equals(leftField=\"doy\", rightField=\"doy\")\njoin = ee.Join.saveAll(\"doy_matches\")\njoined = ee.ImageCollection(join.apply(distinct_doy, ndvi_col, join_filter))\n\nndvi_composites = joined.map(\n    lambda img: (\n        ee.ImageCollection.fromImages(img.get(\"doy_matches\"))\n        .reduce(ee.Reducer.median())\n        .rename(\"NDVI\")\n        .copyProperties(img, [\"doy\", \"system:time_start\"])\n    )\n)\n\nprint(f\"NDVI composites: {ndvi_composites.size().getInfo()} frames\")","key":"fMpU09c7La"},{"type":"outputs","id":"HqsovW34nJzYiVvMqRjk4","children":[],"key":"l0RaF0GS1r"}],"key":"Hssl3D8DPr"},{"type":"block","children":[],"key":"rOTwnYbIna"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ndvi_vis = {\n    \"min\": 0,\n    \"max\": 9000,\n    \"palette\": [\n        \"FFFFFF\", \"CE7E45\", \"DF923D\", \"F1B555\", \"FCD163\", \"99B718\", \"74A901\",\n        \"66A000\", \"529400\", \"3E8601\", \"207401\", \"056201\", \"004C00\", \"023B01\",\n        \"012E01\", \"011D01\", \"011301\",\n    ],\n}\n\nndvi_rgb = ndvi_composites.map(lambda img: img.visualize(**ndvi_vis))\n\ngif_ndvi_params = {\n    \"dimensions\": 600,\n    \"framesPerSecond\": 4,\n}\n\ngif_ndvi_path = str(paths.images_path / \"10_ee_ndvi_by_doy.gif\")\n\ngeemap.download_ee_video(ndvi_rgb, gif_ndvi_params, gif_ndvi_path)\nprint(f\"NDVI GIF saved to {gif_ndvi_path}\")","key":"qHMjok5LlF"},{"type":"outputs","id":"Mmv_lzhY0iGBU8u3_zmRW","children":[],"key":"JcMHo4wit2"}],"key":"j9tcCu8mMA"},{"type":"block","children":[],"key":"YB7oYmbP9A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"doy_list = list(range(1, 366, 16))  # 1, 17, 33, ...\nndvi_labels = [\n    (date(2024, 1, 1) + timedelta(days=d - 1)).strftime(\"%b %d\")\n    for d in doy_list\n]\n\ngeemap.add_text_to_gif(\n    gif_ndvi_path,\n    gif_ndvi_path,\n    xy=(\"5%\", \"90%\"),\n    text_sequence=ndvi_labels,\n    font_size=20,\n    font_color=\"white\",\n    add_progress_bar=True,\n    progress_bar_color=\"green\",\n    progress_bar_height=5,\n)\nprint(f\"Annotated NDVI GIF saved to {gif_ndvi_path}\")","key":"IqyB49i7HQ"},{"type":"outputs","id":"B8Zv9gXQy3jPAPyCTsx-m","children":[],"key":"IpLqWVq6ZM"}],"key":"oRRY1pp3bs"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"children":[{"type":"text","value":"Subsolar latitude overlay","position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"key":"vDHDlJobvv"}],"identifier":"subsolar-latitude-overlay","label":"Subsolar latitude overlay","html_id":"subsolar-latitude-overlay","implicit":true,"key":"kHg79wzwRU"},{"type":"paragraph","position":{"start":{"line":633,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"text","value":"To highlight the connection between the Sun’s position and vegetation, we\ndraw the subsolar declination latitude as a yellow dashed line on each frame.","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"key":"tsEag78hQV"}],"key":"qLAAZ7GQlF"}],"key":"MfhDmuEcbJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"global_lat_min, global_lat_max = -90, 90\n\n\ndef solar_declination(doy: int) -> float:\n    \"\"\"Solar declination in degrees for a given day-of-year.\"\"\"\n    return 23.44 * math.sin(math.radians(360 / 365 * (doy - 81)))\n\n\ndef add_subsolar_line(gif_in_path, lat_min, lat_max):\n    \"\"\"Add a dashed yellow subsolar-latitude line to each frame of a GIF.\"\"\"\n    gif = Image.open(gif_in_path)\n    frames = []\n    durations = []\n    frame_idx = 0\n\n    try:\n        while True:\n            frame = gif.copy().convert(\"RGBA\")\n            draw = ImageDraw.Draw(frame)\n            w, h = frame.size\n\n            doy = doy_list[frame_idx % len(doy_list)]\n            decl = solar_declination(doy)\n            y = int((lat_max - decl) / (lat_max - lat_min) * h)\n\n            dash_len, gap_len = 12, 6\n            x = 0\n            while x < w:\n                draw.line([(x, y), (min(x + dash_len, w), y)], fill=\"yellow\", width=2)\n                x += dash_len + gap_len\n\n            frames.append(frame)\n            durations.append(gif.info.get(\"duration\", 250))\n            frame_idx += 1\n            gif.seek(gif.tell() + 1)\n    except EOFError:\n        pass\n\n    frames[0].save(\n        gif_in_path,\n        save_all=True,\n        append_images=frames[1:],\n        duration=durations,\n        loop=0,\n    )\n\n\nadd_subsolar_line(gif_ndvi_path, global_lat_min, global_lat_max)\nprint(f\"Subsolar line added to {gif_ndvi_path}\")","key":"DFkm6vH6LR"},{"type":"outputs","id":"i2qcpaNsdXA-0IAF_5m90","children":[],"key":"s15wm7Jr5k"}],"key":"vGZFiHBtpG"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_ee_ndvi_by_doy-3b4e29073f51be0fb212d064a267fed9.gif","alt":"Global NDVI seasonal cycle (multi-year median of MODIS Terra 16-day\ncomposites). The yellow dashed line marks the subsolar latitude. Vegetation\ngreens up in each hemisphere’s spring/summer, closely tracking the Sun’s\nposition. The boreal forest “green wave” sweeping northward in May–June is\none of the most visible seasonal changes on Earth.","data":{"altTextIsAutoGenerated":true},"key":"FFcKG23eXa","urlSource":"../../output/images/10_ee_ndvi_by_doy.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":690,"column":1},"end":{"line":694,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-ndvi-global","identifier":"fig-10-ndvi-global","html_id":"fig-10-ndvi-global","enumerator":"8","children":[{"type":"text","value":"Figure ","key":"B33Ff3538A"},{"type":"text","value":"8","key":"iI4wEwDNS2"},{"type":"text","value":":","key":"ntnu62AVFe"}],"template":"Figure %s:","key":"sTD46kBjhY"},{"type":"text","value":"Global NDVI seasonal cycle (multi-year median of MODIS Terra 16-day\ncomposites). The yellow dashed line marks the subsolar latitude. Vegetation\ngreens up in each hemisphere’s spring/summer, closely tracking the Sun’s\nposition. The boreal forest “green wave” sweeping northward in May–June is\none of the most visible seasonal changes on Earth.","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"meDGS75ow8"}],"key":"suegT8y0gU"}],"key":"gGB08OuOH3"}],"label":"fig-10-ndvi-global","identifier":"fig-10-ndvi-global","enumerator":"8","html_id":"fig-10-ndvi-global","key":"CkVOgU9DrE"}],"key":"UWAq4je5D8"},{"type":"block","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"children":[{"type":"text","value":"Vegetation — Africa close-up","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"UdapRLnkwr"}],"identifier":"vegetation-africa-close-up","label":"Vegetation — Africa close-up","html_id":"vegetation-africa-close-up","implicit":true,"key":"VqZsA3DFaU"},{"type":"paragraph","position":{"start":{"line":701,"column":1},"end":{"line":707,"column":1}},"children":[{"type":"text","value":"Africa straddles both tropics, making it an ideal region to observe the\nseasonal vegetation pulse. The most dramatic change occurs in the ","position":{"start":{"line":701,"column":1},"end":{"line":701,"column":1}},"key":"kFvmjXVrVC"},{"type":"strong","position":{"start":{"line":701,"column":1},"end":{"line":701,"column":1}},"children":[{"type":"text","value":"Sahel","position":{"start":{"line":701,"column":1},"end":{"line":701,"column":1}},"key":"NGSYNZPZQx"}],"key":"qwulaLNjqs"},{"type":"text","value":"\n— the semi-arid transition zone between the Sahara and the tropical savannas.\nDuring the West African monsoon (approximately June–September), moisture\nfrom the Gulf of Guinea pushes northward, triggering a rapid greening of the\nSahel. This vegetation pulse closely follows the northward migration of the\nsubsolar latitude and retreats as the Sun moves south again.","position":{"start":{"line":701,"column":1},"end":{"line":701,"column":1}},"key":"fqipyDFyzi"}],"key":"uKdmolc9S0"}],"key":"F8P1Wutasu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"africa = ee.Geometry.Rectangle([-20, -35, 55, 38])\n\nndvi_rgb_africa = ndvi_composites.map(\n    lambda img: img.visualize(**ndvi_vis).clip(africa)\n)\n\ngif_ndvi_africa_params = {\n    \"dimensions\": 800,\n    \"framesPerSecond\": 4,\n    \"region\": africa,\n}\n\ngif_ndvi_africa_path = str(paths.images_path / \"10_ee_ndvi_africa_by_doy.gif\")\n\ngeemap.download_ee_video(ndvi_rgb_africa, gif_ndvi_africa_params, gif_ndvi_africa_path)\nprint(f\"NDVI Africa GIF saved to {gif_ndvi_africa_path}\")","key":"E50FEXEDiu"},{"type":"outputs","id":"X31erXbVsOLV6qz3pWhm6","children":[],"key":"WrDrrMZRdD"}],"key":"gDEkmThB2d"},{"type":"block","children":[],"key":"SqjfQtZTjr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"geemap.add_text_to_gif(\n    gif_ndvi_africa_path,\n    gif_ndvi_africa_path,\n    xy=(\"5%\", \"90%\"),\n    text_sequence=ndvi_labels,\n    font_size=20,\n    font_color=\"white\",\n    add_progress_bar=True,\n    progress_bar_color=\"green\",\n    progress_bar_height=5,\n)\nprint(f\"Annotated NDVI Africa GIF saved to {gif_ndvi_africa_path}\")","key":"WOB9OZ7EfI"},{"type":"outputs","id":"FA7j3TJazVdm8LKSi1ZHQ","children":[],"key":"VtOibS2BEr"}],"key":"v91zJlvAiJ"},{"type":"block","children":[],"key":"LG4BTGwRD2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"add_subsolar_line(gif_ndvi_africa_path, lat_min=-35, lat_max=38)\nprint(f\"Subsolar line added to {gif_ndvi_africa_path}\")","key":"VbrmQ3Askj"},{"type":"outputs","id":"cZ-u4S2PVRSjzojtE_IYW","children":[],"key":"R9JtVrk71E"}],"key":"rUkITJzKYj"},{"type":"block","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/world-of-energy/build/10_ee_ndvi_africa_by-4009bbc170e1eaacfb09b85989c11405.gif","alt":"NDVI seasonal cycle over Africa. The Sahel’s rapid greening during the\nmonsoon season (June–September) is clearly visible as a band of green\npushing northward, closely following the subsolar latitude (yellow dashed\nline). Southern Africa shows the opposite pattern, greening during the\naustral summer (November–March).","data":{"altTextIsAutoGenerated":true},"key":"KRn8U6PBa2","urlSource":"../../output/images/10_ee_ndvi_africa_by_doy.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":750,"column":1},"end":{"line":754,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-10-ndvi-africa","identifier":"fig-10-ndvi-africa","html_id":"fig-10-ndvi-africa","enumerator":"9","children":[{"type":"text","value":"Figure ","key":"xyHIz3mfJZ"},{"type":"text","value":"9","key":"E3wefUMQaS"},{"type":"text","value":":","key":"qhxgZX3zNO"}],"template":"Figure %s:","key":"lkY662U2Od"},{"type":"text","value":"NDVI seasonal cycle over Africa. The Sahel’s rapid greening during the\nmonsoon season (June–September) is clearly visible as a band of green\npushing northward, closely following the subsolar latitude (yellow dashed\nline). Southern Africa shows the opposite pattern, greening during the\naustral summer (November–March).","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"WUJdxyOKXJ"}],"key":"ZYOz8szbde"}],"key":"QvRdLTLwuB"}],"label":"fig-10-ndvi-africa","identifier":"fig-10-ndvi-africa","enumerator":"9","html_id":"fig-10-ndvi-africa","key":"cfzi4DPalg"}],"key":"Ytrik1qetw"}],"key":"tAgZgMesDQ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Seasonality Heatmaps","url":"/notebooks/load-seasonalities","group":"World of Energy"},"next":{"title":"Resources","url":"/markdown/resources","group":"World of Energy"}}},"domain":"http://localhost:3000"}